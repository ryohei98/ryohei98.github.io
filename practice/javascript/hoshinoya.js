!function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){"use strict";exports.__esModule=!0;var ua=navigator.userAgent.toLowerCase(),platform=navigator.platform.toLowerCase(),win=ua.match(/windows/),mac=ua.match(/macintosh/),googlebot=ua.match(/googlebot/),yahoobot=ua.indexOf("y!j")>=0,bingbot=ua.match(/bing/),crawlerbot=googlebot||yahoobot||bingbot,uc=ua.match(/ubrowser/),qq=ua.match(/qqbrowser/),cn=!(!uc&&!qq),edge=ua.match(/windows/)&&ua.match(/edge/),ie=ua.match(/msie/)||ua.match(/trident/)||edge,ie8=ua.match(/msie 8/),ie9=ua.match(/msie 9/),ie10=ua.match(/msie 10/),chrome=ua.match(/chrome/),safari=ua.match(/safari/)&&!ua.match(/chrome/),firefox=ua.match(/firefox/),opera=ua.match(/opera/),iphone=ua.match(/iphone/),ipod=ua.match(/ipod/),ipad=ua.match(/ipad/),ios=iphone||ipod||ipad,android=ua.match(/android/),androidMobile=android&&ua.match(/mobile/),androidTablet=android&&!ua.match(/mobile/),androidLegacy=ua.match(/android 2|android 4.0|android 4.1|android 4.2|android 4.3/),ios_ver=null,android_ver=null;try{if(ios){ios_ver=(ua.split(" os ")[1]||"").split(" ")[0];var v1=parseInt(ios_ver.split("_")[0]),v2=parseInt(ios_ver.split("_")[1]||0);ios_ver=parseInt(((v1<10?"0":"")+v1+v2).substr(0,3))}android&&(android_ver=(ua.split("android ")[1]||"").substr(0,3).split(".").join(""),android_ver=parseInt(android_ver))}catch(e){alert(e)}var macPC="macintel"===platform,mobile=androidMobile||iphone||ipod,tablet=androidTablet||ipad,hasTouch="ontouchstart"in window,touch=hasTouch&&!win,desktop=!touch,retina=window.devicePixelRatio>=2;win&&(retina=!1);var pixelratio=retina?1.5:1;iphone&&(pixelratio=2),tablet&&(pixelratio=1),(cn||"cn"===(window.HOSHINOYA&&window.HOSHINOYA.domain))&&(pixelratio=1);var canVideoPlaysInline=!!(desktop||ios&&ios_ver>=100);exports.default={googlebot:googlebot,yahoobot:yahoobot,bingbot:bingbot,crawlerbot:crawlerbot,win:win,mac:mac,uc:uc,qq:qq,cn:cn,ie:ie,ie8:ie8,ie9:ie9,ie10:ie10,edge:edge,chrome:chrome,safari:safari,firefox:firefox,opera:opera,ios:ios,iphone:iphone,ipad:ipad,android:android,androidLegacy:androidLegacy,androidMobile:androidMobile,androidTablet:androidTablet,ios_ver:ios_ver,android_ver:android_ver,mobile:mobile,tablet:tablet,touch:touch,desktop:desktop,retina:retina,pixelratio:pixelratio,canVideoPlaysInline:canVideoPlaysInline,macPC:macPC}},{}],2:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function($){$.fn.css3=function(option){var transforms=[];return void 0===option.scale&&void 0===option.scaleX&&void 0===option.scaleY||transforms.push("scale("+(option.scale||option.scaleX||0)+", "+(option.scale||option.scaleY||0)+")"),void 0===option.x&&void 0===option.y&&void 0===option.z||transforms.push("translate3d("+(option.x||0)+"px, "+(option.y||0)+"px, "+(option.z||0)+"px)"),void 0!==option.rotate&&transforms.push("rotate("+option.rotate+"deg)"),void 0!==option.rotateX&&transforms.push("rotateX("+(option.rotateX||0)+"deg)"),void 0!==option.rotateY&&transforms.push("rotateY("+option.rotateY+"deg)"),void 0!==option.rotateZ&&transforms.push("rotateZ("+option.rotateZ+"deg)"),this.each(function(el){this.style["-webkit-transform"]=this.style.transform=transforms.join(" ")}),this}}},{}],3:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function($){$.fn.switchClass=function(className,isAdd,delay,callback){var $self=this;if(0!==$self.length){var f=function(){isAdd?$self.addClass(className):$self.removeClass(className),callback&&callback()};return delay>=0&&clearTimeout($self.switchClassDelayID),delay>0?$self.switchClassDelayID=setTimeout(f,delay):f(),this}}}},{}],4:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _eventemitter=require("eventemitter2"),_Tween=require("../utils/Tween"),_Tween2=_interopRequireDefault(_Tween),_Browsers=require("../constants/Browsers"),_Browsers2=_interopRequireDefault(_Browsers),WindowStore=function(_EventEmitter){function WindowStore(props){_classCallCheck(this,WindowStore);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this,props));return _this.setMaxListeners(0),_this}return _inherits(WindowStore,_EventEmitter),WindowStore.prototype.setup=function(){this._isSetup||(this._isSetup=!0,this.$window=$(window),this.$html=$("html"),this.$body=$(document.body),this.$htmlBody=$("html,body"),this.$scrollBody=$(_Browsers2.default.touch?".bodyInner":document.body),this.$scrollTarget=_Browsers2.default.touch?$(".bodyInner"):this.$window,this._info={loaded:!1,width:void 0,height:void 0,scrollTop:void 0,isPC:void 0,isSP:void 0,isFocus:!0,modelOpened:!1,scrollBarWidth:this._calcScrollBarWidth()},this._modaOpenCount=0,this.$checker=$('<div class="jsm-windowstore__checker"></div>').appendTo(this.$body),this.$window.on("load",this._loadHdl.bind(this)).on("resize",this._resizeHdl.bind(this)).on("focus",this._focusHdl.bind(this)).on("blur",this._blurHdl.bind(this)),this.$scrollTarget.on("scroll",this._scrollHdl.bind(this)),this._resizeHdl())},WindowStore.prototype._calcScrollBarWidth=function(){if(_Browsers2.default.touch)return 0;var $outer=$('<div style="position: absolute; visibility: hidden; opacity: 0;"><div style="overflow: scroll;"><div style="width: 100px; height: 100px;"></div><div></div>').appendTo(document.body),$inner=$outer.find("div"),w=$outer.outerWidth()-$inner.outerWidth();return $outer.remove(),w},WindowStore.prototype.onAll=function(resizeHdl,scrollHdl){this.onLoad(resizeHdl).onResize(resizeHdl).onScroll(scrollHdl),resizeHdl()},WindowStore.prototype.onLoad=function(f){return this.on("load",f),this},WindowStore.prototype.onResize=function(f){return this.on("resize",f),this},WindowStore.prototype.onFocus=function(f){return this.on("focus",f),this},WindowStore.prototype.onBreak=function(f){return this.on("break",f),this},WindowStore.prototype.onScroll=function(f){return this.on("scroll",f),this},WindowStore.prototype.onModalStateChange=function(f){return this.on("modalstate",f),this},WindowStore.prototype.offResize=function(f){return f?(this.off("resize",f),this):this},WindowStore.prototype.offFocus=function(f){return f?(this.off("focus",f),this):this},WindowStore.prototype.offBreak=function(f){return f?(this.off("break",f),this):this},WindowStore.prototype.offScroll=function(f){return f?(this.off("scroll",f),this):this},WindowStore.prototype.offModalStateChange=function(f){return this.on("modalstate",f),this},WindowStore.prototype.triggerResize=function(){this.emit("resize",this._info)},WindowStore.prototype.triggerScroll=function(){this.emit("scroll",this._info)},WindowStore.prototype.triggerFoucs=function(){this.emit("focus",this._info)},WindowStore.prototype.scrollTo=function(top){var _this2=this,duration=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this._tw&&this._tw.stop(),0===duration)return this.$scrollTarget.scrollTop(top);this._tw=this._tw||new _Tween2.default,this._tw.it({start:this.getScrollTop(),end:top,duration:duration,easing:"easeInOutQuad",onProgress:function(v){_this2.$scrollTarget.scrollTop(v)}})},WindowStore.prototype.switchModalState=function(opened){var delay=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;clearTimeout(this._modalDelayId),delay?this._modalDelayId=setTimeout(this._switchModalState.bind(this,opened),delay):this._switchModalState(opened)},WindowStore.prototype._switchModalState=function(opened){this._modaOpenCount+=opened?1:-1,this._modaOpenCount<0&&(this._modaOpenCount=0),opened=this._modaOpenCount>0,this._info.modelOpened!==opened&&(this._info.modelOpened=opened,this.$html.switchClass("js-modalopened",opened),opened?(this._info.scrollBarWidth&&this.$body.css("margin-right",this._info.scrollBarWidth),_Browsers2.default.touch?this.$scrollTarget.css({height:"100%",overflow:"hidden"}):(this.$html.css("overflow","hidden"),this._memoriedScrollTop=this.getScrollTop(),this.$body.scrollTop(this._memoriedScrollTop))):(this._info.scrollBarWidth&&this.$body.css("margin-right",""),_Browsers2.default.touch?this.$scrollTarget.css({height:"",overflow:""}):(this.$htmlBody.css({height:"",overflow:""}),this.$body.scrollTop(0),this.scrollTo(this._memoriedScrollTop))),this._modalOffsetRight(),this.emit("modalstate"))},WindowStore.prototype._modalOffsetRight=function(){var barWidth=this.getScrollBarWidth();barWidth&&$(".jsm-windowstore__modaloffsetright").css("right",this.getModelOpened()?barWidth:"")},WindowStore.prototype.getWidth=function(){return this._info.width},WindowStore.prototype.getHeight=function(){return this._info.height},WindowStore.prototype.getScrollTop=function(){return this._info.scrollTop},WindowStore.prototype.getIsPC=function(){return this._info.isPC},WindowStore.prototype.getIsSP=function(){return this._info.isSP},WindowStore.prototype.getIsFocus=function(){return this._info.isFocus},WindowStore.prototype.getScrollBarWidth=function(){return this._info.scrollBarWidth},WindowStore.prototype.getModelOpened=function(){return this._info.modelOpened},WindowStore.prototype.calcElTop=function($el){var top=$el.offset().top;return _Browsers2.default.touch&&(top+=this._info.scrollTop),top},WindowStore.prototype._loadHdl=function(){this._info.loaded=!0,this.emit("load",this._info),this.triggerResize()},WindowStore.prototype._resizeHdl=function(){this._info.width=window.innerWidth||this.$window.width(),this._info.height=window.innerHeight||this.$window.height();var checkerW=this.$checker.css("width"),isPC=1===Math.round(parseFloat(checkerW));this._info.isPC!==isPC&&(this._info.isPC=isPC,this._info.isSP=!isPC,this.emit("break")),this.triggerResize(),this._scrollHdl()},WindowStore.prototype._scrollHdl=function(){this._info.scrollTop=this.$scrollTarget.scrollTop(),this.triggerScroll()},WindowStore.prototype._focusHdl=function(){this._info.isFocus=!0,this.triggerFoucs()},WindowStore.prototype._blurHdl=function(){this._info.isFocus=!1,this.triggerFoucs()},WindowStore}(_eventemitter.EventEmitter2);exports.default=new WindowStore},{"../constants/Browsers":1,"../utils/Tween":9,eventemitter2:117}],5:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Util=require("./Util"),_Util2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Util),DomUtil=function(){function DomUtil(){_classCallCheck(this,DomUtil)}return DomUtil.findNearestParent=function($el){var tagName=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"a";return $el[0].tagName.toLowerCase()===tagName?$el:this.findNearestParent($el.parent(),tagName)},DomUtil.on=function(el,eventName,fn){_.each(eventName.split(" "),function(e){el.addEventListener?el.addEventListener(e,fn,!1):el.attachEvent("on"+e,fn)})},DomUtil.off=function(el,eventName,fn){_.each(eventName.split(" "),function(e){el.removeEventListener?el.removeEventListener(e,fn,!1):el.detachEvent("on"+e,fn)})},DomUtil.getRect=function(el){var rect=el.getBoundingClientRect();return{x:rect.left,y:rect.top,width:el.offsetWidth,height:el.offsetHeight}},DomUtil.attr2data=function(el){return _.reduce(el.attributes,function(res,attr){var k=attr.name.split("data-")[1];if(!k)return res;var v=attr.value;return v.indexOf&&(v.indexOf(",")>=0||v.indexOf(":")>=0)&&v.indexOf("//")<0&&(v=v.split(","),v=_.map(v,function(v2){return _Util2.default.str2arr(v2,":")})),res[k]=_Util2.default.parseFloatOrRaw(v),res},{})},DomUtil.domHeight=function(el){var $el=$(el);return $el.outerHeight()+parseInt($el.css("margin-top"))+parseInt($el.css("margin-bottom"))},DomUtil.domChildrenHeight=function(el){var _this=this;return _.sum(_.map($(el).children(),function(child){return _this.domHeight(child)}))},DomUtil.copyProtect=function($el){$el.attr("unselectable","on").attr("draggable","false").css({"-moz-user-select":"none","-o-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none"})},DomUtil.getFormData=function($form){return _.reduce($form.find("select, input[type=text], input[type=radio]:checked, input[type=checkbox]:checked"),function(res,el){var $el=$(el),name=$el.attr("name"),val=$el.val();return res[name]=res[name]?res[name]+","+val:val,res},{})},DomUtil.addClass=function(el,className){el.classList?el.classList.add(className):el.className+=" "+className},DomUtil.removeClass=function(el,className){el.classList?el.classList.remove(className):el.className=el.className.replace(new RegExp("(^|\\b)"+className.split(" ").join("|")+"(\\b|$)","gi")," ")},DomUtil.switchClass=function(el,className,isAdd){isAdd?this.addClass(el,className):this.removeClass(el,className)},DomUtil}();exports.default=DomUtil},{"./Util":11}],6:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Util=require("./Util"),_Util2=_interopRequireDefault(_Util),_DomUtil=require("./DomUtil"),_DomUtil2=_interopRequireDefault(_DomUtil),Draggee=function(){function Draggee(){_classCallCheck(this,Draggee),this.bindedUpdate=this.update.bind(this),this.bindedStartHdl=this.startHdl.bind(this),this.bindedMoveHdl=this.moveHdl.bind(this),this.bindedEndHdl=this.endHdl.bind(this)}return Draggee.prototype.init=function(node,options){var _this=this;return this.node=node,this.$=$(node),this.$body=$(document.body),this.options=_.assign({preventDefaultEvent:!1,accelDecreasePer:.5,lockVertical:!1},options||{}),this.isStarted=!1,this.$.on("mousedown touchstart MSPointerDown",this.bindedStartHdl),_DomUtil2.default.copyProtect(this.$),this.$.on("click","a",function(e){_this._onceMoved&&(e.preventDefault(),e.stopPropagation()),_this._onceMoved=!1}),this},Draggee.prototype.setOptions=function(options){this.options=_.assign(this.options,options)},Draggee.prototype.clear=function(){this.cancelUpdate(),this.unbindDrag(),this.$&&this.$.off(),_Util2.default.deleteAll(this)},Draggee.prototype.onStart=function(fn){return this.startCallback=fn,this},Draggee.prototype.onMove=function(fn){return this.moveCallback=fn,this},Draggee.prototype.onEnd=function(fn){return this.endCabllback=fn,this},Draggee.prototype.onEndDir=function(fn){return this.endDirCallback=fn,this},Draggee.prototype.onClick=function(fn){return this.clickCabllback=fn,this},Draggee.prototype.bindDrag=function(){this.$&&this.$.on("mousemove touchmove MSPointerMove",this.bindedMoveHdl),this.$body&&this.$body.on("mouseup touchend MSPointerUp",this.bindedEndHdl)},Draggee.prototype.unbindDrag=function(){this.$&&this.$.off("mousemove touchmove MSPointerMove",this.bindedMoveHdl),this.$body&&this.$body.off("mouseup touchend MSPointerUp",this.bindedEndHdl)},Draggee.prototype.startHdl=function(e){if(e=e||{type:""},this.options.preventDefaultEvent&&(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()),e.type.indexOf("touch")>=0&&(this._touchFired=!0),!(this._touchFired&&(e.type.indexOf("mouse")>=0||e.type.indexOf("MSPointer")>=0||e.type.indexOf("pointer")>=0)||this.isStarted)){this.isStarted=!0,this._multiTouch=!1,this._onceMoved=!1,this._xMoved=!1;var p=_Util2.default.getPoint(e);this.ix=p.x,this.iy=p.y,this.dx=this.dy=this.ax=this.ay=0,this.startCallback&&this.startCallback(p.x,p.y,e),this.bindDrag(),this.update()}},Draggee.prototype.moveHdl=function(e){if(this.isStarted){if(e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches.length>1)return void(this._multiTouch=!0);this.options.preventDefaultEvent&&(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()),this._onceMoved=!0;var p=_Util2.default.getPoint(e),dx=p.x-this.ix,dy=p.y-this.iy;this.ax+=dx-this.dx,this.ay+=dy-this.dy,this.dx=dx,this.dy=dy,Math.abs(dx)>Math.abs(dy)&&(this._xMoved=!0),this.options.lockVertical&&this._xMoved&&(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation())}},Draggee.prototype.endHdl=function(e){if(this.isStarted&&(this.options.preventDefaultEvent&&(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()),this.isStarted)){this.isStarted=!1,this.unbindDrag(),this.cancelUpdate(),this.endCabllback&&this.endCabllback(this.dx,this.dy,this.ax,this.ay);var dir=0,limitW=.5*this.node.offsetWidth;Math.abs(this.dx)>Math.abs(this.dy)&&Math.abs(this.ax)>Math.abs(this.ay)&&(this.dx<0&&this.ax<-1.5?dir=1:this.dx>0&&this.ax>1.5?dir=-1:this.dx<-limitW?dir=1:this.dx>limitW&&(dir=-1)),this.endDirCallback&&this.endDirCallback(dir),this._onceMoved||this._multiTouch||this.clickCabllback&&this.clickCabllback(e)}},Draggee.prototype.update=function(){this.cancelUpdate(),this.ax*=this.options.accelDecreasePer,this.ay*=this.options.accelDecreasePer,this.moveCallback&&this.moveCallback(this.dx,this.dy,this.ax,this.ay),this.updateID=_Util2.default.requestAnimationFrame(this.bindedUpdate)},Draggee.prototype.cancelUpdate=function(){this.updateID&&_Util2.default.cancelAnimationFrame(this.updateID)},Draggee}();exports.default=Draggee},{"./DomUtil":5,"./Util":11}],7:[function(require,module,exports){"use strict";exports.__esModule=!0;var _tweenFunctions=require("tween-functions"),_tweenFunctions2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_tweenFunctions);exports.default={it:function(currentTime,startValue,endValue,duration,easing){var _this=this,easingFunc=_tweenFunctions2.default[easing]||_tweenFunctions2.default.linear;return _.isNumber(startValue)||_.isString(startValue)?this._easingString(currentTime,startValue,endValue,duration,easingFunc):_.reduce(startValue,function(res,startNum,key){var endNum=endValue[key];return res[key]=_this._easingString(currentTime,startNum,endNum,duration,easingFunc),res},{})},_easingString:function(currentTime,startValue,endValue,duration,easingFunc){if(_.isNumber(startValue)&&_.isNumber(endValue))return easingFunc(currentTime,startValue,endValue,duration);var startStr=""+startValue,startNum=parseInt(startValue),endNum=parseInt(endValue),val=easingFunc(currentTime,startNum,endNum,duration);return startStr.split(""+startNum).join(val)}}},{"tween-functions":307}],8:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_WindowStore=require("../stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Util=require("./Util"),_Util2=_interopRequireDefault(_Util),_Tween=require("./Tween"),_Tween2=_interopRequireDefault(_Tween),_Settings=require("../../main/Settings"),_Settings2=_interopRequireDefault(_Settings),OnePageScroll=function(){function OnePageScroll(){var conf=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{$el:null,$front:null,$back:null,$backText:null,draggee:null,onSwitchDown:null,onUpdate:null};_classCallCheck(this,OnePageScroll),this.conf=conf,this.$=conf.$el,this.$front=conf.$front,this.$back=conf.$back,this.$backText=conf.$backText,this._draggee=conf.draggee,this.$body=$(document.body),this.$router=$(".jsm-router"),this._bindedResizeHdl=this._resizeHdl.bind(this),this._bindedScrollHdl=this._scrollHdl.bind(this),this._bindedTouchStartHdl=this._touchStartHdl.bind(this),this._bindedTouchMoveHdl=this._touchMoveHdl.bind(this),this._bindedTouchEndHdl=this._touchEndHdl.bind(this),this._down=void 0,this._reachTop=!1,this._y=0,_WindowStore2.default.onResize(this._bindedResizeHdl).onScroll(this._bindedScrollHdl),this._resizeHdl(),this._scrollHdl()}return _createClass(OnePageScroll,[{key:"isDown",get:function(){return this._down}}]),OnePageScroll.prototype.destroy=function(){_WindowStore2.default.offResize(this._bindedResizeHdl).offScroll(this._bindedScrollHdl),this.activate(!1),this.$router=null,_Util2.default.deleteAll(this)},OnePageScroll.prototype.activate=function(active){this.$router[active?"on":"off"]("touchstart",this._bindedTouchStartHdl)[active?"on":"off"]("touchmove",this._bindedTouchMoveHdl)[active?"on":"off"]("touchend",this._bindedTouchEndHdl),active&&void 0===this._down&&this._switchDown(!1,{isDirect:!0}),active||(this.$front.removeAttr("style"),this.$back.removeAttr("style"),this.$backText&&this.$backText.removeAttr("style"))},OnePageScroll.prototype.scrollClicked=function(){this._switchDown(!0,{byClick:!0,killTimer:!0})},OnePageScroll.prototype._resizeHdl=function(){this._sh=_WindowStore2.default.getHeight()},OnePageScroll.prototype._scrollHdl=function(){var reachTop=_WindowStore2.default.getScrollTop()<=0;this._reachTop!==reachTop&&(this._reachTop=reachTop)},OnePageScroll.prototype._switchDown=function(down){var _this=this,switchOptions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._switchKilled){switchOptions.killTimer&&(this._switchKilled=!0,setTimeout(function(){_this._switchKilled=!1},100)),this._down=down;var end=this._down?0:this._sh;this._tw=this._tw||new _Tween2.default,this._tw.it({start:this._y,end:end,duration:switchOptions.isDirect?0:switchOptions.byClick?900:500,easing:switchOptions.byClick?"easeInOutQuart":"easeOutQuart",onProgress:function(v){_this._updateY(v)}}),clearTimeout(this._classDelayId),this._classDelayId=setTimeout(function(){_this.$.switchClass("js-scrollDown",down)},switchOptions.byClick?500:0),this.conf.onSwitchDown&&this.conf.onSwitchDown(down,switchOptions)}},OnePageScroll.prototype._touchStartHdl=function(e){_WindowStore2.default.getModelOpened()||(this._touchStarted=!0,this._touchMoved=!1,this._draggee&&this._draggee.startHdl(e.originalEvent),this._down||(e.stopPropagation(),e.preventDefault()),this._startDragY=_Util2.default.getPoint(e).y,this._oldDY=0,this.$body.trigger("touchstartOriginal",e))},OnePageScroll.prototype._touchMoveHdl=function(e){if(!_WindowStore2.default.getModelOpened()){this._touchMoved=!0,this._draggee&&this._draggee.moveHdl(e.originalEvent);var dy=_Util2.default.getPoint(e).y-this._startDragY;if((!this._down||this._down&&this._reachTop&&dy>0)&&(e.stopPropagation(),e.preventDefault()),!this._down||this._reachTop){this._dir=dy-this._oldDY>0?1:-1,this._oldDY=dy;var y=(this._down?0:this._sh)+dy;this._updateY(y)}}},OnePageScroll.prototype._touchEndHdl=function(e){if(!_WindowStore2.default.getModelOpened()){if(this._touchStarted&&!this._touchMoved){var isA="a"===e.target.tagName.toLowerCase();isA&&e.target.getAttribute("href");$(e.target).trigger("click")}if(this._touchStarted=this._touchMoved=!1,this._draggee&&this._draggee.endHdl(e.originalEvent),this._down&&!this._reachTop||(e.stopPropagation(),e.preventDefault()),!this._down||this._reachTop){var down=this._down;!this._down&&this._dir<0&&this._oldDY<-50&&(down=!0),this._down&&this._dir>0&&this._oldDY>50&&(down=!1),this._switchDown(down)}}},OnePageScroll.prototype._updateY=function(y){if(y=Math.max(0,Math.min(this._sh,y)),this._y!==y){this._y=y,this.$front.css3({y:y});var backY=(1-y/this._sh)*-_Settings2.default.outlinehero.parallax;this.$back.css3({y:backY}),this.$backText&&this.$backText.css3({y:y-this._sh}),this.conf.onUpdate&&this.conf.onUpdate(y)}},OnePageScroll}();exports.default=OnePageScroll},{"../../main/Settings":21,"../stores/WindowStore":4,"./Tween":9,"./Util":11}],9:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Interpolate=require("./Interpolate"),_Interpolate2=_interopRequireDefault(_Interpolate),_Util=require("./Util"),_Util2=_interopRequireDefault(_Util),Tween=function(){function Tween(){var defaultValue=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;_classCallCheck(this,Tween),this._currentValue=defaultValue,this._bindedTick=this._tick.bind(this)}return Tween.prototype.it=function(props){this._p=_.assign({start:this._currentValue,end:0,duration:0,delay:0,easing:"easeInOutQuad",onProgress:null,onComplete:null},props),this.stop(),0===this._p.delay?this._start():this._delayId=setTimeout(this._start.bind(this),this._p.delay)},Tween.prototype.pause=function(){this._isPaused=!0,this.stop(),this._elapsedTime=(new Date).getTime()-this._startTime},Tween.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._start(this._elapsedTime))},Tween.prototype.stop=function(){clearTimeout(this._delayId),_Util2.default.cancelAnimationFrame(this._tickId)},Tween.prototype._start=function(){var elapsedTime=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._startTime=(new Date).getTime(),elapsedTime&&(this._startTime-=elapsedTime),this._tick()},Tween.prototype._tick=function(){var currentTime=Math.min((new Date).getTime()-this._startTime,this._p.duration);this._currentValue=0===this._p.duration?this._p.end:_Interpolate2.default.it(currentTime,this._p.start,this._p.end,this._p.duration,this._p.easing),this._p.onProgress&&this._p.onProgress(this._currentValue,currentTime/this._p.duration),currentTime>=this._p.duration?this._p.onComplete&&this._p.onComplete():this._tickId=_Util2.default.requestAnimationFrame(this._bindedTick)},Tween}();exports.default=Tween},{"./Interpolate":7,"./Util":11}],10:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var Url=function(){function Url(){_classCallCheck(this,Url)}return Url.prototype.parse=function(url){var queryStr=url.split("?")[1],query={};return(queryStr?queryStr.split("&"):[]).forEach(function(v){var arr=v.split("="),key=arr[0],val=arr[1];isNaN(Number(val))||(val=Number(val)),query[key]=val}),{query:query}},Url.prototype.queryObj2str=function(obj){return _.reduce(obj,function(res,v,k){return res&&(res+="&"),v=encodeURIComponent(v),res+=k+"="+v},"")},Url}();module.exports=new Url},{}],11:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Browsers=require("../constants/Browsers"),_Browsers2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Browsers),d=new Date,NOW={date:d,time:d.getTime(),yyyy:d.getFullYear(),m:d.getMonth()+1,d:d.getDate(),day:d.getDay()},WEEKDAY={ja:"日 月 火 水 木 金 土".split(" "),en:"Sun Mon Tue Wed Thu Fri Sat".split(" "),zhcn:"日 一 二 三 四 五 六".split(" "),zhtw:"日 一 二 三 四 五 六".split(" ")},MONTHS="January February March April May June July August September October November December".split(" "),MONTHS_SHORT="Jan. Feb. Mar. Apr. May. Jun. Jul. Aug. Sep. Oct. Nov. Dec.".split(" "),requestAnimationFrameFunction=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,cancelAnimationFrameFunction=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame,Util=function(){function Util(){_classCallCheck(this,Util)}return Util.abs2rel=function(url){if(!_.includes(url,"http"))return url;var urlArr=_.compact(url.split("/").slice(3)),last=_.last(urlArr)||"",endSlash=last.match(/[\.\?#]/)||!last?"":"/";return"/"+urlArr.join("/")+endSlash},Util.getRadian=function(p,pBase){var x=p.x,y=p.y;return pBase&&(x-=pBase.x,y-=pBase.y),Math.atan2(y,x)},Util.radian2angle=function(radian){return radian/Math.PI*180},Util.angle2radian=function(angle){return angle*Math.PI/180},Util.getClassValue=function(el,key){var c=_.find(el.classList,function(name){return _.includes(name,key)});return c||console.error("[Util#getClassValue] has no class "+key),c.split(key+"-")[1]},Util.zeroPad=function(num){return("00000000000"+num).slice(-(arguments.length>1&&void 0!==arguments[1]?arguments[1]:2))},Util.date2str=function(date){return date.getFullYear()+"/"+this.zeroPad(date.getMonth()+1,2)+"/"+this.zeroPad(date.getDate(),2)},Util.getPoint=function(e){return e.originalEvent&&(e=e.originalEvent),e.touches&&e.touches[0]?{x:e.touches[0].clientX,y:e.touches[0].clientY}:{x:e.clientX,y:e.clientY}},Util.requestAnimationFrame=function(fn){return requestAnimationFrameFunction?requestAnimationFrameFunction(fn):setTimeout(fn,33)},Util.cancelAnimationFrame=function(clearID){return cancelAnimationFrameFunction?cancelAnimationFrameFunction(clearID):clearTimeout(clearID)},Util.setAnimationFrameTimeout=function(f){var _this=this,duration=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,startTime=(new Date).getTime(),timerId=void 0,_loop=function(){if((new Date).getTime()-startTime>=duration)return _loop=null,f();timerId=_this.requestAnimationFrame(_loop)},cancel=function(){_this.cancelAnimationFrame(timerId)};return _loop(),cancel},Util.requestFullscreenFunction=function(element){var funcs="requestFullscreen webkitRequestFullScreen mozRequestFullScreen msRequestFullscreen".split(" ");return _.find(funcs,function(f){return element[f]})},Util.requestFullscreen=function(element){var f=this.requestFullscreenFunction(element);f&&element[f]()},Util.fullscreenEnabled=function(){return!!this.requestFullscreenFunction(document.body)},Util.fullscreenElement=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},Util.exitFullscreen=function(){
return document.exitFullscreen?document.exitFullscreen():document.cancelFullScreen?document.cancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():void 0},Util.getWheelDeltaY=function(e){var deltaY=-(e.originalEvent.wheelDeltaY||e.originalEvent.deltaY);return _Browsers2.default.firefox&&(deltaY*=-1,deltaY/=2),_Browsers2.default.chrome&&(deltaY/=4),_Browsers2.default.safari&&(deltaY/=6),_Browsers2.default.ie&&(deltaY*=-1),isNaN(deltaY)&&(deltaY=0),deltaY},Util.color16to255=function(color){var r=(16711680&color)>>16,g=(65280&color)>>8,b=255&color;return{r:r,g:g,b:b,isGrayScale:r===g&&g===b}},Util.color255to16=function(r,g,b){return r<<16|g<<8|b},Util.print=function(str,obj){return _.reduce(obj,function(res,val,key){return res.split("%"+key+"%").join(val)},str)},Util.parseFloatOrRaw=function(v){var num=parseFloat(v);return isNaN(num)?v:String(num)===v?num:v},Util.parseIntOrRaw=function(v){var num=parseInt(v);return isNaN(num)?v:String(num)===v?num:v},Util.str2arr=function(v,delimiter){var _this2=this;return!v||!v.indexOf||v.indexOf(delimiter)<0?this.parseFloatOrRaw(v):_.map(v.split(delimiter),function(v2){return _this2.parseFloatOrRaw(v2)})},Util.num2price=function(num){return String(num).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},Util.loadImgUrl=function(url,callback){if(this._loadedFlags=this._loadedFlags||{},this._loadedFlags[url])return callback();var img=new Image;return img.src=url,this.loadImg(img,callback)},Util.loadImg=function(img,callback){var _this3=this;return this._loadedFlags=this._loadedFlags||{},this._loadedFlags[img.src]?callback():img.complete||"complete"==img.readyState||4==img.readyState?(callback(img),img):(img.addEventListener("load",function(){_this3._loadedFlags[img.src]=!0,callback(img)}),img.addEventListener("error",function(){console.error("image load error ["+img.src+"]"),callback(img)}),img)},Util.loadScript=function(src,callback){var loaded=!1,s=document.createElement("script");s.type="text/javascript",s.src=src,s.onload=s.onreadystatechange=function(){loaded||s.readyState&&"complete"!=s.readyState||(loaded=!0,callback&&callback())};var target=document.getElementsByTagName("script")[0];target.parentNode.insertBefore(s,target)},Util.deleteAll=function(obj){_.forEach(obj,function(v,k){obj[k]=null})},Util.template=function(str,obj){return _.forEach(obj,function(v,k){str=str.split("{"+k+"}").join(v)}),str},Util.getWeekDay=function(day){var lang=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";return _.includes(["ja","en","zhcn","zhtw"],lang)||(lang="en"),WEEKDAY[lang][day]},Util.getMonthName=function(month){var lang=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";return _.includes(["ja","en","zhcn","zhtw"],lang)||(lang="en"),"en"===lang?MONTHS[month-1]:month},Util.getMonthNameShort=function(month){var lang=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";return _.includes(["ja","en","zhcn","zhtw"],lang)||(lang="en"),"en"===lang?MONTHS_SHORT[month-1]:month},Util.makeCalender=function(props){props=_.assign({startDate:null,$container:null,rowHtml:"",cellClass:null},props);var startWeek=props.startDate.getDay(),startMonth=props.startDate.getMonth()+1,startTime=props.startDate.getTime(),rowFrag=(new Date(props.startDate.getFullYear(),props.startDate.getMonth()+1,0).getDate(),document.createDocumentFragment());this._cells=_.compact(_.flatten(_.map(_.range(6),function(row){var $row=$('<tr class="jsm-booking__monthRow"></tr>'),cellFrag=document.createDocumentFragment(),cells=_.map(_.range(7),function(col){var index=7*row+col-startWeek,date=new Date(startTime+1e3*index*60*60*24),yyyy=date.getFullYear(),m=date.getMonth()+1,d=date.getDate(),outDate=startMonth!==m,today=!1,past=!1;yyyy===NOW.yyyy&&m===NOW.m&&(d===NOW.d?today=!0:d<NOW.d&&(past=!0));var cell=new props.cellClass(date,{today:today,past:past,outDate:outDate});return cellFrag.appendChild(cell.$[0]),outDate?null:cell});return rowFrag.appendChild($row[0]),$row[0].appendChild(cellFrag),cells}))),props.$container[0].appendChild(rowFrag)},_createClass(Util,null,[{key:"now",get:function(){return NOW}}]),Util}();exports.default=Util},{"../constants/Browsers":1}],12:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _jquery=require("jquery"),_jquery2=_interopRequireDefault(_jquery),_jquery3=require("./common/libs/jquery.css3"),_jquery4=_interopRequireDefault(_jquery3),_jquery5=require("./common/libs/jquery.swithclass"),_jquery6=_interopRequireDefault(_jquery5),_lodash=require("lodash"),_lodash2=_interopRequireDefault(_lodash),_bluebird=require("bluebird"),_bluebird2=_interopRequireDefault(_bluebird),_pixi=require("pixi.js"),_WindowStore=(_interopRequireDefault(_pixi),require("./common/stores/WindowStore")),_WindowStore2=_interopRequireDefault(_WindowStore),_Settings=require("./main/Settings"),_Settings2=_interopRequireDefault(_Settings),_GAClicker=require("./main/GAClicker"),_GAClicker2=_interopRequireDefault(_GAClicker),_Router=require("./main/Router"),_Router2=_interopRequireDefault(_Router),_App=require("./main/App"),_App2=_interopRequireDefault(_App);window.$=window.jQuery=_jquery2.default,(0,_jquery4.default)(_jquery2.default),(0,_jquery6.default)(_jquery2.default),window._=_lodash2.default,window.Promise=_bluebird2.default,PIXI.utils.skipHello(),_WindowStore2.default.setup(),_Settings2.default.setup(_WindowStore2.default.getIsPC()),_GAClicker2.default.setup(),_Router2.default.setup(),(new _App2.default).setup()},{"./common/libs/jquery.css3":2,"./common/libs/jquery.swithclass":3,"./common/stores/WindowStore":4,"./main/App":13,"./main/GAClicker":14,"./main/Router":20,"./main/Settings":21,bluebird:115,jquery:120,lodash:122,"pixi.js":259}],13:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Browsers=require("../common/constants/Browsers"),_autoInit=(_interopRequireDefault(_Browsers),require("./modules/auto-init")),_autoInit2=_interopRequireDefault(_autoInit),_SideNav=require("./SideNav"),_SideNav2=_interopRequireDefault(_SideNav),_Menu=require("./Menu"),_Menu2=_interopRequireDefault(_Menu),_LHeader=require("./LHeader"),_LHeader2=_interopRequireDefault(_LHeader),_GFooter=require("./GFooter"),_GFooter2=_interopRequireDefault(_GFooter),App=function(){function App(){_classCallCheck(this,App)}return App.prototype.setup=function(){this._sidenav=new _SideNav2.default,this._menu=new _Menu2.default,this._lheader=new _LHeader2.default,this._gfooter=new _GFooter2.default,this._initCommonAreaModules()},App.prototype._initCommonAreaModules=function(){(0,_autoInit2.default)($(".o-lFooter, .o-gFooter, .jsm-booking__outer"))},App}();exports.default=App},{"../common/constants/Browsers":1,"./GFooter":16,"./LHeader":18,"./Menu":19,"./SideNav":22,"./modules/auto-init":68}],14:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var GAClicker=function(){function GAClicker(){_classCallCheck(this,GAClicker)}return GAClicker.prototype.setup=function(){function getEl($el,count){return count>5?null:1===parseInt($el.attr("data-ga"))?$el:(count++,getEl($el.parent(),count))}function getAnchor($el,count){return count>5?null:"a"===$el[0].tagName.toLowerCase()?$el:(count++,getAnchor($el.parent(),count))}$(document.body).on("click","a",function(e){var $anchor=getAnchor($(e.target),0);$anchor.attr("data-noga")||$anchor&&"http"===$anchor.attr("href").substr(0,4)&&window.HOSHINOYA.GA.clickEvent("external_link",$anchor.attr("href"))}),$(document.body).on("click",'[data-ga="1"]',function(e){var $el=getEl($(e.target),0);if(!$el)return console.warn("[GAClicker] element not found");var vars=($el.attr("data-gav")||"").split(","),category=_.trim(vars[0]),label=_.trim(vars[1]);if(!category)return console.warn('[GAClicker] attribute data-gav="category,label" required');window.HOSHINOYA.GA.clickEvent(category,label)})},GAClicker}();exports.default=new GAClicker},{}],15:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Settings=require("./Settings"),_isDarkPage=(_interopRequireDefault(_Settings),require("./utils/isDarkPage")),_isDarkPage2=_interopRequireDefault(_isDarkPage),GCover=function(){function GCover(){_classCallCheck(this,GCover),this.$=$(".jsm-gcover")}return GCover.prototype.hide=function(){this.$.addClass("js-hidden")},GCover.prototype.show=function(newUrl){var isDark=(0,_isDarkPage2.default)(newUrl);this.$.switchClass("js-black",isDark).switchClass("js-white",!isDark),this.$.addClass("js-visible")},GCover}();exports.default=GCover},{"./Settings":21,"./utils/isDarkPage":112}],16:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _autoInit=require("./modules/auto-init"),_autoInit2=_interopRequireDefault(_autoInit),_rotateLogo=require("./utils/rotateLogo"),_rotateLogo2=_interopRequireDefault(_rotateLogo),_Router=require("./Router"),_Router2=_interopRequireDefault(_Router),GFooter=function(){function GFooter(){_classCallCheck(this,GFooter),this.$=$(".jsm-gfooter"),_Router2.default.on(_Router2.default.Events.pageReady,this._initModules.bind(this)),this._initModules()}return GFooter.prototype._initModules=function(){(0,_autoInit2.default)(this.$),(0,_rotateLogo2.default)(this.$.find(".jsm-logoanime").data("jsm-instance"))},GFooter}();exports.default=GFooter},{"./Router":20,"./modules/auto-init":68,"./utils/rotateLogo":113}],17:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Settings=require("./Settings"),GLoading=(function(obj){obj&&obj.__esModule}(_Settings),function(){function GLoading(){_classCallCheck(this,GLoading),this.$=$(".jsm-gloading")}return GLoading.prototype.show=function(){var _this=this;clearTimeout(this._delayId),this.$.removeClass("js-progress js-complete js-hidden"),this._delayId=setTimeout(function(){_this.$.addClass("js-progress")},33)},GLoading.prototype.hide=function(){var _this2=this;clearTimeout(this._delayId),this.$.addClass("js-complete"),this._delayId=setTimeout(function(){_this2.$.addClass("js-hidden")},200),this._firstHide()},GLoading.prototype._firstHide=function(){var _this3=this;this._doneFirstHide||(this._doneFirstHide=!0,setTimeout(function(){_this3.$.addClass("js-back")},1e3))},GLoading}());exports.default=GLoading},{"./Settings":21}],18:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _autoInit=require("./modules/auto-init"),_autoInit2=_interopRequireDefault(_autoInit),_rotateLogo=require("./utils/rotateLogo"),_rotateLogo2=_interopRequireDefault(_rotateLogo),_Router=require("./Router"),_Router2=_interopRequireDefault(_Router),LHeader=function(){function LHeader(){_classCallCheck(this,LHeader),this.$=$(".jsm-lheader"),_Router2.default.on(_Router2.default.Events.pageReady,this._initModules.bind(this)),this._initModules()}return LHeader.prototype._initModules=function(){(0,_autoInit2.default)(this.$),(0,_rotateLogo2.default)(this.$.find(".jsm-logoanime").data("jsm-instance"))},LHeader}();exports.default=LHeader},{"./Router":20,"./modules/auto-init":68,"./utils/rotateLogo":113}],19:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Browsers=require("../common/constants/Browsers"),_Store=(_interopRequireDefault(_Browsers),require("./Store")),_Store2=_interopRequireDefault(_Store),_autoInit=require("./modules/auto-init"),_autoInit2=_interopRequireDefault(_autoInit),_WindowStore=require("../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_rotateLogo=require("./utils/rotateLogo"),_rotateLogo2=_interopRequireDefault(_rotateLogo),Menu=function(){function Menu(){_classCallCheck(this,Menu),this.$=$(".jsm-menu"),this.$html=$("html"),this.$inner=this.$.find(".jsm-menu__inner"),_Store2.default.onMenuOpened(this._menuOpened.bind(this)),(0,_autoInit2.default)(this.$,{forced:!0}),(0,_rotateLogo2.default)(this.$.find(".jsm-logoanime").data("jsm-instance")),this.$.find(".jsm-menu__close").on("click",function(){setTimeout(function(){_Store2.default.toggleMenu(!1)},33)})}return Menu.prototype._menuOpened=function(opened){var _this=this;clearTimeout(this._delayId),opened?(this.$inner.scrollTop(0),this.$html.addClass("js-menuIsVisible"),window.HOSHINOYA.GA.clickEvent("modal","menu")):this._delayId=setTimeout(function(){_this.$html.removeClass("js-menuIsVisible")},1e3),this.$html.switchClass("js-menuIsActive",opened),_WindowStore2.default.switchModalState(opened,opened?500:0)},Menu}();exports.default=Menu},{"../common/constants/Browsers":1,"../common/stores/WindowStore":4,"./Store":23,"./modules/auto-init":68,"./utils/rotateLogo":113}],20:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_eventemitter=require("eventemitter2"),_DomUtil=require("../common/utils/DomUtil"),_DomUtil2=_interopRequireDefault(_DomUtil),_Util=require("../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_WindowStore=require("../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Page=require("./pages/Page"),_Page2=_interopRequireDefault(_Page),_PageTop=require("./pages/PageTop"),_PageTop2=_interopRequireDefault(_PageTop),_PageAbout=require("./pages/PageAbout"),_PageAbout2=_interopRequireDefault(_PageAbout),_PageOutline=require("./pages/PageOutline"),_PageOutline2=_interopRequireDefault(_PageOutline),_PageVoices=require("./pages/PageVoices"),_PageVoices2=_interopRequireDefault(_PageVoices),_PageNotfound=require("./pages/PageNotfound"),_PageNotfound2=_interopRequireDefault(_PageNotfound),_GLoading=require("./GLoading"),_GLoading2=_interopRequireDefault(_GLoading),_GCover=require("./GCover"),_GCover2=_interopRequireDefault(_GCover),_Settings=require("./Settings"),_Store=(_interopRequireDefault(_Settings),require("./Store")),_Store2=_interopRequireDefault(_Store),_Browsers=require("../common/constants/Browsers"),_Browsers2=_interopRequireDefault(_Browsers),PAGES={top:_PageTop2.default,about:_PageAbout2.default,voices:_PageVoices2.default,outline:_PageOutline2.default,notfound:_PageNotfound2.default},Events={transitComplete:"transitComplete",pageReady:"pageReady"},Router=function(_EventEmitter){function Router(){return _classCallCheck(this,Router),_possibleConstructorReturn(this,_EventEmitter.call(this))}return _inherits(Router,_EventEmitter),_createClass(Router,[{key:"Events",get:function(){return Events}}]),Router.prototype.setup=function(){this.$=$(".jsm-router"),this.$body=$("body"),this._bodyClass=this.$body.attr("class"),this._gloading=new _GLoading2.default,this._gcover=new _GCover2.default,this._page=this._makePage(this.$body,!0),this._page.onPreReady(this._pagePreReadyHdl.bind(this)).onReady(this._pageReadyHdl.bind(this)).setup(!0),this._currentUrl=this._formatUrl(location.href),this._setLangHref(),$(window).on("popstate",this._popstateHdl.bind(this)),this.$body.on("click","a",this._aClickHdl.bind(this)),this._setupTimestamp=(new Date).getTime(),this._maxTimestamp=3e5},Router.prototype._formatUrl=function(url){return _Util2.default.abs2rel(url.split("#")[0])},Router.prototype._aClickHdl=function(e){var $a=_DomUtil2.default.findNearestParent($(e.target),"a"),rawHref=$a.attr("href");if($a.hasClass("jsm-router__lang")&&window.HOSHINOYA.langSelected($a.attr("data-lang")),"_blank"!==$a.attr("target")&&!_.includes(rawHref.substr(0,10),".pdf")&&!_.includes(rawHref.substr(0,10),":")){e.preventDefault(),e.stopPropagation();var url=_Util2.default.abs2rel($a[0].href);url!==this._currentUrl&&(this._checkPjaxSite(url)?(this._scrollToTop(),this._pushUrl(url),this._popstateHdl()):this._fadeoutToTransit(url))}},Router.prototype._checkPjaxSite=function(url){if(_Browsers2.default.ie)return!1;var elapsedTime=(new Date).getTime()-this._setupTimestamp;if(console.log("[Router] fontplus elapsed time : "+Math.round(elapsedTime/1e3/60*100)/100+"min."),elapsedTime>this._maxTimestamp)return!1;url=url.split("#")[0].split("?")[0];var currentSite=window.HOSHINOYA.site,currentLang=window.HOSHINOYA.lang;if(!_.includes(url,currentSite))return!1;if("ja"===currentLang){if(_.includes(url,"/en/")||_.includes(url,"/id/")||_.includes(url,"/zhcn/")||_.includes(url,"/zhtw/"))return!1}else if(!_.includes(url,"/"+currentLang+"/"))return!1;return!0},Router.prototype._fadeoutToTransit=function(url){this._gcover.show(url),setTimeout(function(){location.href=url},300)},Router.prototype._pushUrl=function(url){history.pushState("","",url)},Router.prototype._popstateHdl=function(e){var url=this._formatUrl(location.href);url!==this._currentUrl&&(this._currentUrl=url,this._setLangHref(),this._transit(url),_Store2.default.toggleMenu(!1))},Router.prototype._transit=function(url){this._transitCnt=0,this._gloading.show(),this._newPage&&(this._newPage.clear(),this._newPage=null),this._loadNewPage(url),this._page.onHidden(this._transitCountup.bind(this)),this._page.hide(),window.HOSHINOYA.GA.pageview()},Router.prototype._transitCountup=function(){2===++this._transitCnt&&this._transitComplete()},Router.prototype._transitComplete=function(){this._newPage&&(this._page.clear(),_WindowStore2.default.scrollTo(0),this.$body.attr("class",this._bodyClass),this._page=this._newPage,this._newPage=null,this._page.onPreReady(this._pagePreReadyHdl.bind(this)).onReady(this._pageReadyHdl.bind(this)).setup(!1),this.emit(Events.transitComplete))},Router.prototype._loadNewPage=function(url){var _this2=this;this._currentXHR&&this._currentXHR.abort&&this._currentXHR.abort(),this._currentXHR=$.ajax({url:url,dataType:"text",success:function(html){var title=html.split("<title>")[1].split("</title>")[0];document.title=title;var body="<body"+html.split("<body")[1].split("</html>")[0];body=body.replace(/<script[.\s|\S]*?<\/script>/g,""),body=body.replace(/<iframe[.\s|\S]*?<\/iframe>/g,"");var $body=$(body.split("<body").join("<div").split("body>").join("div>"));_this2._bodyClass=$body.attr("class"),_this2._newPage=_this2._makePage($body),_this2._newPage.readyForShow(),_this2.$.append(_this2._newPage.$),_this2._transitCountup()},error:function(e,e2,e3){"abort"!==e2&&(console.error("page load error",url),console.error(e,e2,e3))}})},Router.prototype._makePage=function($body,isFirst){var tpl=_Util2.default.getClassValue($body[0],"tpl");return new(PAGES[tpl]||_Page2.default)($body.find(".jsm-page"),isFirst)},Router.prototype._pagePreReadyHdl=function(){this._gloading.hide()},Router.prototype._pageReadyHdl=function(){this._gloading.hide(),this._gcover.hide(),this._page.show(),this.emit(Events.pageReady)},Router.prototype._scrollToTop=function(){_WindowStore2.default.scrollTo(0,_Store2.default.menuOpened?0:900)},Router.prototype._setLangHref=function(){var _this3=this,currentLang=window.HOSHINOYA.lang,currentSite=window.HOSHINOYA.site;_.forEach($(".jsm-router__lang"),function(el){var distLang=el.getAttribute("data-lang"),href=_this3._currentUrl;distLang!==currentLang&&(href="ja"===currentLang?"_admin"===currentSite?"/"+distLang+href:"/"+currentSite+"/"+distLang+href.split(currentSite)[1]:href.split("/"+currentLang+"/").join("ja"===distLang?"/":"/"+distLang+"/")),href=href.split("//").join("/"),el.setAttribute("href",href)})},Router}(_eventemitter.EventEmitter2);exports.default=new Router},{"../common/constants/Browsers":1,"../common/stores/WindowStore":4,"../common/utils/DomUtil":5,"../common/utils/Util":11,"./GCover":15,"./GLoading":17,"./Settings":21,"./Store":23,"./pages/Page":97,"./pages/PageAbout":98,"./pages/PageNotfound":99,"./pages/PageOutline":100,"./pages/PageTop":101,"./pages/PageVoices":102,eventemitter2:117}],21:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.__esModule=!0;var _Browsers=require("../common/constants/Browsers"),_Browsers2=_interopRequireDefault(_Browsers),_Url=require("../common/utils/Url"),_Url2=_interopRequireDefault(_Url),_lodash=require("lodash"),_lodash2=_interopRequireDefault(_lodash),domain=location.href.split("/")[2],isLocal=_lodash2.default.includes(domain,"192.168.")||_lodash2.default.includes(domain,"hoshinoya.dev")||_lodash2.default.includes(domain,"localhost"),Settings={isLocal:isLocal,query:_Url2.default.parse(location.href).query,animationframe:Math.round(1e3/60),page:{hide_duration:300},top:{img_wait_delay:750},outlinehero:{parallax:[300,200],pan_sp:100,pan_duration:5e3},spritepic:{roundness:[4*_Browsers2.default.pixelratio,4*_Browsers2.default.pixelratio]},switcher:{autointerval:2700,rect_parallax:[0,30],cirle_parallax:[50,30],pan:[0,30],fade_duration:[2e3,1400]},carrousel:{aspect:1.5,autointerval:5e3,parallax:[50,30],parallax_x:[200,100],scroll_speed:.3,slide_duration:1200},roller:{scroll_speed:[.4,.2],slide_duration:1200},tile:{autointerval:4e3,parallax:[50,30]},accordion:{duration:400},anchorlink:{duration_base:400,dist_threshold:.2},folding:{duration:400},parallax:{amount:[100,50]},gmap:{pin:{src:["/assets/img/map-pin-pc.png","/assets/img/map-pin-sp.png"],width:[33,33],height:[45,45]}},tophero:{parallax:[200,100]},tophotels:{mousemove_speed:.05}};Settings.setup=function(isPC){function dig(obj){_lodash2.default.forEach(obj,function(v,k){if(_lodash2.default.isArray(v)&&(obj[k]=isPC?v[0]:v[1]),_lodash2.default.isObject(v))return dig(v)})}dig(Settings)},exports.default=Settings},{"../common/constants/Browsers":1,"../common/utils/Url":10,lodash:122}],22:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Browsers=require("../common/constants/Browsers"),_Browsers2=_interopRequireDefault(_Browsers),_Store=require("./Store"),_Store2=_interopRequireDefault(_Store),_autoInit=require("./modules/auto-init"),_autoInit2=_interopRequireDefault(_autoInit),_WindowStore=require("../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Settings=require("./Settings"),_Router=(_interopRequireDefault(_Settings),require("./Router")),_Router2=_interopRequireDefault(_Router),_rotateLogo=require("./utils/rotateLogo"),_rotateLogo2=_interopRequireDefault(_rotateLogo),SideNav=function(){function SideNav(){var _this=this;_classCallCheck(this,SideNav),this.$=$(".jsm-sidenav"),this.$namebar=$(".jsm-sidenav__navnamebar"),this.$.on("click",function(e){_this._isButtonElement(e.target)||_Store2.default.toggleMenu(!_Store2.default.menuOpened)}),_Store2.default.onMenuOpened(function(opened){_this.$.switchClass("js-active",opened)}),this.$.on(_Browsers2.default.touch?"touchstart":"mouseover",function(e){_this._hover(!_this._isButtonElement(e.target))}).on(_Browsers2.default.touch?"touchend":"mouseout",this._hover.bind(this,!1)),(0,_autoInit2.default)(this.$),(0,_rotateLogo2.default)(this.$.find(".jsm-logoanime").data("jsm-instance")),_WindowStore2.default.onResize(this._resizeHdl.bind(this)),_WindowStore2.default.onScroll(this._scrollHdl.bind(this)),_Router2.default.on(_Router2.default.Events.transitComplete,this._transitHdl.bind(this)),this._transitHdl()}return SideNav.prototype._isButtonElement=function(el){return"a"===el.tagName.toLowerCase()||!!el.classList.contains("jsm-booking__trigger")},SideNav.prototype._hover=function(hover){this.$.switchClass("js-hover",hover)},SideNav.prototype._transitHdl=function(){this._outlineHero=$(".jsm-outlinehero").data("jsm-instance"),this._$subhero=$(".jsm-sidenav__subhero"),0===this._$subhero.length&&(this._$subhero=null),this._resizeHdl()},SideNav.prototype._resizeHdl=function(){this._limit1=50,this._outlineHero?this._limit2=this._outlineHero.$.outerHeight()-.2*_WindowStore2.default.getHeight():this._$subhero?this._limit2=this._$subhero.outerHeight()-.2*_WindowStore2.default.getHeight():this._limit2=this._limit1,this._scrollHdl()},SideNav.prototype._scrollHdl=function(){var scrolledLeft=_WindowStore2.default.getScrollTop()>(this._outlineHero?this._limit2:this._limit1),scrolledRight=_WindowStore2.default.getScrollTop()>this._limit2;this._scrolledLeft!==scrolledLeft&&(this._scrolledLeft=scrolledLeft,this.$.switchClass("js-scrolled",scrolledLeft)),this._scrolledRight!==scrolledRight&&(this._scrolledRight=scrolledRight,this.$namebar.switchClass("js-scrolled",scrolledRight))},SideNav}();exports.default=SideNav},{"../common/constants/Browsers":1,"../common/stores/WindowStore":4,"./Router":20,"./Settings":21,"./Store":23,"./modules/auto-init":68,"./utils/rotateLogo":113}],23:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_eventemitter=require("eventemitter2"),Store=function(_EventEmitter){function Store(){_classCallCheck(this,Store);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));return _this._menuOpened=!1,_this}return _inherits(Store,_EventEmitter),Store.prototype.onMenuOpened=function(f){this.on("menu",f)},Store.prototype.toggleMenu=function(opened){this._menuOpened!==opened&&(this._menuOpened=opened,this.emit("menu",opened))},_createClass(Store,[{key:"menuOpened",get:function(){return this._menuOpened}}]),Store}(_eventemitter.EventEmitter2);exports.default=new Store},{eventemitter2:117}],24:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Accordion__item=require("./Accordion__item"),_Accordion__item2=_interopRequireDefault(_Accordion__item),_WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Settings=require("../Settings"),_Settings2=_interopRequireDefault(_Settings),Accordion=function(){function Accordion($el,options){_classCallCheck(this,Accordion),this.$=$el,this.options=_.assign({},options||{})}return Accordion.prototype.init=function(){var _this=this;this._items=_.map(this.$.find(".jsm-accordion__item"),function(el,i){var item=new _Accordion__item2.default($(el),i,_this.options);return item.$trigger.on("click",function(){_this._switch(i===_this._num?-1:i)}),item})},Accordion.prototype.clear=function(){_.forEach(this._items,function(item){item.$.off(),item.$.remove(),item.$=null}),this._items=[],this.$.remove(),this.$=null},Accordion.prototype._switch=function(num){if(this._num!==num){this._num=num;var oldItem=this._currentItem,newItem=this._items[num];if(oldItem||newItem){this._currentItem=newItem;var openToOpen=oldItem&&newItem&&oldItem.num<newItem.num,scrollEnd=(newItem||oldItem).getOffsetTop();newItem&&newItem.switchState(!0,!1),_WindowStore2.default.scrollTo(scrollEnd,_Settings2.default.accordion.duration),openToOpen?setTimeout(function(){_WindowStore2.default.scrollTo(_WindowStore2.default.getScrollTop()-oldItem.getCurrentHeight()),oldItem&&oldItem.switchState(!1,!0)},_Settings2.default.accordion.duration+33):oldItem&&oldItem.switchState(!1,!1)}}},Accordion}();exports.default=Accordion},{"../../common/stores/WindowStore":4,"../Settings":21,"./Accordion__item":25}],25:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}
}(),_Tween=require("../../common/utils/Tween"),_Tween2=_interopRequireDefault(_Tween),_WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),Accordion__item=function(){function Accordion__item($el,num,options){_classCallCheck(this,Accordion__item),this.$=$el,this._num=num,this.options=options,this.$clip=this.$.find(".jsm-accordion__clip"),this.$content=this.$.find(".jsm-accordion__content"),this.$trigger=this.$.find(".jsm-accordion__trigger"),this._tw=new _Tween2.default,this.switchState(!1,!0)}return Accordion__item.prototype.getCurrentHeight=function(){return this.$clip.outerHeight()||0},Accordion__item.prototype.getOffsetTop=function(){return _WindowStore2.default.calcElTop(this.$)},Accordion__item.prototype.switchState=function(opened,isDirect){var _this=this;if(this._opened!==opened){this._opened=opened;var start=this.getCurrentHeight(),end=opened?this.$content.outerHeight():0,duration=isDirect?0:400;this._tw=this._tw||new _Tween2.default,this._tw.it({start:start,end:end,duration:duration,easing:"easeInOutQuad",onProgress:function(v,per){_this.$clip.css("height",v)},onComplete:function(){_this.$clip.css("height",opened?"auto":"")}}),this.$.switchClass("js-active",opened)}},_createClass(Accordion__item,[{key:"num",get:function(){return this._num}},{key:"id",get:function(){return this._id}}]),Accordion__item}();exports.default=Accordion__item},{"../../common/stores/WindowStore":4,"../../common/utils/Tween":9}],26:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Settings=require("../Settings"),_Settings2=_interopRequireDefault(_Settings),Anchorlink=function(){function Anchorlink($el,options){_classCallCheck(this,Anchorlink),this.$=$el,this.options=_.assign({name:""},options||{})}return Anchorlink.prototype.init=function(){this.$.on("click",this._scroll.bind(this))},Anchorlink.prototype.clear=function(){this.$.off(),this.$.remove(),this.$=null},Anchorlink.prototype._scroll=function(){var $target=$('.jsm-anchorlink__target[data-name="'+this.options.name+'"]'),currentTop=_WindowStore2.default.getScrollTop(),top=_WindowStore2.default.calcElTop($target)-40,duration=_Settings2.default.anchorlink.duration_base+Math.round(Math.abs(top-currentTop)*_Settings2.default.anchorlink.dist_threshold);_WindowStore2.default.scrollTo(top,duration)},Anchorlink}();exports.default=Anchorlink},{"../../common/stores/WindowStore":4,"../Settings":21}],27:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _ScreenModule2=require("../utils/ScreenModule"),_ScreenModule3=_interopRequireDefault(_ScreenModule2),_Settings=require("../Settings"),_Settings2=_interopRequireDefault(_Settings),_WindowStore=require("../../common/stores/WindowStore"),_Carrousel__item=(_interopRequireDefault(_WindowStore),require("./Carrousel__item")),_Carrousel__item2=_interopRequireDefault(_Carrousel__item),_Tween=require("../../common/utils/Tween"),_Tween2=_interopRequireDefault(_Tween),Carrousel=function(_ScreenModule){function Carrousel($el,options){_classCallCheck(this,Carrousel);var _this=_possibleConstructorReturn(this,_ScreenModule.call(this,$el,_.assign({autointerval:_Settings2.default.carrousel.autointerval},options||{})));return _this.$area=_this.$.find(".jsm-carrousel__area"),_this._needDrag=!0,_this}return _inherits(Carrousel,_ScreenModule),Carrousel.prototype._screenInit=function(){var _this2=this;this._items=_.map(this.$.find(".jsm-carrousel__item"),function(el,i){var item=new _Carrousel__item2.default($(el),_this2._imgLoadHdl.bind(_this2));return _this2._stage.addChild(item.spriteEl),item}),this._navCount=this._items.length,this._x=0,this._tickedX=0,this._tweenedX=0,this._draggedX=0,this._tweening=!1,this._dragging=!1},Carrousel.prototype._screenClear=function(){_.forEach(this._items,function(item){item.destroy()}),this._items=[]},Carrousel.prototype._imgLoadHdl=function(item){var isDirect=!this._onScreen||!item.visible;if(item.show(isDirect),!this._onScreen&&!this._onceForceRendered){var visibleItems=_.filter(this._items,"visible");_.filter(visibleItems,"loaded").length==visibleItems.length&&(this._onceForceRendered=!0,this._tick(!0))}},Carrousel.prototype._screenResized=function(){var _this3=this;_.forEach(this._items,function(item){item.resized(_this3._areaW,_this3._areaH)}),this._itemW=this._items[0].calcWidth(),this._totalW=this._itemW*this._navCount,this._minX=-this._itemW,this._maxX=this._areaW,this._rangeX=this._maxX-this._minX,this._perMinX=-(this._itemW-this._items[0].picW),this._perMaxX=this._areaW-this._itemW,this._perMaxX=Math.max(this._perMaxX,.3*this._itemW),this._perRangeX=this._perMaxX-this._perMinX,this._pageStartX=Math.round(.5*(this._areaW-this._itemW))},Carrousel.prototype._screenTick=function(){this._dragging||(this._tickedX-=_Settings2.default.carrousel.scroll_speed),this._updateX(),this._refreshPos()},Carrousel.prototype._screenEnterFirst=function(){this._switch(0,{isFirst:!0})},Carrousel.prototype._screenEnter=function(){this._tw&&this._tweening&&this._tw.resume()},Carrousel.prototype._screenLeave=function(){this._tw&&this._tweening&&this._tw.pause()},Carrousel.prototype._screenSwitch=function(num){var _this4=this,switchOptions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(switchOptions.navClicked){var localNum=this._num%this._navCount,dir=num-localNum;num=this._num+dir}if(this._num=num,!switchOptions.isFirst){this._tw=this._tw||new _Tween2.default;var targetX=-this._itemW*num,willTickedAmount=this.options.autointerval/_Settings2.default.animationframe*_Settings2.default.carrousel.scroll_speed*.6,distX=targetX-this._x+willTickedAmount,start=this._tweenedX,end=this._tweenedX+distX;this._tweening=!0,this._tw.it({start:start,end:end,duration:_Settings2.default.carrousel.slide_duration,easing:switchOptions.bySwipe?"easeOutQuart":"easeInOutQuart",onProgress:function(v){_this4._tweenedX=v,_this4._updateX()},onComplete:function(){_this4._tweening=!1}})}},Carrousel.prototype._screenDragStart=function(clientX,clientY,e){this._pauseAutoTimer(),this._tweening&&(this._tw.stop(),this._tweening=!1),this._dragging=!0,this._dragStartX=this._draggedX},Carrousel.prototype._screenDragMove=function(dx,dy,ax,ay){this._draggedX=this._dragStartX+dx},Carrousel.prototype._screenDragEnd=function(dx,dy,ax,ay){this._dragging=!1;var limitW=.5*this._itemW,dir=0;dx<0&&ax<-1.5?dir=1:dx>0&&ax>1.5?dir=-1:dx<-limitW?dir=1:dx>limitW&&(dir=-1),0!==dir?this._switch(this._num+dir,{bySwipe:!0}):this._resumeAutoTimer()},Carrousel.prototype._updateX=function(){this._x=this._tickedX+this._tweenedX+this._draggedX},Carrousel.prototype._refreshPos=function(){var _this5=this;_.forEach(this._items,function(item,i){var x=_this5._minX+(_this5._x-_this5._minX+_this5._pageStartX+_this5._itemW*i+999*_this5._totalW)%_this5._totalW,visible=x<=_this5._maxX;visible||(x=_this5._maxX);var xPer=(x-_this5._perMinX)/_this5._perRangeX;item.refreshPos(_this5._itemW,x,xPer,_this5._scrollPerEco,visible)})},Carrousel}(_ScreenModule3.default);exports.default=Carrousel},{"../../common/stores/WindowStore":4,"../../common/utils/Tween":9,"../Settings":21,"../utils/ScreenModule":108,"./Carrousel__item":28}],28:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Settings=require("../Settings"),_Settings2=_interopRequireDefault(_Settings),_WindowStore=require("../../common/stores/WindowStore"),_SpritePic=(_interopRequireDefault(_WindowStore),require("../utils/SpritePic")),_SpritePic2=_interopRequireDefault(_SpritePic),_hideImgLoading=require("../utils/hideImgLoading"),_hideImgLoading2=_interopRequireDefault(_hideImgLoading),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),Carrousel__item=function(){function Carrousel__item($el,imgLoadHdl){var _this=this;_classCallCheck(this,Carrousel__item),this.$=$el,this.$pic=this.$.find(".jsm-carrousel__itemPic"),this._img=$.data(this.$.find(".jsm-img")[0],"jsm-instance"),this._sprite=new _SpritePic2.default(this._img,{shape:"rect",roundrect:!0,parallax:_Settings2.default.carrousel.parallax,parallax_x:_Settings2.default.carrousel.parallax_x,onImgLoad:function(){_this._loaded=!0,setTimeout(imgLoadHdl.bind(null,_this),0)}})}return Carrousel__item.prototype.destroy=function(){this._sprite.destroy(),_Util2.default.deleteAll(this)},Carrousel__item.prototype.show=function(isDirect){(0,_hideImgLoading2.default)(this.$,isDirect),this.$.addClass("js-visible")},Carrousel__item.prototype.resized=function(areaW,areaH){this._picW=Math.round(areaH*_Settings2.default.carrousel.aspect),this._picH=areaH,this.$pic.css({width:this._picW,height:this._picH}),this._sprite.setSize(this._picW,this._picH)},Carrousel__item.prototype.calcWidth=function(){return Math.round(this.$.outerWidth())},Carrousel__item.prototype.refreshPos=function(itemW,x,xPer,scrollPer,visible){if(this._visible=visible,this._x!==x){this._x=x;var picLocalX=itemW-this._picW;this.$.css3({x:x}),this._sprite.setPos(x+picLocalX,0),this._sprite.tickParallaxX(xPer),this._sprite.tickParallax(scrollPer)}},_createClass(Carrousel__item,[{key:"spriteEl",get:function(){return this._sprite.el}},{key:"x",get:function(){return this._x}},{key:"picW",get:function(){return this._picW}},{key:"visible",get:function(){return this._visible}},{key:"loaded",get:function(){return this._loaded}}]),Carrousel__item}();exports.default=Carrousel__item},{"../../common/stores/WindowStore":4,"../../common/utils/Util":11,"../Settings":21,"../utils/SpritePic":109,"../utils/hideImgLoading":111}],29:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_WindowStore),Download=function(){function Download($el,options){_classCallCheck(this,Download),this.$=$el,this.options=_.assign({},options||{})}return Download.prototype.init=function(){var _this=this;this.$modal=this.$.find(".jsm-download__modal"),_.forEach(this.$.find(".jsm-download__item"),function(el){var $item=$(el),src=$item.attr("data-src");$item.on("click",function(){_this._show(src)})}),this.$.find(".jsm-download__modalYes, .jsm-download__modalNo, .jsm-download__modalBg, .jsm-download__modalClose").on("click",function(){setTimeout(_this._hide.bind(_this),10)})},Download.prototype.clear=function(){},Download.prototype._show=function(src){this.$.find(".jsm-download__modalYes").attr("href",src),this.$.find(".jsm-download__modalContent").scrollTop(0),clearTimeout(this._delayId),this.$modal.addClass("js-show js-visible"),_WindowStore2.default.switchModalState(!0)},Download.prototype._hide=function(){var _this2=this;clearTimeout(this._delayId),this.$modal.removeClass("js-show"),this._delayId=setTimeout(function(){_this2.$modal.removeClass("js-visible"),_WindowStore2.default.switchModalState(!1)},200)},Download}();exports.default=Download},{"../../common/stores/WindowStore":4}],30:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),FadeIn=function(){function FadeIn($el,options){_classCallCheck(this,FadeIn),this.$=$el,this.options=_.assign({each:this.$.hasClass("option-each-1"),slow:this.$.hasClass("option-slow-1"),delay:0},options||{})}return FadeIn.prototype.init=function(){this._bindedResizeHdl=this._resizeHdl.bind(this),this._bindedScrollHdl=this._scrollHdl.bind(this),_WindowStore2.default.onResize(this._bindedResizeHdl),_WindowStore2.default.onScroll(this._bindedScrollHdl),this._resizeHdl(),this._scrollHdl()},FadeIn.prototype.clear=function(){this._clear()},FadeIn.prototype._clear=function(){_WindowStore2.default.offResize(this._bindedResizeHdl),_WindowStore2.default.offScroll(this._bindedScrollHdl),this._bindedResizeHdl=null,this._bindedScrollHdl=null},FadeIn.prototype._resizeHdl=function(){var sh=_WindowStore2.default.getHeight(),h=this.$.outerHeight(),top=_WindowStore2.default.calcElTop(this.$);this._minScrollTop=Math.max(0,top-sh),this._maxScrollTop=top+h},FadeIn.prototype._scrollHdl=function(){var scrollTop=_WindowStore2.default.getScrollTop();scrollTop>=this._minScrollTop&&scrollTop<=this._maxScrollTop&&(this._clear(),_Util2.default.setAnimationFrameTimeout(this._show.bind(this),this.options.delay))},FadeIn.prototype._show=function(){var _this=this;this.options.each?_.forEach(this.$.find("span"),function(el,i){var myEl=el,delay=Math.round(Math.random()*(_this.options.slow?900:600));_Util2.default.setAnimationFrameTimeout(function(){myEl.classList.add("js-visible")},delay)}):this.$.addClass("js-visible")},FadeIn}();exports.default=FadeIn},{"../../common/stores/WindowStore":4,"../../common/utils/Util":11}],31:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Tween=require("../../common/utils/Tween"),_Tween2=_interopRequireDefault(_Tween),_Settings=require("../Settings"),_Settings2=_interopRequireDefault(_Settings),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),Folding=function(){function Folding($el,options){_classCallCheck(this,Folding),this.$=$el,this.options=_.assign({},options||{}),this.$clip=this.$.find(".jsm-folding__clip"),this.$content=this.$.find(".jsm-folding__content"),this.$heightbbase=this.$.find(".jsm-folding__heightbbase")}return Folding.prototype.init=function(){this.$.find(".jsm-folding__opener").on("click",this._switch.bind(this,!0)),this.$.find(".jsm-folding__closer").on("click",this._switch.bind(this,!1)),this._bindedresizeHdl=this._resizeHdl.bind(this),_WindowStore2.default.onResize(this._bindedresizeHdl),this._resizeHdl()},Folding.prototype.clear=function(){this.$.find(".jsm-folding__opener").off(),this.$.find(".jsm-folding__closer").off(),_WindowStore2.default.offResize(this._bindedresizeHdl),_Util2.default.deleteAll(this)},Folding.prototype._resizeHdl=function(){var disabled=this.$content.outerHeight()<=this.$heightbbase.outerHeight();this._disabled!==disabled&&(this._disabled=disabled,this.$.switchClass("js-disabled",disabled))},Folding.prototype._switch=function(active){var _this=this;if(this._active!==active){this._active=active;var $active=active?this.$content:this.$heightbbase,$inactive=active?this.$heightbbase:this.$content,start=this.$clip.outerHeight(),end=$active.outerHeight(),duration=_Settings2.default.folding.duration;this._tw=this._tw||new _Tween2.default,this._tw.it({start:start,end:end,duration:duration,easing:"easeInOutQuad",onProgress:function(v,per){_this.$clip.css("height",v)},onComplete:function(){$active.css("position","relative"),$inactive.css("position","absolute"),_this.$clip.css("height",active?"auto":"")}}),this.$.switchClass("js-active",active)}},Folding}();exports.default=Folding},{"../../common/stores/WindowStore":4,"../../common/utils/Tween":9,"../../common/utils/Util":11,"../Settings":21}],32:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Gallery__body=require("./Gallery__body"),_Gallery__body2=_interopRequireDefault(_Gallery__body),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_Browsers=require("../../common/constants/Browsers"),_Browsers2=_interopRequireDefault(_Browsers),_ModalCtrl=require("../utils/ModalCtrl"),_ModalCtrl2=_interopRequireDefault(_ModalCtrl),Gallery=function(){function Gallery($el,options){_classCallCheck(this,Gallery),this.$=$el,this.options=_.assign({},options||{})}return Gallery.prototype.init=function(){var _this=this,confs=[],seq=0;_.forEach(this.$.find(".jsm-gallery__triggerGroup"),function(groupEl,groupNum){var $group=$(groupEl),title=$group.find(".jsm-gallery__triggerGroupTitle").html();confs=_.concat(confs,_.map($group.find(".jsm-gallery__triggerItem"),function(itemEl,itemNum){var $item=$(itemEl),num=seq;return seq++,$item.on("click",function(){_this._open(num)}),{num:num,title:title,main:$item.attr("data-main_"+(_WindowStore2.default.getIsPC()?_Browsers2.default.retina?"pc2x":"pc":"sp")),thumb:$item.attr("data-thumb")}}))}),this._body=new _Gallery__body2.default(this.$.find(".jsm-gallery__body"),confs),_Browsers2.default.touch&&(this.$body=$(document.body),this._bindedTouchStartHdl=this._touchStartHdl.bind(this),this._bindedTouchEndHdl=this._touchEndHdl.bind(this),this.$.find(".jsm-gallery__triggerItem").on("touchstart",this._bindedTouchStartHdl)),this._modalCtrl=new _ModalCtrl2.default({hash:"gallery",$close:this.$.find(".jsm-gallery__close"),onClose:function(){_this._body.close()}})},Gallery.prototype.clear=function(){this.$.find(".jsm-gallery__triggerItem").off(),this._body.destroy(),this._modalCtrl.destroy(),_Util2.default.deleteAll(this)},Gallery.prototype._open=function(num){var _this2=this,delay=0;this._bodyCreated||(this._bodyCreated=!0,this._body.create(num),delay=33),setTimeout(function(){_this2._body.open(num),_this2._modalCtrl.opened()},delay)},Gallery.prototype._touchStartHdl=function(e){this._$currentToutchItem=$(e.target),this._$currentToutchItem.addClass("js-hover"),this.$body.on("touchend",this._bindedTouchEndHdl)},Gallery.prototype._touchEndHdl=function(e){this._$currentToutchItem.removeClass("js-hover"),this.$body.off("touchend",this._bindedTouchEndHdl)},Gallery}();exports.default=Gallery},{"../../common/constants/Browsers":1,"../../common/stores/WindowStore":4,"../../common/utils/Util":11,"../utils/ModalCtrl":104,"./Gallery__body":33}],33:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Gallery__pic=require("./Gallery__pic"),_Gallery__pic2=_interopRequireDefault(_Gallery__pic),_WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Tween=require("../../common/utils/Tween"),_Tween2=_interopRequireDefault(_Tween),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_Draggee=require("../../common/utils/Draggee"),_Draggee2=_interopRequireDefault(_Draggee),_Browsers=require("../../common/constants/Browsers"),Gallery__body=(_interopRequireDefault(_Browsers),function(){function Gallery__body($el,confs){_classCallCheck(this,Gallery__body),this.$=$el,this._confs=confs,this._total=this._confs.length,this._num=-1}return Gallery__body.prototype.create=function(num){var _this=this,mainHtml="",thumbHtml="";_.forEach(this._confs,function(conf,i){mainHtml+='\n    <div class="jsm-gallery__mainPic">\n      <div class="jsm-gallery__mainPicBody"></div>\n      <div class="jsm-imgloading"></div>\n    </div>',thumbHtml+='\n    <div class="jsm-gallery__thumbPic" data-num="'+i+'">\n      <div class="jsm-gallery__thumbPicBody"></div>\n    </div>\n      '}),this.$.find(".jsm-gallery__mainPicWrapper").html(mainHtml),this.$.find(".jsm-gallery__thumbPicWrapper").html(thumbHtml),this.$titleWrapper=this.$.find(".jsm-gallery__titleWrapper"),this.$cover=this.$.find(".jsm-gallery__cover"),this.$thumbPicArea=this.$.find(".jsm-gallery__thumbArea"),this.$thumbPicWrapper=this.$.find(".jsm-gallery__thumbPicWrapper"),this._mainPics=_.map(this.$.find(".jsm-gallery__mainPic"),function(el,i){return new _Gallery__pic2.default($(el),_this._confs[i].main)}),this._thumbPics=_.map(this.$.find(".jsm-gallery__thumbPic"),function(el,i){return new _Gallery__pic2.default($(el),_this._confs[i].thumb)}),this._startLoad(num);this.$.find(".jsm-gallery__thumbArea").css("padding-bottom",30-_WindowStore2.default.getScrollBarWidth()).css("bottom",-30),this._touchMoved=!1,this.$.find(".jsm-gallery__thumbPicWrapper").on("touchstart",function(){_this._touchMoved=!1}).on("touchmove",function(){_this._touchMoved=!0}).on("click",".jsm-gallery__thumbPic",function(e){var num=parseInt($(e.target).attr("data-num"));_this._switch(num)}),this.$.find(".jsm-prev").on("click",this._prev.bind(this)),this.$.find(".jsm-next").on("click",this._next.bind(this)),this._d=new _Draggee2.default,this._d.init(this.$.find(".jsm-gallery__mainPicWrapper")[0]).onEndDir(function(dir){dir>0?_this._next():dir<0&&_this._prev()})},Gallery__body.prototype.destroy=function(){this._mainPics&&_.forEach(_.concat(this._mainPics,this._thumbPics),function(pic){pic.destroy()}),this._d&&this._d.clear(),this.$.find(".jsm-gallery__thumbPicWrapper").off(),this.$.find(".jsm-prev").off(),this.$.find(".jsm-next").off(),this.$.find(".jsm-gallery__close").off(),this.$.remove(),_Util2.default.deleteAll(this)},Gallery__body.prototype.open=function(num){var _this2=this;_WindowStore2.default.switchModalState(!0,0),setTimeout(function(){_this2.$.addClass("js-visible"),_this2._switch(num,{isFirst:!0}),window.HOSHINOYA.GA.clickEvent("modal","rooms_gallery")},33)},Gallery__body.prototype.close=function(){this._close()},Gallery__body.prototype._close=function(){this.$.removeClass("js-visible"),this._switch(-1),_WindowStore2.default.switchModalState(!1,300)},Gallery__body.prototype._prev=function(){var num=(this._num-1+this._total)%this._total;this._switch(num)},Gallery__body.prototype._next=function(){var num=(this._num+1+this._total)%this._total;this._switch(num)},Gallery__body.prototype._switch=function(num){var _this3=this,switchOptions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._num!==num){this._num=num;var newMain=this._mainPics[num],newThumb=this._thumbPics[num],oldMain=this._currentMain,oldThumb=this._currentThumb;this._currentMain=newMain,this._currentThumb=newThumb,_.includes(this._queuePics,newMain)&&(this._queuePics=_.concat(newMain,_.without(this._queuePics,newMain)));var title=this._confs[num]&&this._confs[num].title||"";if(this._title!==title){this._title=title;var $oldTitle=this._$currentTitle,$newTitle=title?$('<div class="jsm-gallery__title">'+title+"</div>").appendTo(this.$titleWrapper):null;this._$currentTitle=$newTitle,$oldTitle&&($oldTitle.removeClass("js-visible"),setTimeout(function(){$oldTitle.remove()},300),this.$cover.addClass("js-visible"),clearTimeout(this._coverDelayId),this._coverDelayId=setTimeout(function(){_this3.$cover.removeClass("js-visible")},400)),$newTitle&&setTimeout(function(){$newTitle.addClass("js-visible")},33)}oldMain&&oldMain.activate(!1),oldThumb&&oldThumb.activate(!1),newMain&&newMain.activate(!0),newThumb&&newThumb.activate(!0),this._moveThumb(switchOptions)}},Gallery__body.prototype._startLoad=function(num){var mains=this._mainPics.slice(),thumbs=this._thumbPics.slice(),mains0=mains.splice(num,1),thumbs1=thumbs.splice(num),thumbs2=thumbs.reverse(),mains1=mains.splice(num),mains2=mains.reverse();this._queuePics=_.concat(mains0,thumbs1,thumbs2,mains1,mains2),this._loop()},Gallery__body.prototype._loop=function(){if(0!==this._queuePics.length){this._queuePics.splice(0,1)[0].startLoad(this._loop.bind(this))}},Gallery__body.prototype._moveThumb=function(){var _this4=this,switchOptions=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._currentThumb){var thumbW=this._currentThumb.calcWidth(),thumbX=this._currentThumb.calcLeft()-this.$thumbPicWrapper.offset().left,sw=_WindowStore2.default.getWidth(),totalW=thumbW*this._confs.length,maxScroll=Math.max(0,totalW-sw),end=Math.min(maxScroll,thumbX-.5*sw+.5*thumbW);this._tw=this._tw||new _Tween2.default,this._tw.it({start:this.$thumbPicArea.scrollLeft(),end:end,duration:switchOptions.isFirst?0:500,easing:"easeInOutQuad",onProgress:function(v){_this4.$thumbPicArea.scrollLeft(v)}})}},Gallery__body}());exports.default=Gallery__body},{"../../common/constants/Browsers":1,"../../common/stores/WindowStore":4,"../../common/utils/Draggee":6,"../../common/utils/Tween":9,"../../common/utils/Util":11,"./Gallery__pic":34}],34:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Util=require("../../common/utils/Util"),_Util2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Util),Gallery__pic=function(){function Gallery__pic($el,src){_classCallCheck(this,Gallery__pic),this.$=$el,this._src=src}return Gallery__pic.prototype.destroy=function(){_Util2.default.deleteAll(this)},Gallery__pic.prototype.startLoad=function(callbabck){var _this=this;this._loadCallback=callbabck,_Util2.default.loadImgUrl(this._src,function(){_this._loadCallback&&(_this.$.find(".jsm-gallery__mainPicBody, .jsm-gallery__thumbPicBody").css("background-image","url("+_this._src+")"),_this.$.addClass("js-loaded"),_this._loadCallback())})},Gallery__pic.prototype.activate=function(active){this.$.switchClass("js-active",active)},Gallery__pic.prototype.calcWidth=function(){return this.$.outerWidth()},Gallery__pic.prototype.calcLeft=function(){return this.$.offset().left},_createClass(Gallery__pic,[{key:"src",get:function(){return this._src}}]),Gallery__pic}();exports.default=Gallery__pic},{"../../common/utils/Util":11}],35:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Gmap__API=require("./Gmap__API"),_Gmap__API2=_interopRequireDefault(_Gmap__API),_Settings=require("../Settings"),_Util=(_interopRequireDefault(_Settings),require("../../common/utils/Util")),_Util2=_interopRequireDefault(_Util),_Gmap__styles=require("./Gmap__styles"),Gmap=(_interopRequireDefault(_Gmap__styles),function(){function Gmap($el,options){_classCallCheck(this,Gmap),this.$=$el,this.options=_.assign({latlng:[],zoom:15,apikey:""},options||{})}return Gmap.prototype.init=function(){_Gmap__API2.default.load(this.options.apikey,this._init.bind(this))},Gmap.prototype.clear=function(){_Gmap__API2.default.abort(),_Util2.default.deleteAll(this)},Gmap.prototype._init=function(){var center=new google.maps.LatLng(this.options.latlng[0],this.options.latlng[1]);this._map=new google.maps.Map(this.$[0],{zoom:this.options.zoom,center:center,mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,zoomControl:!0,scrollwheel:!1,gestureHandling:"cooperative"})},Gmap.prototype._size=function(p){return new google.maps.Size(p[0],p[1])},Gmap.prototype._latlng=function(p){return new google.maps.LatLng(p[0],p[1])},Gmap}());exports.default=Gmap},{"../../common/utils/Util":11,"../Settings":21,"./Gmap__API":36,"./Gmap__styles":37}],36:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Util=require("../../common/utils/Util"),_Util2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Util),Gmap__API=function(){function Gmap__API(){_classCallCheck(this,Gmap__API),this._loading=!1,this._loaded=!1,this._callbacks=[]}return Gmap__API.prototype.load=function(apikey,calback){var _this=this;if(this._loaded)return calback();if(this._callbacks.push(calback),!this._loading){this._loading=!0,window.initGoogleMap=function(){_this._loaded=!0,_.forEach(_this._callbacks,function(f){return f()})};_Util2.default.loadScript("https://maps.googleapis.com/maps/api/js?key=AIzaSyCgY7J2LqSAg4EmsbSq5kkb2tChHzvJr_U&callback=initGoogleMap")}},Gmap__API.prototype.abort=function(){this._callbacks=[]},Gmap__API}();exports.default=new Gmap__API},{"../../common/utils/Util":11}],37:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=[{stylers:[{saturation:-100}]},{elementType:"labels.text.fill",stylers:[{color:"#666666"}]},{featureType:"administrative",elementType:"geometry",stylers:[{color:"#bdbdbd"}]},{featureType:"administrative",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"geometry.fill",stylers:[{color:"#e6e6e6"}]},{featureType:"poi",stylers:[{visibility:"simplified"}]},{featureType:"poi.attraction",stylers:[{visibility:"off"}]},{featureType:"poi.business",stylers:[{visibility:"off"}]},{featureType:"poi.government",stylers:[{visibility:"off"}]},{featureType:"poi.medical",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#cccccc"}]},{featureType:"poi.park",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",stylers:[{visibility:"off"}]},{featureType:"poi.school",stylers:[{visibility:"off"}]},{featureType:"poi.sports_complex",
stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels",stylers:[{saturation:-100},{lightness:30}]},{featureType:"road.highway",elementType:"geometry",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{visibility:"on"}]},{featureType:"road.highway",elementType:"labels.text.stroke",stylers:[{visibility:"on"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#999999"},{visibility:"simplified"}]},{featureType:"road.local",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{saturation:-100}]},{featureType:"transit.line",elementType:"geometry.fill",stylers:[{color:"#cccccc"}]},{featureType:"transit.line",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"water",stylers:[{visibility:"simplified"}]}]},{}],38:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_eventemitter=require("eventemitter2"),_WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_Browsers=require("../../common/constants/Browsers"),_Browsers2=_interopRequireDefault(_Browsers),_hideImgLoading=require("../utils/hideImgLoading"),_hideImgLoading2=_interopRequireDefault(_hideImgLoading),LOADERS_ARR=[],LOADERS_IDX={},WAITEES={},LOADED_FLAGS={},TEXTURES={},LOAD_STARTED=!1,LOAD_BOOST=!0,Img=function(_EventEmitter){function Img($el,options){_classCallCheck(this,Img);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));return _this.$=$el,_this.options=_.assign({src:"",pc:"",pc2x:"",sp:"",setbg:!1,forcanvas:!1},options),_this.options.src&&(_this.options.pc=_this.options.sp=_this.options.src),_this.options.pc2x&&_Browsers2.default.pixelratio>1&&(_this.options.pc=_this.options.pc2x),_this.options.sp||(_this.options.sp=_this.options.pc),_this._loaded=!1,_this}return _inherits(Img,_EventEmitter),Img.applyPostpone=function(){var first=[],latter=[];_.forEach(LOADERS_ARR,function(loader){loader.__postpone?latter.push(loader):first.push(loader)}),LOADERS_ARR=first.concat(latter)},Img.boostLoading=function(){LOAD_BOOST=!0},Img.prototype.onLoad=function(f){if(this._loaded)return f();this.on("load",f)},Img.prototype.loadComplete=function(){this._cleared||(this._loaded=!0,this.$.addClass("js-loaded"),this._texture=TEXTURES[this._src],this._texture&&(this._w=this._texture.frame.width,this._h=this._texture.frame.height),this.options.setbg&&this._setBg(),this.emit("load"))},Img.prototype._setBg=function(){var $body=this.$.find(".jsm-img__body");0===$body.length&&($body=this.$),$body.css("background-image","url("+this._src+")").addClass("js-visible"),(0,_hideImgLoading2.default)(this.$)},Img.prototype.init=function(){var src=_WindowStore2.default.getIsPC()?this.options.pc:this.options.sp;return this.options.forcanvas||(this._img=this.$.find("img")[0],this._img?src=this._img.src:this._img=new Image),src?(this._src=src,LOADED_FLAGS[src]?this.loadComplete():(WAITEES[src]=WAITEES[src]||[],WAITEES[src].push(this),void(LOADERS_IDX[src]||(this._img?(LOADERS_IDX[src]=this._img,LOADERS_IDX[src].__type="img"):LOADERS_IDX[src]=(new PIXI.loaders.Loader).add(src,src),LOADERS_IDX[src].__postpone=1===parseInt(this.$.attr("data-postpone")),LOADERS_IDX[src].__src=src,LOADERS_ARR.push(LOADERS_IDX[src]),this._start())))):console.error("[img module] src is required.")},Img.prototype.clear=function(){this.removeAllListeners(),_Util2.default.deleteAll(this),this._cleared=!0},Img.prototype._start=function(){LOAD_STARTED||(LOAD_STARTED=!0,this._loop())},Img.prototype._loop=function(){var _this2=this;if(0===LOADERS_ARR.length)return void(LOAD_STARTED=!1);var loader=LOADERS_ARR.splice(0,1)[0],src=loader.__src,complete=function(){if(_.forEach(WAITEES[src],function(img){img.loadComplete()}),LOADED_FLAGS[src]=!0,WAITEES[src]=[],LOAD_BOOST)return _.forEach(_.range(2),function(){_this2._loop()}),void(LOAD_BOOST=!1);_this2._loop()};"img"===loader.__type?(loader.src=src,_Util2.default.loadImg(loader,complete)):loader.load(function(loader,assets){TEXTURES[src]=assets[src].texture,complete()})},_createClass(Img,[{key:"loaded",get:function(){return this._loaded}},{key:"texture",get:function(){return this._texture}},{key:"w",get:function(){return this._w}},{key:"h",get:function(){return this._h}}]),Img}(_eventemitter.EventEmitter2);exports.default=Img},{"../../common/constants/Browsers":1,"../../common/stores/WindowStore":4,"../../common/utils/Util":11,"../utils/hideImgLoading":111,eventemitter2:117}],39:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Tween=require("../../common/utils/Tween"),_Settings=(_interopRequireDefault(_Tween),require("../Settings")),_Util=(_interopRequireDefault(_Settings),require("../../common/utils/Util")),_Util2=_interopRequireDefault(_Util),Location=function(){function Location($el,options){_classCallCheck(this,Location),this.$=$el,this.options=_.assign({},options||{}),this.$body=$(document.body)}return Location.prototype.init=function(){var _this=this;if(this._$items=_.map(this.$.find(".jsm-location__item"),function(el,i){var $item=$(el);return $item.$detail=$item.find(".jsm-location__itemDetail"),$item.find(".jsm-location__itemTrigger").on("click",_this._activate.bind(_this,i)),$item.find(".jsm-location__itemContentClose").on("click",_this._close.bind(_this,i)),$item}),_WindowStore2.default.getIsSP()){var $map=this.$.find(".jsm-location__map"),$mapInner=this.$.find(".jsm-location__mapInner"),left=Math.round(.5*($mapInner.outerWidth()-$map.outerWidth()));$map.scrollLeft(left)}this._isPC=!0,this._bindedBreakHdl=this._breakHdl.bind(this),_WindowStore2.default.onBreak(this._bindedBreakHdl),this._breakHdl()},Location.prototype.clear=function(){this._toggleOuterClick(!1),this.$.find(".jsm-location__itemTrigger").off(),_WindowStore2.default.offBreak(this._bindedBreakHdl),_Util2.default.deleteAll(this)},Location.prototype._breakHdl=function(){var _this2=this;this._isPC!==_WindowStore2.default.getIsPC()&&(this._isPC=_WindowStore2.default.getIsPC(),_.forEach(this._$items,function($item){_this2._isPC?$item.append($item.$detail):_this2.$.append($item.$detail)}))},Location.prototype._close=function(){this._activate(-1)},Location.prototype._activate=function(num){num===this._num&&(num=-1),this._num=num;var $newItem=this._$items[num],$oldItem=this._$currentItem;this._$currentItem=$newItem,$newItem&&($newItem.addClass("js-active"),$newItem.$detail.addClass("js-active")),$oldItem&&($oldItem.removeClass("js-active"),$oldItem.$detail.removeClass("js-active")),clearTimeout(this._delayId),this._delayId=setTimeout(this._toggleOuterClick.bind(this,num>=0),33)},Location.prototype._toggleOuterClick=function(isBind){this.$body&&this._isBind!==isBind&&(this._isBind=isBind,this._bindedOuterClickHdl=this._bindedOuterClickHdl||this._outerClickHdl.bind(this),this.$body[isBind?"on":"off"]("mousedown touchstart",this._bindedOuterClickHdl))},Location.prototype._outerClickHdl=function(e){this._$currentItem&&($.contains(this._$currentItem[0],e.target)||$.contains(this._$currentItem.$detail[0],e.target)||this._close())},Location}();exports.default=Location},{"../../common/stores/WindowStore":4,"../../common/utils/Tween":9,"../../common/utils/Util":11,"../Settings":21}],40:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_Browsers=require("../../common/constants/Browsers"),_Tween=(_interopRequireDefault(_Browsers),require("../../common/utils/Tween")),_Tween2=_interopRequireDefault(_Tween),LogoAnime=function(){function LogoAnime($el){_classCallCheck(this,LogoAnime),this.$=$el}return LogoAnime.prototype.init=function(){this.$circles=this.$.find(".jsm-logoanime__c"),this.$iconWrap=this.$.find(".jsm-logoanime__c1icon")},LogoAnime.prototype.clear=function(){_Util2.default.deleteAll(this)},LogoAnime.prototype.showDirect=function(){this.$.addClass("js-showDirect js-complete")},LogoAnime.prototype.showText=function(callback){var _this=this;this.$circles.eq(1).addClass("js-visible");var $covers=this.$.find(".jsm-logoanime__c2covers span");_.forEach($covers,function(el,i){_Util2.default.setAnimationFrameTimeout(function(){_this._showLetter(el),callback&&i===$covers.length-1&&_Util2.default.setAnimationFrameTimeout(callback,600)},800+150*i)})},LogoAnime.prototype._showLetter=function(el){var $el=$(el),$inner=$el.find("i");(new _Tween2.default).it({start:-1,end:1,duration:600,easing:"easeInOutQuart",onProgress:function(v){$el.css3({rotate:30*v})}}),(new _Tween2.default).it({start:1,end:0,duration:600,easing:"easeInOutQuart",onProgress:function(v){$inner.css3({scaleX:v,scaleY:1})}})},LogoAnime.prototype.showIntro=function(highlightCallback){var _this2=this;this.showText(),_Util2.default.setAnimationFrameTimeout(function(){_this2.$circles.eq(2).addClass("js-visible")},1200),_Util2.default.setAnimationFrameTimeout(function(){_this2.$circles.eq(0).addClass("js-visible")},1200);var hotels=window.HOSHINOYA.hotels,lastSite=window.HOSHINOYA.site;hotels=_.concat(_.shuffle(_.without(hotels,lastSite)),lastSite),_Util2.default.setAnimationFrameTimeout(function(){_.forEach(hotels,function(siteName,i){var isFirst=0===i,isLast=i===hotels.length-1,delay=210*i;isFirst&&(delay-=100),_Util2.default.setAnimationFrameTimeout(function(){var isBlack=lastSite!==siteName;_this2.switchIcon(siteName,{isFirst:isFirst,isLast:isLast,findExists:!0,isBlack:isBlack}),isLast&&(_Util2.default.setAnimationFrameTimeout(function(){_this2.$.addClass("js-highlight")},200),highlightCallback())},delay)})},2600),_Util2.default.setAnimationFrameTimeout(function(){_this2.$.addClass("js-complete")},3e3)},LogoAnime.prototype.switchIcon=function(hotelId){var switchOptions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._hotelId!==hotelId){this._hotelId=hotelId;var $newIcon=void 0;if(hotelId){(window.HOSHINOYA.sites[hotelId]||{}).has_black_logo||(switchOptions.isBlack=!1);var svgName=hotelId+(switchOptions.isBlack?"-black":"");$newIcon=$('<li><svg><use xlink:href="#logo-hotel-'+svgName+'"></use></svg></li>').appendTo(this.$iconWrap)}var $oldIcon=this._$currentIcon;this._$currentIcon=$newIcon,$oldIcon&&_Util2.default.setAnimationFrameTimeout(function(){$oldIcon.addClass("js-hidden"),_Util2.default.setAnimationFrameTimeout(function(){$oldIcon.remove(),$oldIcon=null},1200)},33),clearTimeout(this._delayId),$newIcon&&($newIcon.switchClass("js-first",switchOptions.isFirst).switchClass("js-last",switchOptions.isLast).switchClass("js-slow",switchOptions.isSlow).switchClass("js-noScale",switchOptions.noScale),this._delayId=_Util2.default.setAnimationFrameTimeout(function(){$newIcon.addClass("js-visible")},33+(switchOptions.delay||0)))}},LogoAnime}();exports.default=LogoAnime},{"../../common/constants/Browsers":1,"../../common/utils/Tween":9,"../../common/utils/Util":11}],41:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _Settings=require("../Settings"),_Util=(_interopRequireDefault(_Settings),require("../../common/utils/Util")),_Tween=(_interopRequireDefault(_Util),require("../../common/utils/Tween")),_eventemitter=(_interopRequireDefault(_Tween),require("eventemitter2")),_YoutubeAPI=require("./YoutubeAPI"),_YoutubeAPI2=_interopRequireDefault(_YoutubeAPI),_Browsers=require("../../common/constants/Browsers"),_Browsers2=_interopRequireDefault(_Browsers),_ModalCtrl=require("../utils/ModalCtrl"),_ModalCtrl2=_interopRequireDefault(_ModalCtrl),Movie=function(_EventEmitter){function Movie($el,options){_classCallCheck(this,Movie);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));_this.$=$el,_this.options=_.assign({youtubeid:""},options||{}),_this.$modal=_this.$.find(".jsm-movie__modal"),_this.$.find(".jsm-movie__trigger").on("click",_this._open.bind(_this));var $video=_this.$.find(".jsm-movie__triggerInner--video");if(_Browsers2.default.canVideoPlaysInline){_this.$.find(".jsm-movie__triggerInner--image").remove();var videoEl=$video.find("video")[0];videoEl&&videoEl.play()}else $video.remove();return _this._modalCtrl=new _ModalCtrl2.default({hash:"movie",$close:_this.$.find(".jsm-movie__modalBg, .jsm-movie__modalClose"),onClose:function(){_this._close()}}),_this._playing=!1,_this}return _inherits(Movie,_EventEmitter),Movie.prototype._build=function(){var _this2=this;this._isBuilt||(this._isBuilt=!0,_YoutubeAPI2.default.init().then(function(){_this2._player=_YoutubeAPI2.default.makePlayer(_this2.$.find(".jsm-movie__modalBody")[0],_this2.options.youtubeid,_this2._playerReadyHdl.bind(_this2),_this2._playerStateChangeHdl.bind(_this2))}))},Movie.prototype._playerReadyHdl=function(){this._playerReady=!0,this._updateState()},Movie.prototype._playerStateChangeHdl=function(){},Movie.prototype._open=function(){this._playing||(this._build(),this._playing=!0,this._updateState(),this._modalCtrl.opened(),clearTimeout(this._delayId),this.$modal.addClass("js-show js-visible"))},Movie.prototype._close=function(){var _this3=this;this._playing=!1,this._updateState(),clearTimeout(this._delayId),this.$modal.removeClass("js-show"),this._delayId=setTimeout(function(){_this3.$modal.removeClass("js-visible")},200)},Movie.prototype._updateState=function(){this._playerReady&&this._player&&(this._playing?this._player.playVideo():this._player.pauseVideo())},Movie}(_eventemitter.EventEmitter2);exports.default=Movie},{"../../common/constants/Browsers":1,"../../common/utils/Tween":9,"../../common/utils/Util":11,"../Settings":21,"../utils/ModalCtrl":104,"./YoutubeAPI":67,eventemitter2:117}],42:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_News__dataItem=require("./News__dataItem"),_News__dataItem2=_interopRequireDefault(_News__dataItem),_News__modal=require("./News__modal"),_News__modal2=_interopRequireDefault(_News__modal),_News__indexItem=require("./News__indexItem"),_News__index=(_interopRequireDefault(_News__indexItem),require("./News__index")),_News__index2=_interopRequireDefault(_News__index),_autoInit=require("./auto-init"),_autoInit2=_interopRequireDefault(_autoInit),_ModalCtrl=require("../utils/ModalCtrl"),_ModalCtrl2=_interopRequireDefault(_ModalCtrl),News=function(){function News($el,options){_classCallCheck(this,News),this.$=$el,this.options=_.assign({},options||{})}return News.prototype.setup=function(callback){var _this=this;$.ajax({url:"/_admin/wp-content/themes/hsn/_data/instagram.json",dataType:"text",cache:!1,success:function(res){_this._build(JSON.parse(res)),callback()},error:function(e,e2,e3){console.error(e,e2,e3)}})},News.prototype._build=function(data){var _this2=this;this._$filterItems=_.map(this.$.find(".jsm-news__filterItem"),function(el){var $item=$(el);return $item.id=$item.attr("data-id"),$item.on("click",_this2._switchHotel.bind(_this2,$item.id)),$item}),this.$select=this.$.find(".jsm-news__select"),this.$select.on("change",function(){_this2._switchHotel(_this2.$select.val())});var month3=_.map(_.range(3),function(num){var yyyy=_Util2.default.now.yyyy,m=_Util2.default.now.m-num;return m<1&&(yyyy--,m+=12),yyyy+"-"+m});this._data=_.compact(_.map(data,function(obj){var item=new _News__dataItem2.default(obj),date=new Date(1e3*parseInt(obj.created_time)),monthStr=date.getFullYear()+"-"+(date.getMonth()+1);return _.includes(month3,monthStr)?item:null})),this._index=new _News__index2.default(this.$.find(".jsm-news__index"),this._data),this._index.onClick(this._switchModal.bind(this)),this._modal=new _News__modal2.default(this.$.find(".jsm-news__modal"),this._data),this.$.find('[data-cancelauto="1"]').removeAttr("data-cancelauto"),(0,_autoInit2.default)(this.$),this.$.addClass("js-moduleinited"),this._sticky=this.$.find(".jsm-sticky").data("jsm-instance"),this._modalCtrl=new _ModalCtrl2.default({hash:"detail",$close:this.$.find(".jsm-news__modalClose, .jsm-news__modalBg"),onClose:function(){_this2._switchModal(-1)}}),this._switchHotel((location.hash||"#").split("#")[1])},News.prototype._switchHotel=function(id){var _this3=this;_.includes(window.HOSHINOYA.hotels,id)||(id="_admin"),"detail"===id&&(id=this._id||"_admin"),this._id!==id&&(this._id=id,this._index.filter(id),this._modal.filter(id),_.forEach(this._$filterItems,function($item){$item.switchClass("js-active",$item.id===id)}),this.$select.val(id),location.replace("#"+("_admin"===id?"":id)),_WindowStore2.default.scrollTo(0,300),setTimeout(function(){_this3._sticky.calcBounds()},500))},News.prototype._switchModal=function(num){this._modal.switchItem(num),num>=0&&this._modalCtrl.opened()},News}();exports.default=News},{"../../common/stores/WindowStore":4,"../../common/utils/Util":11,"../utils/ModalCtrl":104,"./News__dataItem":43,"./News__index":44,"./News__indexItem":45,"./News__modal":46,"./auto-init":68}],43:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Util=require("../../common/utils/Util"),_Util2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Util),News__dataItem=function(){function News__dataItem(obj){var _this=this;_classCallCheck(this,News__dataItem),this._obj=obj,this._date=new Date(1e3*parseInt(obj.created_time)),this._dateStr=this._date.getFullYear()+"."+_Util2.default.zeroPad(this._date.getMonth()+1)+"."+_Util2.default.zeroPad(this._date.getDate()),this._rawCaption=this._obj.caption.text,this._caption=this._removeTags(this._rawCaption),this._hotel=_.find(window.HOSHINOYA.hotels,function(hotelId){return _.includes(hotelId,"taketomi")?_.includes(_this._rawCaption,"#taketomi"):_.includes(_this._rawCaption,"#"+hotelId)});var hotelConf=window.HOSHINOYA.sites[this._hotel];hotelConf&&(this._hotelName=hotelConf.texts[window.HOSHINOYA.lang].name,this._hotelLogo=this._hotel+(hotelConf.has_black_logo?"-small-black":"-small"))}return _createClass(News__dataItem,[{key:"id",get:function(){return this._obj.id}},{key:"hotel",get:function(){return this._hotel}},{key:"hotelName",get:function(){return this._hotelName}},{key:"hotelLogo",get:function(){return this._hotelLogo}},{key:"dateStr",get:function(){return this._dateStr}},{key:"thumb",get:function(){return this._obj.images.standard_resolution.url}},{key:"image",get:function(){return this._obj.images.standard_resolution.url}},{key:"caption",get:function(){return this._caption}},{key:"link",get:function(){return this._obj.link}},{key:"langUrl",get:function(){var lang=window.HOSHINOYA.lang;return"ja"===lang?"":lang+"/"}}]),News__dataItem.prototype._removeTags=function(caption){return caption=caption.replace(/#(.*)/g,"")},News__dataItem.prototype.toObject=function(){return _.pick(this,"hotel hotelName hotelLogo image thumb dateStr caption langUrl".split(" "))},News__dataItem}();exports.default=News__dataItem},{"../../common/utils/Util":11}],44:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _WindowStore=require("../../common/stores/WindowStore"),_Util=(_interopRequireDefault(_WindowStore),require("../../common/utils/Util")),_Util2=_interopRequireDefault(_Util),_News__indexItem=require("./News__indexItem"),_News__indexItem2=_interopRequireDefault(_News__indexItem),_eventemitter=require("eventemitter2"),News__index=function(_EventEmitter){function News__index($el,data){_classCallCheck(this,News__index);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));_this.$=$el;var tplItem=_this.$.html(),itemsHtml=_.map(data,function(dataItem){return _Util2.default.template(tplItem,dataItem.toObject())}).join("");return _this.$.html(itemsHtml),_this._items=_.map(_this.$.find(".jsm-news__indexItem"),function(el,i){var item=new _News__indexItem2.default($(el),data[i]);return item.$.on("click",_this._itemClicked.bind(_this,item)),item}),_this}return _inherits(News__index,_EventEmitter),News__index.prototype.onClick=function(f){this.on("click",f)},News__index.prototype.filter=function(hotelId){var count=0;this._currentItems=_.filter(this._items,function(item){return item.switchShow(hotelId,count),item.visible&&count++,item.visible})},News__index.prototype._itemClicked=function(item){var num=this._currentItems.indexOf(item);this.emit("click",num)},News__index}(_eventemitter.EventEmitter2);exports.default=News__index},{"../../common/stores/WindowStore":4,"../../common/utils/Util":11,"./News__indexItem":45,eventemitter2:117}],45:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_WindowStore=require("../../common/stores/WindowStore"),_Util=(_interopRequireDefault(_WindowStore),require("../../common/utils/Util")),News__indexItem=(_interopRequireDefault(_Util),function(){function News__indexItem($el,dataItem){_classCallCheck(this,News__indexItem),this.$=$el,this._hotel=dataItem.hotel,this._visible=!1}return _createClass(News__indexItem,[{key:"visible",get:function(){return this._visible}}]),News__indexItem.prototype.switchShow=function(hotelId,count){var _this=this,visible="_admin"===hotelId||hotelId===this._hotel;this._visible=visible,clearTimeout(this._delayId),visible?(this.$.removeClass("js-show"),this._delayId=setTimeout(function(){_this.$.addClass("js-visible"),_this._delayId=setTimeout(function(){_this.$.addClass("js-show")},33+100*count)},200)):(this.$.removeClass("js-show"),this._delayId=setTimeout(function(){_this.$.removeClass("js-visible")},200))},News__indexItem}());exports.default=News__indexItem},{"../../common/stores/WindowStore":4,"../../common/utils/Util":11}],46:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_News__modalItem=require("./News__modalItem"),_News__modalItem2=_interopRequireDefault(_News__modalItem),_Draggee=require("../../common/utils/Draggee"),_Draggee2=_interopRequireDefault(_Draggee),News__modal=function(){function News__modal($el,data){_classCallCheck(this,News__modal),this.$=$el,this.$content=this.$.find(".jsm-news__modalContent");var tplItem=this.$content.html(),itemsHtml=_.map(data,function(dataItem){return _Util2.default.template(tplItem,dataItem.toObject())}).join("");this.$content.html(itemsHtml),this._items=_.map(this.$content.find(".jsm-news__modalItem"),function(el,i){return new _News__modalItem2.default($(el),data[i])}),this.$.find(".jsm-news__modalNext").on("click",this._next.bind(this,!1)),this.$.find(".jsm-news__modalPrev").on("click",this._prev.bind(this,!1)),this._d=new _Draggee2.default,this._d.init(this.$content[0]).onStart(this._dragStartHdl.bind(this)).onMove(this._dragMoveHdl.bind(this)).onEndDir(this._dragEndDirHdl.bind(this))}return _createClass(News__modal,[{key:"num",get:function(){return this._num}}]),News__modal.prototype.filter=function(hotelId){this._currentItems=_.filter(this._items,function(item){return"_admin"===hotelId||item.hotel===hotelId}),this._total=this._currentItems.length},News__modal.prototype._close=function(){this.switchItem(-1)},News__modal.prototype._prev=function(){var bySwipe=arguments.length>0&&void 0!==arguments[0]&&arguments[0],num=(this._num-1+this._total)%this._total;this.switchItem(num,{dir:-1,bySwipe:bySwipe})},News__modal.prototype._next=function(){var bySwipe=arguments.length>0&&void 0!==arguments[0]&&arguments[0],num=(this._num+1+this._total)%this._total;this.switchItem(num,{dir:1,bySwipe:bySwipe})},News__modal.prototype.switchItem=function(num,switchOptions){var _this=this;if(this._currentItems){switchOptions=_.assign({dir:0,bySwipe:!1},switchOptions),this._num=num;var visible=num>=0;this._visible!==visible&&(this._visible=visible,_WindowStore2.default.switchModalState(visible),visible?(clearTimeout(this._delayId),this.$.addClass("js-show js-visible")):(clearTimeout(this._delayId),this.$.removeClass("js-show"),this._delayId=setTimeout(function(){_this.$.removeClass("js-visible")},200)));var newItem=this._currentItems[num],oldItem=this._activeItem;this._activeItem=newItem,newItem&&newItem.switchShow(!0,switchOptions),oldItem&&oldItem.switchShow(!1,switchOptions)}},News__modal.prototype._dragStartHdl=function(clientX,clientY,e){this._activeItem.dragStart()},News__modal.prototype._dragMoveHdl=function(dx,dy,ax,ay){this._activeItem.dragMove(dx)},News__modal.prototype._dragEndDirHdl=function(dir){if(0===dir)return void this._activeItem.dragEnd();dir>0?this._next(!0):this._prev(!0)},News__modal}();exports.default=News__modal},{"../../common/stores/WindowStore":4,"../../common/utils/Draggee":6,"../../common/utils/Util":11,"./News__modalItem":47}],47:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Util=require("../../common/utils/Util"),_Tween=(_interopRequireDefault(_Util),require("../../common/utils/Tween")),_Tween2=_interopRequireDefault(_Tween),News__modalItem=function(){function News__modalItem($el,dataItem){_classCallCheck(this,News__modalItem),this.$=$el,
this._hotel=dataItem.hotel,this._tw=new _Tween2.default,this._visible=!1,this._dragX=0}return _createClass(News__modalItem,[{key:"hotel",get:function(){return this._hotel}}]),News__modalItem.prototype.dragStart=function(){this._dragX=0},News__modalItem.prototype.dragMove=function(x){this._dragX=x,this.$.css3({x:x})},News__modalItem.prototype.dragEnd=function(){var _this=this;this._tw.it({start:this._dragX,end:0,duration:300,delay:0,easing:"easeInOutQuad",onProgress:function(x){_this._dragX=x,_this.$.css3({x:x})}})},News__modalItem.prototype.switchShow=function(visible,switchOptions){var _this2=this;if(this._visible!==visible){this._visible=visible,this.$.switchClass("js-relative",visible),visible&&this.$.addClass("js-visible");var hideW=.5*this.$.outerWidth()+.5*_WindowStore2.default.getWidth(),start=visible?hideW*switchOptions.dir:this._dragX,end=visible?0:hideW*switchOptions.dir*-1,duration=_WindowStore2.default.getIsPC()?900:500,easing=switchOptions.bySwipe?"easeOutQuart":"easeInOutQuart";this._dragX=0,this._tw.it({start:start,end:end,duration:duration,easing:easing,onProgress:function(x){_this2.$.css3({x:x})},onComplete:function(){visible||_this2.$.removeClass("js-visible")}})}},News__modalItem}();exports.default=News__modalItem},{"../../common/stores/WindowStore":4,"../../common/utils/Tween":9,"../../common/utils/Util":11}],48:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Settings=require("../Settings"),_Util=(_interopRequireDefault(_Settings),require("../../common/utils/Util")),_Util2=_interopRequireDefault(_Util),_Tween=require("../../common/utils/Tween"),_Tween2=_interopRequireDefault(_Tween),_eventemitter=require("eventemitter2"),_jsCookie=require("js-cookie"),_jsCookie2=_interopRequireDefault(_jsCookie),_Notice__modal=require("./Notice__modal"),_Notice__modal2=_interopRequireDefault(_Notice__modal),COOKIE_NAME_BASE="hsn_notice_view-",Notice=function(_EventEmitter){function Notice($el,options){_classCallCheck(this,Notice);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));return _this.$=$el,_this.$bar=_this.$.find(".jsm-notice__bar"),_this.$barClose=_this.$.find(".jsm-notice__barClose"),_this.options=_.assign({},options||{}),_this._killed=!1,_this._postIds=_.compact(_.map(_this.$bar.find(".jsm-notice__barItem"),function(el){var $item=$(el),postId=$item.attr("data-postid");return 1===parseInt(_jsCookie2.default.get(COOKIE_NAME_BASE+postId))?($item.remove(),null):($item.on("click",_this._showModal.bind(_this,postId)),postId)})),0===_this._postIds.length?(_this._killed=!0,_this.$.remove(),_possibleConstructorReturn(_this)):(_this._build(),_this)}return _inherits(Notice,_EventEmitter),_createClass(Notice,[{key:"height",get:function(){return this._h}},{key:"offset",get:function(){return this._offset}},{key:"killed",get:function(){return this._killed}}]),Notice.prototype._build=function(){this._modal=new _Notice__modal2.default(this.$.find(".jsm-notice__modal"))},Notice.prototype._showModal=function(postId){this._markViewed(postId),this._modal.show(postId),this._postIds=_.without(this._postIds,postId),0===this._postIds.length&&this._closeBar()},Notice.prototype._markViewed=function(postId){_jsCookie2.default.set(COOKIE_NAME_BASE+postId,"1",{expires:99,path:"/"})},Notice.prototype._markAllViewed=function(){var _this2=this;_.forEach(this._postIds,function(postId){_this2._markViewed(postId)})},Notice.prototype.onClosing=function(f){this.on("closing",f)},Notice.prototype.onCloseComplete=function(f){this.on("close_complete",f)},Notice.prototype.init=function(){this._killed||(this.resized(),this._$affectees=_.map($('[data-notice__affectee="1"]'),function(el){var $el=$(el);return $el.affectProp=$el.attr("data-notice__affectprop")||"top",$el}),this.$barClose.on("click",this._closeBar.bind(this,!0)))},Notice.prototype.preClear=function(){this._killed||this._closeBar(!1)},Notice.prototype.clear=function(){},Notice.prototype.resized=function(){this._killed||(this._h=this.$bar.outerHeight())},Notice.prototype.scrolled=function(y){if(!this._killed&&(y>this._h&&(y=this._h),this._y!==y)){this._y=y;var offset=this._h-this._y;offset<0&&(offset=0),this._offset!==offset&&(this._offset=offset,this.$bar.css3({y:-this._y}),this._applyOffset(offset))}},Notice.prototype._applyOffset=function(offset){_.forEach(this._$affectees,function($el){$el.css($el.affectProp,offset)})},Notice.prototype._closeBar=function(withMark){var _this3=this;if(!this._killed){this._killed=!0,this.$bar.addClass("js-close"),withMark&&this._markAllViewed();(new _Tween2.default).it({start:{height:this._h,offset:this._offset},end:{height:0,offset:0},duration:400,delay:0,easing:"easeInOutQuart",onProgress:function(props){_this3._h=props.height,_this3._offset=props.offset,_this3.$bar.css("height",_this3._h),_this3._applyOffset(_this3._offset),_this3.emit("closing")},onComplete:function(){_this3.$bar.remove(),_this3.emit("close_complete"),_Util2.default.deleteAll(_this3),_this3._killed=!0}})}},Notice}(_eventemitter.EventEmitter2);exports.default=Notice},{"../../common/utils/Tween":9,"../../common/utils/Util":11,"../Settings":21,"./Notice__modal":49,eventemitter2:117,"js-cookie":121}],49:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Settings=require("../Settings"),_Util=(_interopRequireDefault(_Settings),require("../../common/utils/Util")),_Tween=(_interopRequireDefault(_Util),require("../../common/utils/Tween")),_WindowStore=(_interopRequireDefault(_Tween),require("../../common/stores/WindowStore")),_WindowStore2=_interopRequireDefault(_WindowStore),Notice__modal=function(){function Notice__modal($el,options){_classCallCheck(this,Notice__modal),this.$=$el,this.options=_.assign({},options||{}),this._$items=_.map(this.$.find(".jsm-notice__modalItem"),function(el){var $el=$(el);return $el.postId=$el.attr("data-postid"),$el}),this.$.find(".jsm-notice__modalBg, .jsm-notice__modalClose").on("click",this._hide.bind(this))}return Notice__modal.prototype.show=function(postId){clearTimeout(this._delayId),_WindowStore2.default.switchModalState(!0),this.$.addClass("js-show js-visible"),_.forEach(this._$items,function($item){$item.switchClass("js-visible",$item.postId===postId)})},Notice__modal.prototype._hide=function(){var _this=this;clearTimeout(this._delayId),_WindowStore2.default.switchModalState(!1),this.$.removeClass("js-show"),this._delayId=setTimeout(function(){_this.$.removeClass("js-visible")},200)},Notice__modal}();exports.default=Notice__modal},{"../../common/stores/WindowStore":4,"../../common/utils/Tween":9,"../../common/utils/Util":11,"../Settings":21}],50:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_ScreenModule2=require("../utils/ScreenModule"),_ScreenModule3=_interopRequireDefault(_ScreenModule2),_WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_OutlineHero__PC=require("./OutlineHero__PC"),_OutlineHero__PC2=_interopRequireDefault(_OutlineHero__PC),_OutlineHero__SP=require("./OutlineHero__SP"),_OutlineHero__SP2=_interopRequireDefault(_OutlineHero__SP),_OutlineHero__button=require("./OutlineHero__button"),_OutlineHero__button2=_interopRequireDefault(_OutlineHero__button),_Browsers=require("../../common/constants/Browsers"),_Browsers2=_interopRequireDefault(_Browsers),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_Settings=require("../Settings"),_Settings2=_interopRequireDefault(_Settings),OutlineHero=function(_ScreenModule){function OutlineHero($el){_classCallCheck(this,OutlineHero);var _this=_possibleConstructorReturn(this,_ScreenModule.call(this,$el));return _this.$=$el,_this._onLoadCallbacks=[],_this.$bookingButtons=$(".jsm-outlinehero__bookingButton"),_this.$bookingButtonSide=$(".jsm-outlinehero__bookingButton--side"),_this.$footer=$(".jsm-outlinehero__footer"),_this._frameTimeCancelCallbacks=[],_WindowStore2.default.getIsPC()&&(_Settings2.default.query.ui_bottom||_.includes(["bottom","bottom_best"],window.HOSHINOYA.uiPattern))&&_this.$bookingButtons.addClass("js-halfhidden"),_this._buttons=_.map(_this.$bookingButtons,function(el){var $el=$(el),button=new _OutlineHero__button2.default($el);return $el.on("click",function(e){button.clicked(e,_this._current.isFirstView())}),button}),_this}return _inherits(OutlineHero,_ScreenModule),OutlineHero.prototype.onLoad=function(f){if(this._isImageLoaded)return f();this._onLoadCallbacks.push(f)},OutlineHero.prototype._screenInit=function(){var _this2=this;this._isImageLoaded=!1,this._img=this.$.find(".jsm-img").data("jsm-instance"),this._img.onLoad(function(){_this2._isImageLoaded=!0,_.forEach(_this2._onLoadCallbacks,function(f){return f()})});var notice=this.$.parent().parent().find(".jsm-notice").data("jsm-instance");notice&&notice.killed&&(notice=null),this._pc=new _OutlineHero__PC2.default(this.$,notice),this._sp=new _OutlineHero__SP2.default(this.$,notice),this.$.find(".jsm-outlinehero__arw").on(_Browsers2.default.touch?"touchend":"click",function(){_this2._current.scrollClicked()})},OutlineHero.prototype._screenClear=function(){this._img=null,this._onLoadCallbacks=[],_.forEach(this._frameTimeCancelCallbacks,function(cancel){cancel()}),_.forEach(this._buttons,function(button){button.destroy()}),this.$.find(".jsm-outlinehero__arw").off(),this.$bookingButtons.off(),this._current.activate(!1),this._pc.destroy(),this._sp.destroy()},OutlineHero.prototype._screenResized=function(){var newCurrent=_WindowStore2.default.getIsPC()?this._pc:this._sp;if(newCurrent&&newCurrent.resized(),this._current!==newCurrent){var oldCurrent=this._current;this._current=newCurrent,oldCurrent&&oldCurrent.activate(!1),newCurrent&&newCurrent.activate(!0)}},OutlineHero.prototype._screenScrolled=function(){this._current.scrolled()},OutlineHero.prototype._screenTick=function(){this._current.tick(this._scrollPer)},OutlineHero.prototype.intro=function(){var _this3=this;this._frameTimeCancelCallbacks.push(_Util2.default.setAnimationFrameTimeout(function(){_this3.$.find(".jsm-outlinehero__arw").addClass("js-visible")},1e3)),this._introPC()},OutlineHero.prototype.introBooking=function(){var _this4=this,delay=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._frameTimeCancelCallbacks.push(_Util2.default.setAnimationFrameTimeout(function(){_this4.$bookingButtons.addClass("js-visible"),_this4._frameTimeCancelCallbacks.push(_Util2.default.setAnimationFrameTimeout(function(){_this4.$bookingButtons.addClass("js-halfhidden")},1400))},delay))},OutlineHero.prototype._introPC=function(){var _this5=this;this.$.find(".jsm-outlinehero__frontLogo").addClass("js-visible"),setTimeout(function(){_.forEach(_this5.$.find(".jsm-outlinehero__frontTitle span"),function(el,i){var myEl=el;_this5._frameTimeCancelCallbacks.push(_Util2.default.setAnimationFrameTimeout(function(){myEl.classList.add("js-visible")},33+33*i+500*Math.random()))}),_this5._frameTimeCancelCallbacks.push(_Util2.default.setAnimationFrameTimeout(function(){_this5.$.find(".jsm-outlinehero__frontDesc").addClass("js-visible")},1200))},500)},OutlineHero.prototype.ready=function(){this.$.find(".jsm-outlinehero__backInner").addClass("js-zoom")},_createClass(OutlineHero,[{key:"isImageLoaded",get:function(){return this._isImageLoaded}}]),OutlineHero}(_ScreenModule3.default);exports.default=OutlineHero},{"../../common/constants/Browsers":1,"../../common/stores/WindowStore":4,"../../common/utils/Util":11,"../Settings":21,"../utils/ScreenModule":108,"./OutlineHero__PC":51,"./OutlineHero__SP":52,"./OutlineHero__button":53}],51:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Settings=require("../Settings"),_Settings2=_interopRequireDefault(_Settings),_Browsers=require("../../common/constants/Browsers"),_Browsers2=_interopRequireDefault(_Browsers),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),OutlineHero__PC=function(){function OutlineHero__PC($el,notice){_classCallCheck(this,OutlineHero__PC),this.$=$el,this._notice=notice,this.$back=this.$.find(".jsm-outlinehero__back"),this.$clipBefore=$(".jsm-outlinehero__clip--before"),this.$clipAfter=$(".jsm-outlinehero__clip--after"),this.$bookingButtons=$(".jsm-outlinehero__bookingButton")}return OutlineHero__PC.prototype.isFirstView=function(){return!this._bookingScrolled},OutlineHero__PC.prototype.destroy=function(){this.activate(!1),_Util2.default.deleteAll(this)},OutlineHero__PC.prototype.activate=function(active){active&&this._noticeScrolled()},OutlineHero__PC.prototype.resized=function(){this._sh=_WindowStore2.default.getHeight();var bottom=this.$.offset().top+this.$.outerHeight();this._minScrollTop=bottom-_WindowStore2.default.getHeight(),this._maxScrollTop=bottom,this._noticeResized()},OutlineHero__PC.prototype.scrolled=function(){this._noticeScrolled();var overshoot=_WindowStore2.default.getScrollTop()-this._minScrollTop;if(overshoot=Math.max(0,Math.min(_WindowStore2.default.getHeight(),overshoot)),this._overshoot!==overshoot){this._overshoot=overshoot;var borderY=this._sh-overshoot;this.$clipBefore.css("clip","rect(0px 150px "+borderY+"px 0px)"),this.$clipAfter.css("clip","rect("+borderY+"px 150px "+this._sh+"px 0px)");var bookingScrolled=overshoot>10;this._bookingScrolled!==bookingScrolled&&(this._bookingScrolled=bookingScrolled,this.$bookingButtons.switchClass("js-scrolled",bookingScrolled),this.$bookingButtons.addClass("js-scrollSwitched").switchClass("js-scrollSwitched",!1,500),bookingScrolled&&this.$bookingButtons.addClass("js-halfhidden"))}},OutlineHero__PC.prototype.tick=function(scrollPer){if(!_Browsers2.default.touch&&!_Browsers2.default.ie){var y=void 0;y=_Browsers2.default.touch?(1-scrollPer)*-_Settings2.default.outlinehero.parallax:scrollPer*_Settings2.default.outlinehero.parallax,this.$back.css3({y:y})}},OutlineHero__PC.prototype.scrollClicked=function(){_WindowStore2.default.scrollTo(this._maxScrollTop,800)},OutlineHero__PC.prototype._noticeResized=function(){this._notice&&this._notice.resized()},OutlineHero__PC.prototype._noticeScrolled=function(){this._notice&&this._notice.scrolled(_WindowStore2.default.getScrollTop())},OutlineHero__PC}();exports.default=OutlineHero__PC},{"../../common/constants/Browsers":1,"../../common/stores/WindowStore":4,"../../common/utils/Util":11,"../Settings":21}],52:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_Tween=require("../../common/utils/Tween"),_Settings=(_interopRequireDefault(_Tween),require("../Settings")),_Settings2=_interopRequireDefault(_Settings),_OnePageScroll=require("../../common/utils/OnePageScroll"),_OnePageScroll2=_interopRequireDefault(_OnePageScroll),_PanCtrl=require("../utils/PanCtrl"),_PanCtrl2=_interopRequireDefault(_PanCtrl),OutlineHero__SP=function(){function OutlineHero__SP($el,notice){var _this=this;_classCallCheck(this,OutlineHero__SP),this.$=$el,this._notice=notice,this.$outlinelogoloading=$(".jsm-outlinelogoloading"),this.$backInner=this.$.find(".jsm-outlinehero__backInner"),this._onePage=new _OnePageScroll2.default({$el:this.$,$front:this.$.find(".jsm-outlinehero__front"),$back:this.$.find(".jsm-outlinehero__back"),onSwitchDown:this._onSwitchDown.bind(this),onUpdate:this._onUpdate.bind(this)}),this.$clipBefore=$(".jsm-outlinehero__clip--before"),this.$clipAfter=$(".jsm-outlinehero__clip--after"),this._panCtrl=new _PanCtrl2.default({duration:_Settings2.default.outlinehero.pan_duration,tick:this._panTick.bind(this)}),this._notice&&(this._notice.onClosing(function(){_this._onUpdate(_this._borderY)}),this._notice.onCloseComplete(function(){_this._notice=null,_this._destroyed&&_Util2.default.deleteAll(_this)}))}return OutlineHero__SP.prototype.isFirstView=function(){return!this._onePage.isDown},OutlineHero__SP.prototype.destroy=function(){this._destroyed=!0,this.activate(!1),this._onePage.destroy(),this._panCtrl.destroy(),this._notice||_Util2.default.deleteAll(this)},OutlineHero__SP.prototype.activate=function(active){this._onePage.activate(active),active?this._panCtrl.start():(this._panCtrl.stop(),this.$.css("min-height",""))},OutlineHero__SP.prototype.resized=function(){this._sh=_WindowStore2.default.getHeight(),this.$.css("min-height",this._sh),this._notice&&this._notice.resized()},OutlineHero__SP.prototype.scrolled=function(){},OutlineHero__SP.prototype.tick=function(){},OutlineHero__SP.prototype.scrollClicked=function(){this._onePage.scrollClicked(!0)},OutlineHero__SP.prototype._panTick=function(per){if(!this._covered){var x=-1*_Settings2.default.outlinehero.pan_sp*per;this.$backInner.css3({x:x})}},OutlineHero__SP.prototype._onSwitchDown=function(down,switchOptions){this.$outlinelogoloading.switchClass("js-scrollDown",down)},OutlineHero__SP.prototype._onUpdate=function(borderY){if(this._borderY=borderY,this._notice){var top=this._sh-borderY;this._notice.scrolled(top),borderY-=this._notice.offset}this.$clipBefore.css("clip","rect(0px 150px "+borderY+"px 0px)"),this.$clipAfter.css("clip","rect("+borderY+"px 150px "+this._sh+"px 0px)");var covered=0===borderY;this._covered!==covered&&(this._covered=covered,this.$.switchClass("js-covered",covered))},OutlineHero__SP}();exports.default=OutlineHero__SP},{"../../common/stores/WindowStore":4,"../../common/utils/OnePageScroll":8,"../../common/utils/Tween":9,"../../common/utils/Util":11,"../Settings":21,"../utils/PanCtrl":106}],53:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Settings=require("../Settings"),_Util=(_interopRequireDefault(_Settings),require("../../common/utils/Util")),_Util2=_interopRequireDefault(_Util),_Browsers=require("../../common/constants/Browsers"),_Browsers2=_interopRequireDefault(_Browsers),_WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),OutlineHero__button=function(){function OutlineHero__button($el){var _this=this;_classCallCheck(this,OutlineHero__button),this.$=$el,this.$body=$(document.body),this._type="side",this.$.hasClass("jsm-outlinehero__bookingButton--bottom")&&(this._type="bottom"),this.$.hasClass("jsm-outlinehero__bookingButton--footer")&&(this._type="footer"),_Browsers2.default.desktop?this.$.on("mouseover",function(){_this._hover(!0)}).on("mouseout",function(){_this._hover(!1)}):(this._bindedTouchStartHdl=this._touchStartHdl.bind(this),this.$body.on("touchstart touchstartOriginal",this._bindedTouchStartHdl)),this._bindedScrollHdl=this._scrollHdl.bind(this),_WindowStore2.default.onScroll(this._bindedScrollHdl),this.$.find(".jsm-date__year").html(_Util2.default.now.yyyy),this.$.find(".jsm-date__month").html(_Util2.default.zeroPad(_Util2.default.now.m)),this.$.find(".jsm-date__date").html(_Util2.default.zeroPad(_Util2.default.now.d)),this.$.find(".jsm-date__day").html(_Util2.default.getWeekDay(_Util2.default.now.day,window.HOSHINOYA.lang)),this._hovering=!1}return OutlineHero__button.prototype.clicked=function(e,isFirstView){var clickTarget="other";$.contains(this.$.find(".jsm-outlinehero__bookingButtonDate")[0],e.target)?clickTarget="date":$.contains(this.$.find(".jsm-outlinehero__bookingButtonSubmit")[0],e.target)&&(clickTarget="submit"),_Browsers2.default.desktop?this._open():"other"===clickTarget?this._hover(!this._hovering):this._open();var gaLabel=isFirstView?"top_fv":"top_menu";"footer"===this._type&&(gaLabel="top_footer"),window.HOSHINOYA.GA.clickEvent("availability_hotels",gaLabel),window.HOSHINOYA.GA.clickEvent("availability_hotels_ui",this._type+"-"+clickTarget)},OutlineHero__button.prototype.destroy=function(){this.$.off(),this.$body.off("touchstart touchstartOriginal",this._bindedTouchStartHdl),_WindowStore2.default.offScroll(this._bindedScrollHdl),_Util2.default.deleteAll(this)},OutlineHero__button.prototype._touchStartHdl=function(e){$.contains(this.$[0],e.target)||(_Browsers2.default.touch&&!this.$.hasClass("js-halfhidden")&&this.$.addClass("js-halfhidden"),this._hovering&&this._hover(!1))},OutlineHero__button.prototype._scrollHdl=function(){this._hovering&&this._hover(!1)},OutlineHero__button.prototype._hover=function(hovering){this._hovering!==hovering&&(this._hovering=hovering,this.$.switchClass("js-halfhidden",!this._hovering,_Browsers2.default.touch?10:0))},OutlineHero__button.prototype._open=function(){var _this2=this;setTimeout(function(){_this2.$body.trigger("bookingopen"),setTimeout(function(){_this2._hover(!1)},500)},1)},OutlineHero__button}();exports.default=OutlineHero__button},{"../../common/constants/Browsers":1,"../../common/stores/WindowStore":4,"../../common/utils/Util":11,"../Settings":21}],54:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _eventemitter=require("eventemitter2"),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),OutlineLogoLoading=function(_EventEmitter){function OutlineLogoLoading($el){_classCallCheck(this,OutlineLogoLoading);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));return _this.$=$el,_this._logoAnime=_this.$.find(".jsm-logoanime").data("jsm-instance"),_this}return _inherits(OutlineLogoLoading,_EventEmitter),OutlineLogoLoading.prototype.init=function(){this._bindedScrollHdl=this._scrollHdl.bind(this)},OutlineLogoLoading.prototype.clear=function(){this.removeAllListeners(),_Util2.default.deleteAll(this)},OutlineLogoLoading.prototype.onHighlight=function(f){this.on("highlight",f)},OutlineLogoLoading.prototype.skip=function(){this.$.addClass("js-skipped"),this._logoAnime.showDirect(),this._logoAnime.switchIcon(window.HOSHINOYA.site)},OutlineLogoLoading.prototype.start=function(){var _this2=this;this.$.addClass("js-start"),this._logoAnime.showIntro(function(){setTimeout(function(){_this2.$.find(".jsm-outlinelogoloading__text").addClass("js-visible"),_this2.emit("highlight")},800)})},OutlineLogoLoading.prototype.hide=function(){_WindowStore2.default.onScroll(this._bindedScrollHdl),setTimeout(this._doHide.bind(this),2e3)},OutlineLogoLoading.prototype._scrollHdl=function(){_WindowStore2.default.getScrollTop()>10&&this._doHide()},OutlineLogoLoading.prototype._doHide=function(){this._hidden||(this._hidden=!0,_WindowStore2.default.offScroll(this._bindedScrollHdl),this.$.addClass("js-hidden"))},OutlineLogoLoading.prototype.remove=function(){},OutlineLogoLoading}(_eventemitter.EventEmitter2);exports.default=OutlineLogoLoading},{"../../common/stores/WindowStore":4,"../../common/utils/Util":11,eventemitter2:117}],55:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _Settings=require("../Settings"),_Settings2=_interopRequireDefault(_Settings),_ScreenModule2=require("../utils/ScreenModule"),_ScreenModule3=_interopRequireDefault(_ScreenModule2),_ParallaxItem=require("../utils/ParallaxItem"),_ParallaxItem2=_interopRequireDefault(_ParallaxItem),_WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),Parallax=function(_ScreenModule){function Parallax($el){_classCallCheck(this,Parallax);var _this=_possibleConstructorReturn(this,_ScreenModule.call(this,$el));_this.$=$el;var amount=_Settings2.default.parallax.amount;return _this._parallaxItems=_.map(_this.$.find(".jsm-img"),function(el){var $wrapper=$(el),$body=$wrapper.find(".jsm-img__body");return $body.css("padding-bottom",amount),new _ParallaxItem2.default({$wrapper:$wrapper,$body:$body,amount:amount})}),_this}return _inherits(Parallax,_ScreenModule),Parallax.prototype._screenInit=function(){},Parallax.prototype._screenClear=function(){_.forEach(this._parallaxItems,function(item){item.destroy()})},Parallax.prototype._screenResized=function(){_.forEach(this._parallaxItems,function(item){item.resized(_WindowStore2.default.getHeight())})},Parallax.prototype._screenScrolled=function(){},Parallax.prototype._screenTick=function(){_.forEach(this._parallaxItems,function(item){item.update(_WindowStore2.default.getScrollTop())})},Parallax}(_ScreenModule3.default);exports.default=Parallax},{"../../common/stores/WindowStore":4,"../Settings":21,"../utils/ParallaxItem":107,"../utils/ScreenModule":108}],56:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _ScreenModule2=require("../utils/ScreenModule"),_ScreenModule3=_interopRequireDefault(_ScreenModule2),_Settings=require("../Settings"),_Settings2=_interopRequireDefault(_Settings),_WindowStore=require("../../common/stores/WindowStore"),_Roller__item=(_interopRequireDefault(_WindowStore),require("./Roller__item")),_Roller__item2=_interopRequireDefault(_Roller__item),_Tween=require("../../common/utils/Tween"),_Tween2=_interopRequireDefault(_Tween),_Util=require("../../common/utils/Util"),_Browsers=(_interopRequireDefault(_Util),require("../../common/constants/Browsers")),_Browsers2=_interopRequireDefault(_Browsers),Roller=function(_ScreenModule){function Roller($el,options){_classCallCheck(this,Roller);var _this=_possibleConstructorReturn(this,_ScreenModule.call(this,$el,_.assign({initialx_sp:0},options||{})));return _this.$area=_this.$.find(".jsm-roller__area"),_this._needDrag=!0,_this}return _inherits(Roller,_ScreenModule),Roller.prototype._screenInit=function(){this._items=_.map(this.$.find(".jsm-roller__item"),function(el,i){return new _Roller__item2.default($(el),i)}),this._num=-1,this._x=0,this._tweenedX=0,this._tickedX=this.options.initialx_sp,this._draggedX=0,this._tweening=!1,this._dragging=!1},Roller.prototype._screenClear=function(){_.forEach(this._items,function(item){item.destroy()}),
this._items=[]},Roller.prototype._screenResized=function(){this._itemW=this._items[0].calcWidth(),this._itemGutter=this._items[0].calcGutter(),this._unitW=this._itemW+this._itemGutter,this._itemW2=Math.floor(.5*this._itemW),this._rpp=Math.max(1,Math.round(this._areaW/this._itemW));var totalPage=Math.ceil(this._items.length/this._rpp);this._totalPage!==totalPage&&(this._totalPage=totalPage,this._restItemCnt=this._items.length%this._rpp,0===this._restItemCnt&&(this._restItemCnt=this._rpp),this._centerX=this._restItemCnt*this._unitW*.5,this._navCount=this._totalPage,this._nav&&this._nav.make(this._navCount),this._num=-1,this._disabled=1===totalPage,this.$.switchClass("js-disabled",this._disabled)),this._totalW=this._items.length*this._unitW,this._minX=-this._unitW,this._maxX=this._areaW},Roller.prototype._screenTick=function(){var _this2=this;this._dragging||this._disabled||(this._tickedX-=_Settings2.default.roller.scroll_speed),this._updateX(),_.forEach(this._items,function(item,i){var x=_this2._minX+(_this2._x+_this2._unitW*i+999*_this2._totalW-_this2._minX)%_this2._totalW;x=Math.max(_this2._minX,Math.min(_this2._maxX,x)),_this2._disabled&&(x=_this2._unitW*i),_Browsers2.default.retina||(x=Math.round(x)),item.update(x)}),this._chechCurrentNum()},Roller.prototype._screenEnterFirst=function(){},Roller.prototype._screenEnter=function(){},Roller.prototype._screenLeave=function(){},Roller.prototype._screenSwitch=function(num){var _this3=this,switchOptions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};num=(num+this._totalPage)%this._totalPage;var targetItem=this._items[num*this._rpp],currentHeadItem=_.find(this._items,function(item){return Math.abs(item.x)<=.5*_this3._unitW}),distIndex=targetItem.index-currentHeadItem.index,distX=-distIndex*this._unitW-currentHeadItem.x;distX+=_Settings2.default.roller.slide_duration/_Settings2.default.animationframe*_Settings2.default.roller.scroll_speed,switchOptions.prevClicked?distX<0&&(distX+=this._totalW):distX>0&&(distX-=this._totalW),this._tween({end:this._tweenedX+distX,duration:_Settings2.default.roller.slide_duration,easing:"easeInOutQuart"})},Roller.prototype._screenDragStart=function(clientX,clientY,e){this._tweening&&(this._tweening=!1,this._tw.stop()),this._dragging=!0,this._dragStartX=this._draggedX},Roller.prototype._screenDragMove=function(dx,dy,ax,ay){this._draggedX=this._dragStartX+dx},Roller.prototype._screenDragEnd=function(dx,dy,ax,ay){this._dragging=!1;var throwX=8*ax,duration=3*Math.abs(throwX);this._tween({end:this._tweenedX+throwX,duration:duration,easing:"easeOutQuart"})},Roller.prototype._chechCurrentNum=function(){var _this4=this,nearestIndex=0,maxDist=9999999;_.forEach(this._items,function(item,i){var dist=Math.abs(item.x-(_this4._centerX-_this4._itemW2));dist<maxDist&&(maxDist=dist,nearestIndex=i)});var num=Math.floor(nearestIndex/this._rpp);this._num!==num&&(this._num=num,this._nav&&this._nav.activate(num,0))},Roller.prototype._tween=function(tweenOptions){var _this5=this;this._tw=this._tw||new _Tween2.default,this._tweening=!0,this._tw.it(_.assign({start:this._tweenedX,onProgress:function(v){_this5._tweenedX=v},onComplete:function(){_this5._tweening=!1}},tweenOptions))},Roller.prototype._updateX=function(){this._x=this._tweenedX+this._tickedX+this._draggedX},Roller}(_ScreenModule3.default);exports.default=Roller},{"../../common/constants/Browsers":1,"../../common/stores/WindowStore":4,"../../common/utils/Tween":9,"../../common/utils/Util":11,"../Settings":21,"../utils/ScreenModule":108,"./Roller__item":57}],57:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_ScreenModule=require("../utils/ScreenModule"),_Settings=(_interopRequireDefault(_ScreenModule),require("../Settings")),_WindowStore=(_interopRequireDefault(_Settings),require("../../common/stores/WindowStore")),_Tween=(_interopRequireDefault(_WindowStore),require("../../common/utils/Tween")),_Util=(_interopRequireDefault(_Tween),require("../../common/utils/Util")),_Util2=_interopRequireDefault(_Util),Roller__item=function(){function Roller__item($el,index){_classCallCheck(this,Roller__item),this.$=$el,this._index=index}return Roller__item.prototype.destroy=function(){_Util2.default.deleteAll(this)},Roller__item.prototype.calcWidth=function(){return Math.floor(this.$.outerWidth())},Roller__item.prototype.calcGutter=function(){return parseInt(this.$.css("margin-right"))},Roller__item.prototype.update=function(x){this._x!==x&&(this._x=x,this.$.css3({x:x}))},_createClass(Roller__item,[{key:"x",get:function(){return this._x}},{key:"index",get:function(){return this._index}}]),Roller__item}();exports.default=Roller__item},{"../../common/stores/WindowStore":4,"../../common/utils/Tween":9,"../../common/utils/Util":11,"../Settings":21,"../utils/ScreenModule":108}],58:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Settings=require("../Settings"),Sticky=(_interopRequireDefault(_Settings),function(){function Sticky($el,options){_classCallCheck(this,Sticky),this.$=$el,this.options=_.assign({bottom:"",bottommargin:0},options||{}),this.$inner=this.$.find(".jsm-sticky__inner")}return Sticky.prototype.init=function(){this.$bottom=this.options.bottom?$(this.options.bottom):null,this.$bottom&&0===this.$bottom.length&&(this.$bottom=null),this._bindedResizeHdl=this._resizeHdl.bind(this),this._bindedScrollHdl=this._scrollHdl.bind(this,!1),this._bindedModalStateChangeHdl=this._modalStateChanged.bind(this),_WindowStore2.default.onResize(this._bindedResizeHdl).onScroll(this._bindedScrollHdl).onModalStateChange(this._bindedModalStateChangeHdl),this._resizeHdl()},Sticky.prototype.clear=function(){_WindowStore2.default.offResize(this._bindedResizeHdl).offScroll(this._bindedScrollHdl).offModalStateChange(this._bindedModalStateChangeHdl)},Sticky.prototype.calcBounds=function(){this._resizeHdl()},Sticky.prototype._resizeHdl=function(){this._y=this.$.offset().top,this._h=this.$.outerHeight(),this.$bottom&&(this._bottomY=this.$bottom.offset().top-this._h-this.options.bottommargin,this._bottomY<this._y&&(this._bottomY=this._y)),this._scrollHdl(!0)},Sticky.prototype._scrollHdl=function(){var forced=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!_WindowStore2.default.getModelOpened()){var top=_WindowStore2.default.getScrollTop(),fixed=top>this._y;this._fixed!==fixed&&(this._fixed=fixed,this.$.switchClass("js-fixed",fixed).switchClass("js-static",!fixed));var touchBottom=!1;fixed&&this._bottomY&&(touchBottom=top>=this._bottomY),(this._touchBottom!==touchBottom||forced)&&(this._touchBottom=touchBottom,this.$.switchClass("js-touchBottom",touchBottom),this.$.css("top",touchBottom?this._bottomY-this._y:""))}},Sticky.prototype._modalStateChanged=function(){var opened=_WindowStore2.default.getModelOpened();_WindowStore2.default.getScrollBarWidth()&&this.$inner.css("right",opened?_WindowStore2.default.getScrollBarWidth():"")},Sticky}());exports.default=Sticky},{"../../common/stores/WindowStore":4,"../Settings":21}],59:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _Switcher__item=require("./Switcher__item"),_Switcher__item2=_interopRequireDefault(_Switcher__item),_ScreenModule2=require("../utils/ScreenModule"),_ScreenModule3=_interopRequireDefault(_ScreenModule2),_Settings=require("../Settings"),_Settings2=_interopRequireDefault(_Settings),_hideImgLoading=require("../utils/hideImgLoading"),_hideImgLoading2=_interopRequireDefault(_hideImgLoading),_Util=require("../../common/utils/Util"),_Browsers=(_interopRequireDefault(_Util),require("../../common/constants/Browsers")),_Browsers2=_interopRequireDefault(_Browsers),_WindowStore=require("../../common/stores/WindowStore"),Switcher=(_interopRequireDefault(_WindowStore),function(_ScreenModule){function Switcher($el,options){_classCallCheck(this,Switcher),options=_.assign({shape:"rect",autointerval:_Settings2.default.switcher.autointerval},options||{});var _this=_possibleConstructorReturn(this,_ScreenModule.call(this,$el,options));return _this.$area=_this.$.find(".jsm-switcher__area"),_this._barrageKillDuration=.7*_Settings2.default.switcher.fade_duration,_this._waitInitTillFirstImgLoad=!0,_this._needDrag=!0,_this}return _inherits(Switcher,_ScreenModule),Switcher.prototype._screenInit=function(){var _this2=this;this._y=0,this._parallax="rect"===this.options.shape?_Settings2.default.switcher.rect_parallax:_Settings2.default.switcher.cirle_parallax,this.$holder=this.$.find(".jsm-switcher__holder"),this._items=_.map(this.$.find(".jsm-switcher__item"),function(el,i){return new _Switcher__item2.default($(el))}),_Browsers2.default.touch&&this.$area.on("click",this._next.bind(this)),this._disabled=1===this._items.length,this._disabled&&(this.$.addClass("js-disabled"),this.$.find(".jsm-nav").remove()),this._navCount=this._items.length,setTimeout(function(){_this2._switch(0,{isFirst:!0}),setTimeout(function(){(0,_hideImgLoading2.default)(_this2.$,!_this2._onScreen)},33),_this2._onScreen||_this2._pauseAutoTimer()},33)},Switcher.prototype._screenClear=function(){this.$area.off(),_.forEach(this._items,function(item){item.destroy()}),this._items=[]},Switcher.prototype._screenResized=function(){var _this3=this;_.forEach(this._items,function(item){item.resized(_this3._areaW,_this3._areaH)})},Switcher.prototype._screenTick=function(){var y=-this._parallax*(1-this._scrollPerEco);this._y!==y&&(this._y=y,this.$holder.css3({y:y}))},Switcher.prototype._screenEnterFirst=function(){this.$.addClass("js-enterFirst")},Switcher.prototype._screenEnter=function(){},Switcher.prototype._screenLeave=function(){},Switcher.prototype._screenSwitch=function(num){var _this4=this,switchOptions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};num=(num+this._navCount)%this._navCount,this._num!==num&&(this._num=num,this._activeItem=null,_.forEach(this._items,function(item,i){var active=i===num;item.activate(active,{isFirst:switchOptions.isFirst,bySwipe:switchOptions.bySwipe}),active&&(_this4._activeItem=item)}))},Switcher.prototype._screenDragStart=function(clientX,clientY,e){this._disabled||(this._dragDir=0,this._isDragMoved=!1,this._pauseAutoTimer())},Switcher.prototype._screenDragMove=function(dx,dy,ax,ay){if(!this._disabled){var adx=Math.abs(dx),ady=Math.abs(dy);if(!(ady>adx)&&((adx>0||ady>0)&&(this._isDragMoved=!0),this._isDragMoved)){var dir=0===dx?0:dx<0?1:-1;if(this._dragDir!==dir){this._dragDir=dir;var oldDragItem=this._dragItem;this._dragItem=0===dir?null:this._items[(this._num+dir+this._navCount)%this._navCount],oldDragItem&&oldDragItem.dragAborted(),this._dragItem&&this._dragItem.dragStarted(dir)}if(this._dragItem){var x=this._areaW*dir+dx;this._dragItem.dragMoved(x)}}}},Switcher.prototype._screenDragEndDir=function(dir){var _this5=this;if(!this._disabled){if(!this._isDragMoved)return this._resumeAutoTimer();if(0===dir)return this._dragItem&&this._dragItem.dragEndCancelled(this._areaW),void setTimeout(function(){_this5._resumeAutoTimer()},200);this._dragItem&&this._dragItem.dragEndShow(),dir<0?this._prev({bySwipe:!0,forced:!0}):this._next({bySwipe:!0,forced:!0})}},Switcher}(_ScreenModule3.default));exports.default=Switcher},{"../../common/constants/Browsers":1,"../../common/stores/WindowStore":4,"../../common/utils/Util":11,"../Settings":21,"../utils/ScreenModule":108,"../utils/hideImgLoading":111,"./Switcher__item":60}],60:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Settings=require("../Settings"),_Settings2=_interopRequireDefault(_Settings),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_Tween=require("../../common/utils/Tween"),_Tween2=_interopRequireDefault(_Tween),Switcher__item=function(){function Switcher__item($el){_classCallCheck(this,Switcher__item),this.$=$el,this.$inner=this.$.find(".jsm-switcher__itemInner"),0===this.$inner.length&&(this.$inner=null),this._active=!1,this._tw=new _Tween2.default}return _createClass(Switcher__item,[{key:"imgLoaded",get:function(){var img=this.$.find(".jsm-img").data("jsm-instance");return img&&img.loaded}}]),Switcher__item.prototype.destroy=function(){clearTimeout(this._delayId),_Util2.default.deleteAll(this)},Switcher__item.prototype.activate=function(active,activeOptions){var _this=this;this._active!==active&&(this._active=active,activeOptions=_.assign({isFirst:!1,bySwipe:!1},activeOptions),clearTimeout(this._delayId),active?(this.$.removeClass("js-show js-hide").addClass("js-ready"),activeOptions.bySwipe||this.$.removeClass("js-pan"),this._delayId=setTimeout(function(){_this.$.addClass("js-show js-pan"),activeOptions.isFirst&&(_this.$.addClass("js-direct"),setTimeout(function(){_this.$.removeClass("js-direct")},33))},33)):this._delayId=setTimeout(function(){_this.$.addClass("js-hide").removeClass("js-show"),_this._delayId=setTimeout(function(){_this.$.removeClass("js-ready js-hide js-pan")},_Settings2.default.switcher.fade_duration)},33))},Switcher__item.prototype.resized=function(areaW,areaH){this._areaW=areaW,this._areaH=areaH},Switcher__item.prototype.dragStarted=function(dir){var _this2=this;this._tw.stop(),this._dragDir=dir,this.$.addClass("js-dragging"),this.$.addClass("js-dragStarted"),setTimeout(function(){_this2.$.removeClass("js-dragStarted"),_this2.$.addClass("js-pan")},33)},Switcher__item.prototype.dragAborted=function(){this.$.removeClass("js-dragging"),this._resetX()},Switcher__item.prototype.dragMoved=function(x){this._updateX(x)},Switcher__item.prototype.dragEndCancelled=function(areaW){var end=areaW*this._dragDir;this._tweenX(end,200)},Switcher__item.prototype.dragEndShow=function(){this._tweenX(0,500)},Switcher__item.prototype._tweenX=function(end,duration){var _this3=this;this._tw.it({start:this._x,end:end,duration:duration,easing:"easeOutQuart",onProgress:function(x){_this3._updateX(x)},onComplete:function(){_this3.$.removeClass("js-dragging"),_this3._resetX()}})},Switcher__item.prototype._resetX=function(){this._updateX(0)},Switcher__item.prototype._updateX=function(x){if(this.$inner){if(this._x=x,0===x)return this.$.css3({x:0}),void this.$inner.css3({x:0});this.$.css3({x:x}),this.$inner.css3({x:-x})}},Switcher__item}();exports.default=Switcher__item},{"../../common/utils/Tween":9,"../../common/utils/Util":11,"../Settings":21}],61:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _ScreenModule2=require("../utils/ScreenModule"),_ScreenModule3=_interopRequireDefault(_ScreenModule2),_Settings=require("../Settings"),_Settings2=_interopRequireDefault(_Settings),_hideImgLoading=require("../utils/hideImgLoading"),_hideImgLoading2=_interopRequireDefault(_hideImgLoading),_Util=require("../../common/utils/Util"),_ParallaxItem=(_interopRequireDefault(_Util),require("../utils/ParallaxItem")),_ParallaxItem2=_interopRequireDefault(_ParallaxItem),_WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),Tile=function(_ScreenModule){function Tile($el,options){_classCallCheck(this,Tile);var _this=_possibleConstructorReturn(this,_ScreenModule.call(this,$el,_.assign({autointerval:_Settings2.default.tile.autointerval},options||{})));return _this.$area=_this.$.find(".jsm-tile__area"),_this._needDrag=!0,_this._waitInitTillFirstImgLoad=!0,_this}return _inherits(Tile,_ScreenModule),Tile.prototype._screenInit=function(){var _this2=this;this._$pages=_.map(this.$.find(".jsm-tile__page"),function(el){return $(el)}),this._parallaxItems=_.map(this.$.find(".jsm-tile__pic"),function(el){var $wrapper=$(el),$body=$wrapper.find(".jsm-tile__picBody");return new _ParallaxItem2.default({$wrapper:$wrapper,$body:$body,amount:_Settings2.default.tile.parallax})}),this._navCount=this._$pages.length,setTimeout(function(){_this2._switch(0,{isFirst:!0}),(0,_hideImgLoading2.default)(_this2.$,!_this2._onScreen),_this2._onScreen||_this2._pauseAutoTimer()},33)},Tile.prototype._screenClear=function(){_.forEach(this._parallaxItems,function(item){item.destroy()}),this._$pages=[]},Tile.prototype._screenResized=function(){_.forEach(this._parallaxItems,function(item){item.resized(_WindowStore2.default.getHeight())})},Tile.prototype._screenTick=function(){_.forEach(this._parallaxItems,function(item){item.update(_WindowStore2.default.getScrollTop())})},Tile.prototype._screenEnterFirst=function(){var _this3=this;setTimeout(function(){_this3._setAutoTimer(!1,900)},33)},Tile.prototype._screenEnter=function(){},Tile.prototype._screenLeave=function(){},Tile.prototype._screenSwitch=function(num){var switchOptions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(num=(num+this._navCount)%this._navCount,this._num!==num){this._num=num;var $newPage=this._$pages[num],$oldPage=this._$activePage;this._$activePage=$newPage,$newPage.addClass("js-active"),$oldPage&&$oldPage.removeClass("js-active"),switchOptions.isFirst&&$newPage&&($newPage.addClass("js-direct"),setTimeout(function(){$newPage.removeClass("js-direct")},33))}},Tile.prototype._screenDragEndDir=function(dir){return dir<0?this._prev():dir>0?this._next():void 0},Tile}(_ScreenModule3.default);exports.default=Tile},{"../../common/stores/WindowStore":4,"../../common/utils/Util":11,"../Settings":21,"../utils/ParallaxItem":107,"../utils/ScreenModule":108,"../utils/hideImgLoading":111}],62:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _Settings=require("../Settings"),_Settings2=_interopRequireDefault(_Settings),_ScreenModule=require("../utils/ScreenModule"),_Switcher2=(_interopRequireDefault(_ScreenModule),require("./Switcher")),_Switcher3=_interopRequireDefault(_Switcher2),_TopHero__item=require("./TopHero__item"),_TopHero__item2=_interopRequireDefault(_TopHero__item),_TopHero__counter=require("./TopHero__counter"),_TopHero__counter2=_interopRequireDefault(_TopHero__counter),_Browsers=require("../../common/constants/Browsers"),_Browsers2=_interopRequireDefault(_Browsers),_Draggee=require("../../common/utils/Draggee"),_WindowStore=(_interopRequireDefault(_Draggee),require("../../common/stores/WindowStore")),_WindowStore2=_interopRequireDefault(_WindowStore),_OnePageScroll=require("../../common/utils/OnePageScroll"),_OnePageScroll2=_interopRequireDefault(_OnePageScroll),_Util=require("../../common/utils/Util"),TopHero=(_interopRequireDefault(_Util),function(_Switcher){function TopHero($el,options){_classCallCheck(this,TopHero);var _this=_possibleConstructorReturn(this,_Switcher.call(this,$el,_.assign({autointerval:3500},options||{})));return _this.$area=_this.$,_this._needDrag=!0,_this._waitInitTillFirstImgLoad=!1,_this._isAllReady=!1,_this._readyCount=0,_this}return _inherits(TopHero,_Switcher),TopHero.prototype.onAllReady=function(f){this._allReadyCallback=f},TopHero.prototype.hotelsReady=function(){this._countUpReady()},TopHero.prototype._countUpReady=function(){3===++this._readyCount&&(this._isAllReady=!0,this._introLatter())},TopHero.prototype._screenInit=function(){var _this2=this;this.$back=this.$.find(".jsm-tophero__back"),this._logoAnime=this.$.find(".jsm-logoanime").data("jsm-instance"),this._items=_.map(this.$.find(".jsm-tophero__item"),function(el){return new _TopHero__item2.default($(el))}),this._hotels=_.uniq(_.map(this._items,"hotel")),this._hotelCount=this._hotels.length,this._initialNum=Math.floor(Math.random()*this._items.length),this._navCount=this._items.length,this._$currentHotels=_.map(this.$.find(".jsm-tophero__currentHotel li"),function(el){var $item=$(el);return $item.hotel=$item.attr("data-hotel"),$item}),this._items[this._initialNum].loadStart(function(){_this2._countUpReady()}),setTimeout(function(){var restItems=_this2._items.slice(_this2._initialNum+1).concat(_this2._items.slice(0,_this2._initialNum));_.forEach(restItems,function(item){return item.loadStart()})},100),this._counterHotel=new _TopHero__counter2.default(this.$.find(".jsm-tophero__counterHotels")),this._counterNum=new _TopHero__counter2.default(this.$.find(".jsm-tophero__counterCurrent")),this.$.find(".jsm-tophero__prev").on("click",this._prev.bind(this)),this.$.find(".jsm-tophero__next").on("click",this._next.bind(this))},TopHero.prototype._screenInitDrag=function(){var _this3=this;this._onePage=new _OnePageScroll2.default({$el:this.$,$front:$(".jsm-tophero__bottom"),$back:this.$.find(".jsm-tophero__back"),$backText:this.$.find(".jsm-tophero__front"),draggee:this._d,onSwitchDown:function(down,switchOptions){},onUpdate:function(borderY){var downed=0===borderY;_this3.$.switchClass("js-downed",downed),_this3._pauseAutoTimer(),clearTimeout(_this3._debounceAutoTimerId),downed||(_this3._debounceAutoTimerId=setTimeout(_this3._resumeAutoTimer.bind(_this3),500))}}),_WindowStore2.default.onBreak(this._breakHdl.bind(this)),this._breakHdl()},TopHero.prototype._screenClear=function(){},TopHero.prototype.intro=function(callback){var _this4=this;this._introCallback=callback,this._logoAnime.showText(function(){_this4._logoAnime.showDirect(),setTimeout(_this4._countUpReady.bind(_this4),10)})},TopHero.prototype._switch=function(num){var switchOptions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._isAllReady&&_Switcher.prototype._switch.call(this,num,switchOptions)},TopHero.prototype._introLatter=function(){var _this5=this;this._allReadyCallback(),this._switch(this._initialNum,{isFirst:!0}),setTimeout(function(){_this5.$.find(".jsm-tophero__logo").addClass("js-visible")},300),this.$.find(".jsm-tophero__back").addClass("js-visible"),setTimeout(function(){_.forEach(_this5.$.find(".jsm-tophero__copy span"),function(el){$(el).switchClass("js-visible",!0,700*Math.random())}),setTimeout(function(){_this5.$.find(".jsm-tophero__hotels, .jsm-tophero__links, .jsm-tophero__currentHotel, .jsm-tophero__ui").addClass("js-visible"),setTimeout(_this5._introCallback,0)},1400)},700)},TopHero.prototype._screenSwitch=function(num){var switchOptions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(num=(num+this._navCount)%this._navCount,this._num!==num){var oldNum=this._num;this._num=num;var newItem=this._items[num],oldItem=this._activeItem;if(this._activeItem=newItem,switchOptions.byAuto&&newItem&&!newItem.imgLoaded)return void this._screenSwitch(oldNum);clearTimeout(this._switchDelayId),this._switchDelayId=setTimeout(function(){newItem&&newItem.activate(!0,switchOptions),oldItem&&oldItem.activate(!1,switchOptions)},33),this._logoAnime.switchIcon(newItem.hotel,{isSlow:!0,noScale:!0});var numStr=num+1;numStr<10&&(numStr="0"+numStr),this._counterNum.change(numStr),this._counterHotel.change(newItem.hotel.toUpperCase()),_.forEach(this._$currentHotels,function($item){$item.switchClass("js-visible",$item.hotel===newItem.hotel)})}},TopHero.prototype._screenTick=function(){if(!(_WindowStore2.default.getIsSP()||_Browsers2.default.touch||_Browsers2.default.ie)){var y=this._scrollPer*_Settings2.default.tophero.parallax;this.$back.css3({y:y})}},TopHero.prototype._breakHdl=function(){this._onePage.activate(_WindowStore2.default.getIsSP())},TopHero}(_Switcher3.default));exports.default=TopHero},{"../../common/constants/Browsers":1,"../../common/stores/WindowStore":4,"../../common/utils/Draggee":6,"../../common/utils/OnePageScroll":8,"../../common/utils/Util":11,"../Settings":21,"../utils/ScreenModule":108,"./Switcher":59,"./TopHero__counter":63,"./TopHero__item":64}],63:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Util=require("../../common/utils/Util"),_Util2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Util),TopHero__counter=function(){function TopHero__counter($el){_classCallCheck(this,TopHero__counter),this.$=$el}return TopHero__counter.prototype.change=function(val){if(this._val!==val){this._val=val;var $oldItem=this._$currentItem,$newItem=$("<li>"+val+"</li>").appendTo(this.$);this._$currentItem=$newItem,$oldItem&&(clearTimeout($oldItem.delayId),$oldItem.addClass("js-hidden"),setTimeout(function(){$oldItem.remove()},1e3)),$newItem.delayId=setTimeout(function(){$newItem.addClass("js-visible")},33)}},TopHero__counter.prototype.destroy=function(){this._$currentItem&&clearTimeout(this._$currentItem.delayId),_Util2.default.deleteAll(this)},TopHero__counter}();exports.default=TopHero__counter},{"../../common/utils/Util":11}],64:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Settings=require("../Settings"),_autoInit=(_interopRequireDefault(_Settings),require("./auto-init")),_autoInit2=_interopRequireDefault(_autoInit),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_Switcher__item2=require("./Switcher__item"),_Switcher__item3=_interopRequireDefault(_Switcher__item2),TopHero__item=function(_Switcher__item){function TopHero__item($el){_classCallCheck(this,TopHero__item);var _this=_possibleConstructorReturn(this,_Switcher__item.call(this,$el));return _this.$=$el,_this._hotel=_this.$.attr("data-hotel"),_this}return _inherits(TopHero__item,_Switcher__item),TopHero__item.prototype.destroy=function(){_Util2.default.deleteAll(this)},TopHero__item.prototype.loadStart=function(callback){this._loadStarted||(this._loadStarted=!0,this.$.find('[data-cancelauto="1"]').removeAttr("data-cancelauto"),(0,_autoInit2.default)(this.$),callback&&this.$.find(".jsm-img").data("jsm-instance").onLoad(callback))},TopHero__item.prototype.activate=function(active){var _this2=this,switchOptions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._active!==active&&(this._active=active,clearTimeout(this._delayId),active?this.$.addClass("js-visible"):this._delayId=setTimeout(function(){_this2.$.removeClass("js-visible js-pan")},1500),this.$.switchClass("js-active",active),this.$.switchClass("js-first",switchOptions.isFirst))},_createClass(TopHero__item,[{key:"hotel",get:function(){return this._hotel}}]),TopHero__item}(_Switcher__item3.default);exports.default=TopHero__item},{"../../common/utils/Util":11,"../Settings":21,"./Switcher__item":60,"./auto-init":68}],65:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}
exports.__esModule=!0;var _Settings=require("../Settings"),_TopHotels__item=(_interopRequireDefault(_Settings),require("./TopHotels__item")),_TopHotels__item2=_interopRequireDefault(_TopHotels__item),_Browsers=require("../../common/constants/Browsers"),_autoInit=(_interopRequireDefault(_Browsers),require("./auto-init")),_autoInit2=_interopRequireDefault(_autoInit),_WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_bluebird=require("bluebird"),_bluebird2=_interopRequireDefault(_bluebird),TopHotels=function(){function TopHotels($el,options){_classCallCheck(this,TopHotels),this.$=$el,this.options=_.assign({autointerval:0},options||{})}return TopHotels.prototype.init=function(){this._items=_.map(this.$.find(".jsm-tophotels__item"),function(el){return new _TopHotels__item2.default($(el))}),_WindowStore2.default.getIsPC()&&this._loadImgs()},TopHotels.prototype.clear=function(){_.forEach(this._items,function(item){return item.destroy()}),_Util2.default.deleteAll(this)},TopHotels.prototype.show=function(){this.$.addClass("js-visible"),_WindowStore2.default.getIsSP()&&this._loadImgs()},TopHotels.prototype._loadImgs=function(){this.$.find('[data-cancelauto="1"]').removeAttr("data-cancelauto"),(0,_autoInit2.default)(this.$)},TopHotels.prototype.onImgLoad=function(callback){var _this=this;if(_WindowStore2.default.getIsSP())return callback();_bluebird2.default.race([new _bluebird2.default(function(f,r){_this.$.find(".jsm-img").eq(2).data("jsm-instance").onLoad(f)}),new _bluebird2.default(function(f,r){setTimeout(f,5e3)})]).then(callback)},TopHotels}();exports.default=TopHotels},{"../../common/constants/Browsers":1,"../../common/stores/WindowStore":4,"../../common/utils/Util":11,"../Settings":21,"./TopHotels__item":66,"./auto-init":68,bluebird:115}],66:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Settings=require("../Settings"),_Settings2=_interopRequireDefault(_Settings),_WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_Browsers=require("../../common/constants/Browsers"),_Browsers2=_interopRequireDefault(_Browsers),TopHotels__item=function(){function TopHotels__item($el){var _this=this;_classCallCheck(this,TopHotels__item),this.$=$el,this.$a=this.$.find("a"),this.$back=this.$.find(".jsm-tophotels__back"),this.$body=$(document.body),this._bindedResizeHdl=this._resizeHdl.bind(this),this._bindedTick=this._tick.bind(this),_Browsers2.default.touch?(this.$.on("touchstart",function(){_this.$a.addClass("js-hover")}),this.$body.on("touchend",function(){_this.$a.removeClass("js-hover")})):(this.$.on("mousemove",this._mouseMoveHdl.bind(this)).on("mouseout",this._mouseOutHdl.bind(this)),_WindowStore2.default.onResize(this._bindedResizeHdl),this._tx=this._x=.5,this._ty=this._y=.5,this._resizeHdl(),this._tick())}return TopHotels__item.prototype.destroy=function(){this.$.off(),_WindowStore2.default.offResize(this._bindedResizeHdl),_Util2.default.cancelAnimationFrame(this._tickId),_Util2.default.deleteAll(this)},TopHotels__item.prototype._resizeHdl=function(){var offset=this.$.offset();this._top=offset.top,this._left=offset.left,this._w=this.$.outerWidth(),this._h=this.$.outerHeight(),this._w2=.5*this._w,this._h2=.5*this._h},TopHotels__item.prototype._mouseMoveHdl=function(e){var p=_Util2.default.getPoint(e),x=p.x-this._left,y=p.y-(this._top-_WindowStore2.default.getScrollTop());this._tx=Math.max(-1,Math.min(1,x/this._w)),this._ty=Math.max(-1,Math.min(1,y/this._h)),this._tx=1-this._tx,this._ty=1-this._ty},TopHotels__item.prototype._mouseOutHdl=function(){},TopHotels__item.prototype._tick=function(){this._x+=(this._tx-this._x)*_Settings2.default.tophotels.mousemove_speed,this._y+=(this._ty-this._y)*_Settings2.default.tophotels.mousemove_speed;var x=Math.round(1e4*this._x)/100,y=Math.round(1e4*this._y)/100;this._oldX!==x&&this._oldY!==y&&(this._oldX=x,this._oldY=y,this.$back[0].style.transformOrigin=x+"% "+y+"%"),this._tickId=_Util2.default.requestAnimationFrame(this._bindedTick)},TopHotels__item}();exports.default=TopHotels__item},{"../../common/constants/Browsers":1,"../../common/stores/WindowStore":4,"../../common/utils/Util":11,"../Settings":21}],67:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var $=void 0,YoutubeAPI=function(){function YoutubeAPI(){_classCallCheck(this,YoutubeAPI),$=window.NCOMMON_$||window.$,this._initQueues=[]}return YoutubeAPI.prototype.init=function(){var _this=this;return this._isReady?Promise.resolve():(this._isInitializing||this._init(),new Promise(function(f,r){_this._initQueues.push(f)}))},YoutubeAPI.prototype._init=function(){if(!this._isInitializing){this._isInitializing=!0,window.onYouTubeIframeAPIReady=this._ready.bind(this);var script=document.createElement("script");script.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(script,firstScriptTag)}},YoutubeAPI.prototype._ready=function(){this._isInitializing=!1,this._isReady=!0,_.forEach(this._initQueues,function(queue){queue()})},YoutubeAPI.prototype.makePlayer=function(el,videoId,onReady,onStateChange){var playerVars=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return playerVars=_.assign({enablejsapi:1,loop:0,autoplay:1,controls:0,showinfo:0,rel:0,playsinline:1},playerVars),new YT.Player(el,{videoId:videoId,width:640,height:480,playerVars:playerVars,events:{onReady:onReady,onStateChange:onStateChange}})},YoutubeAPI}();module.exports=new YoutubeAPI},{}],68:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.__esModule=!0,exports.clearModules=exports.preClearModules=exports.makeModule=void 0,exports.default=function($area,options){var _this=this;$area=$area||$(document.body),options=_.assign({forced:!1});var initChildModules=function($childArea){_this.initModules($childArea,moduleList)},modules=_.compact(_.flatten(_.map(moduleList,function(Klass,key){return _.map($area.find(".jsm-"+key),function(el){return makeModule(key,Klass,el,options.forced)})})));_.forEach(modules,function(module){module.init&&module.init(initChildModules)})};var _DomUtil=require("../../common/utils/DomUtil"),_DomUtil2=_interopRequireDefault(_DomUtil),_Img=require("./Img"),_Img2=_interopRequireDefault(_Img),_Accordion=require("./Accordion"),_Accordion2=_interopRequireDefault(_Accordion),_Anchorlink=require("./Anchorlink"),_Anchorlink2=_interopRequireDefault(_Anchorlink),_Folding=require("./Folding"),_Folding2=_interopRequireDefault(_Folding),_Carrousel=require("./Carrousel"),_Carrousel2=_interopRequireDefault(_Carrousel),_Tile=require("./Tile"),_Tile2=_interopRequireDefault(_Tile),_Roller=require("./Roller"),_Roller2=_interopRequireDefault(_Roller),_Gallery=require("./Gallery"),_Gallery2=_interopRequireDefault(_Gallery),_FadeIn=require("./FadeIn"),_FadeIn2=_interopRequireDefault(_FadeIn),_LogoAnime=require("./LogoAnime"),_LogoAnime2=_interopRequireDefault(_LogoAnime),_Gmap=require("./Gmap"),_Gmap2=_interopRequireDefault(_Gmap),_OutlineHero=require("./OutlineHero"),_OutlineHero2=_interopRequireDefault(_OutlineHero),_OutlineLogoLoading=require("./OutlineLogoLoading"),_OutlineLogoLoading2=_interopRequireDefault(_OutlineLogoLoading),_TopHero=require("./TopHero"),_TopHero2=_interopRequireDefault(_TopHero),_TopHotels=require("./TopHotels"),_TopHotels2=_interopRequireDefault(_TopHotels),_Booking=require("./booking/Booking"),_Booking2=_interopRequireDefault(_Booking),_Parallax=require("./Parallax"),_Parallax2=_interopRequireDefault(_Parallax),_Notice=require("./Notice"),_Notice2=_interopRequireDefault(_Notice),_News=require("./News"),_News2=_interopRequireDefault(_News),_Movie=require("./Movie"),_Movie2=_interopRequireDefault(_Movie),_Location=require("./Location"),_Location2=_interopRequireDefault(_Location),_Sticky=require("./Sticky"),_Sticky2=_interopRequireDefault(_Sticky),_Switcher=require("./Switcher"),_Switcher2=_interopRequireDefault(_Switcher),_Download=require("./Download"),_Download2=_interopRequireDefault(_Download),moduleList={notice:_Notice2.default,img:_Img2.default,accordion:_Accordion2.default,anchorlink:_Anchorlink2.default,folding:_Folding2.default,fadein:_FadeIn2.default,switcher:_Switcher2.default,carrousel:_Carrousel2.default,tile:_Tile2.default,roller:_Roller2.default,gallery:_Gallery2.default,logoanime:_LogoAnime2.default,gmap:_Gmap2.default,outlinehero:_OutlineHero2.default,outlinelogoloading:_OutlineLogoLoading2.default,tophero:_TopHero2.default,tophotels:_TopHotels2.default,booking:_Booking2.default,parallax:_Parallax2.default,news:_News2.default,movie:_Movie2.default,location:_Location2.default,sticky:_Sticky2.default,download:_Download2.default},makeModule=exports.makeModule=function(key,Klass,el){var forced=arguments.length>3&&void 0!==arguments[3]&&arguments[3],$el=$(el),attr="data-inited-"+key;if(!$el.is(":visible")&&!forced)return null;if(1===parseInt($el.attr(attr)))return null;var options=_DomUtil2.default.attr2data(el);if(options.cancelauto)return null;var instance=new Klass($el,options);return $el.attr(attr,1),$el.addClass("jsm-moduleready"),$.data($el[0],"jsm-instance",instance),instance};exports.preClearModules=function($area){if(!$area)return console.error('[clearModules()] required "$area"');_.forEach(moduleList,function(Klass,key){_.forEach($area.find(".jsm-"+key),function(el){var $el=$(el),instance=$.data($el[0],"jsm-instance");instance&&(instance.preClear&&instance.preClear(),delete instance.preClear)})})},exports.clearModules=function($area){if(!$area)return console.error('[clearModules()] required "$area"');_.forEach(moduleList,function(Klass,key){_.forEach($area.find(".jsm-"+key),function(el){var $el=$(el),instance=$.data($el[0],"jsm-instance");instance&&(instance.preClear&&instance.preClear(),instance.clear&&instance.clear())})})}},{"../../common/utils/DomUtil":5,"./Accordion":24,"./Anchorlink":26,"./Carrousel":27,"./Download":29,"./FadeIn":30,"./Folding":31,"./Gallery":32,"./Gmap":35,"./Img":38,"./Location":39,"./LogoAnime":40,"./Movie":41,"./News":42,"./Notice":48,"./OutlineHero":50,"./OutlineLogoLoading":54,"./Parallax":55,"./Roller":56,"./Sticky":58,"./Switcher":59,"./Tile":61,"./TopHero":62,"./TopHotels":65,"./booking/Booking":71}],69:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function request(url,_success,_error){if(cache[url]){var timerId=setTimeout(function(){_success(cache[url])},0);return{abort:function(){clearTimeout(timerId)}}}return $.ajax({url:url,method:"get",dataType:"text",crossDomain:!0,success:function(res){try{if(!res)return console.log("[API] empty response",url,res),_error&&_error();var data=JSON.parse(res);cache[url]=data,_success(data)}catch(e){console.error(e),console.log("[API]",url,res),_error&&_error()}},error:function(e1,e2,e3){"abort"!==e2&&(console.log(e1,e2,e3),_error&&_error())}})}function buildEndpoiint(path,data){return path+(_.includes(path,"?")?"&":"?")+_Url2.default.queryObj2str(data)}exports.__esModule=!0,exports.buildEndpoiint=buildEndpoiint;var _eventemitter=require("eventemitter2"),_Util=require("../../../common/utils/Util"),_Url=(_interopRequireDefault(_Util),require("../../../common/utils/Url")),_Url2=_interopRequireDefault(_Url),_APIUtil=require("./APIUtil"),_APIUtil2=_interopRequireDefault(_APIUtil),ENDPOINTS={exrate:"/api/booking/?path=/exchange/rate",monthly:"https://booking.hoshinoresort.com/api/rooms/vacancies/monthly",weekly:"/api/booking/?path=/rooms/vacancies/weekly"},cache={},noCache=Date.now(),API=function(_EventEmitter){function API(){return _classCallCheck(this,API),_possibleConstructorReturn(this,_EventEmitter.call(this))}return _inherits(API,_EventEmitter),API.prototype.fetchMonthly=function(hotelName,monthlyDate,condition,success,error){return condition=_APIUtil2.default.formatCondition(hotelName,condition),request(buildEndpoiint(ENDPOINTS.monthly,_.assign({hotelId:_APIUtil2.default.hotelName2id(hotelName),monthlyDate:monthlyDate},condition)),success,error)},API.prototype.fetchWeekly=function(hotelName,startDate,endDate,condition,success,error){return condition=_APIUtil2.default.formatCondition(hotelName,condition),request(buildEndpoiint(ENDPOINTS.weekly,_.assign({noCache:noCache,hotelId:_APIUtil2.default.hotelName2id(hotelName),lang:"ja",chargeDetail:!0,startDate:startDate,endDate:endDate},condition)),success,error)},API.prototype.fetchExrate=function(){var base=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"JPY",success=arguments[1],error=arguments[2];return request(buildEndpoiint(ENDPOINTS.exrate,{noCache:noCache,hotelId:"JPY"===base?_APIUtil2.default.hotelName2id("karuizawa"):_APIUtil2.default.hotelName2id("bali"),base:base,lang:"ja"}),success,error)},API}(_eventemitter.EventEmitter2);exports.default=new API},{"../../../common/utils/Url":10,"../../../common/utils/Util":11,"./APIUtil":70,eventemitter2:117}],70:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Util=require("../../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_Url=require("../../../common/utils/Url"),_Config=(_interopRequireDefault(_Url),require("./constants/Config")),_Config2=_interopRequireDefault(_Config),PREFIX={JPY:"&yen;",USD:"&#x24;",IDR:"Rp",CNY:"&yen;",TWD:"NT&#x24;"},SUFFIX="ja"===window.HOSHINOYA.lang?"~":"-",SITE_LANG={},APIUtil=function(){function APIUtil(){_classCallCheck(this,APIUtil)}return APIUtil.hotelName2id=function(hotelName){if(!window.HOSHINOYA.sites[hotelName])return null;var hotelId=parseInt(window.HOSHINOYA.sites[hotelName].hotel_id);return _Util2.default.zeroPad(hotelId,10)},APIUtil.formatCondition=function(hotelName,condition){return"kyoto"===hotelName&&(condition=_.assign({},condition,{underTwelve:0,underSeven:0,underFour:0})),condition},APIUtil.isFull=function(info){return!(info.vacancy>0)},APIUtil.isClosed=function(info){return info.closedDay},APIUtil.getPrice=function(distCurrency,info){if(!info||!info.charge)return null;var detail=info.charge.searchChargeDetail;if(!detail)return null;var priceNum=detail.unitCharge,chargeStr=detail.unitChargeStr.toLowerCase(),srcCurrency="JPY";_.includes(chargeStr,"rp")?srcCurrency="IDR":_.includes(chargeStr,"nt$")&&(srcCurrency="TWD");var resultPrice=priceNum;if(srcCurrency!==distCurrency){var priceJPY=priceNum*_Config2.default.conversionRates[srcCurrency][srcCurrency];resultPrice=Math.round(priceJPY*_Config2.default.exchangeRates[srcCurrency][distCurrency])}return"<span>"+PREFIX[distCurrency]+"</span><span>"+_Util2.default.num2price(resultPrice)+"</span><span>"+SUFFIX+"</span>"},APIUtil.getBookingSiteUrl=function(hotelName){return"https://booking.hoshinoresort.com/#/"+this.tellBookingSiteLang(hotelName)+"/hotels/"+this.hotelName2id(hotelName)},APIUtil.tellBookingSiteLang=function(hotelName){if(!SITE_LANG[hotelName]){var siteConf=window.HOSHINOYA.sites[hotelName||"_admin"],siteLangConf=_.assignIn({},window.HOSHINOYA.booking_lang,siteConf.booking_lang_override);SITE_LANG[hotelName]=siteLangConf[window.HOSHINOYA.lang].toUpperCase()}return SITE_LANG[hotelName]},APIUtil}();exports.default=APIUtil},{"../../../common/utils/Url":10,"../../../common/utils/Util":11,"./constants/Config":74}],71:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Settings=require("../../Settings"),_Util=(_interopRequireDefault(_Settings),require("../../../common/utils/Util")),_Action=(_interopRequireDefault(_Util),require("./actions/Action")),_Action2=_interopRequireDefault(_Action),_DisplayStore=require("./stores/DisplayStore"),_DisplayStore2=_interopRequireDefault(_DisplayStore),_ConditionStore=require("./stores/ConditionStore"),_ConditionStore2=_interopRequireDefault(_ConditionStore),_PaneAll=require("./views/PaneAll"),_PaneAll2=_interopRequireDefault(_PaneAll),_PaneHotel=require("./views/PaneHotel"),_PaneHotel2=_interopRequireDefault(_PaneHotel),_Cond=require("./views/Cond"),_Cond2=_interopRequireDefault(_Cond),_Plan=require("./views/Plan"),_Plan2=_interopRequireDefault(_Plan),_Currency=require("./views/Currency"),_Currency2=_interopRequireDefault(_Currency),_Config=require("./constants/Config"),_Config2=_interopRequireDefault(_Config),_UDate=require("./UDate"),_WindowStore=(_interopRequireDefault(_UDate),require("../../../common/stores/WindowStore")),_WindowStore2=_interopRequireDefault(_WindowStore),_Tooltip=require("./views/Tooltip"),_Tooltip2=_interopRequireDefault(_Tooltip),_ModalCtrl=require("../../utils/ModalCtrl"),_ModalCtrl2=_interopRequireDefault(_ModalCtrl),_NightsRestrictModal=require("./views/NightsRestrictModal"),_NightsRestrictModal2=_interopRequireDefault(_NightsRestrictModal),_PeopleRestrictModal=require("./views/PeopleRestrictModal"),_PeopleRestrictModal2=_interopRequireDefault(_PeopleRestrictModal),Booking=function(){function Booking($el,options){_classCallCheck(this,Booking),this.$=$el,this.options=_.assign({},options||{}),this.$html=$("html"),this.$.addClass("js-inited"),_Config2.default.setup(),this._visible=!1}return Booking.prototype.init=function(){var _this=this;this._modalCtrl=new _ModalCtrl2.default({hash:"availability",$close:this.$.find(".jsm-booking__close"),onClose:function(){_this._switchVisibility(!1)}}),$("body").on("click",".jsm-booking__trigger",this._switchVisibility.bind(this,!0)).on("bookingopen",this._switchVisibility.bind(this,!0)),$('.jsm-booking__trigger[data-autoclick="1"]').length&&this._switchVisibility(!0)},Booking.prototype.clear=function(){this._modalCtrl.destroy()},Booking.prototype._switchVisibility=function(visible){var _this2=this;this._visible!==visible&&(this._visible=visible,visible&&this._modalCtrl.opened(),_Action2.default.switchVisibility(visible),clearTimeout(this._addClassDelayId),this._addClassDelayId=setTimeout(function(){_this2.$html.switchClass("js-bookingOpened",visible)},visible?500:0),visible?(_WindowStore2.default.switchModalState(!0),clearTimeout(this._delayId),this.$.addClass("js-visible"),this._delayId=setTimeout(function(){_this2._build(),_this2._delayId=setTimeout(function(){_this2.$.addClass("js-show")},33)},200)):(clearTimeout(this._delayId),this.$.removeClass("js-show"),this._delayId=setTimeout(function(){_this2.$.removeClass("js-visible"),_WindowStore2.default.switchModalState(!1)},200)),visible?window.HOSHINOYA.GA.pageview("/availability_hotels/"):window.HOSHINOYA.GA.pageview())},Booking.prototype._build=function(){var _this3=this;this._built||(this._built=!0,_DisplayStore2.default.setup(function(){_Action2.default.makeAllCalenderStores(),_this3.$message=_this3.$.find(".jsm-booking__paneMessage"),_this3._buildTabs(),_this3._buildPanes(),_this3._cond=new _Cond2.default(_this3.$.find(".jsm-booking__cond")),_this3._plans=new _Plan2.default(_this3.$.find(".jsm-booking__planContainer")),_this3._currency=new _Currency2.default(_this3.$.find(".jsm-booking__currency")),_this3._nightsRestrictModal=new _NightsRestrictModal2.default(_this3.$.find(".jsm-booking__restrictModal--nights")),_this3._peopleRestrictModal=new _PeopleRestrictModal2.default(_this3.$.find(".jsm-booking__restrictModal--people")),_.forEach(_this3.$.find(".jsm-booking__tooltip"),function(el){return new _Tooltip2.default($(el))}),_DisplayStore2.default.onChangeOneState("tab",_this3._tabChangeHdl.bind(_this3)),_DisplayStore2.default.onChangeOneState("currency",_this3._currencyChangeHdl.bind(_this3)),_ConditionStore2.default.onChange(_this3._conditionChangeHdl.bind(_this3)),_this3._currencyChangeHdl(),setTimeout(function(){_this3.$.addClass("js-ready"),_Action2.default.changeTab(window.HOSHINOYA.site)},33)}))},Booking.prototype._buildTabs=function(){var _this4=this;this._$tabs=_.map(this.$.find(".jsm-booking__tabItem"),function(el){var $tab=$(el),siteName=$tab.attr("data-name");return $tab.on("click",function(){_Action2.default.changeTab(siteName),window.HOSHINOYA.GA.clickEvent("reserve_ui","ui_hotels")}),$tab.siteName=siteName,$tab}),this.$siteSelect=this.$.find(".jsm-booking__siteSelect"),this.$siteSelect.on("change",function(){_Action2.default.changeTab(_this4.$siteSelect.val()),window.HOSHINOYA.GA.clickEvent("reserve_ui","ui_hotels")})},Booking.prototype._buildPanes=function(){var $container=this.$.find(".jsm-booking__paneContainer"),$paneAll=this.$.find(".jsm-booking__paneAll"),$tpl_paneHotel=this.$.find(".jsm-booking__paneHotel").remove();this._panes=_.reduce(this._$tabs,function(res,$tab){var siteName=$tab.siteName;return res[siteName]="_admin"===siteName?new _PaneAll2.default($paneAll,{}):new _PaneHotel2.default($tpl_paneHotel.clone().appendTo($container),{hotelName:siteName}),res},{})},Booking.prototype._tabChangeHdl=function(tab){this.$.attr("data-tab",tab),_.forEach(this._$tabs,function($tab){$tab.switchClass("js-active",$tab.siteName===tab)}),this.$siteSelect.val(tab),_.forEach(this._panes,function(pane,siteName){pane.activate(siteName===tab)}),this.$.switchClass("jsm-booking__onlyAdult","kyoto"===tab),"_admin"!==tab&&"karuizawa"!==tab&&_ConditionStore2.default.isPeopleOver3&&setTimeout(function(){_Action2.default.changePeopleUnder3()},1)},Booking.prototype._currencyChangeHdl=function(){this.$.attr("data-currency",_DisplayStore2.default.state.currency)},Booking.prototype._conditionChangeHdl=function(){_Action2.default.refreshCalenderStores(),this.$.addClass("js-blink").switchClass("js-blink",!1,33);var duration=this._messageShown?800:2500;this._messageShown=!0,this.$message.addClass("js-visible").switchClass("js-visible",!1,duration)},Booking}();exports.default=Booking},{"../../../common/stores/WindowStore":4,"../../../common/utils/Util":11,"../../Settings":21,"../../utils/ModalCtrl":104,"./UDate":72,"./actions/Action":73,"./constants/Config":74,"./stores/ConditionStore":76,"./stores/DisplayStore":77,"./views/Cond":82,"./views/Currency":85,"./views/NightsRestrictModal":89,"./views/PaneAll":90,"./views/PaneHotel":92,"./views/PeopleRestrictModal":93,"./views/Plan":94,"./views/Tooltip":95}],72:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Util=require("../../../common/utils/Util"),_Util2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Util),UDate=function(){function UDate(date){if(_classCallCheck(this,UDate),_.isString(date)){var strArr=date.split("/");2===strArr.length&&strArr.push("1"),date=new Date(parseInt(strArr[0]),parseInt(strArr[1])-1,parseInt(strArr[2]))}else if(!date.getTime)return console.error("[UDate] date format is String or Date.");this._date=date,this._time=this._date.getTime(),this._week=this._date.getDay(),this._yyyy=this._date.getFullYear(),this._m=this._date.getMonth()+1,this._d=this._date.getDate(),this._mm=_Util2.default.zeroPad(this._m,2),this._dd=_Util2.default.zeroPad(this._d,2),this._str=this._yyyy+"/"+this._mm+"/"+this._dd,this._strMonth=this._yyyy+"/"+this._mm,this._strDot=this._yyyy+"."+this._mm+"."+this._dd}return _createClass(UDate,[{key:"isUDate",get:function(){return!0}}]),UDate.prototype.isSame=function(udate){return!!udate&&this.str===udate.str},UDate.prototype.makeWeekStr=function(){return _Util2.default.getWeekDay(this._week,window.HOSHINOYA.lang)},UDate.prototype.makeMonthName=function(){return _Util2.default.getMonthName(this._m,window.HOSHINOYA.lang)},UDate.prototype.makeMonthNameShort=function(){return _Util2.default.getMonthNameShort(this._m,window.HOSHINOYA.lang)},UDate.prototype.makeOffsetUDate=function(dir){return new UDate(new Date(this._yyyy,this._m-1,this._d+dir))},UDate.prototype.calcDaysBetween=function(udate){return Math.round(Math.abs(udate.time-this._time)/864e5)},_createClass(UDate,[{key:"date",get:function(){return this._date}},{key:"time",get:function(){return this._time}},{key:"week",get:function(){return this._week}},{key:"str",get:function(){return this._str}},{key:"strMonth",get:function(){return this._strMonth}},{key:"strDot",get:function(){return this._strDot}},{key:"yyyy",get:function(){return this._yyyy}},{key:"m",get:function(){return this._m}},{key:"d",get:function(){return this._d}},{key:"mm",get:function(){return this._mm}},{key:"dd",get:function(){return this._dd}}]),UDate}();exports.default=UDate},{"../../../common/utils/Util":11}],73:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _ConditionStore=require("../stores/ConditionStore"),_ConditionStore2=_interopRequireDefault(_ConditionStore),_DisplayStore=require("../stores/DisplayStore"),_DisplayStore2=_interopRequireDefault(_DisplayStore),_MonthlyCalenderStoreClass=require("../stores/MonthlyCalenderStoreClass"),_MonthlyCalenderStoreClass2=_interopRequireDefault(_MonthlyCalenderStoreClass),_WeeklyCalenderStoreClass=require("../stores/WeeklyCalenderStoreClass"),_WeeklyCalenderStoreClass2=_interopRequireDefault(_WeeklyCalenderStoreClass),_API=require("../API"),_Config=(_interopRequireDefault(_API),require("../constants/Config")),_Config2=_interopRequireDefault(_Config),_Util=require("../../../../common/utils/Util"),_Url=(_interopRequireDefault(_Util),require("../../../../common/utils/Url")),_Url2=_interopRequireDefault(_Url),_APIUtil=require("../APIUtil"),_APIUtil2=_interopRequireDefault(_APIUtil),Action=function(){function Action(){_classCallCheck(this,Action)}return Action.switchVisibility=function(visible){_DisplayStore2.default.update({visible:visible})},Action.changeTab=function(siteName){_DisplayStore2.default.update({tab:siteName}),this.refreshCalenderStores()},Action.changeCondition=function(condition){_ConditionStore2.default.update(condition)},Action.changePeopleUnder3=function(){this.changeCondition({adult:Math.min(3,_ConditionStore2.default.state.adult),underTwelve:Math.min(3,_ConditionStore2.default.state.underTwelve),underSeven:Math.min(3,_ConditionStore2.default.state.underSeven),underFour:Math.min(3,_ConditionStore2.default.state.underFour)})},Action.moveMonthIndex=function(dir){var monthIndex=_DisplayStore2.default.state.monthIndex+dir;monthIndex<0?monthIndex=0:monthIndex>_Config2.default.maxMonthIndex&&(monthIndex=_Config2.default.maxMonthIndex),this.setMonthIndex(monthIndex)},Action.setMonthIndex=function(monthIndex){_DisplayStore2.default.update({monthIndex:monthIndex}),this.refreshCalenderStores()},Action.changeAllCheckin=function(allCheckinDate){_DisplayStore2.default.update({allCheckinDate:allCheckinDate}),setTimeout(function(){_DisplayStore2.default.update({allCheckinDate:null})},33)},Action.makeAllCalenderStores=function(){_.forEach(window.HOSHINOYA.hotels,function(hotelName){_.forEach(_Config2.default.months,function(udate,monthIndex){_MonthlyCalenderStoreClass2.default.getInstance(hotelName,monthIndex),_WeeklyCalenderStoreClass2.default.getInstance(hotelName,monthIndex)})})},Action.refreshCalenderStores=function(){var currentTab=_DisplayStore2.default.state.tab,condition=_ConditionStore2.default.state,isAll="_admin"===currentTab,currentMonthIndex=_DisplayStore2.default.state.monthIndex,visibleMonths=_.uniq(_DisplayStore2.default.getAllVisibleMonths());isAll&&(currentMonthIndex=_DisplayStore2.default.getAllVisiblePriorMonthIndex()),_MonthlyCalenderStoreClass2.default.clearQueues(),_WeeklyCalenderStoreClass2.default.clearQueues();var queues=_.compact(_.flatten(_.map(window.HOSHINOYA.hotels,function(hotelName){if(isAll||currentTab===hotelName)return _.map(_Config2.default.months,function(udate,monthIndex){var distMonthIndex=Math.abs(currentMonthIndex-monthIndex);return{hotelName:hotelName,monthIndex:monthIndex,distMonthIndex:distMonthIndex,strMonth:udate.strMonth}})})));queues=_.sortBy(queues,"distMonthIndex"),_.forEach(queues,function(queue){var monthlyStore=_MonthlyCalenderStoreClass2.default.getInstance(queue.hotelName,queue.monthIndex),weeklyStore=_WeeklyCalenderStoreClass2.default.getInstance(queue.hotelName,queue.monthIndex);if(queue.distMonthIndex>1||isAll&&!_.includes(visibleMonths,queue.strMonth))return void monthlyStore.setLoading();var monthlyVacancyList=monthlyStore.pushQueues(condition);weeklyStore.pushQueues(condition),monthlyVacancyList&&weeklyStore.cancelDisabedDayByMonthly(monthlyVacancyList)}),isAll&&_WeeklyCalenderStoreClass2.default.sortPriorQueues(_DisplayStore2.default.state.allVisibleDates),_MonthlyCalenderStoreClass2.default.run(isAll?6:2),_WeeklyCalenderStoreClass2.default.run(3),this._sendConditionGA(condition)},Action._sendConditionGA=function(condition){condition=_APIUtil2.default.formatCondition(_DisplayStore2.default.state.tab,condition);var gaQuery=_Url2.default.queryObj2str(_.assign({tab:"_admin"===_DisplayStore2.default.state.tab?"all":_DisplayStore2.default.state.tab},condition));this._gaQuery!==gaQuery&&(this._gaQuery=gaQuery,window.HOSHINOYA.GA.queryEvent("reserve_ui",gaQuery))},Action.updateAllVisibleDates=function(allVisibleDates){_DisplayStore2.default.update({allVisibleDates:allVisibleDates}),this.refreshCalenderStores()},Action}();exports.default=Action},{"../../../../common/utils/Url":10,"../../../../common/utils/Util":11,"../API":69,"../APIUtil":70,"../constants/Config":74,"../stores/ConditionStore":76,"../stores/DisplayStore":77,"../stores/MonthlyCalenderStoreClass":78,"../stores/WeeklyCalenderStoreClass":79}],74:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.__esModule=!0
;var _Util=require("../../../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_UDate=require("../UDate"),_UDate2=_interopRequireDefault(_UDate);exports.default={nightsRestrictSites:["_admin","karuizawa","taketomijima"],exchangeRates:{},conversionRates:{},setExrate:function(base,res){var _this=this;this.exchangeRates[base]={},this.conversionRates[base]={},_.forEach(res.exchangeRateList,function(obj){_this.exchangeRates[base][obj.quote]=parseFloat(obj.rate),_this.conversionRates[base][obj.quote]=parseFloat(obj.conversion)})},setup:function(){var maxDate=new _UDate2.default(new Date(_Util2.default.now.yyyy,_Util2.default.now.m-1+18,_Util2.default.now.d-1)),y=_Util2.default.now.yyyy,m=_Util2.default.now.m,monthDateCount={},months=_.map(_.range(18),function(i){var ud=new _UDate2.default(new Date(y,m-1,1));return monthDateCount[ud.strMonth]=new Date(y,m-0,0).getDate(),m++,m>12&&(m=1,y++),ud});this.today=new _UDate2.default(new Date(_Util2.default.now.yyyy,_Util2.default.now.m-1,_Util2.default.now.d)),this.maxDate=maxDate,this.monthDateCount=monthDateCount,this.months=months,this.maxMonthIndex=months.length-1,this.nightsRestrictUDate=new _UDate2.default(new Date(_Util2.default.now.yyyy,_Util2.default.now.m-1,_Util2.default.now.d+30)),delete this.setup}}},{"../../../../common/utils/Util":11,"../UDate":72}],75:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_eventemitter=require("eventemitter2"),_UDate=require("../UDate"),AbstractStore=(function(obj){obj&&obj.__esModule}(_UDate),function(_EventEmitter){function AbstractStore(){_classCallCheck(this,AbstractStore);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));return _this.setMaxListeners(0),_this._state={},_this}return _inherits(AbstractStore,_EventEmitter),AbstractStore.prototype.onChange=function(f){return this.on("change",f),this},AbstractStore.prototype.onChangeOneState=function(stateStr,f){return this.on(stateStr,f),this},AbstractStore.prototype.offChange=function(f){return this.off("change",f),this},AbstractStore.prototype.offChangeOneState=function(stateStr,f){return this.off(stateStr,f),this},_createClass(AbstractStore,[{key:"state",get:function(){return this._state}}]),AbstractStore.prototype.update=function(newState){var _this2=this;newState=_.assign({},this._state,newState);var oldState=_.assign({},this._state);this._state=_.assign(this._state,newState);var changedAny=!1;_.forEach(newState,function(v,k){(v&&v.isUDate?!v.isSame(oldState[k]):v!==oldState[k])&&(changedAny=!0,_this2.emit(k,v))}),changedAny&&this._emitChange()},AbstractStore.prototype._emitChange=function(){this.emit("change",this._state)},AbstractStore}(_eventemitter.EventEmitter2));exports.default=AbstractStore},{"../UDate":72,eventemitter2:117}],76:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_AbstractStore2=require("./AbstractStore"),_AbstractStore3=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_AbstractStore2),ConditionStore=function(_AbstractStore){function ConditionStore(){_classCallCheck(this,ConditionStore);var _this=_possibleConstructorReturn(this,_AbstractStore.call(this));return _this._state={stayLength:2,adult:2,underTwelve:0,underSeven:0,underFour:0},_this}return _inherits(ConditionStore,_AbstractStore),ConditionStore.prototype.getMergedPeople=function(){return{adults:this.state.adult,children:this.state.underTwelve+this.state.underSeven+this.state.underFour}},_createClass(ConditionStore,[{key:"isPeopleOver3",get:function(){return this._state.adult>3||this._state.underTwelve>3||this._state.underSeven>3||this._state.underFour>3}}]),ConditionStore}(_AbstractStore3.default);exports.default=new ConditionStore},{"./AbstractStore":75}],77:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _AbstractStore2=require("./AbstractStore"),_AbstractStore3=_interopRequireDefault(_AbstractStore2),_API=require("../API"),_API2=_interopRequireDefault(_API),_Config=require("../constants/Config"),_Config2=_interopRequireDefault(_Config),DisplayStore=function(_AbstractStore){function DisplayStore(){_classCallCheck(this,DisplayStore);var _this=_possibleConstructorReturn(this,_AbstractStore.call(this));return _this._state={visible:!1,tab:"",monthIndex:0,allCheckinDate:null,allVisibleDates:[],currency:{ja:"JPY",en:"USD",id:"IDR",zhcn:"CNY",zhtw:"TWD"}[window.HOSHINOYA.lang]||"JPY"},_this}return _inherits(DisplayStore,_AbstractStore),DisplayStore.prototype.setup=function(callback){_API2.default.fetchExrate("JPY",function(res){_Config2.default.setExrate("JPY",res),_API2.default.fetchExrate("IDR",function(res){_Config2.default.setExrate("IDR",res),_API2.default.fetchExrate("TWD",function(res){_Config2.default.setExrate("TWD",res),callback()})})})},DisplayStore.prototype.getAllVisibleMonths=function(){return _.map(this.state.allVisibleDates,function(dateStr){return dateStr.split("/").slice(0,2).join("/")})},DisplayStore.prototype.getAllVisiblePriorMonthIndex=function(){if(0===this.state.allVisibleDates.length)return 0;var months=this.getAllVisibleMonths(),maxCount=0,priorMonth=_.reduce(_.uniq(months),function(res,month){var count=_.filter(months,function(m){return m===month}).length;return count>maxCount?(maxCount=count,month):res},null);return _.findIndex(_Config2.default.months,{strMonth:priorMonth})},DisplayStore}(_AbstractStore3.default);exports.default=new DisplayStore},{"../API":69,"../constants/Config":74,"./AbstractStore":75}],78:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function loopAPIQueues(){if(0!==queues.length){(0,queues.splice(0,1)[0])()}}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_AbstractStore2=require("./AbstractStore"),_AbstractStore3=_interopRequireDefault(_AbstractStore2),_API=require("../API"),_API2=_interopRequireDefault(_API),_Config=require("../constants/Config"),_Config2=_interopRequireDefault(_Config),_UDate=require("../UDate"),_Util=(_interopRequireDefault(_UDate),require("../../../../common/utils/Util")),instances=(_interopRequireDefault(_Util),{}),instanceArr=[],queues=[],MonthlyCalenderStoreClass=function(_AbstractStore){function MonthlyCalenderStoreClass(hotelName,monthIndex){_classCallCheck(this,MonthlyCalenderStoreClass);var _this=_possibleConstructorReturn(this,_AbstractStore.call(this));return _this._hotelName=hotelName,_this._monthIndex=monthIndex,_this._udate=_Config2.default.months[_this._monthIndex],_this._state={loading:!1,vacancyList:[]},_this}return _inherits(MonthlyCalenderStoreClass,_AbstractStore),MonthlyCalenderStoreClass.getInstance=function(hotelName,monthIndex){return instances[hotelName]||(instances[hotelName]={}),instances[hotelName][monthIndex]||(instances[hotelName][monthIndex]=new MonthlyCalenderStoreClass(hotelName,monthIndex),instanceArr.push(instances[hotelName][monthIndex])),instances[hotelName][monthIndex]},MonthlyCalenderStoreClass.prototype.getInfo=function(date){return _.find(this.state.vacancyList,{date:date})},MonthlyCalenderStoreClass.prototype.getVacancyList=function(){return this.state.vacancyList},_createClass(MonthlyCalenderStoreClass,[{key:"hotelName",get:function(){return this._hotelName}},{key:"monthIndex",get:function(){return this._monthIndex}},{key:"udate",get:function(){return this._udate}}]),MonthlyCalenderStoreClass.clearQueues=function(){queues=[],_.forEach(instanceArr,function(instance){instance.abort()})},MonthlyCalenderStoreClass.run=function(numThred){_.forEach(_.range(numThred),function(){loopAPIQueues()})},MonthlyCalenderStoreClass.prototype.setLoading=function(){this.update({loading:!0})},MonthlyCalenderStoreClass.prototype.abort=function(){this._xhr&&this._xhr.abort&&(this._xhr.abort(),this._xhr=null)},MonthlyCalenderStoreClass.prototype.pushQueues=function(condition){return this._conditionJson=JSON.stringify(condition),this._completeConditionJson===this._conditionJson?(this.update({loading:!1}),this.state.vacancyList):(this.abort(),this.update({loading:!0,vacancyList:[]}),queues.push(this._fetch.bind(this,condition)),null)},MonthlyCalenderStoreClass.prototype._fetch=function(condition){var _this2=this;this._xhr=_API2.default.fetchMonthly(this._hotelName,this._udate.str,condition,this._completeHdl.bind(this),function(){setTimeout(_this2._fetch.bind(_this2,condition),1e3)})},MonthlyCalenderStoreClass.prototype._completeHdl=function(data){this._completeConditionJson=this._conditionJson;var vacancyList=data.vacancyList;this.update({vacancyList:vacancyList,loading:!1}),loopAPIQueues()},MonthlyCalenderStoreClass}(_AbstractStore3.default);exports.default=MonthlyCalenderStoreClass},{"../../../../common/utils/Util":11,"../API":69,"../UDate":72,"../constants/Config":74,"./AbstractStore":75}],79:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function loopAPIQueues(){if(0!==queues.length){(0,queues.splice(0,1)[0])()}}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_AbstractStore2=require("./AbstractStore"),_AbstractStore3=_interopRequireDefault(_AbstractStore2),_API=require("../API"),_API2=_interopRequireDefault(_API),_Config=require("../constants/Config"),_Config2=_interopRequireDefault(_Config),_UDate=require("../UDate"),_Util=(_interopRequireDefault(_UDate),require("../../../../common/utils/Util")),_Util2=_interopRequireDefault(_Util),_APIUtil=require("../APIUtil"),_APIUtil2=_interopRequireDefault(_APIUtil),instances={},instanceArr=[],queues=[],WeeklyCalenderStoreClass=function(_AbstractStore){function WeeklyCalenderStoreClass(hotelName,monthIndex){_classCallCheck(this,WeeklyCalenderStoreClass);var _this=_possibleConstructorReturn(this,_AbstractStore.call(this));_this._hotelName=hotelName,_this._monthIndex=monthIndex,_this._udate=_Config2.default.months[_this._monthIndex],_this._state={},_this._infoIdx={},_this._cacheIdx={},_this._xhrList=[];var dayCount=_Config2.default.monthDateCount[_this._udate.strMonth],currentMonth=_this._udate.yyyy===_Util2.default.now.yyyy&&_this._udate.m===_Util2.default.now.m;return _this._weeklyDateStrs=[],_.forEach(_.range(dayCount),function(day){var startD=day+1;if(!(currentMonth&&startD<_Util2.default.now.d)){var d=_this._udate.strMonth+"/"+_Util2.default.zeroPad(startD,2);_this._weeklyDateStrs.push(d)}}),_this}return _inherits(WeeklyCalenderStoreClass,_AbstractStore),WeeklyCalenderStoreClass.getInstance=function(hotelName,monthIndex){return instances[hotelName]||(instances[hotelName]={}),instances[hotelName][monthIndex]||(instances[hotelName][monthIndex]=new WeeklyCalenderStoreClass(hotelName,monthIndex),instanceArr.push(instances[hotelName][monthIndex])),instances[hotelName][monthIndex]},WeeklyCalenderStoreClass.prototype.getInfo=function(date){return this._infoIdx[date]},_createClass(WeeklyCalenderStoreClass,[{key:"hotelName",get:function(){return this._hotelName}},{key:"monthIndex",get:function(){return this._monthIndex}},{key:"udate",get:function(){return this._udate}}]),WeeklyCalenderStoreClass.clearQueues=function(){queues=[],clearTimeout(this._runDelayId),_.forEach(instanceArr,function(instance){instance.abort()})},WeeklyCalenderStoreClass.sortPriorQueues=function(allVisibleDates){if(allVisibleDates&&0!==allVisibleDates.length){var visibles=[],hiddens=[];queues=_.sortBy(queues,"dateStr"),_.forEach(queues,function(q){_.includes(allVisibleDates,q.dateStr)?visibles.push(q):hiddens.push(q)}),queues=visibles.concat(hiddens)}},WeeklyCalenderStoreClass.run=function(numThred){clearTimeout(this._runDelayId),this._runDelayId=setTimeout(function(){_.forEach(_.range(numThred),function(){loopAPIQueues()})},300)},WeeklyCalenderStoreClass.prototype.abort=function(){_.forEach(this._xhrList,function(xhr){xhr&&xhr.abort&&xhr.abort()}),this._xhrList=[]},WeeklyCalenderStoreClass.prototype.pushQueues=function(condition){var _this2=this;this.abort();var conditionJson=JSON.stringify(condition);this._conditionJson&&(this._cacheIdx[this._conditionJson]=this._infoIdx),this._infoIdx=this._cacheIdx[conditionJson]||{},this._conditionJson=conditionJson,this._emitChange(),_.forEach(this._weeklyDateStrs,function(dateStr){if(!_this2._infoIdx[dateStr]){var f=_this2._fetch.bind(_this2,dateStr,dateStr,condition);f.dateStr=dateStr,f.hotelName=_this2._hotelName,f.monthIndex=_this2._monthIndex,queues.push(f)}})},WeeklyCalenderStoreClass.prototype._fetch=function(startDate,endDate,condition){var _this3=this,xhr=_API2.default.fetchWeekly(this._hotelName,startDate,endDate,condition,this._completeHdl.bind(this),function(){setTimeout(_this3._fetch.bind(_this3,startDate,endDate,condition),1e3)});this._xhrList.push(xhr)},WeeklyCalenderStoreClass.prototype._completeHdl=function(data){this._mergeData(data),this._emitChange(),loopAPIQueues()},WeeklyCalenderStoreClass.prototype._mergeData=function(data){var info=data.vacancyList[0];this._infoIdx[info.date]=info},WeeklyCalenderStoreClass.prototype.cancelDisabedDayByMonthly=function(vacancyList){var _this4=this;_.forEach(vacancyList,function(info){(_APIUtil2.default.isClosed(info)||_APIUtil2.default.isFull(info))&&_this4._cancelDisabledDayQueue(info.date)})},WeeklyCalenderStoreClass.prototype._cancelDisabledDayQueue=function(dateStr){queues=_.reject(queues,{dateStr:dateStr,hotelName:this._hotelName,monthIndex:this._monthIndex})},WeeklyCalenderStoreClass}(_AbstractStore3.default);exports.default=WeeklyCalenderStoreClass},{"../../../../common/utils/Util":11,"../API":69,"../APIUtil":70,"../UDate":72,"../constants/Config":74,"./AbstractStore":75}],80:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Config=require("../constants/Config"),_HotelCalender=(_interopRequireDefault(_Config),require("./HotelCalender")),_WindowStore=(_interopRequireDefault(_HotelCalender),require("../../../../common/stores/WindowStore")),_DisplayStore=(_interopRequireDefault(_WindowStore),require("../stores/DisplayStore")),_Action=(_interopRequireDefault(_DisplayStore),require("../actions/Action")),CalenderLoading=(_interopRequireDefault(_Action),function(){function CalenderLoading($el){_classCallCheck(this,CalenderLoading),this.$=$el,this._isShow=!0}return CalenderLoading.prototype.switchShow=function(isShow){this._isShow!==isShow&&(this._isShow=isShow,this.$.switchClass("js-hidden",!isShow))},CalenderLoading}());exports.default=CalenderLoading},{"../../../../common/stores/WindowStore":4,"../actions/Action":73,"../constants/Config":74,"../stores/DisplayStore":77,"./HotelCalender":86}],81:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _Action=require("../actions/Action"),_Action2=_interopRequireDefault(_Action),_Config=require("../constants/Config"),_Config2=_interopRequireDefault(_Config),_makeCalender2=require("./makeCalender"),_makeCalender3=_interopRequireDefault(_makeCalender2),_UDate=require("../UDate"),_UDate2=_interopRequireDefault(_UDate),_Util=require("../../../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_MiniFloat2=require("./MiniFloat"),_MiniFloat3=_interopRequireDefault(_MiniFloat2),CheckCalender=function(_MiniFloat){function CheckCalender($el,props){_classCallCheck(this,CheckCalender);var _this=_possibleConstructorReturn(this,_MiniFloat.call(this,$el,props));return _this.$=$el,_this.props=_.assign({},props||{}),_this.$head=_this.$.find(".jsm-booking__calenderHead"),_this.$table=_this.$.find(".jsm-booking__calenderTable"),_this._headTemplate=_this.$head.html(),_this._cellTemplate=_this.$table.html(),_this.$table.html(""),_this.$table.on("click",".jsm-booking__calenderCell",_this._cellClickHdl.bind(_this)),_this.$.find(".jsm-booking__checkCalenderPrev").on("click",_this._makePrev.bind(_this)),_this.$.find(".jsm-booking__checkCalenderNext").on("click",_this._makeNext.bind(_this)),_this._monthIndex=0,_this}return _inherits(CheckCalender,_MiniFloat),CheckCalender.prototype._floatWillShow=function(){this._make()},CheckCalender.prototype._makePrev=function(){0!==this._monthIndex&&(this._monthIndex--,this._make())},CheckCalender.prototype._makeNext=function(){this._monthIndex!==_Config2.default.maxMonthIndex&&(this._monthIndex++,this._make())},CheckCalender.prototype._make=function(){if(this._madeMonthIndex!==this._monthIndex){this._madeMonthIndex=this._monthIndex;var monthUdate=_Config2.default.months[this._monthIndex];this.$head.html(_Util2.default.template(this._headTemplate,{year:monthUdate.yyyy,month:monthUdate.makeMonthName()}));var _makeCalender=(0,_makeCalender3.default)({month:monthUdate,cellTemplate:this._cellTemplate,onerow:!1}),tableHtml=_makeCalender.tableHtml;_makeCalender.allUDates;this.$table.html(tableHtml)}},CheckCalender.prototype._cellClickHdl=function(e){var dateStr=e.target.getAttribute("data-datestr"),udate=new _UDate2.default(dateStr);_Action2.default.changeAllCheckin(udate),this._hide()},CheckCalender}(_MiniFloat3.default);exports.default=CheckCalender},{"../../../../common/utils/Util":11,"../UDate":72,"../actions/Action":73,"../constants/Config":74,"./MiniFloat":88,"./makeCalender":96}],82:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _CondPeople=require("./CondPeople"),_CondPeople2=_interopRequireDefault(_CondPeople),_CondNights=require("./CondNights"),_CondNights2=_interopRequireDefault(_CondNights),Cond=function Cond($el,props){_classCallCheck(this,Cond),this.$=$el,this.props=_.assign({},props||{}),new _CondPeople2.default(this.$.find(".jsm-booking__condPeople")),new _CondNights2.default(this.$.find(".jsm-booking__condNights"))};exports.default=Cond},{"./CondNights":83,"./CondPeople":84}],83:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _ConditionStore=require("../stores/ConditionStore"),_ConditionStore2=_interopRequireDefault(_ConditionStore),_Action=require("../actions/Action"),_Action2=_interopRequireDefault(_Action),_MiniFloat=require("./MiniFloat"),_MiniFloat2=_interopRequireDefault(_MiniFloat),CondNights=function(){function CondNights($el,props){var _this=this;_classCallCheck(this,CondNights),this.$=$el,this.props=_.assign({},props||{}),this.$trigger=this.$.find(".jsm-booking__condNightsTrigger"),this.$body=$(document.body),this._float=new _MiniFloat2.default(this.$.find(".jsm-booking__condNightsFloat"),{$trigger:this.$trigger,showCallback:function(){window.HOSHINOYA.GA.clickEvent("reserve_ui","ui_nights")}}),this._$items=_.map(this.$.find(".jsm-booking__condNightsSelectItem"),function(el,i){var $item=$(el);return $item.stayLength=i+1,$item.on("click",function(){_Action2.default.changeCondition({stayLength:$item.stayLength}),_this.$body.trigger("minifloatclose")}),$item}),_ConditionStore2.default.onChange(this._conditionChangeHdl.bind(this)),this._conditionChangeHdl()}return CondNights.prototype._conditionChangeHdl=function(){var _this2=this,condition=_ConditionStore2.default.state;_.forEach(this._$items,function($item){var active=$item.stayLength===condition.stayLength;$item.switchClass("js-active",active),active&&_this2.$trigger.html($item.html())})},CondNights}();exports.default=CondNights},{"../actions/Action":73,"../stores/ConditionStore":76,"./MiniFloat":88}],84:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _ConditionStore=require("../stores/ConditionStore"),_ConditionStore2=_interopRequireDefault(_ConditionStore),_Action=require("../actions/Action"),_Action2=_interopRequireDefault(_Action),_MiniFloat=require("./MiniFloat"),_MiniFloat2=_interopRequireDefault(_MiniFloat),_Util=require("../../../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_DisplayStore=require("../stores/DisplayStore"),_DisplayStore2=_interopRequireDefault(_DisplayStore),_APIUtil=require("../APIUtil"),_APIUtil2=_interopRequireDefault(_APIUtil),CondPeople=function(){function CondPeople($el,props){_classCallCheck(this,CondPeople),this.$=$el,this.props=_.assign({},props||{}),this.$trigger=this.$.find(".jsm-booking__condPeopleTrigger"),this._triggerTemplate=this.$trigger.html(),this._float=new _MiniFloat2.default(this.$.find(".jsm-booking__condPeopleFloat"),{$trigger:this.$trigger,showCallback:function(){window.HOSHINOYA.GA.clickEvent("reserve_ui","ui_people")}}),this._$items=_.map(this.$.find(".jsm-booking__condPeopleSelect"),function(el){var $item=$(el);return $item.name=$item.attr("name"),$item.val(_ConditionStore2.default.state[$item.name]),$item.on("change",function(){var _Action$changeConditi;_Action2.default.changeCondition((_Action$changeConditi={},_Action$changeConditi[$item.name]=parseInt($item.val()),_Action$changeConditi))}),$item}),_ConditionStore2.default.onChange(this._conditionChangeHdl.bind(this)),this._conditionChangeHdl(),this.$multiChoice=this.$.find(".jsm-booking__condPeopleMultiChoice"),_DisplayStore2.default.onChangeOneState("tab",this._tabChangeHdl.bind(this)),this._tabChangeHdl()}return CondPeople.prototype._conditionChangeHdl=function(){var condition=_ConditionStore2.default.state;_.forEach(this._$items,function($item){var newVal=condition[$item.name];$item.val(newVal)}),this.$trigger.html(_Util2.default.template(this._triggerTemplate,_ConditionStore2.default.getMergedPeople()))},CondPeople.prototype._tabChangeHdl=function(){var tab=_DisplayStore2.default.state.tab;this.$multiChoice.switchClass("js-hidden","_admin"===tab);var url=_APIUtil2.default.getBookingSiteUrl(tab);this.$multiChoice.attr("href",url)},CondPeople}();exports.default=CondPeople},{"../../../../common/utils/Util":11,"../APIUtil":70,"../actions/Action":73,"../stores/ConditionStore":76,"../stores/DisplayStore":77,"./MiniFloat":88}],85:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Action=require("../actions/Action"),_DisplayStore=(_interopRequireDefault(_Action),require("../stores/DisplayStore")),_DisplayStore2=_interopRequireDefault(_DisplayStore),Currency=function Currency($el,props){var _this=this;_classCallCheck(this,Currency),this.$=$el,this.props=_.assign({},props||{}),this.$select=this.$.find("select"),this.$select.val(_DisplayStore2.default.state.currency).on("change",function(){_DisplayStore2.default.update({currency:_this.$select.val()}),window.HOSHINOYA.GA.clickEvent("reserve_ui","ui_currency")})};exports.default=Currency},{"../actions/Action":73,"../stores/DisplayStore":77}],86:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Config=require("../constants/Config"),_Config2=_interopRequireDefault(_Config),_Util=require("../../../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_UDate=require("../UDate"),_MonthlyCalenderStoreClass=(_interopRequireDefault(_UDate),require("../stores/MonthlyCalenderStoreClass")),_MonthlyCalenderStoreClass2=_interopRequireDefault(_MonthlyCalenderStoreClass),_WeeklyCalenderStoreClass=require("../stores/WeeklyCalenderStoreClass"),_WeeklyCalenderStoreClass2=_interopRequireDefault(_WeeklyCalenderStoreClass),_DisplayStore=require("../stores/DisplayStore"),_DisplayStore2=_interopRequireDefault(_DisplayStore),_Action=require("../actions/Action"),_HotelCalenderCell=(_interopRequireDefault(_Action),require("./HotelCalenderCell")),_HotelCalenderCell2=_interopRequireDefault(_HotelCalenderCell),_makeCalender2=require("./makeCalender"),_makeCalender3=_interopRequireDefault(_makeCalender2),HotelCalender=function(){function HotelCalender($el,props){_classCallCheck(this,HotelCalender),this.$=$el,this.props=_.assign({hotelName:"",monthIndex:0,onerow:!1
},props||{}),this._udate=_Config2.default.months[this.props.monthIndex],this.$calender=this.$.find(".jsm-booking__calender"),this.$loading=this.$.find(".jsm-booking__calenderLoading"),this.$table=this.$.find(".jsm-booking__calenderTable");var $head=this.$.find(".jsm-booking__calenderHead");$head.length&&$head.html(_Util2.default.template($head.html(),{year:this._udate.yyyy,month:this._udate.makeMonthName(),month_short:this._udate.makeMonthNameShort()}))}return _createClass(HotelCalender,[{key:"width",get:function(){return this._width}},{key:"gutter",get:function(){return this._gutter}}]),HotelCalender.prototype.makeTable=function(){var cellTemplate=this.$table.html();this.$table.html("");var _makeCalender=(0,_makeCalender3.default)({month:this._udate,cellTemplate:cellTemplate,showPast:!this.props.onerow,onerow:this.props.onerow}),tableHtml=_makeCalender.tableHtml,allUDates=_makeCalender.allUDates;return this._tableHtml=tableHtml,this.props.onerow||(this.$table.html(tableHtml),this._init()),allUDates},HotelCalender.prototype.appendOneLineCells=function(){this.$table.html(this._tableHtml),this._init()},HotelCalender.prototype.calcBounds=function(){this._width=Math.max(this.$.outerWidth(),this.$calender.outerWidth()),this._gutter=parseInt(this.$.css("margin-right"))},HotelCalender.prototype.setX=function(x){this._x=x,this.$.css3({x:x})},HotelCalender.prototype.dragStarted=function(){this._startX=this._x},HotelCalender.prototype.dragMoved=function(dx){var x=this._startX+dx;this.setX(x)},HotelCalender.prototype.dragEnded=function(){},HotelCalender.prototype._init=function(){var _this=this;this._cellsIdx=_.reduce(this.$[0].querySelectorAll(".jsm-booking__calenderCell"),function(res,el){var cell=new _HotelCalenderCell2.default(el,{onerow:_this.props.onerow,hotelName:_this.props.hotelName});return res[cell.datestr]=cell,res},{}),this.$table.on("click",".jsm-booking__calenderCell",function(e){var date=e.target.getAttribute("data-datestr");if(date){if(!_this._cellsIdx[date].isDisabled()){var tab=_DisplayStore2.default.state.tab;window.HOSHINOYA.GA.clickEvent("reserve_hotels","_admin"===tab?"all":"each_"+tab),window.HOSHINOYA.GA.pageview("/reserve_hotels/")}}}),this._monthlyStore=_MonthlyCalenderStoreClass2.default.getInstance(this.props.hotelName,this.props.monthIndex),this._weeklyStore=_WeeklyCalenderStoreClass2.default.getInstance(this.props.hotelName,this.props.monthIndex),this._monthlyStore.onChange(this._monthlyChangeHdl.bind(this)),this._weeklyStore.onChange(this._weeklyChangeHdl.bind(this)),this._monthlyChangeHdl(),this._weeklyChangeHdl(),_DisplayStore2.default.onChangeOneState("currency",this._currenyChangeHdl.bind(this))},HotelCalender.prototype._monthlyChangeHdl=function(){var _this2=this,loading=this._monthlyStore.state.loading;this.$calender.switchClass("js-loading",loading),this.$loading.switchClass("js-visible",loading),loading||(_.forEach(this._cellsIdx,function(cell,date){if(!cell.outdate){var info=_this2._monthlyStore.getInfo(date);cell.setMonthlyInfo(info)}}),this._weeklyStore.cancelDisabedDayByMonthly(this._monthlyStore.getVacancyList()))},HotelCalender.prototype._weeklyChangeHdl=function(){var _this3=this;_.forEach(this._cellsIdx,function(cell){if(!cell.outdate){var info=_this3._weeklyStore.getInfo(cell.datestr);cell.setWeeklyInfo(info)}})},HotelCalender.prototype._currenyChangeHdl=function(){_.forEach(this._cellsIdx,function(cell){cell.outdate||cell.updatePrice()})},HotelCalender}();exports.default=HotelCalender},{"../../../../common/utils/Util":11,"../UDate":72,"../actions/Action":73,"../constants/Config":74,"../stores/DisplayStore":77,"../stores/MonthlyCalenderStoreClass":78,"../stores/WeeklyCalenderStoreClass":79,"./HotelCalenderCell":87,"./makeCalender":96}],87:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Config=require("../constants/Config"),_Config2=_interopRequireDefault(_Config),_Util=require("../../../../common/utils/Util"),_UDate=(_interopRequireDefault(_Util),require("../UDate")),_UDate2=_interopRequireDefault(_UDate),_APIUtil=require("../APIUtil"),_APIUtil2=_interopRequireDefault(_APIUtil),_DisplayStore=require("../stores/DisplayStore"),_DisplayStore2=_interopRequireDefault(_DisplayStore),_ConditionStore=require("../stores/ConditionStore"),_ConditionStore2=_interopRequireDefault(_ConditionStore),HotelCalenderCell=function(){function HotelCalenderCell(el,props){_classCallCheck(this,HotelCalenderCell),this._el=el,this.props=_.assign({onerow:!1,hotelName:""},props||{}),this._outdate=this._el.classList.contains("js-outdate"),this._priceEl=this._el.querySelector(".jsm-booking__calenderCellPrice"),this._datestr=this._el.getAttribute("data-datestr"),this._udate=new _UDate2.default(this._datestr),this._isNightsRestrictTarget=_.includes(_Config2.default.nightsRestrictSites,this.props.hotelName)&&this._udate.time>=_Config2.default.nightsRestrictUDate.time}return _createClass(HotelCalenderCell,[{key:"datestr",get:function(){return this._datestr}},{key:"outdate",get:function(){return this._outdate}}]),HotelCalenderCell.prototype.isDisabled=function(){var full=this._el.classList.contains("js-full"),closed=this._el.classList.contains("js-closed");return full||closed||this._outdate},HotelCalenderCell.prototype.setMonthlyInfo=function(info){if(info){this._el.classList.remove("js-notfound");var closed=_APIUtil2.default.isClosed(info),full=_APIUtil2.default.isFull(info);this._isNightsRestrictTarget&&1===_ConditionStore2.default.state.stayLength&&(full=!0);var disabled=closed||full;if(this._el.classList[closed?"add":"remove"]("js-closed"),this._el.classList[full?"add":"remove"]("js-full"),this._el.classList[disabled?"remove":"add"]("js-enabled"),disabled)this._el.removeAttribute("href");else{var condition=_APIUtil2.default.formatCondition(this.props.hotelName,_ConditionStore2.default.state),url=_APIUtil2.default.getBookingSiteUrl(this.props.hotelName)+"/search?checkIn="+this._datestr+"&stay="+condition.stayLength+"&a="+condition.adult+"&b="+condition.underTwelve+"&c="+condition.underSeven+"&d="+condition.underFour+"&reserveCount=1&selected=plan";this._el.setAttribute("href",url)}}else this._el.classList.add("js-notfound"),this._el.classList.remove("js-enabled")},HotelCalenderCell.prototype.setWeeklyInfo=function(info){this._weeklyInfo=info,this.updatePrice()},HotelCalenderCell.prototype.updatePrice=function(){if(this._priceEl){var price=_APIUtil2.default.getPrice(_DisplayStore2.default.state.currency,this._weeklyInfo)||"...";this._price!==price&&(this._price=price,this._priceEl.innerHTML=price)}},HotelCalenderCell}();exports.default=HotelCalenderCell},{"../../../../common/utils/Util":11,"../APIUtil":70,"../UDate":72,"../constants/Config":74,"../stores/ConditionStore":76,"../stores/DisplayStore":77}],88:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Action=require("../actions/Action"),_Config=(_interopRequireDefault(_Action),require("../constants/Config")),_makeCalender=(_interopRequireDefault(_Config),require("./makeCalender")),_UDate=(_interopRequireDefault(_makeCalender),require("../UDate")),_Util=(_interopRequireDefault(_UDate),require("../../../../common/utils/Util")),MiniFloat=(_interopRequireDefault(_Util),function(){function MiniFloat($el,props){_classCallCheck(this,MiniFloat),this.$=$el,this.props=_.assign({$trigger:null,showCallback:null},props||{}),this.$body=$(document.body),this._bindedBodyClick=this._bodyClickHdl.bind(this),this.props.$trigger.on("click",this._toggle.bind(this)),this.$.find(".jsm-booking__miniFloatClose").on("click",this._hide.bind(this))}return MiniFloat.prototype._toggle=function(){this._visible?this._hide():this._show()},MiniFloat.prototype._show=function(){var _this=this;this._visible||(this._visible=!0,this._floatWillShow(),clearTimeout(this._delayId),this._delayId=setTimeout(function(){_this.$.addClass("js-visible"),_this.$body.on("mouseup touchend minifloatclose",_this._bindedBodyClick),_this.props.showCallback&&_this.props.showCallback()},10))},MiniFloat.prototype._hide=function(){this._visible&&(this._visible=!1,clearTimeout(this._delayId),this.$.removeClass("js-visible"),this.$body.off("mouseup touchend minifloatclose",this._bindedBodyClick))},MiniFloat.prototype._bodyClickHdl=function(e){$.contains(this.$[0],e.target)||this.$[0]===e.target||$.contains(this.props.$trigger[0],e.target)||this.props.$trigger[0]===e.target||this._hide()},MiniFloat.prototype._floatWillShow=function(){},MiniFloat}());exports.default=MiniFloat},{"../../../../common/utils/Util":11,"../UDate":72,"../actions/Action":73,"../constants/Config":74,"./makeCalender":96}],89:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _DisplayStore=require("../stores/DisplayStore"),_DisplayStore2=_interopRequireDefault(_DisplayStore),_ConditionStore=require("../stores/ConditionStore"),_ConditionStore2=_interopRequireDefault(_ConditionStore),_Config=require("../constants/Config"),_Config2=_interopRequireDefault(_Config),NightsRestrictModal=function(){function NightsRestrictModal($el,props){_classCallCheck(this,NightsRestrictModal),this.$=$el,this.props=_.assign({},props||{}),this._shown={},_DisplayStore2.default.onChange(this._storeChangeHdl.bind(this)),_ConditionStore2.default.onChange(this._storeChangeHdl.bind(this)),this.$.find(".jsm-booking__restrictModalClose").on("click",this._switchVisibility.bind(this,!1))}return NightsRestrictModal.prototype._storeChangeHdl=function(){var tab=_DisplayStore2.default.state.tab;1===_ConditionStore2.default.state.stayLength&&_.includes(_Config2.default.nightsRestrictSites,tab)&&!this._shown[tab]&&(this._shown[tab]=!0,this._switchVisibility(!0))},NightsRestrictModal.prototype._switchVisibility=function(visible){var _this=this;clearTimeout(this._delayId),visible?this.$.addClass("js-show js-visible"):(this.$.removeClass("js-show"),this._delayId=setTimeout(function(){_this.$.removeClass("js-visible")},200))},NightsRestrictModal}();exports.default=NightsRestrictModal},{"../constants/Config":74,"../stores/ConditionStore":76,"../stores/DisplayStore":77}],90:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Config=require("../constants/Config"),_Config2=_interopRequireDefault(_Config),_HotelCalender=require("./HotelCalender"),_WindowStore=(_interopRequireDefault(_HotelCalender),require("../../../../common/stores/WindowStore")),_WindowStore2=_interopRequireDefault(_WindowStore),_Action=require("../actions/Action"),_Action2=_interopRequireDefault(_Action),_PaneAllRow=require("./PaneAllRow"),_PaneAllRow2=_interopRequireDefault(_PaneAllRow),_CalenderLoading=require("./CalenderLoading"),_Tween=(_interopRequireDefault(_CalenderLoading),require("../../../../common/utils/Tween")),_Tween2=_interopRequireDefault(_Tween),_Util=require("../../../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_CheckCalender=require("./CheckCalender"),_CheckCalender2=_interopRequireDefault(_CheckCalender),_DisplayStore=require("../stores/DisplayStore"),_DisplayStore2=_interopRequireDefault(_DisplayStore),PaneAll=function(){function PaneAll($el,props){_classCallCheck(this,PaneAll),this.$=$el,this.props=_.assign({},props||{}),this.$right=this.$.find(".jsm-booking__paneAllRight"),this.$headDate=this.$right.find(".jsm-booking__paneAllHeadDate"),this.$rowWrap=this.$right.find(".jsm-booking__paneAllRowWrap"),this.$headMonth=this.$right.find(".jsm-booking__paneAllHeadMonth"),this._headXArr=[],this._calenderBuildQueues=[],this._tw=new _Tween2.default,this._bindedScrollHdl=this._scrollHdl.bind(this),this._bindedResizeHdl=this._resizeHdl.bind(this),this._debouncedCheckVisibleCells=_.debounce(this._checkVisibleCells.bind(this),100),this.$leftButton=this.$.find(".jsm-booking__paneAllScrollLeft"),this.$rightButton=this.$.find(".jsm-booking__paneAllScrollRight"),this._leftVisible=!1,this._rightVisible=!1}return PaneAll.prototype._build=function(){this._isBuilt||(this._isBuilt=!0,new _CheckCalender2.default(this.$.find(".jsm-booking__checkCalender"),{$trigger:this.$.find(".jsm-booking__checkTrigger"),showCallback:function(){window.HOSHINOYA.GA.clickEvent("reserve_ui","ui_chekin")}}),this.$right.css("margin-bottom",-_WindowStore2.default.getScrollBarWidth()),this._makeRows(),this._makeHeadDate(),this._makeHeadMonth(),this._bindEvents())},PaneAll.prototype._makeRows=function(){var _this=this;this._rows=_.map(this.$right.find(".jsm-booking__paneAllRow"),function(el,i){var $el=$(el),row=new _PaneAllRow2.default($el,{hotelName:$el.attr("data-hotel"),rowIndex:i});return _this._allUDates=row.makeCalenders(),row}),_.forEach(_Config2.default.months,function(monthUdate,i){_.forEach(_this._rows,function(row){_this._calenderBuildQueues.push(row.calenders[i])})}),this._buildCalenderLoop(),this._allUDatesFlat=_.flatten(this._allUDates)},PaneAll.prototype._buildCalenderLoop=function(){var _this2=this;if(!this._buildCalenderTimerId&&0!==this._calenderBuildQueues.length){this._calenderBuildQueues.splice(0,1)[0].appendOneLineCells(),this._buildCalenderTimerId=setTimeout(function(){_this2._buildCalenderTimerId=null,_this2._buildCalenderLoop()},0)}},PaneAll.prototype._makeHeadDate=function(){var template=this.$headDate.html(),html=_.map(this._allUDates,function(udatesArr){return _.map(udatesArr,function(udate,i){return _Util2.default.template(template,{class_top:0===i?"js-top":"",date:udate.d,day:udate.makeWeekStr()})}).join("")}).join("");this.$headDate.html(html),this._$headDateTopItems=_.map(this.$headDate.find(".js-top"),function(el){return $(el)}),this.$headDateItems=this.$headDate.find(".jsm-booking__paneAllHeadDateItem")},PaneAll.prototype._makeHeadMonth=function(){var template=this.$headMonth.html(),html=_.map(_Config2.default.months,function(monthUdate,i){return _Util2.default.template(template,{year:monthUdate.yyyy,month:monthUdate.makeMonthName(),month_short:monthUdate.makeMonthNameShort()})}).join("");this.$headMonth.html(html),this._$headMonthItems=_.map(this.$headMonth.find(".jsm-booking__paneAllHeadMonthItem"),function(el){return $(el)})},PaneAll.prototype._bindEvents=function(){var _this3=this;this.$.find(".jsm-booking__paneAllToday").on("click",function(){_this3._scrollTo(0),window.HOSHINOYA.GA.clickEvent("reserve_ui","ui_today")}),this.$leftButton.on("click",function(){_this3._scrollNeighbour(-1),window.HOSHINOYA.GA.clickEvent("reserve_ui","ui_nextprev_all")}),this.$rightButton.on("click",function(){_this3._scrollNeighbour(1),window.HOSHINOYA.GA.clickEvent("reserve_ui","ui_nextprev_all")}),_DisplayStore2.default.onChangeOneState("allCheckinDate",this._checkinChangeHdl.bind(this))},PaneAll.prototype.activate=function(active){var _this4=this;this._active!==active&&(this._active=active,this.$.switchClass("js-active",active).removeClass("js-show"),active&&setTimeout(function(){_this4.$.addClass("js-show")},33),active?(this._build(),this.$right.on("scroll",this._bindedScrollHdl),_WindowStore2.default.onResize(this._bindedResizeHdl),this._resizeHdl(),this._scrollHdl()):(this.$right.off("scroll",this._bindedScrollHdl),_WindowStore2.default.offResize(this._bindedResizeHdl)))},PaneAll.prototype._resizeHdl=function(){var _this5=this;if(this._sw=this.$right.outerWidth(),this._sw2=Math.round(.5*this._sw),this._rightW=this.$right.outerWidth(),this._totalW=this.$right[0].scrollWidth,this._maxScroll=this._totalW-this._sw,this._cellW=Math.round(this.$headDateItems.eq(1).offset().left-this.$headDateItems.eq(0).offset().left),this._$headDateTopItems.length>0){var baseX=this._$headDateTopItems[0].offset().left;_.forEach(this._$headDateTopItems,function($head,i){if(0===i)return void(_this5._headXArr[i]=0);_this5._headXArr[i]=$head.offset().left-baseX})}_.forEach(this._$headMonthItems,function($headMonth,monthIndex){var x=_this5._headXArr[monthIndex],nextX=_this5._headXArr[monthIndex+1]>=0?_this5._headXArr[monthIndex+1]:_this5._totalW,width=nextX-x;$headMonth.css({left:x,width:width}),_.forEach(_this5._rows,function(row){row.setWidth(monthIndex,width)})})},PaneAll.prototype._scrollHdl=function(){this._scrollLeft=this.$right.scrollLeft(),this._chechLeftRightButton(),this._debouncedCheckVisibleCells()},PaneAll.prototype._chechLeftRightButton=function(){var leftVisible=this._scrollLeft>10,rightVisible=this._scrollLeft<this._maxScroll-10;this._leftVisible!==leftVisible&&(this._leftVisible=leftVisible,this.$leftButton.switchClass("js-visible",leftVisible)),this._rightVisible!==rightVisible&&(this._rightVisible=rightVisible,this.$rightButton.switchClass("js-visible",rightVisible))},PaneAll.prototype._checkVisibleCells=function(){var start=Math.floor(this._scrollLeft/this._cellW),range=Math.ceil(this._rightW/this._cellW)+1,udates=this._allUDatesFlat.slice(start,start+range);_Action2.default.updateAllVisibleDates(_.map(udates,"str"))},PaneAll.prototype._scrollNeighbour=function(dir){var colNum=Math.floor(.95*this._sw/this._cellW),end=this.$right.scrollLeft()+dir*colNum*this._cellW;this._scrollTo(end)},PaneAll.prototype._scrollTo=function(end){var _this6=this,duration=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;this._tw.it({start:this.$right.scrollLeft(),end:end,duration:duration,easing:"easeInOutSine",onProgress:function(v){_this6.$right.scrollLeft(v)},onComplete:function(){_this6._scrollHdl()}})},PaneAll.prototype._checkinChangeHdl=function(){var checkinDate=_DisplayStore2.default.state.allCheckinDate;if(checkinDate){var targetIndex=_.findIndex(this._allUDatesFlat,{str:checkinDate.str}),end=this._cellW*targetIndex;this._scrollTo(end)}},PaneAll}();exports.default=PaneAll},{"../../../../common/stores/WindowStore":4,"../../../../common/utils/Tween":9,"../../../../common/utils/Util":11,"../actions/Action":73,"../constants/Config":74,"../stores/DisplayStore":77,"./CalenderLoading":80,"./CheckCalender":81,"./HotelCalender":86,"./PaneAllRow":91}],91:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Config=require("../constants/Config"),_Config2=_interopRequireDefault(_Config),_HotelCalender=require("./HotelCalender"),_HotelCalender2=_interopRequireDefault(_HotelCalender),_WindowStore=require("../../../../common/stores/WindowStore"),_DisplayStore=(_interopRequireDefault(_WindowStore),require("../stores/DisplayStore")),_Action=(_interopRequireDefault(_DisplayStore),require("../actions/Action")),PaneAllRow=(_interopRequireDefault(_Action),function(){function PaneAllRow($el,props){_classCallCheck(this,PaneAllRow),this.$=$el,this.props=_.assign({hotelName:"",rowIndex:0},props||{})}return _createClass(PaneAllRow,[{key:"calenders",get:function(){return this._calenders}},{key:"hotelName",get:function(){return this.props.hotelName}}]),PaneAllRow.prototype.makeCalenders=function(){var _this=this,$container=this.$.find(".jsm-booking__paneAllCalenderContainer"),$tpl_calender=this.$.find(".jsm-booking__paneAllCalender").remove(),allUDates=[];return this._calenders=_.map(_Config2.default.months,function(monthUdate,i){var calender=new _HotelCalender2.default($tpl_calender.clone().appendTo($container),{hotelName:_this.props.hotelName,monthIndex:i,onerow:!0});return allUDates.push(calender.makeTable()),calender}),allUDates},PaneAllRow.prototype.setWidth=function(monthIndex,width){this._calenders[monthIndex].$.css("width",width)},PaneAllRow}());exports.default=PaneAllRow},{"../../../../common/stores/WindowStore":4,"../actions/Action":73,"../constants/Config":74,"../stores/DisplayStore":77,"./HotelCalender":86}],92:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Config=require("../constants/Config"),_Config2=_interopRequireDefault(_Config),_HotelCalender=require("./HotelCalender"),_HotelCalender2=_interopRequireDefault(_HotelCalender),_WindowStore=require("../../../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_DisplayStore=require("../stores/DisplayStore"),_DisplayStore2=_interopRequireDefault(_DisplayStore),_Draggee=require("../../../../common/utils/Draggee"),_Draggee2=_interopRequireDefault(_Draggee),_Action=require("../actions/Action"),_Action2=_interopRequireDefault(_Action),_Util=require("../../../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_Browsers=require("../../../../common/constants/Browsers"),_Browsers2=_interopRequireDefault(_Browsers),PaneHotel=function(){function PaneHotel($el,props){_classCallCheck(this,PaneHotel),this.$=$el,this.props=_.assign({hotelName:""},props||{}),this._bindedResizeHdl=this._resizeHdl.bind(this),this._bindedDisplayChangeHdl=this._displayChangeHdl.bind(this)}return PaneHotel.prototype._build=function(){var _this=this;if(!this._isBuilt){this._isBuilt=!0;var $container=this.$.find(".jsm-booking__paneHotelCalenderContainer"),$tpl_calender=this.$.find(".jsm-booking__paneHotelCalender").remove();this._calenders=_.map(_Config2.default.months,function(monthUdate,i){var calender=new _HotelCalender2.default($tpl_calender.clone().appendTo($container),{hotelName:_this.props.hotelName,monthIndex:i,onerow:!1});return 0===i?calender.makeTable():setTimeout(calender.makeTable.bind(calender),33*i),calender}),this.$monthSelect=this.$.find(".jsm-booking__paneHotelMonthSelect");var monthSelectTemplate=this.$monthSelect.html();this.$monthSelect.html('<option value="none">'+this.$monthSelect.attr("data-label")+"</option>"+_.map(_Config2.default.months,function(monthUdate,i){return _Util2.default.template(monthSelectTemplate,{monthIndex:i,year:monthUdate.yyyy,month:monthUdate.makeMonthName()})}).join("")),this.$monthSelect.on("change",function(){var val=_this.$monthSelect.val();"none"!==val&&(_Action2.default.setMonthIndex(parseInt(val)),_this.$monthSelect.val("none"),window.HOSHINOYA.GA.clickEvent("reserve_ui","ui_month"))}),this.$.find(".jsm-booking__paneHotelPrev").on("click",function(){_Action2.default.moveMonthIndex(-1),window.HOSHINOYA.GA.clickEvent("reserve_ui","ui_nextprev_month")}),this.$.find(".jsm-booking__paneHotelNext").on("click",function(){_Action2.default.moveMonthIndex(1),window.HOSHINOYA.GA.clickEvent("reserve_ui","ui_nextprev_month")}),_Browsers2.default.touch&&(this._d=new _Draggee2.default,this._d.init(this.$[0],{lockVertical:!0}).onStart(this._dragStartHdl.bind(this)).onMove(this._dragMoveHdl.bind(this)).onEndDir(this._dragEndDirHdl.bind(this)))}},PaneHotel.prototype.activate=function(active){var _this2=this;this._active!==active&&(this._active=active,this.$.switchClass("js-active",active).removeClass("js-show"),active&&setTimeout(function(){_this2.$.addClass("js-show")},33),active?(this._build(),_DisplayStore2.default.onChange(this._bindedDisplayChangeHdl),this._displayChangeHdl(),_WindowStore2.default.onResize(this._bindedResizeHdl),this._moveToCurrentMonth(!0)):(_DisplayStore2.default.offChange(this._bindedDisplayChangeHdl),_WindowStore2.default.offResize(this._bindedResizeHdl)))},PaneHotel.prototype._displayChangeHdl=function(){this._resizeHdl()},PaneHotel.prototype._resizeHdl=function(){_DisplayStore2.default.state.visible&&this._moveToCurrentMonth()},PaneHotel.prototype._moveToCurrentMonth=function(isDirect){var _this3=this;isDirect&&(clearTimeout(this._directDelayId),this._setDirect(!0),this._directDelayId=setTimeout(function(){_this3._setDirect(!1)},33)),this._calenders[0].calcBounds();var w=this._calenders[0].width+this._calenders[0].gutter;if(w<200)return setTimeout(this._moveToCurrentMonth.bind(this,isDirect),0);_.forEach(this._calenders,function(calender,i){var index=i-_DisplayStore2.default.state.monthIndex,x=index*w;calender.setX(x)})},PaneHotel.prototype._setDirect=function(isDirect){isDirect?this.$.addClass("js-direct"):this.$.removeClass("js-direct")},PaneHotel.prototype._dragStartHdl=function(clientX,clientY,e){this._setDirect(!0),_.forEach(this._calenders,function(calender,i){calender.dragStarted()})},PaneHotel.prototype._dragMoveHdl=function(dx,dy,ax,ay){_.forEach(this._calenders,function(calender,i){calender.dragMoved(dx)})},PaneHotel.prototype._dragEndDirHdl=function(dir){var _this4=this;this._setDirect(!1),_.forEach(this._calenders,function(calender,i){calender.dragEnded()});var distMonthIndex=_DisplayStore2.default.state.monthIndex+dir;(distMonthIndex<0||distMonthIndex>_Config2.default.maxMonthIndex)&&(dir=0),0!==dir?(_Action2.default.moveMonthIndex(dir),this.$.addClass("js-flick"),setTimeout(function(){_this4.$.removeClass("js-flick")},300)):this._moveToCurrentMonth(!1)},PaneHotel}();exports.default=PaneHotel},{"../../../../common/constants/Browsers":1,"../../../../common/stores/WindowStore":4,"../../../../common/utils/Draggee":6,"../../../../common/utils/Util":11,"../actions/Action":73,"../constants/Config":74,"../stores/DisplayStore":77,"./HotelCalender":86}],93:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _DisplayStore=require("../stores/DisplayStore"),_DisplayStore2=_interopRequireDefault(_DisplayStore),_ConditionStore=require("../stores/ConditionStore"),_ConditionStore2=_interopRequireDefault(_ConditionStore),_Config=require("../constants/Config"),PeopleRestrictModal=(_interopRequireDefault(_Config),function(){function PeopleRestrictModal($el,props){var _this=this;_classCallCheck(this,PeopleRestrictModal),this.$=$el,this.props=_.assign({},props||{}),this._shown={},_DisplayStore2.default.onChangeOneState("tab",function(){_this._shown={},_this._storeChangeHdl()}),_ConditionStore2.default.onChange(this._storeChangeHdl.bind(this)),this.$.find(".jsm-booking__restrictModalClose").on("click",this._switchVisibility.bind(this,!1))}return PeopleRestrictModal.prototype._storeChangeHdl=function(){var tab=_DisplayStore2.default.state.tab;_ConditionStore2.default.isPeopleOver3&&"karuizawa"!==tab&&!this._shown[tab]&&(this._shown[tab]=!0,this._switchVisibility(!0))},PeopleRestrictModal.prototype._switchVisibility=function(visible){var _this2=this;clearTimeout(this._delayId),visible?this.$.addClass("js-show js-visible"):(this.$.removeClass("js-show"),this._delayId=setTimeout(function(){_this2.$.removeClass("js-visible")},200))},PeopleRestrictModal}());exports.default=PeopleRestrictModal},{"../constants/Config":74,"../stores/ConditionStore":76,"../stores/DisplayStore":77}],94:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _DisplayStore=require("../stores/DisplayStore"),_DisplayStore2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_DisplayStore),ConditionPlan=function(){function ConditionPlan($el,props){_classCallCheck(this,ConditionPlan),this.$=$el,this.props=_.assign({},props||{}),this.$plans=this.$.find(".jsm-booking__plan"),_DisplayStore2.default.onChangeOneState("tab",this._tabChangeHdl.bind(this))}return ConditionPlan.prototype._tabChangeHdl=function(tab){this.$.switchClass("js-visible","_admin"!==tab),this.$plans.removeClass("js-visible").filter('[data-hotel="'+tab+'"]').addClass("js-visible")},ConditionPlan}();exports.default=ConditionPlan},{"../stores/DisplayStore":77}],95:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Action=require("../actions/Action"),_Config=(_interopRequireDefault(_Action),require("../constants/Config")),_makeCalender=(_interopRequireDefault(_Config),require("./makeCalender")),_UDate=(_interopRequireDefault(_makeCalender),require("../UDate")),_Util=(_interopRequireDefault(_UDate),require("../../../../common/utils/Util")),_Browsers=(_interopRequireDefault(_Util),require("../../../../common/constants/Browsers")),_Browsers2=_interopRequireDefault(_Browsers),Tooltip=function(){function Tooltip($el,props){_classCallCheck(this,Tooltip),this.$=$el,this.props=_.assign({},props||{}),this.$body=$(document.body),this._bindedBodyClick=this._bodyClickHdl.bind(this),this._active=!1,_Browsers2.default.desktop?this.$.find(".jsm-booking__tooltipTrigger").on("mouseenter",this._activate.bind(this,!0)).on("mouseleave",this._activate.bind(this,!1)):this.$.on("click",this._toggle.bind(this))}return Tooltip.prototype._toggle=function(){this._activate(!this._active)},Tooltip.prototype._activate=function(active){var _this=this;this._active!==active&&(this._active=active,clearTimeout(this._delayId),active?(this.$.addClass("js-active"),this.$body.on("mousedown touchstart",this._bindedBodyClick)):this._delayId=setTimeout(function(){_this.$.removeClass("js-active"),_this.$body.off("mousedown touchstart",_this._bindedBodyClick)},100))},Tooltip.prototype._bodyClickHdl=function(e){$.contains(this.$[0],e.target)||this.$[0]===e.target||this._activate(!1)},Tooltip}();exports.default=Tooltip},{"../../../../common/constants/Browsers":1,"../../../../common/utils/Util":11,"../UDate":72,"../actions/Action":73,"../constants/Config":74,"./makeCalender":96}],96:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.__esModule=!0,exports.default=function(props){props=_.assign({month:null,cellTemplate:"",onerow:!1,showPast:!1,outedateBefore:null},props);var index=0,allUDates=[];return{tableHtml:_.map(_.range(6),function(rowIndex){var rowHtml=_.compact(_.map(_.range(7),function(colIndex){
var d=index-props.month.week+1,udate=new _UDate2.default(new Date(props.month.yyyy,props.month.m-1,d)),currentMonth=udate.yyyy===_Util2.default.now.yyyy&&udate.m===_Util2.default.now.m&&udate.m===props.month.m,past=currentMonth&&udate.d<_Util2.default.now.d,outdate=past||udate.m!==props.month.m;if(props.outedateBefore&&udate.time<=props.outedateBefore.time&&(outdate=!0),props.showPast?past&&(outdate=!1):past=!1,props.onerow&&outdate)return void index++;var today=currentMonth&&udate.d===_Util2.default.now.d,cellHtml=_Util2.default.template(props.cellTemplate,{datestr:udate.str,date:udate.d,class_past:past?"js-past":"",class_outdate:outdate?"js-outdate":"",class_today:today?"js-today":""});return outdate||allUDates.push(udate),index++,cellHtml})).join("");return props.onerow?rowHtml:'<div class="jsm-booking__calenderRow">'+rowHtml+"</div>"}).join(""),allUDates:allUDates}};var _Config=require("../constants/Config"),_Util=(_interopRequireDefault(_Config),require("../../../../common/utils/Util")),_Util2=_interopRequireDefault(_Util),_UDate=require("../UDate"),_UDate2=_interopRequireDefault(_UDate),_Action=require("../actions/Action");_interopRequireDefault(_Action)},{"../../../../common/utils/Util":11,"../UDate":72,"../actions/Action":73,"../constants/Config":74}],97:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _eventemitter=require("eventemitter2"),_autoInit=require("../modules/auto-init"),_autoInit2=_interopRequireDefault(_autoInit),_Img=require("../modules/Img"),_Img2=_interopRequireDefault(_Img),_Settings=require("../Settings"),_Settings2=_interopRequireDefault(_Settings),_WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_FontplusHandler=require("../utils/FontplusHandler"),_FontplusHandler2=_interopRequireDefault(_FontplusHandler),Page=function(_EventEmitter){function Page($el,isFirst){_classCallCheck(this,Page);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));return _this.$=$el,_this._isFirst=isFirst,_this._moduleInitedIdx={},_this._scrollPer=0,_this._bindedBreakHdl=_this._breakHdl.bind(_this),_this._bindedResizeHdl=_this._resizeHdl.bind(_this),_this._bindedScrollHdl=_this._scrollHdl.bind(_this),_this}return _inherits(Page,_EventEmitter),Page.prototype.onReady=function(f){return this.on("ready",f),this},Page.prototype.onPreReady=function(f){return this.on("pre_ready",f),this},Page.prototype.onHidden=function(f){if(this._hideComplete)return f();this.on("hidden",f)},Page.prototype._triggerReady=function(){this._ready(),this.$.addClass("js-ready"),this.emit("ready")},Page.prototype._triggerPreReady=function(){this.emit("pre_ready")},Page.prototype.setup=function(isFirst){var _this2=this;this._isFirst=isFirst,this._setupCnt=0,_FontplusHandler2.default.onReady(function(){isFirst||_FontplusHandler2.default.reload(),_FontplusHandler2.default.onReloaded(_this2._setupCountup.bind(_this2))}),_WindowStore2.default.onBreak(this._bindedBreakHdl),this._breakHdl(),this._setup()},Page.prototype.clear=function(){this._switchBindResizeScroll(!1),this._clear(),_WindowStore2.default.offBreak(this._bindedBreakHdl),(0,_autoInit.clearModules)(this.$),this._setupCnt=-1,this.$.remove(),this.removeAllListeners(),_Util2.default.deleteAll(this)},Page.prototype._switchBindResizeScroll=function(isBind){isBind?(_WindowStore2.default.onResize(this._bindedResizeHdl).onScroll(this._bindedScrollHdl),this._resizeHdl(),this._setStayingTimer()):(_WindowStore2.default.offResize(this._bindedResizeHdl).offScroll(this._bindedScrollHdl),this._clearStayingTimer())},Page.prototype._firstAnchorScroll=function(){var hash=location.href.split("#")[1];if(hash){var $anchorlink=this.$.find('.jsm-anchorlink[data-name="'+hash+'"]');$anchorlink.eq(0)&&$anchorlink.eq(0).trigger("click")}},Page.prototype._setup=function(){this._setupCountup()},Page.prototype._ready=function(){},Page.prototype._clear=function(){},Page.prototype._setupCountup=function(){2===++this._setupCnt&&(this._triggerReady(),this._switchBindResizeScroll(!0),this._firstAnchorScroll())},Page.prototype._breakHdl=function(){var type=_WindowStore2.default.getIsPC().toString();this._moduleInitedIdx[type]||(this._moduleInitedIdx[type]=!0,(0,_autoInit2.default)(this._isFirst?this.$:null),_Img2.default.applyPostpone(),_Img2.default.boostLoading())},Page.prototype._resizeHdl=function(){var totalHeight=$(".bodyInner")[0].scrollHeight||this.$.offset().top+this.$.outerHeight();this._maxScrollTop=totalHeight-_WindowStore2.default.getHeight()},Page.prototype._scrollHdl=function(){var per=_WindowStore2.default.getScrollTop()/this._maxScrollTop;per=20*Math.round(100*per/20),(per=Math.min(100,Math.max(this._scrollPer,per)))!==this._scrollPer&&(this._scrollPer=per,window.HOSHINOYA.GA.scrollEvent("scroll_rate",per+"%",!0))},Page.prototype.readyForShow=function(){this.$.addClass("js-visibleReady")},Page.prototype.show=function(){var _this3=this;this.$.addClass("js-visible"),this._mainCopyDelayId=setTimeout(function(){var $mainCopy=_this3.$.find('[data-pagemaincopy="1"]');$mainCopy.removeAttr("data-cancelauto"),(0,_autoInit2.default)($mainCopy.parent())},500)},Page.prototype.hide=function(){var _this4=this;this._hideStarted||(this._hideStarted=!0,(0,_autoInit.preClearModules)(this.$),clearTimeout(this._mainCopyDelayId),this.$.addClass("js-hidden"),setTimeout(function(){_this4._hideComplete=!0,_this4.emit("hidden")},_Settings2.default.page.hide_duration))},Page.prototype._setStayingTimer=function(){this._stayingID=setTimeout(function(){window.HOSHINOYA.GA.stayingEvent("stay_time","30sec")},3e4)},Page.prototype._clearStayingTimer=function(){clearTimeout(this._stayingID)},Page}(_eventemitter.EventEmitter2);exports.default=Page},{"../../common/stores/WindowStore":4,"../../common/utils/Util":11,"../Settings":21,"../modules/Img":38,"../modules/auto-init":68,"../utils/FontplusHandler":103,eventemitter2:117}],98:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _Page2=require("./Page"),_Page3=_interopRequireDefault(_Page2),_Settings=require("../Settings"),_autoInit=(_interopRequireDefault(_Settings),require("../modules/auto-init")),_autoInit2=_interopRequireDefault(_autoInit),PageAbout=function(_Page){function PageAbout($el,isFirst){return _classCallCheck(this,PageAbout),_possibleConstructorReturn(this,_Page.call(this,$el,isFirst))}return _inherits(PageAbout,_Page),PageAbout.prototype._ready=function(){var _this2=this;this.$.find(".jsm-pageabout__content").addClass("js-visible"),setTimeout(function(){(0,_autoInit2.default)(_this2.$),_this2._hotels=_this2.$.find(".jsm-tophotels").data("jsm-instance"),_this2._hotels.show()},0)},PageAbout.prototype._clear=function(){},PageAbout}(_Page3.default);exports.default=PageAbout},{"../Settings":21,"../modules/auto-init":68,"./Page":97}],99:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _Page2=require("./Page"),_Page3=_interopRequireDefault(_Page2),_Settings=require("../Settings"),HAS_DETAIL_DIRS=(_interopRequireDefault(_Settings),["/experience/"]),ALT_DIRS={experienceblock:"experience",experiencechild:"experience"},REPLACE_DIRS={"/hotels/":"/"},REMOVE_LAST_DIRS=["important/"],PageNotfound=function(_Page){function PageNotfound($el,isFirst){return _classCallCheck(this,PageNotfound),_possibleConstructorReturn(this,_Page.call(this,$el,isFirst))}return _inherits(PageNotfound,_Page),PageNotfound.prototype._setup=function(){var hasDetailDir=_.find(HAS_DETAIL_DIRS,function(dir){return _.includes(location.href,dir)});if(hasDetailDir)return void location.replace(location.href.split(hasDetailDir)[0]+hasDetailDir);var currentHref=location.href;_.forEach(ALT_DIRS,function(dist,src){currentHref=currentHref.split(src).join(dist)}),_.forEach(["ja","en","id","zhcn","zhtw"],function(lang){var langPath="_"+lang;if(_.includes(currentHref,langPath)){var matched=!1,targetHref=_.reduce(currentHref.split("/"),function(res,dir){return matched?res:(_.includes(dir,langPath)&&(matched=!0,dir=("ja"===lang?"":lang+"/")+dir.split(langPath)[0]),res+=dir+"/")},"");location.replace(targetHref)}}),_.forEach(REPLACE_DIRS,function(dist,src){_.includes(location.href,src)&&location.replace(location.href.split(src).join(dist))}),_.forEach(REMOVE_LAST_DIRS,function(match){_.includes(location.href,match)&&location.replace(location.href.split(match)[0])}),this._setupCountup()},PageNotfound}(_Page3.default);exports.default=PageNotfound},{"../Settings":21,"./Page":97}],100:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _Page2=require("./Page"),_Page3=_interopRequireDefault(_Page2),_Settings=require("../Settings"),_Settings2=_interopRequireDefault(_Settings),_autoInit=require("../modules/auto-init"),_autoInit2=_interopRequireDefault(_autoInit),_WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),PageOutline=function(_Page){function PageOutline($el,isFirst){return _classCallCheck(this,PageOutline),_possibleConstructorReturn(this,_Page.call(this,$el,isFirst))}return _inherits(PageOutline,_Page),PageOutline.prototype._setup=function(){var _this2=this;this._loading=this.$.find(".jsm-outlinelogoloading").data("jsm-instance"),this._hero=this.$.find(".jsm-outlinehero").data("jsm-instance"),this._waitId=setTimeout(function(){if(!_Settings2.default.query.intro&&(_this2._hero.isImageLoaded||!_this2._isFirst||_Settings2.default.query.skip))return _this2._skipped=!0,_this2._loading.skip(),void _this2._hero.onLoad(function(){_this2._setupCountup()});_this2._triggerPreReady(),_this2._loading.start(),_WindowStore2.default.scrollTo(0),_this2._loading.onHighlight(function(){_WindowStore2.default.scrollTo(0),_this2._loading.hide(),_this2._setupCountup()})},_Settings2.default.top.img_wait_delay)},PageOutline.prototype._ready=function(){var _this3=this;this._hero.ready(),this._waitId=setTimeout(function(){var $content=_this3.$.find(".jsm-pageoutline__content");$content.addClass("js-visible"),setTimeout(function(){(0,_autoInit2.default)($content),_this3._waitId=setTimeout(function(){_this3._hero.intro()},_this3._skipped?0:1500),_this3._hero.introBooking(_this3._skipped?240:33)},33)},this._skipped?0:1e3)},PageOutline.prototype._clear=function(){clearTimeout(this._waitId)},PageOutline}(_Page3.default);exports.default=PageOutline},{"../../common/stores/WindowStore":4,"../Settings":21,"../modules/auto-init":68,"./Page":97}],101:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _Page2=require("./Page"),_Page3=_interopRequireDefault(_Page2),_Settings=require("../Settings"),_autoInit=(_interopRequireDefault(_Settings),require("../modules/auto-init")),PageTop=(_interopRequireDefault(_autoInit),function(_Page){function PageTop($el,isFirst){return _classCallCheck(this,PageTop),_possibleConstructorReturn(this,_Page.call(this,$el,isFirst))}return _inherits(PageTop,_Page),PageTop.prototype._ready=function(){var _this2=this;this._hero=this.$.find(".jsm-tophero").data("jsm-instance"),this._hotels=this.$.find(".jsm-tophotels").data("jsm-instance"),this._hero.onAllReady(function(){_this2._hotels.show()}),this._hotels.onImgLoad(function(){_this2._hero.hotelsReady()}),this._hero.intro()},PageTop.prototype._clear=function(){},PageTop}(_Page3.default));exports.default=PageTop},{"../Settings":21,"../modules/auto-init":68,"./Page":97}],102:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _Page2=require("./Page"),_Page3=_interopRequireDefault(_Page2),_Settings=require("../Settings"),_FontplusHandler=(_interopRequireDefault(_Settings),require("../utils/FontplusHandler")),_FontplusHandler2=_interopRequireDefault(_FontplusHandler),PageVoices=function(_Page){function PageVoices($el,isFirst){return _classCallCheck(this,PageVoices),_possibleConstructorReturn(this,_Page.call(this,$el,isFirst))}return _inherits(PageVoices,_Page),PageVoices.prototype._setup=function(){var _this2=this;this._news=this.$.find(".jsm-news").data("jsm-instance"),this._news.setup(function(){_FontplusHandler2.default.reload(),_FontplusHandler2.default.onReloaded(function(){_this2._setupCountup()})})},PageVoices.prototype._ready=function(){},PageVoices.prototype._clear=function(){clearTimeout(this._waitId)},PageVoices}(_Page3.default);exports.default=PageVoices},{"../Settings":21,"../utils/FontplusHandler":103,"./Page":97}],103:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Browsers=require("../../common/constants/Browsers"),_Settings=(_interopRequireDefault(_Browsers),require("../Settings")),_Util=(_interopRequireDefault(_Settings),require("../../common/utils/Util")),_Interpolate=(_interopRequireDefault(_Util),require("../../common/utils/Interpolate")),_asyncLoadScript=(_interopRequireDefault(_Interpolate),require("./asyncLoadScript")),_asyncLoadScript2=_interopRequireDefault(_asyncLoadScript),NO_LOAD="ja"!==window.HOSHINOYA.lang,SKIP_WAIT="cn"===window.HOSHINOYA.domain,FontplusHandler=function(){function FontplusHandler(){_classCallCheck(this,FontplusHandler),this._ready=!1,this._readyCallbacks=[]}return FontplusHandler.prototype.onReady=function(callback){if(NO_LOAD&&(this._ready=!0),this._ready||window.FONTPLUS)return callback();SKIP_WAIT?callback():this._readyCallbacks.push(callback),this._isStartedLoadScript||(this._isStartedLoadScript=!0,(0,_asyncLoadScript2.default)("//webfont.fontplus.jp/accessor/script/fontplus.js?BW98L5QNT5M%3D&box=bXOYBX9u24A%3D&aa=1"),this._waitReallyLoaded(this._loadedHdl.bind(this)),setTimeout(this._loadedHdl.bind(this),5e3))},FontplusHandler.prototype._waitReallyLoaded=function(callback){if(!window.FONTPLUS)return setTimeout(this._waitReallyLoaded.bind(this,callback),33);callback()},FontplusHandler.prototype._loadedHdl=function(){return this._loaded},FontplusHandler.prototype.reload=function(){window.FONTPLUS&&window.FONTPLUS.reload(!0)},FontplusHandler.prototype.onReloaded=function(callback){function complete(){isCompleted||(isCompleted=!0,callback())}if(!window.FONTPLUS||SKIP_WAIT)return callback();var isCompleted=!1;window.FONTPLUS.isloading()?(window.FONTPLUS.attachCompleteEvent(complete),setTimeout(complete,1e3)):setTimeout(complete,33)},FontplusHandler}();exports.default=new FontplusHandler},{"../../common/constants/Browsers":1,"../../common/utils/Interpolate":7,"../../common/utils/Util":11,"../Settings":21,"./asyncLoadScript":110}],104:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Browsers=require("../../common/constants/Browsers"),_Settings=(_interopRequireDefault(_Browsers),require("../Settings")),_Util=(_interopRequireDefault(_Settings),require("../../common/utils/Util")),_Util2=_interopRequireDefault(_Util),_Interpolate=require("../../common/utils/Interpolate"),ModalCtrl=(_interopRequireDefault(_Interpolate),function(){function ModalCtrl(options){_classCallCheck(this,ModalCtrl),this.options=_.assign({hash:"modalName",$close:null,onOpen:null,onClose:null},options),this._opened=!1,this._isOpendHash()&&(this._opened=!0,this.closed(!0),this._hashChangeHdl()),this.$window=$(window),this._bindedHashChangeHdl=this._hashChangeHdl.bind(this),this.$window.on("hashchange popstate",this._bindedHashChangeHdl),this.options.$close&&this.options.$close.on("click",this.closed.bind(this,!1))}return ModalCtrl.prototype.opened=function(){this._opened||(location.hash="#"+this.options.hash)},ModalCtrl.prototype.closed=function(isFirst){if(isFirst||this._opened)return isFirst?(history.replaceState(null,null,location.href.split("#")[0]),void this._hashChangeHdl()):void window.history.back(-1)},ModalCtrl.prototype.destroy=function(){this.$window.off("hashchange popstate",this._bindedHashChangeHdl),this.options.$close&&this.options.$close.off(),_Util2.default.deleteAll(this)},ModalCtrl.prototype._hashChangeHdl=function(){var opened=this._isOpendHash();this._opened!==opened&&(this._opened=opened,opened?this.options.onOpen&&this.options.onOpen():this.options.onClose&&this.options.onClose())},ModalCtrl.prototype._isOpendHash=function(){return _.includes(location.hash,"#"+this.options.hash)},ModalCtrl}());exports.default=ModalCtrl},{"../../common/constants/Browsers":1,"../../common/utils/Interpolate":7,"../../common/utils/Util":11,"../Settings":21}],105:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _eventemitter=require("eventemitter2"),_Tween=require("../../common/utils/Tween"),_Tween2=_interopRequireDefault(_Tween),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),Nav=function(_EventEmitter){function Nav($el,count){_classCallCheck(this,Nav);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));return _this.$=$el,_this.make(count),_this.$.on("click",".jsm-nav__item",function(e){var num=parseInt(e.target.getAttribute("data-num"));_this.emit("change",num)}),_this}return _inherits(Nav,_EventEmitter),Nav.prototype.make=function(count){this._count!==count&&(this._count=count,this._tw&&this._tw.stop(),this.$items&&(this.$items.remove(),this.$items=null),this.$.html(_.map(_.range(count),function(i){return'<li class="jsm-nav__item" data-num="'+i+'"><span></span><i></i></li>'}).join("")),this.$items=this.$.find(".jsm-nav__item"))},Nav.prototype.destroy=function(){this.removeAllListeners(),this.$.off(),_Util2.default.deleteAll(this)},Nav.prototype.onChange=function(f){this.on("change",f)},Nav.prototype.activate=function(num,autoInterval){num=(num+999*this._count)%this._count,this.$items.removeClass("js-active"),this.$items.find("i").removeAttr("style");var $activeItem=this.$items.eq(num),$activeBar=$activeItem.find("i");$activeItem.addClass("js-active"),autoInterval&&(this._tw=this._tw||new _Tween2.default,this._tw.it({start:0,end:1,duration:autoInterval,easing:"linear",onProgress:function(v){$activeBar.css3({scaleX:v,scaleY:1})}}))},Nav.prototype.pause=function(){this._tw&&this._tw.pause()},Nav.prototype.resume=function(){this._tw&&this._tw.resume()},Nav}(_eventemitter.EventEmitter2);exports.default=Nav},{"../../common/utils/Tween":9,"../../common/utils/Util":11,eventemitter2:117}],106:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Browsers=require("../../common/constants/Browsers"),_Browsers2=_interopRequireDefault(_Browsers),_Settings=require("../Settings"),_Util=(_interopRequireDefault(_Settings),require("../../common/utils/Util")),_Util2=_interopRequireDefault(_Util),_Interpolate=require("../../common/utils/Interpolate"),_Interpolate2=_interopRequireDefault(_Interpolate),PanCtrl=function(){function PanCtrl(options){_classCallCheck(this,PanCtrl),this.options=_.assign({duration:1e3,tick:function(){}},options),this._step=33/(this.options.duration*(_Browsers2.default.touch?5:1)),this.reset(),this._bindedTimeout=this._timeout.bind(this),this._bindedTick=this._tick.bind(this)}return PanCtrl.prototype.reset=function(){this._per=_Browsers2.default.touch?.4:0,this._dir=1},PanCtrl.prototype.destroy=function(){this.stop(),_Util2.default.deleteAll(this)},PanCtrl.prototype.start=function(){this._started||(this._started=!0,this._timeout(),this._tick())},PanCtrl.prototype.stop=function(){this._started&&(this._started=!1,clearTimeout(this._timeoutId),_Util2.default.cancelAnimationFrame(this._tickId))},PanCtrl.prototype._timeout=function(){this._per+=this._step*this._dir,this._per>1&&(this._per=1,this._dir*=-1),this._per<0&&(this._per=0,this._dir*=-1),this._timeoutId=setTimeout(this._bindedTimeout,33)},PanCtrl.prototype._tick=function(){var per=_Interpolate2.default.it(this._per,0,1,1,"easeInOutSine");this.options.tick(per),this._tickId=_Util2.default.requestAnimationFrame(this._bindedTick)},PanCtrl}();exports.default=PanCtrl},{"../../common/constants/Browsers":1,"../../common/utils/Interpolate":7,"../../common/utils/Util":11,"../Settings":21}],107:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Browsers=require("../../common/constants/Browsers"),_Browsers2=_interopRequireDefault(_Browsers),ParallaxItem=function(){function ParallaxItem(options){_classCallCheck(this,ParallaxItem),this.options=_.assign({$wrapper:null,$body:null,amount:100},options),this._ecoScrollRangeMin=200}return _createClass(ParallaxItem,[{key:"ecoMinScrollTop",get:function(){return this._ecoMinScrollTop}},{key:"ecoMaxScrollTop",get:function(){return this._ecoMaxScrollTop}}]),ParallaxItem.prototype.destroy=function(){_Util2.default.deleteAll(this)},ParallaxItem.prototype.resized=function(sh){var areaH=this.options.$wrapper.outerHeight(),diffH=sh-areaH,top=_WindowStore2.default.calcElTop(this.options.$wrapper);if(this._ecoMinScrollTop=top-diffH,this._ecoMaxScrollTop=top,diffH<this._ecoScrollRangeMin){var oh2=.5*(this._ecoScrollRangeMin-diffH);this._ecoMinScrollTop-=oh2,this._ecoMaxScrollTop+=oh2}this._ecoRangeScrollTop=this._ecoMaxScrollTop-this._ecoMinScrollTop},ParallaxItem.prototype.setMinMax=function(min,max){this._ecoMinScrollTop=min,this._ecoMaxScrollTop=max,this._ecoRangeScrollTop=this._ecoMaxScrollTop-this._ecoMinScrollTop},ParallaxItem.prototype.update=function(scrollTop){var scrollPerEco=(scrollTop-this._ecoMinScrollTop)/this._ecoRangeScrollTop;(_Browsers2.default.tablet||_Browsers2.default.ie)&&(scrollPerEco=.5);var y=-this.options.amount*(1-scrollPerEco);this._y!==y&&(this._y=y,this.options.$body.css3({y:y}))},ParallaxItem}();exports.default=ParallaxItem},{"../../common/constants/Browsers":1,"../../common/stores/WindowStore":4,"../../common/utils/Util":11}],108:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function triggerResize(){_WindowStore2.default.triggerResize()}exports.__esModule=!0;var _Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),_WindowStore=require("../../common/stores/WindowStore"),_WindowStore2=_interopRequireDefault(_WindowStore),_Browsers=require("../../common/constants/Browsers"),_Browsers2=_interopRequireDefault(_Browsers),_Nav=require("./Nav"),_Nav2=_interopRequireDefault(_Nav),_Draggee=require("../../common/utils/Draggee"),_Draggee2=_interopRequireDefault(_Draggee),debouncedResizeId=null,ScreenModule=function(){function ScreenModule($el,options){_classCallCheck(this,ScreenModule),this.$=$el,this.options=_.assign({autointerval:0,color:"white"},options||{}),this.$area=this.$,this._num=-1,this._barrageKillDuration=0,this._navCount=0,this._waitInitTillFirstImgLoad=!1,this._needDrag=!1,this._ecoScrollRangeMin=200,this._pixelratio=_Browsers2.default.pixelratio,debouncedResizeId&&clearTimeout(debouncedResizeId),debouncedResizeId=setTimeout(triggerResize,2e3)}return ScreenModule.prototype.init=function(){if(this._waitInitTillFirstImgLoad){var firstImg=$.data(_.first(this.$.find(".jsm-img")),"jsm-instance");firstImg?firstImg.onLoad(this._init.bind(this)):this._init()}else this._init()},ScreenModule.prototype._init=function(){this.$canvas=this.$.find("canvas"),0===this.$canvas.length&&(this.$canvas=null),this.$canvas&&(this._stage=new PIXI.Container,this._renderer=PIXI.autoDetectRenderer(100,100,{view:this.$canvas[0],backgroundColor:"black"===this.options.color?0:16777215,antialias:!0}),this._renderer.render(this._stage)),_Browsers2.default.touch&&(this._targetScrollTop=this._scrollTop=0),this._bindedTick=this._tick.bind(this,null),this._bindedResizeHdl=this._resizeHdl.bind(this),this._bindedScrollHdl=this._scrollHdl.bind(this),_WindowStore2.default.onResize(this._bindedResizeHdl),_WindowStore2.default.onScroll(this._bindedScrollHdl),_WindowStore2.default.onFocus(this._bindedScrollHdl),this._screenInit(),this._initNeighour(),this._makeNav(),this._needDrag&&this._initDrag(),this._resizeHdl(),this._scrollHdl(),this._tick(!0)},ScreenModule.prototype.preClear=function(){this._needDrag&&this._clearDrag(),this._clearAutoTimer(),this._bindedResizeHdl&&_WindowStore2.default.offResize(this._bindedResizeHdl),this._bindedScrollHdl&&_WindowStore2.default.offScroll(this._bindedScrollHdl).offFocus(this._bindedScrollHdl),_Util2.default.cancelAnimationFrame(this._tickId)},ScreenModule.prototype.clear=function(){this._screenClear(),this._renderer&&(this._stage.destroy(),
this._renderer.destroy()),this._nav&&(this._nav.destroy(),this._nav=null),this._d&&(this._d.clear(),this._d=null),this.$.find(".jsm-next").off(),this.$.find(".jsm-prev").off(),_Util2.default.deleteAll(this)},ScreenModule.prototype._resizeHdl=function(){var sh=_WindowStore2.default.getHeight(),areaW=this.$area.outerWidth(),areaH=this.$area.outerHeight();0===areaH&&(areaH=sh);var top=_WindowStore2.default.calcElTop(this.$area);if(this._sh!==sh||this._areaW!==areaW||this._areaH!==areaH||this._top!==top){this._sh=sh,this._areaW=areaW,this._areaH=areaH,this._top=top,this._minScrollTop=Math.max(0,top-sh),this._maxScrollTop=top+areaH,this._rangeScrollTop=this._maxScrollTop-this._minScrollTop,this._visibleMinScrollTop=this._minScrollTop-100,this._visibleMaxScrollTop=this._maxScrollTop;var diffH=sh-areaH;if(this._ecoMinScrollTop=top-diffH,this._ecoMaxScrollTop=top,diffH<this._ecoScrollRangeMin){var oh2=.5*(this._ecoScrollRangeMin-diffH);this._ecoMinScrollTop-=oh2,this._ecoMaxScrollTop+=oh2}this._ecoRangeScrollTop=this._ecoMaxScrollTop-this._ecoMinScrollTop,this._screenResized()}},ScreenModule.prototype._scrollHdl=function(){var scrollTop=_WindowStore2.default.getScrollTop(),onScreen=scrollTop>=this._visibleMinScrollTop&&scrollTop<=this._visibleMaxScrollTop;onScreen&&!_WindowStore2.default.getIsFocus()&&(onScreen=!1),this._onScreen!==onScreen&&(onScreen?(void 0===this._onScreenFirst&&(this._onScreenFirst=!0,this._screenEnterFirst()),this._screenEnter(),this._resumeAutoTimer()):(this._screenLeave(),this._pauseAutoTimer())),this._targetScrollTop=scrollTop,this._onScreen=onScreen,this._screenScrolled()},ScreenModule.prototype._pauseAutoTimer=function(){this._clearAutoTimer(!0)},ScreenModule.prototype._resumeAutoTimer=function(){this._setAutoTimer(!0)},ScreenModule.prototype._setAutoTimer=function(){var _this=this,isResume=arguments.length>0&&void 0!==arguments[0]&&arguments[0],interval=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.autointerval;this.options.autointerval&&(this._startTime=(new Date).getTime(),isResume&&(this._elapsedTime&&(interval-=this._elapsedTime),this._nav&&this._nav.resume()),clearTimeout(this._timerId),this._timerId=setTimeout(function(){_this._screenAutoTimeout(),_this._next({byAuto:!0})},interval))},ScreenModule.prototype._clearAutoTimer=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(this._elapsedTime=(new Date).getTime()-this._startTime,this._nav&&this._nav.pause()):this._elapsedTime=0,clearTimeout(this._timerId)},ScreenModule.prototype._tick=function(forced){(this._onScreen||forced)&&(_Browsers2.default.tablet||_Browsers2.default.ie?this._scrollPer=this._scrollPerEco=.5:(_Browsers2.default.touch?this._scrollTop+=.6*(this._targetScrollTop-this._scrollTop):this._scrollTop=this._targetScrollTop,this._scrollPer=Math.max(0,Math.min(1,(this._scrollTop-this._minScrollTop)/this._rangeScrollTop)),this._scrollPerEco=(this._targetScrollTop-this._ecoMinScrollTop)/this._ecoRangeScrollTop),this._screenTick(),this._render()),this._bindedTick&&(this._tickId=_Util2.default.requestAnimationFrame(this._bindedTick))},ScreenModule.prototype._render=function(){this._renderer&&(this._rendererW===this._areaW&&this._rendererH===this._areaH||(this._rendererW=this._areaW,this._rendererH=this._areaH,this._renderer.resize(this._areaW*this._pixelratio,this._areaH*this._pixelratio)),this._renderer.render(this._stage))},ScreenModule.prototype._next=function(){var switchOptions=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!switchOptions.forced&&this._barrageKilled||this._switch(this._num+1,_.assign({nextClicked:!0},switchOptions))},ScreenModule.prototype._prev=function(){var switchOptions=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!switchOptions.forced&&this._barrageKilled||this._switch(this._num-1,_.assign({prevClicked:!0},switchOptions))},ScreenModule.prototype._navChanged=function(num){var switchOptions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!switchOptions.forced&&this._barrageKilled||this._switch(num,_.assign({navClicked:!0},switchOptions))},ScreenModule.prototype._switch=function(num){var _this2=this,switchOptions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._setAutoTimer(this._num===num),this._screenSwitch(num,switchOptions),this._num=num,this._nav&&this._nav.activate(num,this.options.autointerval),this._barrageKillDuration&&(this._barrageKilled=!0,clearTimeout(this._barrageKillId),this._barrageKillId=setTimeout(function(){_this2._barrageKilled=!1},this._barrageKillDuration))},ScreenModule.prototype._initNeighour=function(){this.$.find(".jsm-next").on("click",this._next.bind(this)),this.$.find(".jsm-prev").on("click",this._prev.bind(this))},ScreenModule.prototype._makeNav=function(){var $nav=this.$.find(".jsm-nav");0!==$nav.length&&(this._nav=new _Nav2.default($nav,this._navCount),this._nav.onChange(this._navChanged.bind(this)))},ScreenModule.prototype._initDrag=function(){var _this3=this;_Browsers2.default.touch&&(this._d=new _Draggee2.default,this._d.init(this.$area[0]).onStart(function(clientX,clientY,e){_this3._screenDragStart(clientX,clientY,e)}).onMove(function(dx,dy,ax,ay){_this3._screenDragMove(dx,dy,ax,ay)}).onEnd(function(dx,dy,ax,ay){_this3._screenDragEnd(dx,dy,ax,ay)}).onEndDir(function(dir){_this3._screenDragEndDir(dir)}),this._screenInitDrag())},ScreenModule.prototype._clearDrag=function(){this._d&&this._d.clear()},ScreenModule.prototype._screenInit=function(){},ScreenModule.prototype._screenInitDrag=function(){},ScreenModule.prototype._screenClear=function(){},ScreenModule.prototype._screenResized=function(){},ScreenModule.prototype._screenScrolled=function(){},ScreenModule.prototype._screenEnterFirst=function(){},ScreenModule.prototype._screenEnter=function(){},ScreenModule.prototype._screenLeave=function(){},ScreenModule.prototype._screenTick=function(){},ScreenModule.prototype._screenAutoTimeout=function(){},ScreenModule.prototype._screenSwitch=function(num,switchOptions){},ScreenModule.prototype._screenDragStart=function(clientX,clientY,e){},ScreenModule.prototype._screenDragMove=function(dx,dy,ax,ay){},ScreenModule.prototype._screenDragEnd=function(dx,dy,ax,ay){},ScreenModule.prototype._screenDragEndDir=function(dir){},ScreenModule}();exports.default=ScreenModule},{"../../common/constants/Browsers":1,"../../common/stores/WindowStore":4,"../../common/utils/Draggee":6,"../../common/utils/Util":11,"./Nav":105}],109:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Browsers=require("../../common/constants/Browsers"),_Browsers2=_interopRequireDefault(_Browsers),_Settings=require("../Settings"),_Settings2=_interopRequireDefault(_Settings),_Util=require("../../common/utils/Util"),_Util2=_interopRequireDefault(_Util),SpritePic=function(){function SpritePic(img,options){_classCallCheck(this,SpritePic),this._img=img,this.options=_.assign({roundrect:!1,parallax:0,parallax_x:0,pixelratio:_Browsers2.default.pixelratio,onImgLoad:null},options),this._el=new PIXI.Container,this._mask=new PIXI.Graphics,this._container=new PIXI.Container,this._parallaxWrap=new PIXI.Container,this._image=new PIXI.Sprite,this._mask.lineStyle(0),this._container.mask=this._mask,this._container.addChild(this._parallaxWrap),this._parallaxWrap.addChild(this._image),this._el.addChild(this._container),this._el.addChild(this._mask),this._el.visible=!1,this._img.onLoad(this._imageLoadHdl.bind(this)),this._x=this._y=this._w=this._h=0}return SpritePic.prototype.destroy=function(){this._el.parent&&this._el.parent.removeChild(this._el),this._el.destroy(),_Util2.default.deleteAll(this)},SpritePic.prototype._imageLoadHdl=function(){this._imageW=this._img.w,this._imageH=this._img.h,this._image.texture=this._img.texture,this._el.visible=!0,this._fitImages(),this.options.onImgLoad&&this.options.onImgLoad(this)},SpritePic.prototype.setPos=function(x,y){this._x===x&&this._y===y||(this._x=x,this._y=y,this._el.position.set(x*this.options.pixelratio,y*this.options.pixelratio))},SpritePic.prototype.setSize=function(w,h){this._w===w&&this._h===h||(this._w=w,this._h=h,this._fillMask(this._mask),this._fitImages())},SpritePic.prototype._fillMask=function(mask){mask.clear(),mask.beginFill(16776960,1);var realW=this._w*this.options.pixelratio,realH=this._h*this.options.pixelratio;this.options.roundrect?mask.drawRoundedRect(0,0,realW,realH,_Settings2.default.spritepic.roundness):mask.drawRect(0,0,realW,realH),mask.endFill()},SpritePic.prototype._fitImages=function(){if(!this._w||!this._imageW)return this;var w=this._w,frameW=w+this.options.parallax_x,frameH=this._h+this.options.parallax;this._resizeImage(this._image,frameW,frameH)},SpritePic.prototype._resizeImage=function(image,frameW,frameH){var scale=Math.max(frameW/this._imageW,frameH/this._imageH),imageW=this._imageW*scale,imageH=this._imageH*scale,imageX=.5*(frameW-imageW),imageY=.5*(frameH-imageH);image.scale.set(scale*this.options.pixelratio,scale*this.options.pixelratio),image.position.set(imageX*this.options.pixelratio,imageY*this.options.pixelratio)},SpritePic.prototype.tickParallax=function(scrollPer){this.options.parallax&&(this._parallaxWrap.position.y=-this.options.parallax*(1-scrollPer)*this.options.pixelratio)},SpritePic.prototype.tickParallaxX=function(xPer){this.options.parallax_x&&(this._parallaxWrap.position.x=-this.options.parallax_x*xPer*this.options.pixelratio)},_createClass(SpritePic,[{key:"el",get:function(){return this._el}}]),SpritePic}();exports.default=SpritePic},{"../../common/constants/Browsers":1,"../../common/utils/Util":11,"../Settings":21}],110:[function(require,module,exports){"use strict";function hideImgLoading(path,callback){var timeout=arguments.length>2&&void 0!==arguments[2]?arguments[2]:7,isDone=!1,head=document.getElementsByTagName("head")[0],script=document.createElement("script");script.async=!0,script.src=path,head.appendChild(script);var onload=function(){isDone||(isDone=!0,script.onload=script.onreadystatechange=null,callback&&callback())},loadCheck=function(){(!script.readyState||"loaded"===script.readyState||"complete"===script.readyState)&&onload()};script.addEventListener("load",loadCheck),script.addEventListener("readystatechange",loadCheck),script.onload=script.onreadystatechange=loadCheck,setTimeout(onload,timeout)}exports.__esModule=!0,exports.default=hideImgLoading},{}],111:[function(require,module,exports){"use strict";function hideImgLoading($wrap){var isDirect=arguments.length>1&&void 0!==arguments[1]&&arguments[1],$imgloading=$wrap.find(".jsm-imgloading");isDirect?$imgloading.remove():($imgloading.addClass("js-hidden"),setTimeout(function(){$imgloading.remove()},900))}exports.__esModule=!0,exports.default=hideImgLoading},{}],112:[function(require,module,exports){"use strict";function isDarkPage(url){var paths=_.compact(_Util2.default.abs2rel(url).split("#")[0].split("?")[0].split("/"));return paths=_.filter(paths,function(p){return!("en"===p||"id"===p||"zhcn"===p||"zhtw"===p)}),0===paths.length||"about"===paths[0]}exports.__esModule=!0;var _Util=require("../../common/utils/Util"),_Util2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Util);window.isDarkPage=isDarkPage,exports.default=isDarkPage},{"../../common/utils/Util":11}],113:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(logoAnime){function rotate(){0===hotels.length&&(hotels=HOSHINOYA.hotels.slice());var hotel=hotels.splice(0,1)[0],isBlack=!isDarkTheme;logoAnime.switchIcon(hotel,{isSlow:!0,noScale:!0,isBlack:isBlack}),setTimeout(rotate,2100)}if(logoAnime&&!logoAnime.isRotating){logoAnime.isRotating=!0;var isDarkTheme=_.some($(".theme-dark"),function(el){return $.contains(el,logoAnime.$[0])}),hotels=[];logoAnime.showDirect(),rotate()}}},{}],114:[function(require,module,exports){"use strict";"use restrict";function countTrailingZeros(v){var c=32;return v&=-v,v&&c--,65535&v&&(c-=16),16711935&v&&(c-=8),252645135&v&&(c-=4),858993459&v&&(c-=2),1431655765&v&&(c-=1),c}exports.INT_BITS=32,exports.INT_MAX=2147483647,exports.INT_MIN=-1<<31,exports.sign=function(v){return(v>0)-(v<0)},exports.abs=function(v){var mask=v>>31;return(v^mask)-mask},exports.min=function(x,y){return y^(x^y)&-(x<y)},exports.max=function(x,y){return x^(x^y)&-(x<y)},exports.isPow2=function(v){return!(v&v-1||!v)},exports.log2=function(v){var r,shift;return r=(v>65535)<<4,v>>>=r,shift=(v>255)<<3,v>>>=shift,r|=shift,shift=(v>15)<<2,v>>>=shift,r|=shift,shift=(v>3)<<1,v>>>=shift,(r|=shift)|v>>1},exports.log10=function(v){return v>=1e9?9:v>=1e8?8:v>=1e7?7:v>=1e6?6:v>=1e5?5:v>=1e4?4:v>=1e3?3:v>=100?2:v>=10?1:0},exports.popCount=function(v){return v-=v>>>1&1431655765,16843009*((v=(858993459&v)+(v>>>2&858993459))+(v>>>4)&252645135)>>>24},exports.countTrailingZeros=countTrailingZeros,exports.nextPow2=function(v){return v+=0===v,--v,v|=v>>>1,v|=v>>>2,v|=v>>>4,v|=v>>>8,(v|=v>>>16)+1},exports.prevPow2=function(v){return v|=v>>>1,v|=v>>>2,v|=v>>>4,v|=v>>>8,(v|=v>>>16)-(v>>>1)},exports.parity=function(v){return v^=v>>>16,v^=v>>>8,v^=v>>>4,27030>>>(v&=15)&1};var REVERSE_TABLE=new Array(256);!function(tab){for(var i=0;i<256;++i){var v=i,r=i,s=7;for(v>>>=1;v;v>>>=1)r<<=1,r|=1&v,--s;tab[i]=r<<s&255}}(REVERSE_TABLE),exports.reverse=function(v){return REVERSE_TABLE[255&v]<<24|REVERSE_TABLE[v>>>8&255]<<16|REVERSE_TABLE[v>>>16&255]<<8|REVERSE_TABLE[v>>>24&255]},exports.interleave2=function(x,y){return x&=65535,x=16711935&(x|x<<8),x=252645135&(x|x<<4),x=858993459&(x|x<<2),x=1431655765&(x|x<<1),y&=65535,y=16711935&(y|y<<8),y=252645135&(y|y<<4),y=858993459&(y|y<<2),y=1431655765&(y|y<<1),x|y<<1},exports.deinterleave2=function(v,n){return v=v>>>n&1431655765,v=858993459&(v|v>>>1),v=252645135&(v|v>>>2),v=16711935&(v|v>>>4),(v=65535&(v|v>>>16))<<16>>16},exports.interleave3=function(x,y,z){return x&=1023,x=4278190335&(x|x<<16),x=251719695&(x|x<<8),x=3272356035&(x|x<<4),x=1227133513&(x|x<<2),y&=1023,y=4278190335&(y|y<<16),y=251719695&(y|y<<8),y=3272356035&(y|y<<4),y=1227133513&(y|y<<2),x|=y<<1,z&=1023,z=4278190335&(z|z<<16),z=251719695&(z|z<<8),z=3272356035&(z|z<<4),z=1227133513&(z|z<<2),x|z<<2},exports.deinterleave3=function(v,n){return v=v>>>n&1227133513,v=3272356035&(v|v>>>2),v=251719695&(v|v>>>4),v=4278190335&(v|v>>>8),(v=1023&(v|v>>>16))<<22>>22},exports.nextCombination=function(v){var t=v|v-1;return t+1|(~t&-~t)-1>>>countTrailingZeros(v)+1}},{}],115:[function(require,module,exports){(function(process,global,setImmediate){!function(e){if("object"==typeof exports&&void 0!==module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:void 0!==global?f=global:"undefined"!=typeof self&&(f=self),f.Promise=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof _dereq_&&_dereq_;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof _dereq_&&_dereq_,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise){function any(promises){var ret=new SomePromiseArray(promises),promise=ret.promise();return ret.setHowMany(1),ret.setUnwrap(),ret.init(),promise}var SomePromiseArray=Promise._SomePromiseArray;Promise.any=function(promises){return any(promises)},Promise.prototype.any=function(){return any(this)}}},{}],2:[function(_dereq_,module,exports){"use strict";function Async(){this._isTickUsed=!1,this._lateQueue=new Queue(16),this._normalQueue=new Queue(16),this._trampolineEnabled=!0;var self=this;this.drainQueues=function(){self._drainQueues()},this._schedule=schedule.isStatic?schedule(this.drainQueues):schedule}function AsyncInvokeLater(fn,receiver,arg){this._lateQueue.push(fn,receiver,arg),this._queueTick()}function AsyncInvoke(fn,receiver,arg){this._normalQueue.push(fn,receiver,arg),this._queueTick()}function AsyncSettlePromises(promise){this._normalQueue._pushOne(promise),this._queueTick()}var firstLineError;try{throw new Error}catch(e){firstLineError=e}var schedule=_dereq_("./schedule.js"),Queue=_dereq_("./queue.js"),util=_dereq_("./util.js");Async.prototype.disableTrampolineIfNecessary=function(){util.hasDevTools&&(this._trampolineEnabled=!1)},Async.prototype.enableTrampoline=function(){this._trampolineEnabled||(this._trampolineEnabled=!0,this._schedule=function(fn){setTimeout(fn,0)})},Async.prototype.haveItemsQueued=function(){return this._normalQueue.length()>0},Async.prototype.throwLater=function(fn,arg){if(1===arguments.length&&(arg=fn,fn=function(){throw arg}),"undefined"!=typeof setTimeout)setTimeout(function(){fn(arg)},0);else try{this._schedule(function(){fn(arg)})}catch(e){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")}},util.hasDevTools?(schedule.isStatic&&(schedule=function(fn){setTimeout(fn,0)}),Async.prototype.invokeLater=function(fn,receiver,arg){this._trampolineEnabled?AsyncInvokeLater.call(this,fn,receiver,arg):this._schedule(function(){setTimeout(function(){fn.call(receiver,arg)},100)})},Async.prototype.invoke=function(fn,receiver,arg){this._trampolineEnabled?AsyncInvoke.call(this,fn,receiver,arg):this._schedule(function(){fn.call(receiver,arg)})},Async.prototype.settlePromises=function(promise){this._trampolineEnabled?AsyncSettlePromises.call(this,promise):this._schedule(function(){promise._settlePromises()})}):(Async.prototype.invokeLater=AsyncInvokeLater,Async.prototype.invoke=AsyncInvoke,Async.prototype.settlePromises=AsyncSettlePromises),Async.prototype.invokeFirst=function(fn,receiver,arg){this._normalQueue.unshift(fn,receiver,arg),this._queueTick()},Async.prototype._drainQueue=function(queue){for(;queue.length()>0;){var fn=queue.shift();if("function"==typeof fn){var receiver=queue.shift(),arg=queue.shift();fn.call(receiver,arg)}else fn._settlePromises()}},Async.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._drainQueue(this._lateQueue)},Async.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},Async.prototype._reset=function(){this._isTickUsed=!1},module.exports=new Async,module.exports.firstLineError=firstLineError},{"./queue.js":28,"./schedule.js":31,"./util.js":38}],3:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL,tryConvertToPromise){var rejectThis=function(_,e){this._reject(e)},targetRejected=function(e,context){context.promiseRejectionQueued=!0,context.bindingPromise._then(rejectThis,rejectThis,null,this,e)},bindingResolved=function(thisArg,context){this._isPending()&&this._resolveCallback(context.target)},bindingRejected=function(e,context){context.promiseRejectionQueued||this._reject(e)};Promise.prototype.bind=function(thisArg){var maybePromise=tryConvertToPromise(thisArg),ret=new Promise(INTERNAL);ret._propagateFrom(this,1);var target=this._target();if(ret._setBoundTo(maybePromise),maybePromise instanceof Promise){var context={promiseRejectionQueued:!1,promise:ret,target:target,bindingPromise:maybePromise};target._then(INTERNAL,targetRejected,ret._progress,ret,context),maybePromise._then(bindingResolved,bindingRejected,ret._progress,ret,context)}else ret._resolveCallback(target);return ret},Promise.prototype._setBoundTo=function(obj){void 0!==obj?(this._bitField=131072|this._bitField,this._boundTo=obj):this._bitField=-131073&this._bitField},Promise.prototype._isBound=function(){return 131072==(131072&this._bitField)},Promise.bind=function(thisArg,value){var maybePromise=tryConvertToPromise(thisArg),ret=new Promise(INTERNAL);return ret._setBoundTo(maybePromise),maybePromise instanceof Promise?maybePromise._then(function(){ret._resolveCallback(value)},ret._reject,ret._progress,ret,null):ret._resolveCallback(value),ret}}},{}],4:[function(_dereq_,module,exports){"use strict";function noConflict(){try{Promise===bluebird&&(Promise=old)}catch(e){}return bluebird}var old;"undefined"!=typeof Promise&&(old=Promise);var bluebird=_dereq_("./promise.js")();bluebird.noConflict=noConflict,module.exports=bluebird},{"./promise.js":23}],5:[function(_dereq_,module,exports){"use strict";var cr=Object.create;if(cr){var callerCache=cr(null),getterCache=cr(null);callerCache[" size"]=getterCache[" size"]=0}module.exports=function(Promise){function ensureMethod(obj,methodName){var fn;if(null!=obj&&(fn=obj[methodName]),"function"!=typeof fn){var message="Object "+util.classString(obj)+" has no method '"+util.toString(methodName)+"'";throw new Promise.TypeError(message)}return fn}function caller(obj){return ensureMethod(obj,this.pop()).apply(obj,this)}function namedGetter(obj){return obj[this]}function indexedGetter(obj){var index=+this;return index<0&&(index=Math.max(0,index+obj.length)),obj[index]}var getGetter,util=_dereq_("./util.js"),canEvaluate=util.canEvaluate;util.isIdentifier;Promise.prototype.call=function(methodName){for(var $_len=arguments.length,args=new Array($_len-1),$_i=1;$_i<$_len;++$_i)args[$_i-1]=arguments[$_i];return args.push(methodName),this._then(caller,void 0,void 0,args,void 0)},Promise.prototype.get=function(propertyName){var getter,isIndex="number"==typeof propertyName;if(isIndex)getter=indexedGetter;else if(canEvaluate){var maybeGetter=getGetter(propertyName);getter=null!==maybeGetter?maybeGetter:namedGetter}else getter=namedGetter;return this._then(getter,void 0,void 0,propertyName,void 0)}}},{"./util.js":38}],6:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise){var errors=_dereq_("./errors.js"),async=_dereq_("./async.js"),CancellationError=errors.CancellationError;Promise.prototype._cancel=function(reason){if(!this.isCancellable())return this;for(var parent,promiseToReject=this;void 0!==(parent=promiseToReject._cancellationParent)&&parent.isCancellable();)promiseToReject=parent;this._unsetCancellable(),promiseToReject._target()._rejectCallback(reason,!1,!0)},Promise.prototype.cancel=function(reason){return this.isCancellable()?(void 0===reason&&(reason=new CancellationError),async.invokeLater(this._cancel,this,reason),this):this},Promise.prototype.cancellable=function(){return this._cancellable()?this:(async.enableTrampoline(),this._setCancellable(),this._cancellationParent=void 0,this)},Promise.prototype.uncancellable=function(){var ret=this.then();return ret._unsetCancellable(),ret},Promise.prototype.fork=function(didFulfill,didReject,didProgress){var ret=this._then(didFulfill,didReject,didProgress,void 0,void 0);return ret._setCancellable(),ret._cancellationParent=void 0,ret}}},{"./async.js":2,"./errors.js":13}],7:[function(_dereq_,module,exports){"use strict";module.exports=function(){function CapturedTrace(parent){this._parent=parent;var length=this._length=1+(void 0===parent?0:parent._length);captureStackTrace(this,CapturedTrace),length>32&&this.uncycle()}function reconstructStack(message,stacks){for(var i=0;i<stacks.length-1;++i)stacks[i].push("From previous event:"),stacks[i]=stacks[i].join("\n");return i<stacks.length&&(stacks[i]=stacks[i].join("\n")),message+"\n"+stacks.join("\n")}function removeDuplicateOrEmptyJumps(stacks){for(var i=0;i<stacks.length;++i)(0===stacks[i].length||i+1<stacks.length&&stacks[i][0]===stacks[i+1][0])&&(stacks.splice(i,1),i--)}function removeCommonRoots(stacks){for(var current=stacks[0],i=1;i<stacks.length;++i){for(var prev=stacks[i],currentLastIndex=current.length-1,currentLastLine=current[currentLastIndex],commonRootMeetPoint=-1,j=prev.length-1;j>=0;--j)if(prev[j]===currentLastLine){commonRootMeetPoint=j;break}for(var j=commonRootMeetPoint;j>=0;--j){var line=prev[j];if(current[currentLastIndex]!==line)break;current.pop(),currentLastIndex--}current=prev}}function cleanStack(stack){for(var ret=[],i=0;i<stack.length;++i){var line=stack[i],isTraceLine=stackFramePattern.test(line)||"    (No stack trace)"===line,isInternalFrame=isTraceLine&&shouldIgnore(line);isTraceLine&&!isInternalFrame&&(indentStackFrames&&" "!==line.charAt(0)&&(line="    "+line),ret.push(line))}return ret}function stackFramesAsArray(error){for(var stack=error.stack.replace(/\s+$/g,"").split("\n"),i=0;i<stack.length;++i){var line=stack[i];if("    (No stack trace)"===line||stackFramePattern.test(line))break}return i>0&&(stack=stack.slice(i)),stack}function formatNonError(obj){var str;if("function"==typeof obj)str="[function "+(obj.name||"anonymous")+"]";else{str=obj.toString();if(/\[object [a-zA-Z0-9$_]+\]/.test(str))try{str=JSON.stringify(obj)}catch(e){}0===str.length&&(str="(empty array)")}return"(<"+snip(str)+">, no stack trace)"}function snip(str){return str.length<41?str:str.substr(0,38)+"..."}function parseLineInfo(line){var matches=line.match(parseLineInfoRegex);if(matches)return{fileName:matches[1],line:parseInt(matches[2],10)}}var warn,async=_dereq_("./async.js"),util=_dereq_("./util.js"),bluebirdFramePattern=/[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/,stackFramePattern=null,formatStack=null,indentStackFrames=!1;util.inherits(CapturedTrace,Error),CapturedTrace.prototype.uncycle=function(){var length=this._length;if(!(length<2)){for(var nodes=[],stackToIndex={},i=0,node=this;void 0!==node;++i)nodes.push(node),node=node._parent;length=this._length=i;for(var i=length-1;i>=0;--i){var stack=nodes[i].stack;void 0===stackToIndex[stack]&&(stackToIndex[stack]=i)}for(var i=0;i<length;++i){var currentStack=nodes[i].stack,index=stackToIndex[currentStack];if(void 0!==index&&index!==i){index>0&&(nodes[index-1]._parent=void 0,nodes[index-1]._length=1),nodes[i]._parent=void 0,nodes[i]._length=1;var cycleEdgeNode=i>0?nodes[i-1]:this;index<length-1?(cycleEdgeNode._parent=nodes[index+1],cycleEdgeNode._parent.uncycle(),cycleEdgeNode._length=cycleEdgeNode._parent._length+1):(cycleEdgeNode._parent=void 0,cycleEdgeNode._length=1);for(var currentChildLength=cycleEdgeNode._length+1,j=i-2;j>=0;--j)nodes[j]._length=currentChildLength,currentChildLength++;return}}}},CapturedTrace.prototype.parent=function(){return this._parent},CapturedTrace.prototype.hasParent=function(){return void 0!==this._parent},CapturedTrace.prototype.attachExtraTrace=function(error){if(!error.__stackCleaned__){this.uncycle();for(var parsed=CapturedTrace.parseStackAndMessage(error),message=parsed.message,stacks=[parsed.stack],trace=this;void 0!==trace;)stacks.push(cleanStack(trace.stack.split("\n"))),trace=trace._parent;removeCommonRoots(stacks),removeDuplicateOrEmptyJumps(stacks),util.notEnumerableProp(error,"stack",reconstructStack(message,stacks)),util.notEnumerableProp(error,"__stackCleaned__",!0)}},CapturedTrace.parseStackAndMessage=function(error){var stack=error.stack,message=error.toString();return stack="string"==typeof stack&&stack.length>0?stackFramesAsArray(error):["    (No stack trace)"],{message:message,stack:cleanStack(stack)}},CapturedTrace.formatAndLogError=function(error,title){if("undefined"!=typeof console){var message;if("object"==typeof error||"function"==typeof error){var stack=error.stack;message=title+formatStack(stack,error)}else message=title+String(error);"function"==typeof warn?warn(message):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(message)}},CapturedTrace.unhandledRejection=function(reason){CapturedTrace.formatAndLogError(reason,"^--- With additional stack trace: ")},CapturedTrace.isSupported=function(){return"function"==typeof captureStackTrace},CapturedTrace.fireRejectionEvent=function(name,localHandler,reason,promise){var localEventFired=!1;try{"function"==typeof localHandler&&(localEventFired=!0,"rejectionHandled"===name?localHandler(promise):localHandler(reason,promise))}catch(e){async.throwLater(e)}var globalEventFired=!1;try{globalEventFired=fireGlobalEvent(name,reason,promise)}catch(e){globalEventFired=!0,async.throwLater(e)}var domEventFired=!1;if(fireDomEvent)try{domEventFired=fireDomEvent(name.toLowerCase(),{reason:reason,promise:promise})}catch(e){domEventFired=!0,async.throwLater(e)}globalEventFired||localEventFired||domEventFired||"unhandledRejection"!==name||CapturedTrace.formatAndLogError(reason,"Unhandled rejection ")};var shouldIgnore=function(){return!1},parseLineInfoRegex=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;CapturedTrace.setBounds=function(firstLineError,lastLineError){if(CapturedTrace.isSupported()){for(var firstFileName,lastFileName,firstStackLines=firstLineError.stack.split("\n"),lastStackLines=lastLineError.stack.split("\n"),firstIndex=-1,lastIndex=-1,i=0;i<firstStackLines.length;++i){var result=parseLineInfo(firstStackLines[i]);if(result){firstFileName=result.fileName,firstIndex=result.line;break}}for(var i=0;i<lastStackLines.length;++i){var result=parseLineInfo(lastStackLines[i]);if(result){lastFileName=result.fileName,lastIndex=result.line;break}}firstIndex<0||lastIndex<0||!firstFileName||!lastFileName||firstFileName!==lastFileName||firstIndex>=lastIndex||(shouldIgnore=function(line){if(bluebirdFramePattern.test(line))return!0;var info=parseLineInfo(line);return!!(info&&info.fileName===firstFileName&&firstIndex<=info.line&&info.line<=lastIndex)})}};var fireDomEvent,captureStackTrace=function(){var v8stackFramePattern=/^\s*at\s*/,v8stackFormatter=function(stack,error){return"string"==typeof stack?stack:void 0!==error.name&&void 0!==error.message?error.toString():formatNonError(error)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit=Error.stackTraceLimit+6,stackFramePattern=v8stackFramePattern,formatStack=v8stackFormatter;var captureStackTrace=Error.captureStackTrace;return shouldIgnore=function(line){return bluebirdFramePattern.test(line)},function(receiver,ignoreUntil){Error.stackTraceLimit=Error.stackTraceLimit+6,captureStackTrace(receiver,ignoreUntil),Error.stackTraceLimit=Error.stackTraceLimit-6}}var err=new Error;if("string"==typeof err.stack&&err.stack.split("\n")[0].indexOf("stackDetection@")>=0)return stackFramePattern=/@/,formatStack=v8stackFormatter,indentStackFrames=!0,function(o){o.stack=(new Error).stack};var hasStackAfterThrow;try{throw new Error}catch(e){hasStackAfterThrow="stack"in e}return"stack"in err||!hasStackAfterThrow||"number"!=typeof Error.stackTraceLimit?(formatStack=function(stack,error){return"string"==typeof stack?stack:"object"!=typeof error&&"function"!=typeof error||void 0===error.name||void 0===error.message?formatNonError(error):error.toString()},null):(stackFramePattern=v8stackFramePattern,formatStack=v8stackFormatter,function(o){Error.stackTraceLimit=Error.stackTraceLimit+6;try{throw new Error}catch(e){o.stack=e.stack}Error.stackTraceLimit=Error.stackTraceLimit-6})}(),fireGlobalEvent=function(){if(util.isNode)return function(name,reason,promise){return"rejectionHandled"===name?process.emit(name,promise):process.emit(name,reason,promise)};var customEventWorks=!1,anyEventWorks=!0;try{var ev=new self.CustomEvent("test");customEventWorks=ev instanceof CustomEvent}catch(e){}if(!customEventWorks)try{var event=document.createEvent("CustomEvent");event.initCustomEvent("testingtheevent",!1,!0,{}),self.dispatchEvent(event)}catch(e){anyEventWorks=!1}anyEventWorks&&(fireDomEvent=function(type,detail){var event
;return customEventWorks?event=new self.CustomEvent(type,{detail:detail,bubbles:!1,cancelable:!0}):self.dispatchEvent&&(event=document.createEvent("CustomEvent"),event.initCustomEvent(type,!1,!0,detail)),!!event&&!self.dispatchEvent(event)});var toWindowMethodNameMap={};return toWindowMethodNameMap.unhandledRejection="onunhandledRejection".toLowerCase(),toWindowMethodNameMap.rejectionHandled="onrejectionHandled".toLowerCase(),function(name,reason,promise){var methodName=toWindowMethodNameMap[name],method=self[methodName];return!!method&&("rejectionHandled"===name?method.call(self,promise):method.call(self,reason,promise),!0)}}();return"undefined"!=typeof console&&void 0!==console.warn&&(warn=function(message){console.warn(message)},util.isNode&&process.stderr.isTTY?warn=function(message){process.stderr.write("[31m"+message+"[39m\n")}:util.isNode||"string"!=typeof(new Error).stack||(warn=function(message){console.warn("%c"+message,"color: red")})),CapturedTrace}},{"./async.js":2,"./util.js":38}],8:[function(_dereq_,module,exports){"use strict";module.exports=function(NEXT_FILTER){function CatchFilter(instances,callback,promise){this._instances=instances,this._callback=callback,this._promise=promise}function safePredicate(predicate,e){var safeObject={},retfilter=tryCatch(predicate).call(safeObject,e);return retfilter===errorObj?retfilter:keys(safeObject).length?(errorObj.e=new TypeError("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"),errorObj):retfilter}var util=_dereq_("./util.js"),errors=_dereq_("./errors.js"),tryCatch=util.tryCatch,errorObj=util.errorObj,keys=_dereq_("./es5.js").keys,TypeError=errors.TypeError;return CatchFilter.prototype.doFilter=function(e){for(var cb=this._callback,promise=this._promise,boundTo=promise._boundValue(),i=0,len=this._instances.length;i<len;++i){var item=this._instances[i],itemIsErrorType=item===Error||null!=item&&item.prototype instanceof Error;if(itemIsErrorType&&e instanceof item){var ret=tryCatch(cb).call(boundTo,e);return ret===errorObj?(NEXT_FILTER.e=ret.e,NEXT_FILTER):ret}if("function"==typeof item&&!itemIsErrorType){var shouldHandle=safePredicate(item,e);if(shouldHandle===errorObj){e=errorObj.e;break}if(shouldHandle){var ret=tryCatch(cb).call(boundTo,e);return ret===errorObj?(NEXT_FILTER.e=ret.e,NEXT_FILTER):ret}}}return NEXT_FILTER.e=e,NEXT_FILTER},CatchFilter}},{"./errors.js":13,"./es5.js":14,"./util.js":38}],9:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,CapturedTrace,isDebugging){function Context(){this._trace=new CapturedTrace(peekContext())}function createContext(){if(isDebugging())return new Context}function peekContext(){var lastIndex=contextStack.length-1;if(lastIndex>=0)return contextStack[lastIndex]}var contextStack=[];return Context.prototype._pushContext=function(){isDebugging()&&void 0!==this._trace&&contextStack.push(this._trace)},Context.prototype._popContext=function(){isDebugging()&&void 0!==this._trace&&contextStack.pop()},Promise.prototype._peekContext=peekContext,Promise.prototype._pushContext=Context.prototype._pushContext,Promise.prototype._popContext=Context.prototype._popContext,createContext}},{}],10:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,CapturedTrace){var unhandledRejectionHandled,possiblyUnhandledRejection,getDomain=Promise._getDomain,async=_dereq_("./async.js"),Warning=_dereq_("./errors.js").Warning,util=_dereq_("./util.js"),canAttachTrace=util.canAttachTrace,debugging=util.isNode&&(!!process.env.BLUEBIRD_DEBUG||"development"===process.env.NODE_ENV);return util.isNode&&0==process.env.BLUEBIRD_DEBUG&&(debugging=!1),debugging&&async.disableTrampolineIfNecessary(),Promise.prototype._ignoreRejections=function(){this._unsetRejectionIsUnhandled(),this._bitField=16777216|this._bitField},Promise.prototype._ensurePossibleRejectionHandled=function(){0==(16777216&this._bitField)&&(this._setRejectionIsUnhandled(),async.invokeLater(this._notifyUnhandledRejection,this,void 0))},Promise.prototype._notifyUnhandledRejectionIsHandled=function(){CapturedTrace.fireRejectionEvent("rejectionHandled",unhandledRejectionHandled,void 0,this)},Promise.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var reason=this._getCarriedStackTrace()||this._settledValue;this._setUnhandledRejectionIsNotified(),CapturedTrace.fireRejectionEvent("unhandledRejection",possiblyUnhandledRejection,reason,this)}},Promise.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=524288|this._bitField},Promise.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-524289&this._bitField},Promise.prototype._isUnhandledRejectionNotified=function(){return(524288&this._bitField)>0},Promise.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},Promise.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-2097153&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},Promise.prototype._isRejectionUnhandled=function(){return(2097152&this._bitField)>0},Promise.prototype._setCarriedStackTrace=function(capturedTrace){this._bitField=1048576|this._bitField,this._fulfillmentHandler0=capturedTrace},Promise.prototype._isCarryingStackTrace=function(){return(1048576&this._bitField)>0},Promise.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0},Promise.prototype._captureStackTrace=function(){return debugging&&(this._trace=new CapturedTrace(this._peekContext())),this},Promise.prototype._attachExtraTrace=function(error,ignoreSelf){if(debugging&&canAttachTrace(error)){var trace=this._trace;if(void 0!==trace&&ignoreSelf&&(trace=trace._parent),void 0!==trace)trace.attachExtraTrace(error);else if(!error.__stackCleaned__){var parsed=CapturedTrace.parseStackAndMessage(error);util.notEnumerableProp(error,"stack",parsed.message+"\n"+parsed.stack.join("\n")),util.notEnumerableProp(error,"__stackCleaned__",!0)}}},Promise.prototype._warn=function(message){var warning=new Warning(message),ctx=this._peekContext();if(ctx)ctx.attachExtraTrace(warning);else{var parsed=CapturedTrace.parseStackAndMessage(warning);warning.stack=parsed.message+"\n"+parsed.stack.join("\n")}CapturedTrace.formatAndLogError(warning,"")},Promise.onPossiblyUnhandledRejection=function(fn){var domain=getDomain();possiblyUnhandledRejection="function"==typeof fn?null===domain?fn:domain.bind(fn):void 0},Promise.onUnhandledRejectionHandled=function(fn){var domain=getDomain();unhandledRejectionHandled="function"==typeof fn?null===domain?fn:domain.bind(fn):void 0},Promise.longStackTraces=function(){if(async.haveItemsQueued()&&!1===debugging)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/DT1qyG\n");(debugging=CapturedTrace.isSupported())&&async.disableTrampolineIfNecessary()},Promise.hasLongStackTraces=function(){return debugging&&CapturedTrace.isSupported()},CapturedTrace.isSupported()||(Promise.longStackTraces=function(){},debugging=!1),function(){return debugging}}},{"./async.js":2,"./errors.js":13,"./util.js":38}],11:[function(_dereq_,module,exports){"use strict";var util=_dereq_("./util.js"),isPrimitive=util.isPrimitive;module.exports=function(Promise){var returner=function(){return this},thrower=function(){throw this},returnUndefined=function(){},throwUndefined=function(){throw void 0},wrapper=function(value,action){return 1===action?function(){throw value}:2===action?function(){return value}:void 0};Promise.prototype.return=Promise.prototype.thenReturn=function(value){return void 0===value?this.then(returnUndefined):isPrimitive(value)?this._then(wrapper(value,2),void 0,void 0,void 0,void 0):(value instanceof Promise&&value._ignoreRejections(),this._then(returner,void 0,void 0,value,void 0))},Promise.prototype.throw=Promise.prototype.thenThrow=function(reason){return void 0===reason?this.then(throwUndefined):isPrimitive(reason)?this._then(wrapper(reason,1),void 0,void 0,void 0,void 0):this._then(thrower,void 0,void 0,reason,void 0)}}},{"./util.js":38}],12:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){var PromiseReduce=Promise.reduce;Promise.prototype.each=function(fn){return PromiseReduce(this,fn,null,INTERNAL)},Promise.each=function(promises,fn){return PromiseReduce(promises,fn,null,INTERNAL)}}},{}],13:[function(_dereq_,module,exports){"use strict";function subError(nameProperty,defaultMessage){function SubError(message){if(!(this instanceof SubError))return new SubError(message);notEnumerableProp(this,"message","string"==typeof message?message:defaultMessage),notEnumerableProp(this,"name",nameProperty),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return inherits(SubError,Error),SubError}function OperationalError(message){if(!(this instanceof OperationalError))return new OperationalError(message);notEnumerableProp(this,"name","OperationalError"),notEnumerableProp(this,"message",message),this.cause=message,this.isOperational=!0,message instanceof Error?(notEnumerableProp(this,"message",message.message),notEnumerableProp(this,"stack",message.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}var _TypeError,_RangeError,es5=_dereq_("./es5.js"),Objectfreeze=es5.freeze,util=_dereq_("./util.js"),inherits=util.inherits,notEnumerableProp=util.notEnumerableProp,Warning=subError("Warning","warning"),CancellationError=subError("CancellationError","cancellation error"),TimeoutError=subError("TimeoutError","timeout error"),AggregateError=subError("AggregateError","aggregate error");try{_TypeError=TypeError,_RangeError=RangeError}catch(e){_TypeError=subError("TypeError","type error"),_RangeError=subError("RangeError","range error")}for(var methods="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),i=0;i<methods.length;++i)"function"==typeof Array.prototype[methods[i]]&&(AggregateError.prototype[methods[i]]=Array.prototype[methods[i]]);es5.defineProperty(AggregateError.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),AggregateError.prototype.isOperational=!0;var level=0;AggregateError.prototype.toString=function(){var indent=Array(4*level+1).join(" "),ret="\n"+indent+"AggregateError of:\n";level++,indent=Array(4*level+1).join(" ");for(var i=0;i<this.length;++i){for(var str=this[i]===this?"[Circular AggregateError]":this[i]+"",lines=str.split("\n"),j=0;j<lines.length;++j)lines[j]=indent+lines[j];str=lines.join("\n"),ret+=str+"\n"}return level--,ret},inherits(OperationalError,Error);var errorTypes=Error.__BluebirdErrorTypes__;errorTypes||(errorTypes=Objectfreeze({CancellationError:CancellationError,TimeoutError:TimeoutError,OperationalError:OperationalError,RejectionError:OperationalError,AggregateError:AggregateError}),notEnumerableProp(Error,"__BluebirdErrorTypes__",errorTypes)),module.exports={Error:Error,TypeError:_TypeError,RangeError:_RangeError,CancellationError:errorTypes.CancellationError,OperationalError:errorTypes.OperationalError,TimeoutError:errorTypes.TimeoutError,AggregateError:errorTypes.AggregateError,Warning:Warning}},{"./es5.js":14,"./util.js":38}],14:[function(_dereq_,module,exports){var isES5=function(){"use strict";return void 0===this}();if(isES5)module.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:isES5,propertyIsWritable:function(obj,prop){var descriptor=Object.getOwnPropertyDescriptor(obj,prop);return!(descriptor&&!descriptor.writable&&!descriptor.set)}};else{var has={}.hasOwnProperty,str={}.toString,proto={}.constructor.prototype,ObjectKeys=function(o){var ret=[];for(var key in o)has.call(o,key)&&ret.push(key);return ret},ObjectGetDescriptor=function(o,key){return{value:o[key]}},ObjectDefineProperty=function(o,key,desc){return o[key]=desc.value,o},ObjectFreeze=function(obj){return obj},ObjectGetPrototypeOf=function(obj){try{return Object(obj).constructor.prototype}catch(e){return proto}},ArrayIsArray=function(obj){try{return"[object Array]"===str.call(obj)}catch(e){return!1}};module.exports={isArray:ArrayIsArray,keys:ObjectKeys,names:ObjectKeys,defineProperty:ObjectDefineProperty,getDescriptor:ObjectGetDescriptor,freeze:ObjectFreeze,getPrototypeOf:ObjectGetPrototypeOf,isES5:isES5,propertyIsWritable:function(){return!0}}}},{}],15:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){var PromiseMap=Promise.map;Promise.prototype.filter=function(fn,options){return PromiseMap(this,fn,options,INTERNAL)},Promise.filter=function(promises,fn,options){return PromiseMap(promises,fn,options,INTERNAL)}}},{}],16:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,NEXT_FILTER,tryConvertToPromise){function returnThis(){return this}function throwThis(){throw this}function return$(r){return function(){return r}}function throw$(r){return function(){throw r}}function promisedFinally(ret,reasonOrValue,isFulfilled){var then;return then=isPrimitive(reasonOrValue)?isFulfilled?return$(reasonOrValue):throw$(reasonOrValue):isFulfilled?returnThis:throwThis,ret._then(then,thrower,void 0,reasonOrValue,void 0)}function finallyHandler(reasonOrValue){var promise=this.promise,handler=this.handler,ret=promise._isBound()?handler.call(promise._boundValue()):handler();if(void 0!==ret){var maybePromise=tryConvertToPromise(ret,promise);if(maybePromise instanceof Promise)return maybePromise=maybePromise._target(),promisedFinally(maybePromise,reasonOrValue,promise.isFulfilled())}return promise.isRejected()?(NEXT_FILTER.e=reasonOrValue,NEXT_FILTER):reasonOrValue}function tapHandler(value){var promise=this.promise,handler=this.handler,ret=promise._isBound()?handler.call(promise._boundValue(),value):handler(value);if(void 0!==ret){var maybePromise=tryConvertToPromise(ret,promise);if(maybePromise instanceof Promise)return maybePromise=maybePromise._target(),promisedFinally(maybePromise,value,!0)}return value}var util=_dereq_("./util.js"),isPrimitive=util.isPrimitive,thrower=util.thrower;Promise.prototype._passThroughHandler=function(handler,isFinally){if("function"!=typeof handler)return this.then();var promiseAndHandler={promise:this,handler:handler};return this._then(isFinally?finallyHandler:tapHandler,isFinally?finallyHandler:void 0,void 0,promiseAndHandler,void 0)},Promise.prototype.lastly=Promise.prototype.finally=function(handler){return this._passThroughHandler(handler,!0)},Promise.prototype.tap=function(handler){return this._passThroughHandler(handler,!1)}}},{"./util.js":38}],17:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,apiRejection,INTERNAL,tryConvertToPromise){function promiseFromYieldHandler(value,yieldHandlers,traceParent){for(var i=0;i<yieldHandlers.length;++i){traceParent._pushContext();var result=tryCatch(yieldHandlers[i])(value);if(traceParent._popContext(),result===errorObj){traceParent._pushContext();var ret=Promise.reject(errorObj.e);return traceParent._popContext(),ret}var maybePromise=tryConvertToPromise(result,traceParent);if(maybePromise instanceof Promise)return maybePromise}return null}function PromiseSpawn(generatorFunction,receiver,yieldHandler,stack){(this._promise=new Promise(INTERNAL))._captureStackTrace(),this._stack=stack,this._generatorFunction=generatorFunction,this._receiver=receiver,this._generator=void 0,this._yieldHandlers="function"==typeof yieldHandler?[yieldHandler].concat(yieldHandlers):yieldHandlers}var errors=_dereq_("./errors.js"),TypeError=errors.TypeError,util=_dereq_("./util.js"),errorObj=util.errorObj,tryCatch=util.tryCatch,yieldHandlers=[];PromiseSpawn.prototype.promise=function(){return this._promise},PromiseSpawn.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._next(void 0)},PromiseSpawn.prototype._continue=function(result){if(result===errorObj)return this._promise._rejectCallback(result.e,!1,!0);var value=result.value;if(!0===result.done)this._promise._resolveCallback(value);else{var maybePromise=tryConvertToPromise(value,this._promise);if(!(maybePromise instanceof Promise)&&null===(maybePromise=promiseFromYieldHandler(maybePromise,this._yieldHandlers,this._promise)))return void this._throw(new TypeError("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/4Y4pDk\n\n".replace("%s",value)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));maybePromise._then(this._next,this._throw,void 0,this,null)}},PromiseSpawn.prototype._throw=function(reason){this._promise._attachExtraTrace(reason),this._promise._pushContext();var result=tryCatch(this._generator.throw).call(this._generator,reason);this._promise._popContext(),this._continue(result)},PromiseSpawn.prototype._next=function(value){this._promise._pushContext();var result=tryCatch(this._generator.next).call(this._generator,value);this._promise._popContext(),this._continue(result)},Promise.coroutine=function(generatorFunction,options){if("function"!=typeof generatorFunction)throw new TypeError("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var yieldHandler=Object(options).yieldHandler,PromiseSpawn$=PromiseSpawn,stack=(new Error).stack;return function(){var generator=generatorFunction.apply(this,arguments),spawn=new PromiseSpawn$(void 0,void 0,yieldHandler,stack);return spawn._generator=generator,spawn._next(void 0),spawn.promise()}},Promise.coroutine.addYieldHandler=function(fn){if("function"!=typeof fn)throw new TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");yieldHandlers.push(fn)},Promise.spawn=function(generatorFunction){if("function"!=typeof generatorFunction)return apiRejection("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var spawn=new PromiseSpawn(generatorFunction,this),ret=spawn.promise();return spawn._run(Promise.spawn),ret}}},{"./errors.js":13,"./util.js":38}],18:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,tryConvertToPromise,INTERNAL){var util=_dereq_("./util.js");util.canEvaluate,util.tryCatch,util.errorObj;Promise.join=function(){var fn,last=arguments.length-1;if(last>0&&"function"==typeof arguments[last]){fn=arguments[last];var ret}for(var $_len=arguments.length,args=new Array($_len),$_i=0;$_i<$_len;++$_i)args[$_i]=arguments[$_i];fn&&args.pop();var ret=new PromiseArray(args).promise();return void 0!==fn?ret.spread(fn):ret}}},{"./util.js":38}],19:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,apiRejection,tryConvertToPromise,INTERNAL){function MappingPromiseArray(promises,fn,limit,_filter){this.constructor$(promises),this._promise._captureStackTrace();var domain=getDomain();this._callback=null===domain?fn:domain.bind(fn),this._preservedValues=_filter===INTERNAL?new Array(this.length()):null,this._limit=limit,this._inFlight=0,this._queue=limit>=1?[]:EMPTY_ARRAY,async.invoke(init,this,void 0)}function init(){this._init$(void 0,-2)}function map(promises,fn,options,_filter){var limit="object"==typeof options&&null!==options?options.concurrency:0;return limit="number"==typeof limit&&isFinite(limit)&&limit>=1?limit:0,new MappingPromiseArray(promises,fn,limit,_filter)}var getDomain=Promise._getDomain,async=_dereq_("./async.js"),util=_dereq_("./util.js"),tryCatch=util.tryCatch,errorObj=util.errorObj,PENDING={},EMPTY_ARRAY=[];util.inherits(MappingPromiseArray,PromiseArray),MappingPromiseArray.prototype._init=function(){},MappingPromiseArray.prototype._promiseFulfilled=function(value,index){var values=this._values,length=this.length(),preservedValues=this._preservedValues,limit=this._limit;if(values[index]===PENDING){if(values[index]=value,limit>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return}else{if(limit>=1&&this._inFlight>=limit)return values[index]=value,void this._queue.push(index);null!==preservedValues&&(preservedValues[index]=value);var callback=this._callback,receiver=this._promise._boundValue();this._promise._pushContext();var ret=tryCatch(callback).call(receiver,value,index,length);if(this._promise._popContext(),ret===errorObj)return this._reject(ret.e);var maybePromise=tryConvertToPromise(ret,this._promise);if(maybePromise instanceof Promise){if(maybePromise=maybePromise._target(),maybePromise._isPending())return limit>=1&&this._inFlight++,values[index]=PENDING,maybePromise._proxyPromiseArray(this,index);if(!maybePromise._isFulfilled())return this._reject(maybePromise._reason());ret=maybePromise._value()}values[index]=ret}++this._totalResolved>=length&&(null!==preservedValues?this._filter(values,preservedValues):this._resolve(values))},MappingPromiseArray.prototype._drainQueue=function(){for(var queue=this._queue,limit=this._limit,values=this._values;queue.length>0&&this._inFlight<limit;){if(this._isResolved())return;var index=queue.pop();this._promiseFulfilled(values[index],index)}},MappingPromiseArray.prototype._filter=function(booleans,values){for(var len=values.length,ret=new Array(len),j=0,i=0;i<len;++i)booleans[i]&&(ret[j++]=values[i]);ret.length=j,this._resolve(ret)},MappingPromiseArray.prototype.preservedValues=function(){return this._preservedValues},Promise.prototype.map=function(fn,options){return"function"!=typeof fn?apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):map(this,fn,options,null).promise()},Promise.map=function(promises,fn,options,_filter){return"function"!=typeof fn?apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):map(promises,fn,options,_filter).promise()}}},{"./async.js":2,"./util.js":38}],20:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL,tryConvertToPromise,apiRejection){var util=_dereq_("./util.js"),tryCatch=util.tryCatch;Promise.method=function(fn){if("function"!=typeof fn)throw new Promise.TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");return function(){var ret=new Promise(INTERNAL);ret._captureStackTrace(),ret._pushContext();var value=tryCatch(fn).apply(this,arguments);return ret._popContext(),ret._resolveFromSyncValue(value),ret}},Promise.attempt=Promise.try=function(fn,args,ctx){if("function"!=typeof fn)return apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var ret=new Promise(INTERNAL);ret._captureStackTrace(),ret._pushContext();var value=util.isArray(args)?tryCatch(fn).apply(ctx,args):tryCatch(fn).call(ctx,args);return ret._popContext(),ret._resolveFromSyncValue(value),ret},Promise.prototype._resolveFromSyncValue=function(value){value===util.errorObj?this._rejectCallback(value.e,!1,!0):this._resolveCallback(value,!0)}}},{"./util.js":38}],21:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise){function spreadAdapter(val,nodeback){var promise=this;if(!util.isArray(val))return successAdapter.call(promise,val,nodeback);var ret=tryCatch(nodeback).apply(promise._boundValue(),[null].concat(val));ret===errorObj&&async.throwLater(ret.e)}function successAdapter(val,nodeback){var promise=this,receiver=promise._boundValue(),ret=void 0===val?tryCatch(nodeback).call(receiver,null):tryCatch(nodeback).call(receiver,null,val);ret===errorObj&&async.throwLater(ret.e)}function errorAdapter(reason,nodeback){var promise=this;if(!reason){var target=promise._target(),newReason=target._getCarriedStackTrace();newReason.cause=reason,reason=newReason}var ret=tryCatch(nodeback).call(promise._boundValue(),reason);ret===errorObj&&async.throwLater(ret.e)}var util=_dereq_("./util.js"),async=_dereq_("./async.js"),tryCatch=util.tryCatch,errorObj=util.errorObj;Promise.prototype.asCallback=Promise.prototype.nodeify=function(nodeback,options){if("function"==typeof nodeback){var adapter=successAdapter;void 0!==options&&Object(options).spread&&(adapter=spreadAdapter),this._then(adapter,errorAdapter,void 0,this,nodeback)}return this}}},{"./async.js":2,"./util.js":38}],22:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray){var util=_dereq_("./util.js"),async=_dereq_("./async.js"),tryCatch=util.tryCatch,errorObj=util.errorObj;Promise.prototype.progressed=function(handler){return this._then(void 0,void 0,handler,void 0,void 0)},Promise.prototype._progress=function(progressValue){this._isFollowingOrFulfilledOrRejected()||this._target()._progressUnchecked(progressValue)},Promise.prototype._progressHandlerAt=function(index){return 0===index?this._progressHandler0:this[(index<<2)+index-5+2]},Promise.prototype._doProgressWith=function(progression){var progressValue=progression.value,handler=progression.handler,promise=progression.promise,receiver=progression.receiver,ret=tryCatch(handler).call(receiver,progressValue);if(ret===errorObj){if(null!=ret.e&&"StopProgressPropagation"!==ret.e.name){var trace=util.canAttachTrace(ret.e)?ret.e:new Error(util.toString(ret.e));promise._attachExtraTrace(trace),promise._progress(ret.e)}}else ret instanceof Promise?ret._then(promise._progress,null,null,promise,void 0):promise._progress(ret)},Promise.prototype._progressUnchecked=function(progressValue){for(var len=this._length(),progress=this._progress,i=0;i<len;i++){var handler=this._progressHandlerAt(i),promise=this._promiseAt(i);if(promise instanceof Promise)"function"==typeof handler?async.invoke(this._doProgressWith,this,{handler:handler,promise:promise,receiver:this._receiverAt(i),value:progressValue}):async.invoke(progress,promise,progressValue);else{var receiver=this._receiverAt(i);"function"==typeof handler?handler.call(receiver,progressValue,promise):receiver instanceof PromiseArray&&!receiver._isResolved()&&receiver._promiseProgressed(progressValue,promise)}}}}},{"./async.js":2,"./util.js":38}],23:[function(_dereq_,module,exports){"use strict";module.exports=function(){function Promise(resolver){if("function"!=typeof resolver)throw new TypeError("the promise constructor requires a resolver function\n\n    See http://goo.gl/EC22Yn\n");if(this.constructor!==Promise)throw new TypeError("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/KsIlge\n");this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._progressHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._settledValue=void 0,resolver!==INTERNAL&&this._resolveFromResolver(resolver)}function fillTypes(value){var p=new Promise(INTERNAL);p._fulfillmentHandler0=value,p._rejectionHandler0=value,p._progressHandler0=value,p._promise0=value,p._receiver0=value,p._settledValue=value}var getDomain,makeSelfResolutionError=function(){return new TypeError("circular promise resolution chain\n\n    See http://goo.gl/LhFpo0\n")},reflect=function(){return new Promise.PromiseInspection(this._target())},apiRejection=function(msg){return Promise.reject(new TypeError(msg))},util=_dereq_("./util.js");getDomain=util.isNode?function(){var ret=process.domain;return void 0===ret&&(ret=null),ret}:function(){return null},util.notEnumerableProp(Promise,"_getDomain",getDomain);var UNDEFINED_BINDING={},async=_dereq_("./async.js"),errors=_dereq_("./errors.js"),TypeError=Promise.TypeError=errors.TypeError;Promise.RangeError=errors.RangeError,Promise.CancellationError=errors.CancellationError,Promise.TimeoutError=errors.TimeoutError,Promise.OperationalError=errors.OperationalError,Promise.RejectionError=errors.OperationalError,Promise.AggregateError=errors.AggregateError;var INTERNAL=function(){},APPLY={},NEXT_FILTER={e:null},tryConvertToPromise=_dereq_("./thenables.js")(Promise,INTERNAL),PromiseArray=_dereq_("./promise_array.js")(Promise,INTERNAL,tryConvertToPromise,apiRejection),CapturedTrace=_dereq_("./captured_trace.js")(),isDebugging=_dereq_("./debuggability.js")(Promise,CapturedTrace),createContext=_dereq_("./context.js")(Promise,CapturedTrace,isDebugging),CatchFilter=_dereq_("./catch_filter.js")(NEXT_FILTER),PromiseResolver=_dereq_("./promise_resolver.js"),nodebackForPromise=PromiseResolver._nodebackForPromise,errorObj=util.errorObj,tryCatch=util.tryCatch;return Promise.prototype.toString=function(){return"[object Promise]"},Promise.prototype.caught=Promise.prototype.catch=function(fn){var len=arguments.length;if(len>1){var i,catchInstances=new Array(len-1),j=0;for(i=0;i<len-1;++i){var item=arguments[i];if("function"!=typeof item)return Promise.reject(new TypeError("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"));catchInstances[j++]=item}catchInstances.length=j,fn=arguments[i];var catchFilter=new CatchFilter(catchInstances,fn,this);return this._then(void 0,catchFilter.doFilter,void 0,catchFilter,void 0)}return this._then(void 0,fn,void 0,void 0,void 0)},Promise.prototype.reflect=function(){return this._then(reflect,reflect,void 0,this,void 0)},Promise.prototype.then=function(didFulfill,didReject,didProgress){if(isDebugging()&&arguments.length>0&&"function"!=typeof didFulfill&&"function"!=typeof didReject){var msg=".then() only accepts functions but was passed: "+util.classString(didFulfill);arguments.length>1&&(msg+=", "+util.classString(didReject)),this._warn(msg)}return this._then(didFulfill,didReject,didProgress,void 0,void 0)},Promise.prototype.done=function(didFulfill,didReject,didProgress){this._then(didFulfill,didReject,didProgress,void 0,void 0)._setIsFinal()},Promise.prototype.spread=function(didFulfill,didReject){return this.all()._then(didFulfill,didReject,void 0,APPLY,void 0)},Promise.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},Promise.prototype.toJSON=function(){var ret={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(ret.fulfillmentValue=this.value(),ret.isFulfilled=!0):this.isRejected()&&(ret.rejectionReason=this.reason(),ret.isRejected=!0),ret},Promise.prototype.all=function(){return new PromiseArray(this).promise()},Promise.prototype.error=function(fn){return this.caught(util.originatesFromRejection,fn)},Promise.getNewLibraryCopy=module.exports,Promise.is=function(val){return val instanceof Promise},Promise.fromNode=function(fn){var ret=new Promise(INTERNAL),result=tryCatch(fn)(nodebackForPromise(ret));return result===errorObj&&ret._rejectCallback(result.e,!0,!0),ret},Promise.all=function(promises){return new PromiseArray(promises).promise()},Promise.defer=Promise.pending=function(){var promise=new Promise(INTERNAL);return new PromiseResolver(promise)},Promise.cast=function(obj){var ret=tryConvertToPromise(obj);if(!(ret instanceof Promise)){var val=ret;ret=new Promise(INTERNAL),ret._fulfillUnchecked(val)}return ret},Promise.resolve=Promise.fulfilled=Promise.cast,Promise.reject=Promise.rejected=function(reason){var ret=new Promise(INTERNAL);return ret._captureStackTrace(),ret._rejectCallback(reason,!0),ret},Promise.setScheduler=function(fn){if("function"!=typeof fn)throw new TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var prev=async._schedule;return async._schedule=fn,prev},Promise.prototype._then=function(didFulfill,didReject,didProgress,receiver,internalData){var haveInternalData=void 0!==internalData,ret=haveInternalData?internalData:new Promise(INTERNAL);haveInternalData||(ret._propagateFrom(this,5),ret._captureStackTrace());var target=this._target();target!==this&&(void 0===receiver&&(receiver=this._boundTo),haveInternalData||ret._setIsMigrated());var callbackIndex=target._addCallbacks(didFulfill,didReject,didProgress,ret,receiver,getDomain());return target._isResolved()&&!target._isSettlePromisesQueued()&&async.invoke(target._settlePromiseAtPostResolution,target,callbackIndex),ret},
Promise.prototype._settlePromiseAtPostResolution=function(index){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),this._settlePromiseAt(index)},Promise.prototype._length=function(){return 131071&this._bitField},Promise.prototype._isFollowingOrFulfilledOrRejected=function(){return(939524096&this._bitField)>0},Promise.prototype._isFollowing=function(){return 536870912==(536870912&this._bitField)},Promise.prototype._setLength=function(len){this._bitField=-131072&this._bitField|131071&len},Promise.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},Promise.prototype._setRejected=function(){this._bitField=134217728|this._bitField},Promise.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},Promise.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},Promise.prototype._isFinal=function(){return(33554432&this._bitField)>0},Promise.prototype._cancellable=function(){return(67108864&this._bitField)>0},Promise.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},Promise.prototype._unsetCancellable=function(){this._bitField=-67108865&this._bitField},Promise.prototype._setIsMigrated=function(){this._bitField=4194304|this._bitField},Promise.prototype._unsetIsMigrated=function(){this._bitField=-4194305&this._bitField},Promise.prototype._isMigrated=function(){return(4194304&this._bitField)>0},Promise.prototype._receiverAt=function(index){var ret=0===index?this._receiver0:this[5*index-5+4];if(ret!==UNDEFINED_BINDING)return void 0===ret&&this._isBound()?this._boundValue():ret},Promise.prototype._promiseAt=function(index){return 0===index?this._promise0:this[5*index-5+3]},Promise.prototype._fulfillmentHandlerAt=function(index){return 0===index?this._fulfillmentHandler0:this[5*index-5+0]},Promise.prototype._rejectionHandlerAt=function(index){return 0===index?this._rejectionHandler0:this[5*index-5+1]},Promise.prototype._boundValue=function(){var ret=this._boundTo;return void 0!==ret&&ret instanceof Promise?ret.isFulfilled()?ret.value():void 0:ret},Promise.prototype._migrateCallbacks=function(follower,index){var fulfill=follower._fulfillmentHandlerAt(index),reject=follower._rejectionHandlerAt(index),progress=follower._progressHandlerAt(index),promise=follower._promiseAt(index),receiver=follower._receiverAt(index);promise instanceof Promise&&promise._setIsMigrated(),void 0===receiver&&(receiver=UNDEFINED_BINDING),this._addCallbacks(fulfill,reject,progress,promise,receiver,null)},Promise.prototype._addCallbacks=function(fulfill,reject,progress,promise,receiver,domain){var index=this._length();if(index>=131066&&(index=0,this._setLength(0)),0===index)this._promise0=promise,void 0!==receiver&&(this._receiver0=receiver),"function"!=typeof fulfill||this._isCarryingStackTrace()||(this._fulfillmentHandler0=null===domain?fulfill:domain.bind(fulfill)),"function"==typeof reject&&(this._rejectionHandler0=null===domain?reject:domain.bind(reject)),"function"==typeof progress&&(this._progressHandler0=null===domain?progress:domain.bind(progress));else{var base=5*index-5;this[base+3]=promise,this[base+4]=receiver,"function"==typeof fulfill&&(this[base+0]=null===domain?fulfill:domain.bind(fulfill)),"function"==typeof reject&&(this[base+1]=null===domain?reject:domain.bind(reject)),"function"==typeof progress&&(this[base+2]=null===domain?progress:domain.bind(progress))}return this._setLength(index+1),index},Promise.prototype._setProxyHandlers=function(receiver,promiseSlotValue){var index=this._length();if(index>=131066&&(index=0,this._setLength(0)),0===index)this._promise0=promiseSlotValue,this._receiver0=receiver;else{var base=5*index-5;this[base+3]=promiseSlotValue,this[base+4]=receiver}this._setLength(index+1)},Promise.prototype._proxyPromiseArray=function(promiseArray,index){this._setProxyHandlers(promiseArray,index)},Promise.prototype._resolveCallback=function(value,shouldBind){if(!this._isFollowingOrFulfilledOrRejected()){if(value===this)return this._rejectCallback(makeSelfResolutionError(),!1,!0);var maybePromise=tryConvertToPromise(value,this);if(!(maybePromise instanceof Promise))return this._fulfill(value);var propagationFlags=1|(shouldBind?4:0);this._propagateFrom(maybePromise,propagationFlags);var promise=maybePromise._target();if(promise._isPending()){for(var len=this._length(),i=0;i<len;++i)promise._migrateCallbacks(this,i);this._setFollowing(),this._setLength(0),this._setFollowee(promise)}else promise._isFulfilled()?this._fulfillUnchecked(promise._value()):this._rejectUnchecked(promise._reason(),promise._getCarriedStackTrace())}},Promise.prototype._rejectCallback=function(reason,synchronous,shouldNotMarkOriginatingFromRejection){shouldNotMarkOriginatingFromRejection||util.markAsOriginatingFromRejection(reason);var trace=util.ensureErrorObject(reason),hasStack=trace===reason;this._attachExtraTrace(trace,!!synchronous&&hasStack),this._reject(reason,hasStack?void 0:trace)},Promise.prototype._resolveFromResolver=function(resolver){var promise=this;this._captureStackTrace(),this._pushContext();var synchronous=!0,r=tryCatch(resolver)(function(value){null!==promise&&(promise._resolveCallback(value),promise=null)},function(reason){null!==promise&&(promise._rejectCallback(reason,synchronous),promise=null)});synchronous=!1,this._popContext(),void 0!==r&&r===errorObj&&null!==promise&&(promise._rejectCallback(r.e,!0,!0),promise=null)},Promise.prototype._settlePromiseFromHandler=function(handler,receiver,value,promise){if(!promise._isRejected()){promise._pushContext();var x;if(x=receiver!==APPLY||this._isRejected()?tryCatch(handler).call(receiver,value):tryCatch(handler).apply(this._boundValue(),value),promise._popContext(),x===errorObj||x===promise||x===NEXT_FILTER){var err=x===promise?makeSelfResolutionError():x.e;promise._rejectCallback(err,!1,!0)}else promise._resolveCallback(x)}},Promise.prototype._target=function(){for(var ret=this;ret._isFollowing();)ret=ret._followee();return ret},Promise.prototype._followee=function(){return this._rejectionHandler0},Promise.prototype._setFollowee=function(promise){this._rejectionHandler0=promise},Promise.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},Promise.prototype._propagateFrom=function(parent,flags){(1&flags)>0&&parent._cancellable()&&(this._setCancellable(),this._cancellationParent=parent),(4&flags)>0&&parent._isBound()&&this._setBoundTo(parent._boundTo)},Promise.prototype._fulfill=function(value){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(value)},Promise.prototype._reject=function(reason,carriedStackTrace){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(reason,carriedStackTrace)},Promise.prototype._settlePromiseAt=function(index){var promise=this._promiseAt(index),isPromise=promise instanceof Promise;if(isPromise&&promise._isMigrated())return promise._unsetIsMigrated(),async.invoke(this._settlePromiseAt,this,index);var handler=this._isFulfilled()?this._fulfillmentHandlerAt(index):this._rejectionHandlerAt(index),carriedStackTrace=this._isCarryingStackTrace()?this._getCarriedStackTrace():void 0,value=this._settledValue,receiver=this._receiverAt(index);this._clearCallbackDataAtIndex(index),"function"==typeof handler?isPromise?this._settlePromiseFromHandler(handler,receiver,value,promise):handler.call(receiver,value,promise):receiver instanceof PromiseArray?receiver._isResolved()||(this._isFulfilled()?receiver._promiseFulfilled(value,promise):receiver._promiseRejected(value,promise)):isPromise&&(this._isFulfilled()?promise._fulfill(value):promise._reject(value,carriedStackTrace)),index>=4&&4==(31&index)&&async.invokeLater(this._setLength,this,0)},Promise.prototype._clearCallbackDataAtIndex=function(index){if(0===index)this._isCarryingStackTrace()||(this._fulfillmentHandler0=void 0),this._rejectionHandler0=this._progressHandler0=this._receiver0=this._promise0=void 0;else{var base=5*index-5;this[base+3]=this[base+4]=this[base+0]=this[base+1]=this[base+2]=void 0}},Promise.prototype._isSettlePromisesQueued=function(){return-1073741824==(-1073741824&this._bitField)},Promise.prototype._setSettlePromisesQueued=function(){this._bitField=-1073741824|this._bitField},Promise.prototype._unsetSettlePromisesQueued=function(){this._bitField=1073741823&this._bitField},Promise.prototype._queueSettlePromises=function(){async.settlePromises(this),this._setSettlePromisesQueued()},Promise.prototype._fulfillUnchecked=function(value){if(value===this){var err=makeSelfResolutionError();return this._attachExtraTrace(err),this._rejectUnchecked(err,void 0)}this._setFulfilled(),this._settledValue=value,this._cleanValues(),this._length()>0&&this._queueSettlePromises()},Promise.prototype._rejectUncheckedCheckError=function(reason){var trace=util.ensureErrorObject(reason);this._rejectUnchecked(reason,trace===reason?void 0:trace)},Promise.prototype._rejectUnchecked=function(reason,trace){if(reason===this){var err=makeSelfResolutionError();return this._attachExtraTrace(err),this._rejectUnchecked(err)}if(this._setRejected(),this._settledValue=reason,this._cleanValues(),this._isFinal())return void async.throwLater(function(e){throw"stack"in e&&async.invokeFirst(CapturedTrace.unhandledRejection,void 0,e),e},void 0===trace?reason:trace);void 0!==trace&&trace!==reason&&this._setCarriedStackTrace(trace),this._length()>0?this._queueSettlePromises():this._ensurePossibleRejectionHandled()},Promise.prototype._settlePromises=function(){this._unsetSettlePromisesQueued();for(var len=this._length(),i=0;i<len;i++)this._settlePromiseAt(i)},util.notEnumerableProp(Promise,"_makeSelfResolutionError",makeSelfResolutionError),_dereq_("./progress.js")(Promise,PromiseArray),_dereq_("./method.js")(Promise,INTERNAL,tryConvertToPromise,apiRejection),_dereq_("./bind.js")(Promise,INTERNAL,tryConvertToPromise),_dereq_("./finally.js")(Promise,NEXT_FILTER,tryConvertToPromise),_dereq_("./direct_resolve.js")(Promise),_dereq_("./synchronous_inspection.js")(Promise),_dereq_("./join.js")(Promise,PromiseArray,tryConvertToPromise,INTERNAL),Promise.version="2.11.0",Promise.Promise=Promise,_dereq_("./map.js")(Promise,PromiseArray,apiRejection,tryConvertToPromise,INTERNAL),_dereq_("./cancel.js")(Promise),_dereq_("./using.js")(Promise,apiRejection,tryConvertToPromise,createContext),_dereq_("./generators.js")(Promise,apiRejection,INTERNAL,tryConvertToPromise),_dereq_("./nodeify.js")(Promise),_dereq_("./call_get.js")(Promise),_dereq_("./props.js")(Promise,PromiseArray,tryConvertToPromise,apiRejection),_dereq_("./race.js")(Promise,INTERNAL,tryConvertToPromise,apiRejection),_dereq_("./reduce.js")(Promise,PromiseArray,apiRejection,tryConvertToPromise,INTERNAL),_dereq_("./settle.js")(Promise,PromiseArray),_dereq_("./some.js")(Promise,PromiseArray,apiRejection),_dereq_("./promisify.js")(Promise,INTERNAL),_dereq_("./any.js")(Promise),_dereq_("./each.js")(Promise,INTERNAL),_dereq_("./timers.js")(Promise,INTERNAL),_dereq_("./filter.js")(Promise,INTERNAL),util.toFastProperties(Promise),util.toFastProperties(Promise.prototype),fillTypes({a:1}),fillTypes({b:2}),fillTypes({c:3}),fillTypes(1),fillTypes(function(){}),fillTypes(void 0),fillTypes(!1),fillTypes(new Promise(INTERNAL)),CapturedTrace.setBounds(async.firstLineError,util.lastLineError),Promise}},{"./any.js":1,"./async.js":2,"./bind.js":3,"./call_get.js":5,"./cancel.js":6,"./captured_trace.js":7,"./catch_filter.js":8,"./context.js":9,"./debuggability.js":10,"./direct_resolve.js":11,"./each.js":12,"./errors.js":13,"./filter.js":15,"./finally.js":16,"./generators.js":17,"./join.js":18,"./map.js":19,"./method.js":20,"./nodeify.js":21,"./progress.js":22,"./promise_array.js":24,"./promise_resolver.js":25,"./promisify.js":26,"./props.js":27,"./race.js":29,"./reduce.js":30,"./settle.js":32,"./some.js":33,"./synchronous_inspection.js":34,"./thenables.js":35,"./timers.js":36,"./using.js":37,"./util.js":38}],24:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL,tryConvertToPromise,apiRejection){function toResolutionValue(val){switch(val){case-2:return[];case-3:return{}}}function PromiseArray(values){var parent,promise=this._promise=new Promise(INTERNAL);values instanceof Promise&&(parent=values,promise._propagateFrom(parent,5)),this._values=values,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var util=_dereq_("./util.js"),isArray=util.isArray;return PromiseArray.prototype.length=function(){return this._length},PromiseArray.prototype.promise=function(){return this._promise},PromiseArray.prototype._init=function init(_,resolveValueIfEmpty){var values=tryConvertToPromise(this._values,this._promise);if(values instanceof Promise){if(values=values._target(),this._values=values,!values._isFulfilled())return values._isPending()?void values._then(init,this._reject,void 0,this,resolveValueIfEmpty):void this._reject(values._reason());if(values=values._value(),!isArray(values)){var err=new Promise.TypeError("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");return void this.__hardReject__(err)}}else if(!isArray(values))return void this._promise._reject(apiRejection("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n")._reason());if(0===values.length)return void(-5===resolveValueIfEmpty?this._resolveEmptyArray():this._resolve(toResolutionValue(resolveValueIfEmpty)));var len=this.getActualLength(values.length);this._length=len,this._values=this.shouldCopyValues()?new Array(len):this._values;for(var promise=this._promise,i=0;i<len;++i){var isResolved=this._isResolved(),maybePromise=tryConvertToPromise(values[i],promise);maybePromise instanceof Promise?(maybePromise=maybePromise._target(),isResolved?maybePromise._ignoreRejections():maybePromise._isPending()?maybePromise._proxyPromiseArray(this,i):maybePromise._isFulfilled()?this._promiseFulfilled(maybePromise._value(),i):this._promiseRejected(maybePromise._reason(),i)):isResolved||this._promiseFulfilled(maybePromise,i)}},PromiseArray.prototype._isResolved=function(){return null===this._values},PromiseArray.prototype._resolve=function(value){this._values=null,this._promise._fulfill(value)},PromiseArray.prototype.__hardReject__=PromiseArray.prototype._reject=function(reason){this._values=null,this._promise._rejectCallback(reason,!1,!0)},PromiseArray.prototype._promiseProgressed=function(progressValue,index){this._promise._progress({index:index,value:progressValue})},PromiseArray.prototype._promiseFulfilled=function(value,index){this._values[index]=value,++this._totalResolved>=this._length&&this._resolve(this._values)},PromiseArray.prototype._promiseRejected=function(reason,index){this._totalResolved++,this._reject(reason)},PromiseArray.prototype.shouldCopyValues=function(){return!0},PromiseArray.prototype.getActualLength=function(len){return len},PromiseArray}},{"./util.js":38}],25:[function(_dereq_,module,exports){"use strict";function isUntypedError(obj){return obj instanceof Error&&es5.getPrototypeOf(obj)===Error.prototype}function wrapAsOperationalError(obj){var ret;if(isUntypedError(obj)){ret=new OperationalError(obj),ret.name=obj.name,ret.message=obj.message,ret.stack=obj.stack;for(var keys=es5.keys(obj),i=0;i<keys.length;++i){var key=keys[i];rErrorKey.test(key)||(ret[key]=obj[key])}return ret}return util.markAsOriginatingFromRejection(obj),obj}function nodebackForPromise(promise){return function(err,value){if(null!==promise){if(err){var wrapped=wrapAsOperationalError(maybeWrapAsError(err));promise._attachExtraTrace(wrapped),promise._reject(wrapped)}else if(arguments.length>2){for(var $_len=arguments.length,args=new Array($_len-1),$_i=1;$_i<$_len;++$_i)args[$_i-1]=arguments[$_i];promise._fulfill(args)}else promise._fulfill(value);promise=null}}}var PromiseResolver,util=_dereq_("./util.js"),maybeWrapAsError=util.maybeWrapAsError,errors=_dereq_("./errors.js"),TimeoutError=errors.TimeoutError,OperationalError=errors.OperationalError,haveGetters=util.haveGetters,es5=_dereq_("./es5.js"),rErrorKey=/^(?:name|message|stack|cause)$/;if(PromiseResolver=haveGetters?function(promise){this.promise=promise}:function(promise){this.promise=promise,this.asCallback=nodebackForPromise(promise),this.callback=this.asCallback},haveGetters){var prop={get:function(){return nodebackForPromise(this.promise)}};es5.defineProperty(PromiseResolver.prototype,"asCallback",prop),es5.defineProperty(PromiseResolver.prototype,"callback",prop)}PromiseResolver._nodebackForPromise=nodebackForPromise,PromiseResolver.prototype.toString=function(){return"[object PromiseResolver]"},PromiseResolver.prototype.resolve=PromiseResolver.prototype.fulfill=function(value){if(!(this instanceof PromiseResolver))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._resolveCallback(value)},PromiseResolver.prototype.reject=function(reason){if(!(this instanceof PromiseResolver))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._rejectCallback(reason)},PromiseResolver.prototype.progress=function(value){if(!(this instanceof PromiseResolver))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._progress(value)},PromiseResolver.prototype.cancel=function(err){this.promise.cancel(err)},PromiseResolver.prototype.timeout=function(){this.reject(new TimeoutError("timeout"))},PromiseResolver.prototype.isResolved=function(){return this.promise.isResolved()},PromiseResolver.prototype.toJSON=function(){return this.promise.toJSON()},module.exports=PromiseResolver},{"./errors.js":13,"./es5.js":14,"./util.js":38}],26:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){function propsFilter(key){return!noCopyPropsPattern.test(key)}function isPromisified(fn){try{return!0===fn.__isPromisified__}catch(e){return!1}}function hasPromisified(obj,key,suffix){var val=util.getDataPropertyOrDefault(obj,key+suffix,defaultPromisified);return!!val&&isPromisified(val)}function checkValid(ret,suffix,suffixRegexp){for(var i=0;i<ret.length;i+=2){var key=ret[i];if(suffixRegexp.test(key))for(var keyWithoutAsyncSuffix=key.replace(suffixRegexp,""),j=0;j<ret.length;j+=2)if(ret[j]===keyWithoutAsyncSuffix)throw new TypeError("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/iWrZbw\n".replace("%s",suffix))}}function promisifiableMethods(obj,suffix,suffixRegexp,filter){for(var keys=util.inheritedDataKeys(obj),ret=[],i=0;i<keys.length;++i){var key=keys[i],value=obj[key],passesDefaultFilter=filter===defaultFilter||defaultFilter(key,value,obj);"function"!=typeof value||isPromisified(value)||hasPromisified(obj,key,suffix)||!filter(key,value,obj,passesDefaultFilter)||ret.push(key,value)}return checkValid(ret,suffix,suffixRegexp),ret}function makeNodePromisifiedClosure(callback,receiver,_,fn){function promisified(){var _receiver=receiver;receiver===THIS&&(_receiver=this);var promise=new Promise(INTERNAL);promise._captureStackTrace();var cb="string"==typeof method&&this!==defaultThis?this[method]:callback,fn=nodebackForPromise(promise);try{cb.apply(_receiver,withAppended(arguments,fn))}catch(e){promise._rejectCallback(maybeWrapAsError(e),!0,!0)}return promise}var defaultThis=function(){return this}(),method=callback;return"string"==typeof method&&(callback=fn),util.notEnumerableProp(promisified,"__isPromisified__",!0),promisified}function promisifyAll(obj,suffix,filter,promisifier){for(var suffixRegexp=new RegExp(escapeIdentRegex(suffix)+"$"),methods=promisifiableMethods(obj,suffix,suffixRegexp,filter),i=0,len=methods.length;i<len;i+=2){var key=methods[i],fn=methods[i+1],promisifiedKey=key+suffix;if(promisifier===makeNodePromisified)obj[promisifiedKey]=makeNodePromisified(key,THIS,key,fn,suffix);else{var promisified=promisifier(fn,function(){return makeNodePromisified(key,THIS,key,fn,suffix)});util.notEnumerableProp(promisified,"__isPromisified__",!0),obj[promisifiedKey]=promisified}}return util.toFastProperties(obj),obj}function promisify(callback,receiver){return makeNodePromisified(callback,receiver,void 0,callback)}var makeNodePromisifiedEval,THIS={},util=_dereq_("./util.js"),nodebackForPromise=_dereq_("./promise_resolver.js")._nodebackForPromise,withAppended=util.withAppended,maybeWrapAsError=util.maybeWrapAsError,canEvaluate=util.canEvaluate,TypeError=_dereq_("./errors").TypeError,defaultPromisified={__isPromisified__:!0},noCopyProps=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],noCopyPropsPattern=new RegExp("^(?:"+noCopyProps.join("|")+")$"),defaultFilter=function(name){return util.isIdentifier(name)&&"_"!==name.charAt(0)&&"constructor"!==name},escapeIdentRegex=function(str){return str.replace(/([$])/,"\\$")},makeNodePromisified=canEvaluate?makeNodePromisifiedEval:makeNodePromisifiedClosure;Promise.promisify=function(fn,receiver){if("function"!=typeof fn)throw new TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");if(isPromisified(fn))return fn;var ret=promisify(fn,arguments.length<2?THIS:receiver);return util.copyDescriptors(fn,ret,propsFilter),ret},Promise.promisifyAll=function(target,options){if("function"!=typeof target&&"object"!=typeof target)throw new TypeError("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/9ITlV0\n");options=Object(options);var suffix=options.suffix;"string"!=typeof suffix&&(suffix="Async");var filter=options.filter;"function"!=typeof filter&&(filter=defaultFilter);var promisifier=options.promisifier;if("function"!=typeof promisifier&&(promisifier=makeNodePromisified),!util.isIdentifier(suffix))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/8FZo5V\n");for(var keys=util.inheritedDataKeys(target),i=0;i<keys.length;++i){var value=target[keys[i]];"constructor"!==keys[i]&&util.isClass(value)&&(promisifyAll(value.prototype,suffix,filter,promisifier),promisifyAll(value,suffix,filter,promisifier))}return promisifyAll(target,suffix,filter,promisifier)}}},{"./errors":13,"./promise_resolver.js":25,"./util.js":38}],27:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,tryConvertToPromise,apiRejection){function PropertiesPromiseArray(obj){for(var keys=es5.keys(obj),len=keys.length,values=new Array(2*len),i=0;i<len;++i){var key=keys[i];values[i]=obj[key],values[i+len]=key}this.constructor$(values)}function props(promises){var ret,castValue=tryConvertToPromise(promises);return isObject(castValue)?(ret=castValue instanceof Promise?castValue._then(Promise.props,void 0,void 0,void 0,void 0):new PropertiesPromiseArray(castValue).promise(),castValue instanceof Promise&&ret._propagateFrom(castValue,4),ret):apiRejection("cannot await properties of a non-object\n\n    See http://goo.gl/OsFKC8\n")}var util=_dereq_("./util.js"),isObject=util.isObject,es5=_dereq_("./es5.js");util.inherits(PropertiesPromiseArray,PromiseArray),PropertiesPromiseArray.prototype._init=function(){this._init$(void 0,-3)},PropertiesPromiseArray.prototype._promiseFulfilled=function(value,index){if(this._values[index]=value,++this._totalResolved>=this._length){for(var val={},keyOffset=this.length(),i=0,len=this.length();i<len;++i)val[this._values[i+keyOffset]]=this._values[i];this._resolve(val)}},PropertiesPromiseArray.prototype._promiseProgressed=function(value,index){this._promise._progress({key:this._values[index+this.length()],value:value})},PropertiesPromiseArray.prototype.shouldCopyValues=function(){return!1},PropertiesPromiseArray.prototype.getActualLength=function(len){return len>>1},Promise.prototype.props=function(){return props(this)},Promise.props=function(promises){return props(promises)}}},{"./es5.js":14,"./util.js":38}],28:[function(_dereq_,module,exports){"use strict";function arrayMove(src,srcIndex,dst,dstIndex,len){for(var j=0;j<len;++j)dst[j+dstIndex]=src[j+srcIndex],src[j+srcIndex]=void 0}function Queue(capacity){this._capacity=capacity,this._length=0,this._front=0}Queue.prototype._willBeOverCapacity=function(size){return this._capacity<size},Queue.prototype._pushOne=function(arg){var length=this.length();this._checkCapacity(length+1),this[this._front+length&this._capacity-1]=arg,this._length=length+1},Queue.prototype._unshiftOne=function(value){var capacity=this._capacity;this._checkCapacity(this.length()+1);var front=this._front,i=(front-1&capacity-1^capacity)-capacity;this[i]=value,this._front=i,this._length=this.length()+1},Queue.prototype.unshift=function(fn,receiver,arg){this._unshiftOne(arg),this._unshiftOne(receiver),this._unshiftOne(fn)},Queue.prototype.push=function(fn,receiver,arg){var length=this.length()+3;if(this._willBeOverCapacity(length))return this._pushOne(fn),this._pushOne(receiver),void this._pushOne(arg);var j=this._front+length-3;this._checkCapacity(length);var wrapMask=this._capacity-1;this[j+0&wrapMask]=fn,this[j+1&wrapMask]=receiver,this[j+2&wrapMask]=arg,this._length=length},Queue.prototype.shift=function(){var front=this._front,ret=this[front];return this[front]=void 0,this._front=front+1&this._capacity-1,this._length--,ret},Queue.prototype.length=function(){return this._length},Queue.prototype._checkCapacity=function(size){this._capacity<size&&this._resizeTo(this._capacity<<1)},Queue.prototype._resizeTo=function(capacity){var oldCapacity=this._capacity;this._capacity=capacity,arrayMove(this,0,this,oldCapacity,this._front+this._length&oldCapacity-1)},module.exports=Queue},{}],29:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL,tryConvertToPromise,apiRejection){function race(promises,parent){var maybePromise=tryConvertToPromise(promises);if(maybePromise instanceof Promise)return raceLater(maybePromise);if(!isArray(promises))return apiRejection("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");var ret=new Promise(INTERNAL);void 0!==parent&&ret._propagateFrom(parent,5);for(var fulfill=ret._fulfill,reject=ret._reject,i=0,len=promises.length;i<len;++i){var val=promises[i];(void 0!==val||i in promises)&&Promise.cast(val)._then(fulfill,reject,void 0,ret,null)}return ret}var isArray=_dereq_("./util.js").isArray,raceLater=function(promise){return promise.then(function(array){return race(array,promise)})};Promise.race=function(promises){return race(promises,void 0)},Promise.prototype.race=function(){return race(this,void 0)}}},{"./util.js":38}],30:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,apiRejection,tryConvertToPromise,INTERNAL){function ReductionPromiseArray(promises,fn,accum,_each){this.constructor$(promises),this._promise._captureStackTrace(),this._preservedValues=_each===INTERNAL?[]:null,this._zerothIsAccum=void 0===accum,this._gotAccum=!1,this._reducingIndex=this._zerothIsAccum?1:0,this._valuesPhase=void 0;var maybePromise=tryConvertToPromise(accum,this._promise),rejected=!1,isPromise=maybePromise instanceof Promise;isPromise&&(maybePromise=maybePromise._target(),maybePromise._isPending()?maybePromise._proxyPromiseArray(this,-1):maybePromise._isFulfilled()?(accum=maybePromise._value(),this._gotAccum=!0):(this._reject(maybePromise._reason()),rejected=!0)),isPromise||this._zerothIsAccum||(this._gotAccum=!0);var domain=getDomain();this._callback=null===domain?fn:domain.bind(fn),this._accum=accum,rejected||async.invoke(init,this,void 0)}function init(){this._init$(void 0,-5)}function reduce(promises,fn,initialValue,_each){return"function"!=typeof fn?apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):new ReductionPromiseArray(promises,fn,initialValue,_each).promise()}var getDomain=Promise._getDomain,async=_dereq_("./async.js"),util=_dereq_("./util.js"),tryCatch=util.tryCatch,errorObj=util.errorObj;util.inherits(ReductionPromiseArray,PromiseArray),ReductionPromiseArray.prototype._init=function(){},ReductionPromiseArray.prototype._resolveEmptyArray=function(){(this._gotAccum||this._zerothIsAccum)&&this._resolve(null!==this._preservedValues?[]:this._accum)},ReductionPromiseArray.prototype._promiseFulfilled=function(value,index){var values=this._values;values[index]=value;var valuesPhaseIndex,length=this.length(),preservedValues=this._preservedValues,isEach=null!==preservedValues,gotAccum=this._gotAccum,valuesPhase=this._valuesPhase;if(!valuesPhase)for(valuesPhase=this._valuesPhase=new Array(length),valuesPhaseIndex=0;valuesPhaseIndex<length;++valuesPhaseIndex)valuesPhase[valuesPhaseIndex]=0;if(valuesPhaseIndex=valuesPhase[index],0===index&&this._zerothIsAccum?(this._accum=value,this._gotAccum=gotAccum=!0,valuesPhase[index]=0===valuesPhaseIndex?1:2):-1===index?(this._accum=value,this._gotAccum=gotAccum=!0):0===valuesPhaseIndex?valuesPhase[index]=1:(valuesPhase[index]=2,this._accum=value),gotAccum){for(var ret,callback=this._callback,receiver=this._promise._boundValue(),i=this._reducingIndex;i<length;++i)if(2!==(valuesPhaseIndex=valuesPhase[i])){if(1!==valuesPhaseIndex)return;if(value=values[i],this._promise._pushContext(),isEach?(preservedValues.push(value),ret=tryCatch(callback).call(receiver,value,i,length)):ret=tryCatch(callback).call(receiver,this._accum,value,i,length),this._promise._popContext(),ret===errorObj)return this._reject(ret.e);var maybePromise=tryConvertToPromise(ret,this._promise);if(maybePromise instanceof Promise){if(maybePromise=maybePromise._target(),maybePromise._isPending())return valuesPhase[i]=4,maybePromise._proxyPromiseArray(this,i);if(!maybePromise._isFulfilled())return this._reject(maybePromise._reason());ret=maybePromise._value()}this._reducingIndex=i+1,this._accum=ret}else this._reducingIndex=i+1;this._resolve(isEach?preservedValues:this._accum)}},Promise.prototype.reduce=function(fn,initialValue){return reduce(this,fn,initialValue,null)},Promise.reduce=function(promises,fn,initialValue,_each){return reduce(promises,fn,initialValue,_each)}}},{"./async.js":2,"./util.js":38}],31:[function(_dereq_,module,exports){"use strict";var schedule,util=_dereq_("./util"),noAsyncScheduler=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")};if(util.isNode&&"undefined"==typeof MutationObserver){var GlobalSetImmediate=global.setImmediate,ProcessNextTick=process.nextTick;schedule=util.isRecentNode?function(fn){GlobalSetImmediate.call(global,fn)}:function(fn){ProcessNextTick.call(process,fn)}}else"undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&window.navigator.standalone?schedule=void 0!==setImmediate?function(fn){setImmediate(fn)}:"undefined"!=typeof setTimeout?function(fn){setTimeout(fn,0)}:noAsyncScheduler:(schedule=function(fn){var div=document.createElement("div");return new MutationObserver(fn).observe(div,{attributes:!0}),function(){div.classList.toggle("foo")}},schedule.isStatic=!0);module.exports=schedule},{"./util":38}],32:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray){function SettledPromiseArray(values){this.constructor$(values)}var PromiseInspection=Promise.PromiseInspection;_dereq_("./util.js").inherits(SettledPromiseArray,PromiseArray),SettledPromiseArray.prototype._promiseResolved=function(index,inspection){this._values[index]=inspection,++this._totalResolved>=this._length&&this._resolve(this._values)},SettledPromiseArray.prototype._promiseFulfilled=function(value,index){var ret=new PromiseInspection;ret._bitField=268435456,ret._settledValue=value,this._promiseResolved(index,ret)},SettledPromiseArray.prototype._promiseRejected=function(reason,index){var ret=new PromiseInspection;ret._bitField=134217728,ret._settledValue=reason,this._promiseResolved(index,ret)},Promise.settle=function(promises){
return new SettledPromiseArray(promises).promise()},Promise.prototype.settle=function(){return new SettledPromiseArray(this).promise()}}},{"./util.js":38}],33:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,PromiseArray,apiRejection){function SomePromiseArray(values){this.constructor$(values),this._howMany=0,this._unwrap=!1,this._initialized=!1}function some(promises,howMany){if((0|howMany)!==howMany||howMany<0)return apiRejection("expecting a positive integer\n\n    See http://goo.gl/1wAmHx\n");var ret=new SomePromiseArray(promises),promise=ret.promise();return ret.setHowMany(howMany),ret.init(),promise}var util=_dereq_("./util.js"),RangeError=_dereq_("./errors.js").RangeError,AggregateError=_dereq_("./errors.js").AggregateError,isArray=util.isArray;util.inherits(SomePromiseArray,PromiseArray),SomePromiseArray.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var isArrayResolved=isArray(this._values);!this._isResolved()&&isArrayResolved&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},SomePromiseArray.prototype.init=function(){this._initialized=!0,this._init()},SomePromiseArray.prototype.setUnwrap=function(){this._unwrap=!0},SomePromiseArray.prototype.howMany=function(){return this._howMany},SomePromiseArray.prototype.setHowMany=function(count){this._howMany=count},SomePromiseArray.prototype._promiseFulfilled=function(value){this._addFulfilled(value),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values))},SomePromiseArray.prototype._promiseRejected=function(reason){if(this._addRejected(reason),this.howMany()>this._canPossiblyFulfill()){for(var e=new AggregateError,i=this.length();i<this._values.length;++i)e.push(this._values[i]);this._reject(e)}},SomePromiseArray.prototype._fulfilled=function(){return this._totalResolved},SomePromiseArray.prototype._rejected=function(){return this._values.length-this.length()},SomePromiseArray.prototype._addRejected=function(reason){this._values.push(reason)},SomePromiseArray.prototype._addFulfilled=function(value){this._values[this._totalResolved++]=value},SomePromiseArray.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},SomePromiseArray.prototype._getRangeError=function(count){var message="Input array must contain at least "+this._howMany+" items but contains only "+count+" items";return new RangeError(message)},SomePromiseArray.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},Promise.some=function(promises,howMany){return some(promises,howMany)},Promise.prototype.some=function(howMany){return some(this,howMany)},Promise._SomePromiseArray=SomePromiseArray}},{"./errors.js":13,"./util.js":38}],34:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise){function PromiseInspection(promise){void 0!==promise?(promise=promise._target(),this._bitField=promise._bitField,this._settledValue=promise._settledValue):(this._bitField=0,this._settledValue=void 0)}PromiseInspection.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return this._settledValue},PromiseInspection.prototype.error=PromiseInspection.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return this._settledValue},PromiseInspection.prototype.isFulfilled=Promise.prototype._isFulfilled=function(){return(268435456&this._bitField)>0},PromiseInspection.prototype.isRejected=Promise.prototype._isRejected=function(){return(134217728&this._bitField)>0},PromiseInspection.prototype.isPending=Promise.prototype._isPending=function(){return 0==(402653184&this._bitField)},PromiseInspection.prototype.isResolved=Promise.prototype._isResolved=function(){return(402653184&this._bitField)>0},Promise.prototype.isPending=function(){return this._target()._isPending()},Promise.prototype.isRejected=function(){return this._target()._isRejected()},Promise.prototype.isFulfilled=function(){return this._target()._isFulfilled()},Promise.prototype.isResolved=function(){return this._target()._isResolved()},Promise.prototype._value=function(){return this._settledValue},Promise.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue},Promise.prototype.value=function(){var target=this._target();if(!target.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return target._settledValue},Promise.prototype.reason=function(){var target=this._target();if(!target.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return target._unsetRejectionIsUnhandled(),target._settledValue},Promise.PromiseInspection=PromiseInspection}},{}],35:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){function tryConvertToPromise(obj,context){if(isObject(obj)){if(obj instanceof Promise)return obj;if(isAnyBluebirdPromise(obj)){var ret=new Promise(INTERNAL);return obj._then(ret._fulfillUnchecked,ret._rejectUncheckedCheckError,ret._progressUnchecked,ret,null),ret}var then=util.tryCatch(getThen)(obj);if(then===errorObj){context&&context._pushContext();var ret=Promise.reject(then.e);return context&&context._popContext(),ret}if("function"==typeof then)return doThenable(obj,then,context)}return obj}function getThen(obj){return obj.then}function isAnyBluebirdPromise(obj){return hasProp.call(obj,"_promise0")}function doThenable(x,then,context){function resolveFromThenable(value){promise&&(promise._resolveCallback(value),promise=null)}function rejectFromThenable(reason){promise&&(promise._rejectCallback(reason,synchronous,!0),promise=null)}function progressFromThenable(value){promise&&"function"==typeof promise._progress&&promise._progress(value)}var promise=new Promise(INTERNAL),ret=promise;context&&context._pushContext(),promise._captureStackTrace(),context&&context._popContext();var synchronous=!0,result=util.tryCatch(then).call(x,resolveFromThenable,rejectFromThenable,progressFromThenable);return synchronous=!1,promise&&result===errorObj&&(promise._rejectCallback(result.e,!0,!0),promise=null),ret}var util=_dereq_("./util.js"),errorObj=util.errorObj,isObject=util.isObject,hasProp={}.hasOwnProperty;return tryConvertToPromise}},{"./util.js":38}],36:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,INTERNAL){function successClear(value){var handle=this;return handle instanceof Number&&(handle=+handle),clearTimeout(handle),value}function failureClear(reason){var handle=this;throw handle instanceof Number&&(handle=+handle),clearTimeout(handle),reason}var util=_dereq_("./util.js"),TimeoutError=Promise.TimeoutError,afterTimeout=function(promise,message){if(promise.isPending()){var err;!util.isPrimitive(message)&&message instanceof Error?err=message:("string"!=typeof message&&(message="operation timed out"),err=new TimeoutError(message)),util.markAsOriginatingFromRejection(err),promise._attachExtraTrace(err),promise._cancel(err)}},afterValue=function(value){return delay(+this).thenReturn(value)},delay=Promise.delay=function(value,ms){if(void 0===ms){ms=value,value=void 0;var ret=new Promise(INTERNAL);return setTimeout(function(){ret._fulfill()},ms),ret}return ms=+ms,Promise.resolve(value)._then(afterValue,null,null,ms,void 0)};Promise.prototype.delay=function(ms){return delay(this,ms)},Promise.prototype.timeout=function(ms,message){ms=+ms;var ret=this.then().cancellable();ret._cancellationParent=this;var handle=setTimeout(function(){afterTimeout(ret,message)},ms);return ret._then(successClear,failureClear,void 0,handle,void 0)}}},{"./util.js":38}],37:[function(_dereq_,module,exports){"use strict";module.exports=function(Promise,apiRejection,tryConvertToPromise,createContext){function inspectionMapper(inspections){for(var len=inspections.length,i=0;i<len;++i){var inspection=inspections[i];if(inspection.isRejected())return Promise.reject(inspection.error());inspections[i]=inspection._settledValue}return inspections}function thrower(e){setTimeout(function(){throw e},0)}function castPreservingDisposable(thenable){var maybePromise=tryConvertToPromise(thenable);return maybePromise!==thenable&&"function"==typeof thenable._isDisposable&&"function"==typeof thenable._getDisposer&&thenable._isDisposable()&&maybePromise._setDisposable(thenable._getDisposer()),maybePromise}function dispose(resources,inspection){function iterator(){if(i>=len)return ret.resolve();var maybePromise=castPreservingDisposable(resources[i++]);if(maybePromise instanceof Promise&&maybePromise._isDisposable()){try{maybePromise=tryConvertToPromise(maybePromise._getDisposer().tryDispose(inspection),resources.promise)}catch(e){return thrower(e)}if(maybePromise instanceof Promise)return maybePromise._then(iterator,thrower,null,null,null)}iterator()}var i=0,len=resources.length,ret=Promise.defer();return iterator(),ret.promise}function disposerSuccess(value){var inspection=new PromiseInspection;return inspection._settledValue=value,inspection._bitField=268435456,dispose(this,inspection).thenReturn(value)}function disposerFail(reason){var inspection=new PromiseInspection;return inspection._settledValue=reason,inspection._bitField=134217728,dispose(this,inspection).thenThrow(reason)}function Disposer(data,promise,context){this._data=data,this._promise=promise,this._context=context}function FunctionDisposer(fn,promise,context){this.constructor$(fn,promise,context)}function maybeUnwrapDisposer(value){return Disposer.isDisposer(value)?(this.resources[this.index]._setDisposable(value),value.promise()):value}var TypeError=_dereq_("./errors.js").TypeError,inherits=_dereq_("./util.js").inherits,PromiseInspection=Promise.PromiseInspection;Disposer.prototype.data=function(){return this._data},Disposer.prototype.promise=function(){return this._promise},Disposer.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},Disposer.prototype.tryDispose=function(inspection){var resource=this.resource(),context=this._context;void 0!==context&&context._pushContext();var ret=null!==resource?this.doDispose(resource,inspection):null;return void 0!==context&&context._popContext(),this._promise._unsetDisposable(),this._data=null,ret},Disposer.isDisposer=function(d){return null!=d&&"function"==typeof d.resource&&"function"==typeof d.tryDispose},inherits(FunctionDisposer,Disposer),FunctionDisposer.prototype.doDispose=function(resource,inspection){return this.data().call(resource,resource,inspection)},Promise.using=function(){var len=arguments.length;if(len<2)return apiRejection("you must pass at least 2 arguments to Promise.using");var fn=arguments[len-1];if("function"!=typeof fn)return apiRejection("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var input,spreadArgs=!0;2===len&&Array.isArray(arguments[0])?(input=arguments[0],len=input.length,spreadArgs=!1):(input=arguments,len--);for(var resources=new Array(len),i=0;i<len;++i){var resource=input[i];if(Disposer.isDisposer(resource)){var disposer=resource;resource=resource.promise(),resource._setDisposable(disposer)}else{var maybePromise=tryConvertToPromise(resource);maybePromise instanceof Promise&&(resource=maybePromise._then(maybeUnwrapDisposer,null,null,{resources:resources,index:i},void 0))}resources[i]=resource}var promise=Promise.settle(resources).then(inspectionMapper).then(function(vals){promise._pushContext();var ret;try{ret=spreadArgs?fn.apply(void 0,vals):fn.call(void 0,vals)}finally{promise._popContext()}return ret})._then(disposerSuccess,disposerFail,void 0,resources,void 0);return resources.promise=promise,promise},Promise.prototype._setDisposable=function(disposer){this._bitField=262144|this._bitField,this._disposer=disposer},Promise.prototype._isDisposable=function(){return(262144&this._bitField)>0},Promise.prototype._getDisposer=function(){return this._disposer},Promise.prototype._unsetDisposable=function(){this._bitField=-262145&this._bitField,this._disposer=void 0},Promise.prototype.disposer=function(fn){if("function"==typeof fn)return new FunctionDisposer(fn,this,createContext());throw new TypeError}}},{"./errors.js":13,"./util.js":38}],38:[function(_dereq_,module,exports){"use strict";function tryCatcher(){try{var target=tryCatchTarget;return tryCatchTarget=null,target.apply(this,arguments)}catch(e){return errorObj.e=e,errorObj}}function tryCatch(fn){return tryCatchTarget=fn,tryCatcher}function isPrimitive(val){return null==val||!0===val||!1===val||"string"==typeof val||"number"==typeof val}function isObject(value){return!isPrimitive(value)}function maybeWrapAsError(maybeError){return isPrimitive(maybeError)?new Error(safeToString(maybeError)):maybeError}function withAppended(target,appendee){var i,len=target.length,ret=new Array(len+1);for(i=0;i<len;++i)ret[i]=target[i];return ret[i]=appendee,ret}function getDataPropertyOrDefault(obj,key,defaultValue){if(!es5.isES5)return{}.hasOwnProperty.call(obj,key)?obj[key]:void 0;var desc=Object.getOwnPropertyDescriptor(obj,key);return null!=desc?null==desc.get&&null==desc.set?desc.value:defaultValue:void 0}function notEnumerableProp(obj,name,value){if(isPrimitive(obj))return obj;var descriptor={value:value,configurable:!0,enumerable:!1,writable:!0};return es5.defineProperty(obj,name,descriptor),obj}function thrower(r){throw r}function isClass(fn){try{if("function"==typeof fn){var keys=es5.names(fn.prototype),hasMethods=es5.isES5&&keys.length>1,hasMethodsOtherThanConstructor=keys.length>0&&!(1===keys.length&&"constructor"===keys[0]),hasThisAssignmentAndStaticMethods=thisAssignmentPattern.test(fn+"")&&es5.names(fn).length>0;if(hasMethods||hasMethodsOtherThanConstructor||hasThisAssignmentAndStaticMethods)return!0}return!1}catch(e){return!1}}function toFastProperties(obj){function f(){}f.prototype=obj;for(var l=8;l--;)new f;return obj}function isIdentifier(str){return rident.test(str)}function filledRange(count,prefix,suffix){for(var ret=new Array(count),i=0;i<count;++i)ret[i]=prefix+i+suffix;return ret}function safeToString(obj){try{return obj+""}catch(e){return"[no string representation]"}}function markAsOriginatingFromRejection(e){try{notEnumerableProp(e,"isOperational",!0)}catch(ignore){}}function originatesFromRejection(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)}function canAttachTrace(obj){return obj instanceof Error&&es5.propertyIsWritable(obj,"stack")}function classString(obj){return{}.toString.call(obj)}function copyDescriptors(from,to,filter){for(var keys=es5.names(from),i=0;i<keys.length;++i){var key=keys[i];if(filter(key))try{es5.defineProperty(to,key,es5.getDescriptor(from,key))}catch(ignore){}}}var es5=_dereq_("./es5.js"),canEvaluate="undefined"==typeof navigator,haveGetters=function(){try{var o={};return es5.defineProperty(o,"f",{get:function(){return 3}}),3===o.f}catch(e){return!1}}(),errorObj={e:{}},tryCatchTarget,inherits=function(Child,Parent){function T(){this.constructor=Child,this.constructor$=Parent;for(var propertyName in Parent.prototype)hasProp.call(Parent.prototype,propertyName)&&"$"!==propertyName.charAt(propertyName.length-1)&&(this[propertyName+"$"]=Parent.prototype[propertyName])}var hasProp={}.hasOwnProperty;return T.prototype=Parent.prototype,Child.prototype=new T,Child.prototype},inheritedDataKeys=function(){var excludedPrototypes=[Array.prototype,Object.prototype,Function.prototype],isExcludedProto=function(val){for(var i=0;i<excludedPrototypes.length;++i)if(excludedPrototypes[i]===val)return!0;return!1};if(es5.isES5){var getKeys=Object.getOwnPropertyNames;return function(obj){for(var ret=[],visitedKeys=Object.create(null);null!=obj&&!isExcludedProto(obj);){var keys;try{keys=getKeys(obj)}catch(e){return ret}for(var i=0;i<keys.length;++i){var key=keys[i];if(!visitedKeys[key]){visitedKeys[key]=!0;var desc=Object.getOwnPropertyDescriptor(obj,key);null!=desc&&null==desc.get&&null==desc.set&&ret.push(key)}}obj=es5.getPrototypeOf(obj)}return ret}}var hasProp={}.hasOwnProperty;return function(obj){if(isExcludedProto(obj))return[];var ret=[];enumeration:for(var key in obj)if(hasProp.call(obj,key))ret.push(key);else{for(var i=0;i<excludedPrototypes.length;++i)if(hasProp.call(excludedPrototypes[i],key))continue enumeration;ret.push(key)}return ret}}(),thisAssignmentPattern=/this\s*\.\s*\S+\s*=/,rident=/^[a-z$_][a-z$_0-9]*$/i,ensureErrorObject=function(){return"stack"in new Error?function(value){return canAttachTrace(value)?value:new Error(safeToString(value))}:function(value){if(canAttachTrace(value))return value;try{throw new Error(safeToString(value))}catch(err){return err}}}(),ret={isClass:isClass,isIdentifier:isIdentifier,inheritedDataKeys:inheritedDataKeys,getDataPropertyOrDefault:getDataPropertyOrDefault,thrower:thrower,isArray:es5.isArray,haveGetters:haveGetters,notEnumerableProp:notEnumerableProp,isPrimitive:isPrimitive,isObject:isObject,canEvaluate:canEvaluate,errorObj:errorObj,tryCatch:tryCatch,inherits:inherits,withAppended:withAppended,maybeWrapAsError:maybeWrapAsError,toFastProperties:toFastProperties,filledRange:filledRange,toString:safeToString,canAttachTrace:canAttachTrace,ensureErrorObject:ensureErrorObject,originatesFromRejection:originatesFromRejection,markAsOriginatingFromRejection:markAsOriginatingFromRejection,classString:classString,copyDescriptors:copyDescriptors,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:void 0!==process&&"[object process]"===classString(process).toLowerCase()};ret.isRecentNode=ret.isNode&&function(){var version=process.versions.node.split(".").map(Number);return 0===version[0]&&version[1]>10||version[0]>0}(),ret.isNode&&ret.toFastProperties(process);try{throw new Error}catch(e){ret.lastLineError=e}module.exports=ret},{"./es5.js":14}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("timers").setImmediate)},{_process:294,timers:306}],116:[function(require,module,exports){"use strict";function earcut(data,holeIndices,dim){dim=dim||2;var hasHoles=holeIndices&&holeIndices.length,outerLen=hasHoles?holeIndices[0]*dim:data.length,outerNode=linkedList(data,0,outerLen,dim,!0),triangles=[];if(!outerNode)return triangles;var minX,minY,maxX,maxY,x,y,invSize;if(hasHoles&&(outerNode=eliminateHoles(data,holeIndices,outerNode,dim)),data.length>80*dim){minX=maxX=data[0],minY=maxY=data[1];for(var i=dim;i<outerLen;i+=dim)x=data[i],y=data[i+1],x<minX&&(minX=x),y<minY&&(minY=y),x>maxX&&(maxX=x),y>maxY&&(maxY=y);invSize=Math.max(maxX-minX,maxY-minY),invSize=0!==invSize?1/invSize:0}return earcutLinked(outerNode,triangles,dim,minX,minY,invSize),triangles}function linkedList(data,start,end,dim,clockwise){var i,last;if(clockwise===signedArea(data,start,end,dim)>0)for(i=start;i<end;i+=dim)last=insertNode(i,data[i],data[i+1],last);else for(i=end-dim;i>=start;i-=dim)last=insertNode(i,data[i],data[i+1],last);return last&&equals(last,last.next)&&(removeNode(last),last=last.next),last}function filterPoints(start,end){if(!start)return start;end||(end=start);var again,p=start;do{if(again=!1,p.steiner||!equals(p,p.next)&&0!==area(p.prev,p,p.next))p=p.next;else{if(removeNode(p),(p=end=p.prev)===p.next)break;again=!0}}while(again||p!==end);return end}function earcutLinked(ear,triangles,dim,minX,minY,invSize,pass){if(ear){!pass&&invSize&&indexCurve(ear,minX,minY,invSize);for(var prev,next,stop=ear;ear.prev!==ear.next;)if(prev=ear.prev,next=ear.next,invSize?isEarHashed(ear,minX,minY,invSize):isEar(ear))triangles.push(prev.i/dim),triangles.push(ear.i/dim),triangles.push(next.i/dim),removeNode(ear),ear=next.next,stop=next.next;else if((ear=next)===stop){pass?1===pass?(ear=cureLocalIntersections(ear,triangles,dim),earcutLinked(ear,triangles,dim,minX,minY,invSize,2)):2===pass&&splitEarcut(ear,triangles,dim,minX,minY,invSize):earcutLinked(filterPoints(ear),triangles,dim,minX,minY,invSize,1);break}}}function isEar(ear){var a=ear.prev,b=ear,c=ear.next;if(area(a,b,c)>=0)return!1;for(var p=ear.next.next;p!==ear.prev;){if(pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function isEarHashed(ear,minX,minY,invSize){var a=ear.prev,b=ear,c=ear.next;if(area(a,b,c)>=0)return!1;for(var minTX=a.x<b.x?a.x<c.x?a.x:c.x:b.x<c.x?b.x:c.x,minTY=a.y<b.y?a.y<c.y?a.y:c.y:b.y<c.y?b.y:c.y,maxTX=a.x>b.x?a.x>c.x?a.x:c.x:b.x>c.x?b.x:c.x,maxTY=a.y>b.y?a.y>c.y?a.y:c.y:b.y>c.y?b.y:c.y,minZ=zOrder(minTX,minTY,minX,minY,invSize),maxZ=zOrder(maxTX,maxTY,minX,minY,invSize),p=ear.prevZ,n=ear.nextZ;p&&p.z>=minZ&&n&&n.z<=maxZ;){if(p!==ear.prev&&p!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,n!==ear.prev&&n!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,n.x,n.y)&&area(n.prev,n,n.next)>=0)return!1;n=n.nextZ}for(;p&&p.z>=minZ;){if(p!==ear.prev&&p!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;n&&n.z<=maxZ;){if(n!==ear.prev&&n!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,n.x,n.y)&&area(n.prev,n,n.next)>=0)return!1;n=n.nextZ}return!0}function cureLocalIntersections(start,triangles,dim){var p=start;do{var a=p.prev,b=p.next.next;!equals(a,b)&&intersects(a,p,p.next,b)&&locallyInside(a,b)&&locallyInside(b,a)&&(triangles.push(a.i/dim),triangles.push(p.i/dim),triangles.push(b.i/dim),removeNode(p),removeNode(p.next),p=start=b),p=p.next}while(p!==start);return p}function splitEarcut(start,triangles,dim,minX,minY,invSize){var a=start;do{for(var b=a.next.next;b!==a.prev;){if(a.i!==b.i&&isValidDiagonal(a,b)){var c=splitPolygon(a,b);return a=filterPoints(a,a.next),c=filterPoints(c,c.next),earcutLinked(a,triangles,dim,minX,minY,invSize),void earcutLinked(c,triangles,dim,minX,minY,invSize)}b=b.next}a=a.next}while(a!==start)}function eliminateHoles(data,holeIndices,outerNode,dim){var i,len,start,end,list,queue=[];for(i=0,len=holeIndices.length;i<len;i++)start=holeIndices[i]*dim,end=i<len-1?holeIndices[i+1]*dim:data.length,list=linkedList(data,start,end,dim,!1),list===list.next&&(list.steiner=!0),queue.push(getLeftmost(list));for(queue.sort(compareX),i=0;i<queue.length;i++)eliminateHole(queue[i],outerNode),outerNode=filterPoints(outerNode,outerNode.next);return outerNode}function compareX(a,b){return a.x-b.x}function eliminateHole(hole,outerNode){if(outerNode=findHoleBridge(hole,outerNode)){var b=splitPolygon(outerNode,hole);filterPoints(b,b.next)}}function findHoleBridge(hole,outerNode){var m,p=outerNode,hx=hole.x,hy=hole.y,qx=-1/0;do{if(hy<=p.y&&hy>=p.next.y&&p.next.y!==p.y){var x=p.x+(hy-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(x<=hx&&x>qx){if(qx=x,x===hx){if(hy===p.y)return p;if(hy===p.next.y)return p.next}m=p.x<p.next.x?p:p.next}}p=p.next}while(p!==outerNode);if(!m)return null;if(hx===qx)return m.prev;var tan,stop=m,mx=m.x,my=m.y,tanMin=1/0;for(p=m.next;p!==stop;)hx>=p.x&&p.x>=mx&&hx!==p.x&&pointInTriangle(hy<my?hx:qx,hy,mx,my,hy<my?qx:hx,hy,p.x,p.y)&&((tan=Math.abs(hy-p.y)/(hx-p.x))<tanMin||tan===tanMin&&p.x>m.x)&&locallyInside(p,hole)&&(m=p,tanMin=tan),p=p.next;return m}function indexCurve(start,minX,minY,invSize){var p=start;do{null===p.z&&(p.z=zOrder(p.x,p.y,minX,minY,invSize)),p.prevZ=p.prev,p.nextZ=p.next,p=p.next}while(p!==start);p.prevZ.nextZ=null,p.prevZ=null,sortLinked(p)}function sortLinked(list){var i,p,q,e,tail,numMerges,pSize,qSize,inSize=1;do{for(p=list,list=null,tail=null,numMerges=0;p;){for(numMerges++,q=p,pSize=0,i=0;i<inSize&&(pSize++,q=q.nextZ);i++);for(qSize=inSize;pSize>0||qSize>0&&q;)0!==pSize&&(0===qSize||!q||p.z<=q.z)?(e=p,p=p.nextZ,pSize--):(e=q,q=q.nextZ,qSize--),tail?tail.nextZ=e:list=e,e.prevZ=tail,tail=e;p=q}tail.nextZ=null,inSize*=2}while(numMerges>1);return list}function zOrder(x,y,minX,minY,invSize){return x=32767*(x-minX)*invSize,y=32767*(y-minY)*invSize,x=16711935&(x|x<<8),x=252645135&(x|x<<4),x=858993459&(x|x<<2),x=1431655765&(x|x<<1),y=16711935&(y|y<<8),y=252645135&(y|y<<4),y=858993459&(y|y<<2),y=1431655765&(y|y<<1),x|y<<1}function getLeftmost(start){var p=start,leftmost=start;do{p.x<leftmost.x&&(leftmost=p),p=p.next}while(p!==start);return leftmost}function pointInTriangle(ax,ay,bx,by,cx,cy,px,py){return(cx-px)*(ay-py)-(ax-px)*(cy-py)>=0&&(ax-px)*(by-py)-(bx-px)*(ay-py)>=0&&(bx-px)*(cy-py)-(cx-px)*(by-py)>=0}function isValidDiagonal(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!intersectsPolygon(a,b)&&locallyInside(a,b)&&locallyInside(b,a)&&middleInside(a,b)}function area(p,q,r){return(q.y-p.y)*(r.x-q.x)-(q.x-p.x)*(r.y-q.y)}function equals(p1,p2){return p1.x===p2.x&&p1.y===p2.y}function intersects(p1,q1,p2,q2){return!!(equals(p1,q1)&&equals(p2,q2)||equals(p1,q2)&&equals(p2,q1))||area(p1,q1,p2)>0!=area(p1,q1,q2)>0&&area(p2,q2,p1)>0!=area(p2,q2,q1)>0}function intersectsPolygon(a,b){var p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==b.i&&p.next.i!==b.i&&intersects(p,p.next,a,b))return!0;p=p.next}while(p!==a);return!1}function locallyInside(a,b){return area(a.prev,a,a.next)<0?area(a,b,a.next)>=0&&area(a,a.prev,b)>=0:area(a,b,a.prev)<0||area(a,a.next,b)<0}function middleInside(a,b){var p=a,inside=!1,px=(a.x+b.x)/2,py=(a.y+b.y)/2;do{p.y>py!=p.next.y>py&&p.next.y!==p.y&&px<(p.next.x-p.x)*(py-p.y)/(p.next.y-p.y)+p.x&&(inside=!inside),p=p.next}while(p!==a);return inside}function splitPolygon(a,b){var a2=new Node(a.i,a.x,a.y),b2=new Node(b.i,b.x,b.y),an=a.next,bp=b.prev;return a.next=b,b.prev=a,a2.next=an,an.prev=a2,b2.next=a2,a2.prev=b2,bp.next=b2,b2.prev=bp,b2}function insertNode(i,x,y,last){var p=new Node(i,x,y);return last?(p.next=last.next,p.prev=last,last.next.prev=p,last.next=p):(p.prev=p,p.next=p),p}function removeNode(p){p.next.prev=p.prev,p.prev.next=p.next,p.prevZ&&(p.prevZ.nextZ=p.nextZ),p.nextZ&&(p.nextZ.prevZ=p.prevZ)}function Node(i,x,y){this.i=i,this.x=x,this.y=y,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(data,start,end,dim){for(var sum=0,i=start,j=end-dim;i<end;i+=dim)sum+=(data[j]-data[i])*(data[i+1]+data[j+1]),j=i;return sum}module.exports=earcut,module.exports.default=earcut,earcut.deviation=function(data,holeIndices,dim,triangles){var hasHoles=holeIndices&&holeIndices.length,outerLen=hasHoles?holeIndices[0]*dim:data.length,polygonArea=Math.abs(signedArea(data,0,outerLen,dim));if(hasHoles)for(var i=0,len=holeIndices.length;i<len;i++){var start=holeIndices[i]*dim,end=i<len-1?holeIndices[i+1]*dim:data.length;polygonArea-=Math.abs(signedArea(data,start,end,dim))}var trianglesArea=0;for(i=0;i<triangles.length;i+=3){var a=triangles[i]*dim,b=triangles[i+1]*dim,c=triangles[i+2]*dim;trianglesArea+=Math.abs((data[a]-data[c])*(data[b+1]-data[a+1])-(data[a]-data[b])*(data[c+1]-data[a+1]))}return 0===polygonArea&&0===trianglesArea?0:Math.abs((trianglesArea-polygonArea)/polygonArea)},earcut.flatten=function(data){for(var dim=data[0][0].length,result={vertices:[],holes:[],dimensions:dim},holeIndex=0,i=0;i<data.length;i++){for(var j=0;j<data[i].length;j++)for(var d=0;d<dim;d++)result.vertices.push(data[i][j][d]);i>0&&(holeIndex+=data[i-1].length,result.holes.push(holeIndex))}return result}},{}],117:[function(require,module,exports){!function(undefined){function init(){this._events={},this._conf&&configure.call(this,this._conf)}function configure(conf){conf&&(this._conf=conf,conf.delimiter&&(this.delimiter=conf.delimiter),conf.maxListeners&&(this._events.maxListeners=conf.maxListeners),conf.wildcard&&(this.wildcard=conf.wildcard),conf.newListener&&(this.newListener=conf.newListener),this.wildcard&&(this.listenerTree={}))}function EventEmitter(conf){this._events={},this.newListener=!1,configure.call(this,conf)}function searchListenerTree(handlers,type,tree,i){if(!tree)return[];var leaf,len,branch,xTree,xxTree,isolatedBranch,endReached,listeners=[],typeLength=type.length,currentType=type[i],nextType=type[i+1];if(i===typeLength&&tree._listeners){if("function"==typeof tree._listeners)return handlers&&handlers.push(tree._listeners),[tree];for(leaf=0,len=tree._listeners.length;leaf<len;leaf++)handlers&&handlers.push(tree._listeners[leaf]);return[tree]}if("*"===currentType||"**"===currentType||tree[currentType]){if("*"===currentType){for(branch in tree)"_listeners"!==branch&&tree.hasOwnProperty(branch)&&(listeners=listeners.concat(searchListenerTree(handlers,type,tree[branch],i+1)));return listeners}if("**"===currentType){endReached=i+1===typeLength||i+2===typeLength&&"*"===nextType,endReached&&tree._listeners&&(listeners=listeners.concat(searchListenerTree(handlers,type,tree,typeLength)));for(branch in tree)"_listeners"!==branch&&tree.hasOwnProperty(branch)&&("*"===branch||"**"===branch?(tree[branch]._listeners&&!endReached&&(listeners=listeners.concat(searchListenerTree(handlers,type,tree[branch],typeLength))),listeners=listeners.concat(searchListenerTree(handlers,type,tree[branch],i))):listeners=branch===nextType?listeners.concat(searchListenerTree(handlers,type,tree[branch],i+2)):listeners.concat(searchListenerTree(handlers,type,tree[branch],i)));return listeners}listeners=listeners.concat(searchListenerTree(handlers,type,tree[currentType],i+1))}if(xTree=tree["*"],xTree&&searchListenerTree(handlers,type,xTree,i+1),xxTree=tree["**"])if(i<typeLength){xxTree._listeners&&searchListenerTree(handlers,type,xxTree,typeLength);for(branch in xxTree)"_listeners"!==branch&&xxTree.hasOwnProperty(branch)&&(branch===nextType?searchListenerTree(handlers,type,xxTree[branch],i+2):branch===currentType?searchListenerTree(handlers,type,xxTree[branch],i+1):(isolatedBranch={},isolatedBranch[branch]=xxTree[branch],searchListenerTree(handlers,type,{"**":isolatedBranch},i+1)))}else xxTree._listeners?searchListenerTree(handlers,type,xxTree,typeLength):xxTree["*"]&&xxTree["*"]._listeners&&searchListenerTree(handlers,type,xxTree["*"],typeLength);return listeners}function growListenerTree(type,listener){type="string"==typeof type?type.split(this.delimiter):type.slice();for(var i=0,len=type.length;i+1<len;i++)if("**"===type[i]&&"**"===type[i+1])return;for(var tree=this.listenerTree,name=type.shift();name;){if(tree[name]||(tree[name]={}),tree=tree[name],0===type.length){if(tree._listeners){if("function"==typeof tree._listeners)tree._listeners=[tree._listeners,listener];else if(isArray(tree._listeners)&&(tree._listeners.push(listener),!tree._listeners.warned)){var m=defaultMaxListeners;void 0!==this._events.maxListeners&&(m=this._events.maxListeners),m>0&&tree._listeners.length>m&&(tree._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",tree._listeners.length),console.trace())}}else tree._listeners=listener;return!0}name=type.shift()}return!0}var isArray=Array.isArray?Array.isArray:function(obj){return"[object Array]"===Object.prototype.toString.call(obj)},defaultMaxListeners=10;EventEmitter.prototype.delimiter=".",EventEmitter.prototype.setMaxListeners=function(n){this._events||init.call(this),this._events.maxListeners=n,this._conf||(this._conf={}),this._conf.maxListeners=n},EventEmitter.prototype.event="",EventEmitter.prototype.once=function(event,fn){return this.many(event,1,fn),this},EventEmitter.prototype.many=function(event,ttl,fn){function listener(){0==--ttl&&self.off(event,listener),fn.apply(this,arguments)}var self=this;if("function"!=typeof fn)throw new Error("many only accepts instances of Function");return listener._origin=fn,this.on(event,listener),self},EventEmitter.prototype.emit=function(){
this._events||init.call(this);var type=arguments[0];if("newListener"===type&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var l=arguments.length,args=new Array(l-1),i=1;i<l;i++)args[i-1]=arguments[i];for(i=0,l=this._all.length;i<l;i++)this.event=type,this._all[i].apply(this,args)}if("error"===type&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");var handler;if(this.wildcard){handler=[];var ns="string"==typeof type?type.split(this.delimiter):type.slice();searchListenerTree.call(this,handler,ns,this.listenerTree,0)}else handler=this._events[type];if("function"==typeof handler){if(this.event=type,1===arguments.length)handler.call(this);else if(arguments.length>1)switch(arguments.length){case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:for(var l=arguments.length,args=new Array(l-1),i=1;i<l;i++)args[i-1]=arguments[i];handler.apply(this,args)}return!0}if(handler){for(var l=arguments.length,args=new Array(l-1),i=1;i<l;i++)args[i-1]=arguments[i];for(var listeners=handler.slice(),i=0,l=listeners.length;i<l;i++)this.event=type,listeners[i].apply(this,args);return listeners.length>0||!!this._all}return!!this._all},EventEmitter.prototype.on=function(type,listener){if("function"==typeof type)return this.onAny(type),this;if("function"!=typeof listener)throw new Error("on only accepts instances of Function");if(this._events||init.call(this),this.emit("newListener",type,listener),this.wildcard)return growListenerTree.call(this,type,listener),this;if(this._events[type]){if("function"==typeof this._events[type])this._events[type]=[this._events[type],listener];else if(isArray(this._events[type])&&(this._events[type].push(listener),!this._events[type].warned)){var m=defaultMaxListeners;void 0!==this._events.maxListeners&&(m=this._events.maxListeners),m>0&&this._events[type].length>m&&(this._events[type].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length),console.trace())}}else this._events[type]=listener;return this},EventEmitter.prototype.onAny=function(fn){if("function"!=typeof fn)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(fn),this},EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prototype.off=function(type,listener){if("function"!=typeof listener)throw new Error("removeListener only takes instances of Function");var handlers,leafs=[];if(this.wildcard){var ns="string"==typeof type?type.split(this.delimiter):type.slice();leafs=searchListenerTree.call(this,null,ns,this.listenerTree,0)}else{if(!this._events[type])return this;handlers=this._events[type],leafs.push({_listeners:handlers})}for(var iLeaf=0;iLeaf<leafs.length;iLeaf++){var leaf=leafs[iLeaf];if(handlers=leaf._listeners,isArray(handlers)){for(var position=-1,i=0,length=handlers.length;i<length;i++)if(handlers[i]===listener||handlers[i].listener&&handlers[i].listener===listener||handlers[i]._origin&&handlers[i]._origin===listener){position=i;break}if(position<0)continue;return this.wildcard?leaf._listeners.splice(position,1):this._events[type].splice(position,1),0===handlers.length&&(this.wildcard?delete leaf._listeners:delete this._events[type]),this}(handlers===listener||handlers.listener&&handlers.listener===listener||handlers._origin&&handlers._origin===listener)&&(this.wildcard?delete leaf._listeners:delete this._events[type])}return this},EventEmitter.prototype.offAny=function(fn){var fns,i=0,l=0;if(fn&&this._all&&this._all.length>0){for(fns=this._all,i=0,l=fns.length;i<l;i++)if(fn===fns[i])return fns.splice(i,1),this}else this._all=[];return this},EventEmitter.prototype.removeListener=EventEmitter.prototype.off,EventEmitter.prototype.removeAllListeners=function(type){if(0===arguments.length)return!this._events||init.call(this),this;if(this.wildcard)for(var ns="string"==typeof type?type.split(this.delimiter):type.slice(),leafs=searchListenerTree.call(this,null,ns,this.listenerTree,0),iLeaf=0;iLeaf<leafs.length;iLeaf++){var leaf=leafs[iLeaf];leaf._listeners=null}else{if(!this._events[type])return this;this._events[type]=null}return this},EventEmitter.prototype.listeners=function(type){if(this.wildcard){var handlers=[],ns="string"==typeof type?type.split(this.delimiter):type.slice();return searchListenerTree.call(this,handlers,ns,this.listenerTree,0),handlers}return this._events||init.call(this),this._events[type]||(this._events[type]=[]),isArray(this._events[type])||(this._events[type]=[this._events[type]]),this._events[type]},EventEmitter.prototype.listenersAny=function(){return this._all?this._all:[]},"function"==typeof define&&define.amd?define(function(){return EventEmitter}):"object"==typeof exports?exports.EventEmitter2=EventEmitter:window.EventEmitter2=EventEmitter}()},{}],118:[function(require,module,exports){"use strict";function Events(){}function EE(fn,context,once){this.fn=fn,this.context=context,this.once=once||!1}function EventEmitter(){this._events=new Events,this._eventsCount=0}var has=Object.prototype.hasOwnProperty,prefix="~";Object.create&&(Events.prototype=Object.create(null),(new Events).__proto__||(prefix=!1)),EventEmitter.prototype.eventNames=function(){var events,name,names=[];if(0===this._eventsCount)return names;for(name in events=this._events)has.call(events,name)&&names.push(prefix?name.slice(1):name);return Object.getOwnPropertySymbols?names.concat(Object.getOwnPropertySymbols(events)):names},EventEmitter.prototype.listeners=function(event,exists){var evt=prefix?prefix+event:event,available=this._events[evt];if(exists)return!!available;if(!available)return[];if(available.fn)return[available.fn];for(var i=0,l=available.length,ee=new Array(l);i<l;i++)ee[i]=available[i].fn;return ee},EventEmitter.prototype.emit=function(event,a1,a2,a3,a4,a5){var evt=prefix?prefix+event:event;if(!this._events[evt])return!1;var args,i,listeners=this._events[evt],len=arguments.length;if(listeners.fn){switch(listeners.once&&this.removeListener(event,listeners.fn,void 0,!0),len){case 1:return listeners.fn.call(listeners.context),!0;case 2:return listeners.fn.call(listeners.context,a1),!0;case 3:return listeners.fn.call(listeners.context,a1,a2),!0;case 4:return listeners.fn.call(listeners.context,a1,a2,a3),!0;case 5:return listeners.fn.call(listeners.context,a1,a2,a3,a4),!0;case 6:return listeners.fn.call(listeners.context,a1,a2,a3,a4,a5),!0}for(i=1,args=new Array(len-1);i<len;i++)args[i-1]=arguments[i];listeners.fn.apply(listeners.context,args)}else{var j,length=listeners.length;for(i=0;i<length;i++)switch(listeners[i].once&&this.removeListener(event,listeners[i].fn,void 0,!0),len){case 1:listeners[i].fn.call(listeners[i].context);break;case 2:listeners[i].fn.call(listeners[i].context,a1);break;case 3:listeners[i].fn.call(listeners[i].context,a1,a2);break;case 4:listeners[i].fn.call(listeners[i].context,a1,a2,a3);break;default:if(!args)for(j=1,args=new Array(len-1);j<len;j++)args[j-1]=arguments[j];listeners[i].fn.apply(listeners[i].context,args)}}return!0},EventEmitter.prototype.on=function(event,fn,context){var listener=new EE(fn,context||this),evt=prefix?prefix+event:event;return this._events[evt]?this._events[evt].fn?this._events[evt]=[this._events[evt],listener]:this._events[evt].push(listener):(this._events[evt]=listener,this._eventsCount++),this},EventEmitter.prototype.once=function(event,fn,context){var listener=new EE(fn,context||this,!0),evt=prefix?prefix+event:event;return this._events[evt]?this._events[evt].fn?this._events[evt]=[this._events[evt],listener]:this._events[evt].push(listener):(this._events[evt]=listener,this._eventsCount++),this},EventEmitter.prototype.removeListener=function(event,fn,context,once){var evt=prefix?prefix+event:event;if(!this._events[evt])return this;if(!fn)return 0==--this._eventsCount?this._events=new Events:delete this._events[evt],this;var listeners=this._events[evt];if(listeners.fn)listeners.fn!==fn||once&&!listeners.once||context&&listeners.context!==context||(0==--this._eventsCount?this._events=new Events:delete this._events[evt]);else{for(var i=0,events=[],length=listeners.length;i<length;i++)(listeners[i].fn!==fn||once&&!listeners[i].once||context&&listeners[i].context!==context)&&events.push(listeners[i]);events.length?this._events[evt]=1===events.length?events[0]:events:0==--this._eventsCount?this._events=new Events:delete this._events[evt]}return this},EventEmitter.prototype.removeAllListeners=function(event){var evt;return event?(evt=prefix?prefix+event:event,this._events[evt]&&(0==--this._eventsCount?this._events=new Events:delete this._events[evt])):(this._events=new Events,this._eventsCount=0),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prototype.setMaxListeners=function(){return this},EventEmitter.prefixed=prefix,EventEmitter.EventEmitter=EventEmitter,void 0!==module&&(module.exports=EventEmitter)},{}],119:[function(require,module,exports){!function(global){var apple_phone=/iPhone/i,apple_ipod=/iPod/i,apple_tablet=/iPad/i,android_phone=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,android_tablet=/Android/i,amazon_phone=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,amazon_tablet=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,windows_phone=/Windows Phone/i,windows_tablet=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,other_blackberry=/BlackBerry/i,other_blackberry_10=/BB10/i,other_opera=/Opera Mini/i,other_chrome=/(CriOS|Chrome)(?=.*\bMobile\b)/i,other_firefox=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,seven_inch=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),match=function(regex,userAgent){return regex.test(userAgent)},IsMobileClass=function(userAgent){var ua=userAgent||navigator.userAgent,tmp=ua.split("[FBAN");if(void 0!==tmp[1]&&(ua=tmp[0]),tmp=ua.split("Twitter"),void 0!==tmp[1]&&(ua=tmp[0]),this.apple={phone:match(apple_phone,ua),ipod:match(apple_ipod,ua),tablet:!match(apple_phone,ua)&&match(apple_tablet,ua),device:match(apple_phone,ua)||match(apple_ipod,ua)||match(apple_tablet,ua)},this.amazon={phone:match(amazon_phone,ua),tablet:!match(amazon_phone,ua)&&match(amazon_tablet,ua),device:match(amazon_phone,ua)||match(amazon_tablet,ua)},this.android={phone:match(amazon_phone,ua)||match(android_phone,ua),tablet:!match(amazon_phone,ua)&&!match(android_phone,ua)&&(match(amazon_tablet,ua)||match(android_tablet,ua)),device:match(amazon_phone,ua)||match(amazon_tablet,ua)||match(android_phone,ua)||match(android_tablet,ua)},this.windows={phone:match(windows_phone,ua),tablet:match(windows_tablet,ua),device:match(windows_phone,ua)||match(windows_tablet,ua)},this.other={blackberry:match(other_blackberry,ua),blackberry10:match(other_blackberry_10,ua),opera:match(other_opera,ua),firefox:match(other_firefox,ua),chrome:match(other_chrome,ua),device:match(other_blackberry,ua)||match(other_blackberry_10,ua)||match(other_opera,ua)||match(other_firefox,ua)||match(other_chrome,ua)},this.seven_inch=match(seven_inch,ua),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this},instantiate=function(){var IM=new IsMobileClass;return IM.Class=IsMobileClass,IM};void 0!==module&&module.exports&&"undefined"==typeof window?module.exports=IsMobileClass:void 0!==module&&module.exports&&"undefined"!=typeof window?module.exports=instantiate():"function"==typeof define&&define.amd?define("isMobile",[],global.isMobile=instantiate()):global.isMobile=instantiate()}(this)},{}],120:[function(require,module,exports){!function(global,factory){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)}("undefined"!=typeof window?window:this,function(window,noGlobal){"use strict";function DOMEval(code,doc){doc=doc||document;var script=doc.createElement("script");script.text=code,doc.head.appendChild(script).parentNode.removeChild(script)}function isArrayLike(obj){var length=!!obj&&"length"in obj&&obj.length,type=jQuery.type(obj);return"function"!==type&&!jQuery.isWindow(obj)&&("array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj)}function nodeName(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()}function winnow(elements,qualifier,not){return jQuery.isFunction(qualifier)?jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not}):qualifier.nodeType?jQuery.grep(elements,function(elem){return elem===qualifier!==not}):"string"!=typeof qualifier?jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>-1!==not}):risSimple.test(qualifier)?jQuery.filter(qualifier,elements,not):(qualifier=jQuery.filter(qualifier,elements),jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>-1!==not&&1===elem.nodeType}))}function sibling(cur,dir){for(;(cur=cur[dir])&&1!==cur.nodeType;);return cur}function createOptions(options){var object={};return jQuery.each(options.match(rnothtmlwhite)||[],function(_,flag){object[flag]=!0}),object}function Identity(v){return v}function Thrower(ex){throw ex}function adoptValue(value,resolve,reject,noValue){var method;try{value&&jQuery.isFunction(method=value.promise)?method.call(value).done(resolve).fail(reject):value&&jQuery.isFunction(method=value.then)?method.call(value,resolve,reject):resolve.apply(void 0,[value].slice(noValue))}catch(value){reject.apply(void 0,[value])}}function completed(){document.removeEventListener("DOMContentLoaded",completed),window.removeEventListener("load",completed),jQuery.ready()}function Data(){this.expando=jQuery.expando+Data.uid++}function getData(data){return"true"===data||"false"!==data&&("null"===data?null:data===+data+""?+data:rbrace.test(data)?JSON.parse(data):data)}function dataAttr(elem,key,data){var name;if(void 0===data&&1===elem.nodeType)if(name="data-"+key.replace(rmultiDash,"-$&").toLowerCase(),"string"==typeof(data=elem.getAttribute(name))){try{data=getData(data)}catch(e){}dataUser.set(elem,key,data)}else data=void 0;return data}function adjustCSS(elem,prop,valueParts,tween){var adjusted,scale=1,maxIterations=20,currentValue=tween?function(){return tween.cur()}:function(){return jQuery.css(elem,prop,"")},initial=currentValue(),unit=valueParts&&valueParts[3]||(jQuery.cssNumber[prop]?"":"px"),initialInUnit=(jQuery.cssNumber[prop]||"px"!==unit&&+initial)&&rcssNum.exec(jQuery.css(elem,prop));if(initialInUnit&&initialInUnit[3]!==unit){unit=unit||initialInUnit[3],valueParts=valueParts||[],initialInUnit=+initial||1;do{scale=scale||".5",initialInUnit/=scale,jQuery.style(elem,prop,initialInUnit+unit)}while(scale!==(scale=currentValue()/initial)&&1!==scale&&--maxIterations)}return valueParts&&(initialInUnit=+initialInUnit||+initial||0,adjusted=valueParts[1]?initialInUnit+(valueParts[1]+1)*valueParts[2]:+valueParts[2],tween&&(tween.unit=unit,tween.start=initialInUnit,tween.end=adjusted)),adjusted}function getDefaultDisplay(elem){var temp,doc=elem.ownerDocument,nodeName=elem.nodeName,display=defaultDisplayMap[nodeName];return display||(temp=doc.body.appendChild(doc.createElement(nodeName)),display=jQuery.css(temp,"display"),temp.parentNode.removeChild(temp),"none"===display&&(display="block"),defaultDisplayMap[nodeName]=display,display)}function showHide(elements,show){for(var display,elem,values=[],index=0,length=elements.length;index<length;index++)elem=elements[index],elem.style&&(display=elem.style.display,show?("none"===display&&(values[index]=dataPriv.get(elem,"display")||null,values[index]||(elem.style.display="")),""===elem.style.display&&isHiddenWithinTree(elem)&&(values[index]=getDefaultDisplay(elem))):"none"!==display&&(values[index]="none",dataPriv.set(elem,"display",display)));for(index=0;index<length;index++)null!=values[index]&&(elements[index].style.display=values[index]);return elements}function getAll(context,tag){var ret;return ret=void 0!==context.getElementsByTagName?context.getElementsByTagName(tag||"*"):void 0!==context.querySelectorAll?context.querySelectorAll(tag||"*"):[],void 0===tag||tag&&nodeName(context,tag)?jQuery.merge([context],ret):ret}function setGlobalEval(elems,refElements){for(var i=0,l=elems.length;i<l;i++)dataPriv.set(elems[i],"globalEval",!refElements||dataPriv.get(refElements[i],"globalEval"))}function buildFragment(elems,context,scripts,selection,ignored){for(var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;i<l;i++)if((elem=elems[i])||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+jQuery.htmlPrefilter(elem)+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;jQuery.merge(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}else nodes.push(context.createTextNode(elem));for(fragment.textContent="",i=0;elem=nodes[i++];)if(selection&&jQuery.inArray(elem,selection)>-1)ignored&&ignored.push(elem);else if(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(fragment.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts)for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return fragment}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function on(elem,types,selector,data,fn,one){var origFn,type;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=void 0);for(type in types)on(elem,type,selector,data,types[type],one);return elem}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),!1===fn)fn=returnFalse;else if(!fn)return elem;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),elem.each(function(){jQuery.event.add(this,types,fn,data,selector)})}function manipulationTarget(elem,content){return nodeName(elem,"table")&&nodeName(11!==content.nodeType?content:content.firstChild,"tr")?jQuery(">tbody",elem)[0]||elem:elem}function disableScript(elem){return elem.type=(null!==elem.getAttribute("type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(1===dest.nodeType){if(dataPriv.hasData(src)&&(pdataOld=dataPriv.access(src),pdataCur=dataPriv.set(dest,pdataOld),events=pdataOld.events)){delete pdataCur.handle,pdataCur.events={};for(type in events)for(i=0,l=events[type].length;i<l;i++)jQuery.event.add(dest,type,events[type][i])}dataUser.hasData(src)&&(udataOld=dataUser.access(src),udataCur=jQuery.extend({},udataOld),dataUser.set(dest,udataCur))}}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();"input"===nodeName&&rcheckableType.test(src.type)?dest.checked=src.checked:"input"!==nodeName&&"textarea"!==nodeName||(dest.defaultValue=src.defaultValue)}function domManip(collection,args,callback,ignored){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=collection.length,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return collection.each(function(index){var self=collection.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),domManip(self,args,callback,ignored)});if(l&&(fragment=buildFragment(args,collection[0].ownerDocument,!1,collection,ignored),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first||ignored)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;i<l;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(collection[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;i<hasScripts;i++)node=scripts[i],rscriptType.test(node.type||"")&&!dataPriv.access(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl&&jQuery._evalUrl(node.src):DOMEval(node.textContent.replace(rcleanScript,""),doc))}return collection}function remove(elem,selector,keepData){for(var node,nodes=selector?jQuery.filter(selector,elem):elem,i=0;null!=(node=nodes[i]);i++)keepData||1!==node.nodeType||jQuery.cleanData(getAll(node)),node.parentNode&&(keepData&&jQuery.contains(node.ownerDocument,node)&&setGlobalEval(getAll(node,"script")),node.parentNode.removeChild(node));return elem}function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return computed=computed||getStyles(elem),computed&&(ret=computed.getPropertyValue(name)||computed[name],""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),!support.pixelMarginRight()&&rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0!==ret?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){return conditionFn()?void delete this.get:(this.get=hookFn).apply(this,arguments)}}}function vendorPropName(name){if(name in emptyStyle)return name;for(var capName=name[0].toUpperCase()+name.slice(1),i=cssPrefixes.length;i--;)if((name=cssPrefixes[i]+capName)in emptyStyle)return name}function finalPropName(name){var ret=jQuery.cssProps[name];return ret||(ret=jQuery.cssProps[name]=vendorPropName(name)||name),ret}function setPositiveNumber(elem,value,subtract){var matches=rcssNum.exec(value);return matches?Math.max(0,matches[2]-(subtract||0))+(matches[3]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i,val=0;for(i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0;i<4;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox,styles=getStyles(elem),val=curCSS(elem,name,styles),isBorderBox="border-box"===jQuery.css(elem,"boxSizing",!1,styles);return rnumnonpx.test(val)?val:(valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]),"auto"===val&&(val=elem["offset"+name[0].toUpperCase()+name.slice(1)]),(val=parseFloat(val)||0)+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px")}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function schedule(){inProgress&&(!1===document.hidden&&window.requestAnimationFrame?window.requestAnimationFrame(schedule):window.setTimeout(schedule,jQuery.fx.interval),jQuery.fx.tick())}function createFxNow(){return window.setTimeout(function(){fxNow=void 0}),fxNow=jQuery.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};for(includeWidth=includeWidth?1:0;i<4;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(Animation.tweeners[prop]||[]).concat(Animation.tweeners["*"]),index=0,length=collection.length;index<length;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var prop,value,toggle,hooks,oldfire,propTween,restoreDisplay,display,isBox="width"in props||"height"in props,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHiddenWithinTree(elem),dataShow=dataPriv.get(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})}));for(prop in props)if(value=props[prop],rfxtypes.test(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}if((propTween=!jQuery.isEmptyObject(props))||!jQuery.isEmptyObject(orig)){isBox&&1===elem.nodeType&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],restoreDisplay=dataShow&&dataShow.display,null==restoreDisplay&&(restoreDisplay=dataPriv.get(elem,"display")),display=jQuery.css(elem,"display"),"none"===display&&(restoreDisplay?display=restoreDisplay:(showHide([elem],!0),restoreDisplay=elem.style.display||restoreDisplay,display=jQuery.css(elem,"display"),showHide([elem]))),("inline"===display||"inline-block"===display&&null!=restoreDisplay)&&"none"===jQuery.css(elem,"float")&&(propTween||(anim.done(function(){style.display=restoreDisplay}),null==restoreDisplay&&(display=style.display,restoreDisplay="none"===display?"":display)),style.display="inline-block")),opts.overflow&&(style.overflow="hidden",anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]})),propTween=!1;for(prop in orig)propTween||(dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=dataPriv.access(elem,"fxshow",{display:restoreDisplay}),toggle&&(dataShow.hidden=!hidden),hidden&&showHide([elem],!0),anim.done(function(){hidden||showHide([elem]),dataPriv.remove(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])})),propTween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=propTween.start,hidden&&(propTween.end=propTween.start,propTween.start=0))}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],Array.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),(hooks=jQuery.cssHooks[name])&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function Animation(elem,properties,options){var result,stopped,index=0,length=Animation.prefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;index<length;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),percent<1&&length?remaining:(length||deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{},easing:jQuery.easing._default},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;index<length;index++)animation.tweens[index].run(1);return gotoEnd?(deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation,gotoEnd])):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);index<length;index++)if(result=Animation.prefilters[index].call(animation,elem,props,animation.opts))return jQuery.isFunction(result.stop)&&(jQuery._queueHooks(animation.elem,animation.opts.queue).stop=jQuery.proxy(result.stop,result)),result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation}function stripAndCollapse(value){return(value.match(rnothtmlwhite)||[]).join(" ")}function getClass(elem){return elem.getAttribute&&elem.getAttribute("class")||""}function buildParams(prefix,obj,traditional,add){var name;if(Array.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v&&null!=v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnothtmlwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}
finalDataType=finalDataType||firstDataType}if(finalDataType)return finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(!(conv=converters[prev+" "+current]||converters["* "+current]))for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){!0===conv?conv=converters[conv2]:!0!==converters[conv2]&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(!0!==conv)if(conv&&s.throws)response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}var arr=[],document=window.document,getProto=Object.getPrototypeOf,slice=arr.slice,concat=arr.concat,push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,fnToString=hasOwn.toString,ObjectFunctionString=fnToString.call(Object),support={},jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([a-z])/g,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:"3.2.1",constructor:jQuery,length:0,toArray:function(){return slice.call(this)},get:function(num){return null==num?slice.call(this):num<0?this[num+this.length]:this[num]},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret},each:function(callback){return jQuery.each(this,callback)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},end:function(){return this.prevObject||this.constructor()},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||jQuery.isFunction(target)||(target={}),i===length&&(target=this,i--);i<length;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=Array.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&Array.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+("3.2.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return"function"===jQuery.type(obj)},isWindow:function(obj){return null!=obj&&obj===obj.window},isNumeric:function(obj){var type=jQuery.type(obj);return("number"===type||"string"===type)&&!isNaN(obj-parseFloat(obj))},isPlainObject:function(obj){var proto,Ctor;return!(!obj||"[object Object]"!==toString.call(obj))&&(!(proto=getProto(obj))||"function"==typeof(Ctor=hasOwn.call(proto,"constructor")&&proto.constructor)&&fnToString.call(Ctor)===ObjectFunctionString)},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},type:function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(code){DOMEval(code)},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},each:function(obj,callback){var length,i=0;if(isArrayLike(obj))for(length=obj.length;i<length&&!1!==callback.call(obj[i],i,obj[i]);i++);else for(i in obj)if(!1===callback.call(obj[i],i,obj[i]))break;return obj},trim:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArrayLike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){return null==arr?-1:indexOf.call(arr,elem,i)},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;j<len;j++)first[i++]=second[j];return first.length=i,first},grep:function(elems,callback,invert){for(var matches=[],i=0,length=elems.length,callbackExpect=!invert;i<length;i++)!callback(elems[i],i)!==callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var length,value,i=0,ret=[];if(isArrayLike(elems))for(length=elems.length;i<length;i++)null!=(value=callback(elems[i],i,arg))&&ret.push(value);else for(i in elems)null!=(value=callback(elems[i],i,arg))&&ret.push(value);return concat.apply([],ret)},guid:1,proxy:function(fn,context){var tmp,args,proxy;if("string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn))return args=slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy},now:Date.now,support:support}),"function"==typeof Symbol&&(jQuery.fn[Symbol.iterator]=arr[Symbol.iterator]),jQuery.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){function Sizzle(selector,context,results,seed){var m,i,elem,nid,match,groups,newSelector,newContext=context&&context.ownerDocument,nodeType=context?context.nodeType:9;if(results=results||[],"string"!=typeof selector||!selector||1!==nodeType&&9!==nodeType&&11!==nodeType)return results;if(!seed&&((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,documentIsHTML)){if(11!==nodeType&&(match=rquickExpr.exec(selector)))if(m=match[1]){if(9===nodeType){if(!(elem=context.getElementById(m)))return results;if(elem.id===m)return results.push(elem),results}else if(newContext&&(elem=newContext.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&!compilerCache[selector+" "]&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(1!==nodeType)newContext=context,newSelector=selector;else if("object"!==context.nodeName.toLowerCase()){for((nid=context.getAttribute("id"))?nid=nid.replace(rcssescape,fcssescape):context.setAttribute("id",nid=expando),groups=tokenize(selector),i=groups.length;i--;)groups[i]="#"+nid+" "+toSelector(groups[i]);newSelector=groups.join(","),newContext=rsibling.test(selector)&&testContext(context.parentNode)||context}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{nid===expando&&context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var el=document.createElement("fieldset");try{return!!fn(el)}catch(e){return!1}finally{el.parentNode&&el.parentNode.removeChild(el),el=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=arr.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createDisabledPseudo(disabled){return function(elem){return"form"in elem?elem.parentNode&&!1===elem.disabled?"label"in elem?"label"in elem.parentNode?elem.parentNode.disabled===disabled:elem.disabled===disabled:elem.isDisabled===disabled||elem.isDisabled!==!disabled&&disabledAncestor(elem)===disabled:elem.disabled===disabled:"label"in elem&&elem.disabled===disabled}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&void 0!==context.getElementsByTagName&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";i<len;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,skip=combinator.next,key=skip||dir,checkNonElements=base&&"parentNode"===key,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml);return!1}:function(elem,context,xml){var oldCache,uniqueCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)if(outerCache=elem[expando]||(elem[expando]={}),uniqueCache=outerCache[elem.uniqueID]||(outerCache[elem.uniqueID]={}),skip&&skip===elem.nodeName.toLowerCase())elem=elem[dir]||elem;else{if((oldCache=uniqueCache[key])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(uniqueCache[key]=newCache,newCache[2]=matcher(elem,context,xml))return!0}return!1}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;i<len;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;i<len;i++)(elem=unmatched[i])&&(filter&&!filter(elem,context,xml)||(newUnmatched.push(elem),mapped&&map.push(i)));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));return checkContext=null,ret}];i<len;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;j<len&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context===document||context||outermost);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0,context||elem.ownerDocument===document||(setDocument(elem),xml=!documentIsHTML);matcher=elementMatchers[j++];)if(matcher(elem,context||document,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){for(var i=0,len=list.length;i<len;i++)if(list[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+identifier+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+identifier+")"),CLASS:new RegExp("^\\.("+identifier+")"),TAG:new RegExp("^("+identifier+"|[*])"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)},rcssescape=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,fcssescape=function(ch,asCodePoint){return asCodePoint?"\0"===ch?"�":ch.slice(0,-1)+"\\"+ch.charCodeAt(ch.length-1).toString(16)+" ":"\\"+ch},unloadHandler=function(){setDocument()},disabledAncestor=addCombinator(function(elem){return!0===elem.disabled&&("form"in elem||"label"in elem)},{dir:"parentNode",next:"legend"});try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return!!documentElement&&"HTML"!==documentElement.nodeName},setDocument=Sizzle.setDocument=function(node){var hasCompare,subWindow,doc=node?node.ownerDocument||node:preferredDoc;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=document.documentElement,documentIsHTML=!isXML(document),preferredDoc!==document&&(subWindow=document.defaultView)&&subWindow.top!==subWindow&&(subWindow.addEventListener?subWindow.addEventListener("unload",unloadHandler,!1):subWindow.attachEvent&&subWindow.attachEvent("onunload",unloadHandler)),support.attributes=assert(function(el){return el.className="i",!el.getAttribute("className")}),support.getElementsByTagName=assert(function(el){return el.appendChild(document.createComment("")),!el.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(document.getElementsByClassName),support.getById=assert(function(el){return docElem.appendChild(el).id=expando,!document.getElementsByName||!document.getElementsByName(expando).length}),support.getById?(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}},Expr.find.ID=function(id,context){if(void 0!==context.getElementById&&documentIsHTML){var elem=context.getElementById(id);return elem?[elem]:[]}}):(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=void 0!==elem.getAttributeNode&&elem.getAttributeNode("id");return node&&node.value===attrId}},Expr.find.ID=function(id,context){if(void 0!==context.getElementById&&documentIsHTML){var node,i,elems,elem=context.getElementById(id);if(elem){if((node=elem.getAttributeNode("id"))&&node.value===id)return[elem];for(elems=context.getElementsByName(id),i=0;elem=elems[i++];)if((node=elem.getAttributeNode("id"))&&node.value===id)return[elem]}return[]}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return void 0!==context.getElementsByTagName?context.getElementsByTagName(tag):support.qsa?context.querySelectorAll(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(void 0!==context.getElementsByClassName&&documentIsHTML)return context.getElementsByClassName(className)},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(document.querySelectorAll))&&(assert(function(el){docElem.appendChild(el).innerHTML="<a id='"+expando+"'></a><select id='"+expando+"-\r\\' msallowcapture=''><option selected=''></option></select>",el.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),el.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),el.querySelectorAll("[id~="+expando+"-]").length||rbuggyQSA.push("~="),el.querySelectorAll(":checked").length||rbuggyQSA.push(":checked"),el.querySelectorAll("a#"+expando+"+*").length||rbuggyQSA.push(".#.+[+~]")}),assert(function(el){el.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var input=document.createElement("input");input.setAttribute("type","hidden"),el.appendChild(input).setAttribute("name","D"),el.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),2!==el.querySelectorAll(":enabled").length&&rbuggyQSA.push(":enabled",":disabled"),docElem.appendChild(el).disabled=!0,2!==el.querySelectorAll(":disabled").length&&rbuggyQSA.push(":enabled",":disabled"),el.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(el){support.disconnectedMatch=matches.call(el,"*"),matches.call(el,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare||(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===document||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===document||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===document?-1:b===document?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},document):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&!compilerCache[expr+" "]&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.escape=function(sel){return(sel+"").replace(rcssescape,fcssescape)},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||void 0!==elem.getAttribute&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:!operator||(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:"|="===operator&&(result===check||result.slice(0,check.length+1)===check+"-"))}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,uniqueCache,outerCache,node,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType,diff=!1;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(node=parent,outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),cache=uniqueCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=nodeIndex&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){uniqueCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(node=elem,outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),cache=uniqueCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=nodeIndex),!1===diff)for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&(outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),uniqueCache[type]=[dirruns,diff]),node!==elem)););return(diff-=last)===first||diff%first==0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),input[0]=null,!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do{if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return(elemLang=elemLang.toLowerCase())===lang||0===elemLang.indexOf(lang+"-")}while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:createDisabledPseudo(!1),disabled:createDisabledPseudo(!0),checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,!0===elem.selected},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},
header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=function(type){return function(elem){return"input"===elem.nodeName.toLowerCase()&&elem.type===type}}(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=function(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){matched&&!(match=rcomma.exec(soFar))||(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)cached=matcherFromTokens(match[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers)),cached.selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(!(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0]))return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),!(selector=seed.length&&toSelector(tokens)))return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,!context||rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(el){return 1&el.compareDocumentPosition(document.createElement("fieldset"))}),assert(function(el){return el.innerHTML="<a href='#'></a>","#"===el.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML)return elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(el){return el.innerHTML="<input/>",el.firstChild.setAttribute("value",""),""===el.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){if(!isXML&&"input"===elem.nodeName.toLowerCase())return elem.defaultValue}),assert(function(el){return null==el.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;if(!isXML)return!0===elem[name]?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.uniqueSort=jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains,jQuery.escapeSelector=Sizzle.escape;var dir=function(elem,dir,until){for(var matched=[],truncate=void 0!==until;(elem=elem[dir])&&9!==elem.nodeType;)if(1===elem.nodeType){if(truncate&&jQuery(elem).is(until))break;matched.push(elem)}return matched},siblings=function(n,elem){for(var matched=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&matched.push(n);return matched},rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,ret,len=this.length,self=this;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++)if(jQuery.contains(self[i],this))return!0}));for(ret=this.pushStack([]),i=0;i<len;i++)jQuery.find(selector,self[i],ret);return len>1?jQuery.uniqueSort(ret):ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(jQuery.fn.init=function(selector,context,root){var match,elem;if(!selector)return this;if(root=root||rootjQuery,"string"==typeof selector){if(!(match="<"===selector[0]&&">"===selector[selector.length-1]&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector))||!match[1]&&context)return!context||context.jquery?(context||root).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}return elem=document.getElementById(match[2]),elem&&(this[0]=elem,this.length=1),this}return selector.nodeType?(this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?void 0!==root.ready?root.ready(selector):selector(jQuery):jQuery.makeArray(selector,this)}).prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){for(var i=0;i<l;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],targets="string"!=typeof selectors&&jQuery(selectors);if(!rneedsContext.test(selectors))for(;i<l;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(targets?targets.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.uniqueSort(matched):matched)},index:function(elem){return elem?"string"==typeof elem?indexOf.call(jQuery(elem),this[0]):indexOf.call(this,elem.jquery?elem[0]:elem):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.uniqueSort(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return dir(elem,"nextSibling")},prevAll:function(elem){return dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return dir(elem,"previousSibling",until)},siblings:function(elem){return siblings((elem.parentNode||{}).firstChild,elem)},children:function(elem){return siblings(elem.firstChild)},contents:function(elem){return nodeName(elem,"iframe")?elem.contentDocument:(nodeName(elem,"template")&&(elem=elem.content||elem),jQuery.merge([],elem.childNodes))}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(matched=jQuery.filter(selector,matched)),this.length>1&&(guaranteedUnique[name]||jQuery.uniqueSort(matched),rparentsprev.test(name)&&matched.reverse()),this.pushStack(matched)}});var rnothtmlwhite=/[^\x20\t\r\n\f]+/g;jQuery.Callbacks=function(options){options="string"==typeof options?createOptions(options):jQuery.extend({},options);var firing,memory,fired,locked,list=[],queue=[],firingIndex=-1,fire=function(){for(locked=locked||options.once,fired=firing=!0;queue.length;firingIndex=-1)for(memory=queue.shift();++firingIndex<list.length;)!1===list[firingIndex].apply(memory[0],memory[1])&&options.stopOnFalse&&(firingIndex=list.length,memory=!1);options.memory||(memory=!1),firing=!1,locked&&(list=memory?[]:"")},self={add:function(){return list&&(memory&&!firing&&(firingIndex=list.length-1,queue.push(memory)),function add(args){jQuery.each(args,function(_,arg){jQuery.isFunction(arg)?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==jQuery.type(arg)&&add(arg)})}(arguments),memory&&!firing&&fire()),this},remove:function(){return jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),index<=firingIndex&&firingIndex--}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:list.length>0},empty:function(){return list&&(list=[]),this},disable:function(){return locked=queue=[],list=memory="",this},disabled:function(){return!list},lock:function(){return locked=queue=[],memory||firing||(list=memory=""),this},locked:function(){return!!locked},fireWith:function(context,args){return locked||(args=args||[],args=[context,args.slice?args.slice():args],queue.push(args),firing||fire()),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["notify","progress",jQuery.Callbacks("memory"),jQuery.Callbacks("memory"),2],["resolve","done",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),0,"resolved"],["reject","fail",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),1,"rejected"]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},catch:function(fn){return promise.then(null,fn)},pipe:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[tuple[4]])&&fns[tuple[4]];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().progress(newDefer.notify).done(newDefer.resolve).fail(newDefer.reject):newDefer[tuple[0]+"With"](this,fn?[returned]:arguments)})}),fns=null}).promise()},then:function(onFulfilled,onRejected,onProgress){function resolve(depth,deferred,handler,special){return function(){var that=this,args=arguments,mightThrow=function(){var returned,then;if(!(depth<maxDepth)){if((returned=handler.apply(that,args))===deferred.promise())throw new TypeError("Thenable self-resolution");then=returned&&("object"==typeof returned||"function"==typeof returned)&&returned.then,jQuery.isFunction(then)?special?then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special)):(maxDepth++,then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special),resolve(maxDepth,deferred,Identity,deferred.notifyWith))):(handler!==Identity&&(that=void 0,args=[returned]),(special||deferred.resolveWith)(that,args))}},process=special?mightThrow:function(){try{mightThrow()}catch(e){jQuery.Deferred.exceptionHook&&jQuery.Deferred.exceptionHook(e,process.stackTrace),depth+1>=maxDepth&&(handler!==Thrower&&(that=void 0,args=[e]),deferred.rejectWith(that,args))}};depth?process():(jQuery.Deferred.getStackHook&&(process.stackTrace=jQuery.Deferred.getStackHook()),window.setTimeout(process))}}var maxDepth=0;return jQuery.Deferred(function(newDefer){tuples[0][3].add(resolve(0,newDefer,jQuery.isFunction(onProgress)?onProgress:Identity,newDefer.notifyWith)),tuples[1][3].add(resolve(0,newDefer,jQuery.isFunction(onFulfilled)?onFulfilled:Identity)),tuples[2][3].add(resolve(0,newDefer,jQuery.isFunction(onRejected)?onRejected:Thrower))}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[5];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[3-i][2].disable,tuples[0][2].lock),list.add(tuple[3].fire),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?void 0:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(singleValue){var remaining=arguments.length,i=remaining,resolveContexts=Array(i),resolveValues=slice.call(arguments),master=jQuery.Deferred(),updateFunc=function(i){return function(value){resolveContexts[i]=this,resolveValues[i]=arguments.length>1?slice.call(arguments):value,--remaining||master.resolveWith(resolveContexts,resolveValues)}};if(remaining<=1&&(adoptValue(singleValue,master.done(updateFunc(i)).resolve,master.reject,!remaining),"pending"===master.state()||jQuery.isFunction(resolveValues[i]&&resolveValues[i].then)))return master.then();for(;i--;)adoptValue(resolveValues[i],updateFunc(i),master.reject);return master.promise()}});var rerrorNames=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;jQuery.Deferred.exceptionHook=function(error,stack){window.console&&window.console.warn&&error&&rerrorNames.test(error.name)&&window.console.warn("jQuery.Deferred exception: "+error.message,error.stack,stack)},jQuery.readyException=function(error){window.setTimeout(function(){throw error})};var readyList=jQuery.Deferred();jQuery.fn.ready=function(fn){return readyList.then(fn).catch(function(error){jQuery.readyException(error)}),this},jQuery.extend({isReady:!1,readyWait:1,ready:function(wait){(!0===wait?--jQuery.readyWait:jQuery.isReady)||(jQuery.isReady=!0,!0!==wait&&--jQuery.readyWait>0||readyList.resolveWith(document,[jQuery]))}}),jQuery.ready.then=readyList.then,"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?window.setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed),window.addEventListener("load",completed));var access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(void 0!==value&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;i<len;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet},acceptData=function(owner){return 1===owner.nodeType||9===owner.nodeType||!+owner.nodeType};Data.uid=1,Data.prototype={cache:function(owner){var value=owner[this.expando];return value||(value={},acceptData(owner)&&(owner.nodeType?owner[this.expando]=value:Object.defineProperty(owner,this.expando,{value:value,configurable:!0}))),value},set:function(owner,data,value){var prop,cache=this.cache(owner);if("string"==typeof data)cache[jQuery.camelCase(data)]=value;else for(prop in data)cache[jQuery.camelCase(prop)]=data[prop];return cache},get:function(owner,key){return void 0===key?this.cache(owner):owner[this.expando]&&owner[this.expando][jQuery.camelCase(key)]},access:function(owner,key,value){return void 0===key||key&&"string"==typeof key&&void 0===value?this.get(owner,key):(this.set(owner,key,value),void 0!==value?value:key)},remove:function(owner,key){var i,cache=owner[this.expando];if(void 0!==cache){if(void 0!==key){Array.isArray(key)?key=key.map(jQuery.camelCase):(key=jQuery.camelCase(key),key=key in cache?[key]:key.match(rnothtmlwhite)||[]),i=key.length;for(;i--;)delete cache[key[i]]}(void 0===key||jQuery.isEmptyObject(cache))&&(owner.nodeType?owner[this.expando]=void 0:delete owner[this.expando])}},hasData:function(owner){var cache=owner[this.expando];return void 0!==cache&&!jQuery.isEmptyObject(cache)}};var dataPriv=new Data,dataUser=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/[A-Z]/g;jQuery.extend({hasData:function(elem){return dataUser.hasData(elem)||dataPriv.hasData(elem)},data:function(elem,name,data){return dataUser.access(elem,name,data)},removeData:function(elem,name){dataUser.remove(elem,name)},_data:function(elem,name,data){return dataPriv.access(elem,name,data)},_removeData:function(elem,name){dataPriv.remove(elem,name)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0===key){if(this.length&&(data=dataUser.get(elem),1===elem.nodeType&&!dataPriv.get(elem,"hasDataAttrs"))){for(i=attrs.length;i--;)attrs[i]&&(name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name])));dataPriv.set(elem,"hasDataAttrs",!0)}return data}return"object"==typeof key?this.each(function(){dataUser.set(this,key)}):access(this,function(value){var data;if(elem&&void 0===value){if(void 0!==(data=dataUser.get(elem,key)))return data;if(void 0!==(data=dataAttr(elem,key)))return data}else this.each(function(){dataUser.set(this,key,value)})},null,value,arguments.length>1,null,!0)},removeData:function(key){return this.each(function(){dataUser.remove(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;if(elem)return type=(type||"fx")+"queue",queue=dataPriv.get(elem,type),data&&(!queue||Array.isArray(data)?queue=dataPriv.access(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return dataPriv.get(elem,key)||dataPriv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){dataPriv.remove(elem,[type+"queue",key])})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)(tmp=dataPriv.get(elements[i],type+"queueHooks"))&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rcssNum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),cssExpand=["Top","Right","Bottom","Left"],isHiddenWithinTree=function(elem,el){return elem=el||elem,"none"===elem.style.display||""===elem.style.display&&jQuery.contains(elem.ownerDocument,elem)&&"none"===jQuery.css(elem,"display")},swap=function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret},defaultDisplayMap={};jQuery.fn.extend({show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHiddenWithinTree(this)?jQuery(this).show():jQuery(this).hide()})}});var rcheckableType=/^(?:checkbox|radio)$/i,rtagName=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,rscriptType=/^$|\/(?:java|ecma)script/i,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var rhtml=/<|&#?\w+;/;!function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio"),input.setAttribute("checked","checked"),input.setAttribute("name","t"),div.appendChild(input),support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue}();var documentElement=document.documentElement,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,rtypenamespace=/^([^.]*)(?:\.(.+)|)/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.get(elem);if(elemData)for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),selector&&jQuery.find.matchesSelector(documentElement,selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return void 0!==jQuery&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):void 0}),types=(types||"").match(rnothtmlwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&!1!==special.setup.call(elem,data,namespaces,eventHandle)||elem.addEventListener&&elem.addEventListener(type,eventHandle)),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0)},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.hasData(elem)&&dataPriv.get(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(rnothtmlwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&!1!==special.teardown.call(elem,namespaces,elemData.handle)||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&dataPriv.remove(elem,"handle events")}},dispatch:function(nativeEvent){var i,j,ret,matched,handleObj,handlerQueue,event=jQuery.event.fix(nativeEvent),args=new Array(arguments.length),handlers=(dataPriv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};for(args[0]=event,i=1;i<arguments.length;i++)args[i]=arguments[i];if(event.delegateTarget=this,!special.preDispatch||!1!==special.preDispatch.call(this,event)){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)event.rnamespace&&!event.rnamespace.test(handleObj.namespace)||(event.handleObj=handleObj,event.data=handleObj.data,void 0!==(ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args))&&!1===(event.result=ret)&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var i,handleObj,sel,matchedHandlers,matchedSelectors,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&!("click"===event.type&&event.button>=1))for(;cur!==this;cur=cur.parentNode||this)if(1===cur.nodeType&&("click"!==event.type||!0!==cur.disabled)){for(matchedHandlers=[],matchedSelectors={},i=0;i<delegateCount;i++)handleObj=handlers[i],sel=handleObj.selector+" ",void 0===matchedSelectors[sel]&&(matchedSelectors[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>-1:jQuery.find(sel,this,null,[cur]).length),matchedSelectors[sel]&&matchedHandlers.push(handleObj);matchedHandlers.length&&handlerQueue.push({elem:cur,handlers:matchedHandlers})}return cur=this,delegateCount<handlers.length&&handlerQueue.push({elem:cur,handlers:handlers.slice(delegateCount)}),handlerQueue},addProp:function(name,hook){Object.defineProperty(jQuery.Event.prototype,name,{enumerable:!0,configurable:!0,get:jQuery.isFunction(hook)?function(){if(this.originalEvent)return hook(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[name]},set:function(value){Object.defineProperty(this,name,{enumerable:!0,configurable:!0,writable:!0,value:value})}})},fix:function(originalEvent){return originalEvent[jQuery.expando]?originalEvent:new jQuery.Event(originalEvent)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&nodeName(this,"input"))return this.click(),!1},_default:function(event){return nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}}},jQuery.removeEvent=function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle)},jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event))return new jQuery.Event(src,props);src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&!1===src.returnValue?returnTrue:returnFalse,this.target=src.target&&3===src.target.nodeType?src.target.parentNode:src.target,this.currentTarget=src.currentTarget,this.relatedTarget=src.relatedTarget):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),this[jQuery.expando]=!0},jQuery.Event.prototype={constructor:jQuery.Event,isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(event){var button=event.button;return null==event.which&&rkeyEvent.test(event.type)?null!=event.charCode?event.charCode:event.keyCode:!event.which&&void 0!==button&&rmouseEvent.test(event.type)?1&button?1:2&button?3:4&button?2:0:event.which}},jQuery.event.addProp),jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return related&&(related===target||jQuery.contains(target,related))||(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),jQuery.fn.extend({on:function(types,selector,data,fn){return on(this,types,selector,data,fn)},one:function(types,selector,data,fn){
return on(this,types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return!1!==selector&&"function"!=typeof selector||(fn=selector,selector=void 0),!1===fn&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,rnoInnerhtml=/<script|<style|<link/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;jQuery.extend({htmlPrefilter:function(html){return html.replace(rxhtmlTag,"<$1></$2>")},clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(!0),inPage=jQuery.contains(elem.ownerDocument,elem);if(!(support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0,l=srcElements.length;i<l;i++)fixInput(srcElements[i],destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0,l=srcElements.length;i<l;i++)cloneCopyEvent(srcElements[i],destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),clone},cleanData:function(elems){for(var data,elem,type,special=jQuery.event.special,i=0;void 0!==(elem=elems[i]);i++)if(acceptData(elem)){if(data=elem[dataPriv.expando]){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);elem[dataPriv.expando]=void 0}elem[dataUser.expando]&&(elem[dataUser.expando]=void 0)}}}),jQuery.fn.extend({detach:function(selector){return remove(this,selector,!0)},remove:function(selector){return remove(this,selector)},text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=value)})},null,value,arguments.length)},append:function(){return domManip(this,arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){manipulationTarget(this,elem).appendChild(elem)}})},prepend:function(){return domManip(this,arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++)1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.textContent="");return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null!=dataAndEvents&&dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value&&1===elem.nodeType)return elem.innerHTML;if("string"==typeof value&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=jQuery.htmlPrefilter(value);try{for(;i<l;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var ignored=[];return domManip(this,arguments,function(elem){var parent=this.parentNode;jQuery.inArray(this,ignored)<0&&(jQuery.cleanData(getAll(this)),parent&&parent.replaceChild(elem,this))},ignored)}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;i<=last;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(elem){var view=elem.ownerDocument.defaultView;return view&&view.opener||(view=window),view.getComputedStyle(elem)};!function(){function computeStyleTests(){if(div){div.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",div.innerHTML="",documentElement.appendChild(container);var divStyle=window.getComputedStyle(div);pixelPositionVal="1%"!==divStyle.top,reliableMarginLeftVal="2px"===divStyle.marginLeft,boxSizingReliableVal="4px"===divStyle.width,div.style.marginRight="50%",pixelMarginRightVal="4px"===divStyle.marginRight,documentElement.removeChild(container),div=null}}var pixelPositionVal,boxSizingReliableVal,pixelMarginRightVal,reliableMarginLeftVal,container=document.createElement("div"),div=document.createElement("div");div.style&&(div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,container.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",container.appendChild(div),jQuery.extend(support,{pixelPosition:function(){return computeStyleTests(),pixelPositionVal},boxSizingReliable:function(){return computeStyleTests(),boxSizingReliableVal},pixelMarginRight:function(){return computeStyleTests(),pixelMarginRightVal},reliableMarginLeft:function(){return computeStyleTests(),reliableMarginLeftVal}}))}();var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rcustomProp=/^--/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","Moz","ms"],emptyStyle=document.createElement("div").style;jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),isCustomProp=rcustomProp.test(name),style=elem.style;if(isCustomProp||(name=finalPropName(origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value)return hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name];type=typeof value,"string"===type&&(ret=rcssNum.exec(value))&&ret[1]&&(value=adjustCSS(elem,name,ret),type="number"),null!=value&&value===value&&("number"===type&&(value+=ret&&ret[3]||(jQuery.cssNumber[origName]?"":"px")),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra))||(isCustomProp?style.setProperty(name,value):style[name]=value))}},css:function(elem,name,extra,styles){var val,num,hooks,origName=jQuery.camelCase(name);return rcustomProp.test(name)||(name=finalPropName(origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),!0===extra||isFinite(num)?num||0:val):val}}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed)return!rdisplayswap.test(jQuery.css(elem,"display"))||elem.getClientRects().length&&elem.getBoundingClientRect().width?getWidthOrHeight(elem,name,extra):swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)})},set:function(elem,value,extra){var matches,styles=extra&&getStyles(elem),subtract=extra&&augmentWidthOrHeight(elem,name,extra,"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles);return subtract&&(matches=rcssNum.exec(value))&&"px"!==(matches[3]||"px")&&(elem.style[name]=value,value=jQuery.css(elem,name)),setPositiveNumber(elem,value,subtract)}}}),jQuery.cssHooks.marginLeft=addGetHookIf(support.reliableMarginLeft,function(elem,computed){if(computed)return(parseFloat(curCSS(elem,"marginLeft"))||elem.getBoundingClientRect().left-swap(elem,{marginLeft:0},function(){return elem.getBoundingClientRect().left}))+"px"}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];i<4;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(Array.isArray(name)){for(styles=getStyles(elem),len=name.length;i<len;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||jQuery.easing._default,this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.options.duration?this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):this.pos=eased=percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return 1!==tween.elem.nodeType||null!=tween.elem[tween.prop]&&null==tween.elem.style[tween.prop]?tween.elem[tween.prop]:(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0)},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):1!==tween.elem.nodeType||null==tween.elem.style[jQuery.cssProps[tween.prop]]&&!jQuery.cssHooks[tween.prop]?tween.elem[tween.prop]=tween.now:jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2},_default:"swing"},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,inProgress,rfxtypes=/^(?:toggle|show|hide)$/,rrun=/queueHooks$/;jQuery.Animation=jQuery.extend(Animation,{tweeners:{"*":[function(prop,value){var tween=this.createTween(prop,value);return adjustCSS(tween.elem,prop,rcssNum.exec(value),tween),tween}]},tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.match(rnothtmlwhite);for(var prop,index=0,length=props.length;index<length;index++)prop=props[index],Animation.tweeners[prop]=Animation.tweeners[prop]||[],Animation.tweeners[prop].unshift(callback)},prefilters:[defaultPrefilter],prefilter:function(callback,prepend){prepend?Animation.prefilters.unshift(callback):Animation.prefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return jQuery.fx.off?opt.duration=0:"number"!=typeof opt.duration&&(opt.duration in jQuery.fx.speeds?opt.duration=jQuery.fx.speeds[opt.duration]:opt.duration=jQuery.fx.speeds._default),null!=opt.queue&&!0!==opt.queue||(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHiddenWithinTree).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||dataPriv.get(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||!1===optall.queue?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&!1!==type&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=dataPriv.get(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));!dequeue&&gotoEnd||jQuery.dequeue(this,type)})},finish:function(type){return!1!==type&&(type=type||"fx"),this.each(function(){var index,data=dataPriv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;index<length;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;for(fxNow=jQuery.now();i<timers.length;i++)(timer=timers[i])()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),jQuery.fx.start()},jQuery.fx.interval=13,jQuery.fx.start=function(){inProgress||(inProgress=!0,schedule())},jQuery.fx.stop=function(){inProgress=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=window.setTimeout(next,time);hooks.stop=function(){window.clearTimeout(timeout)}})},function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox",support.checkOn=""!==input.value,support.optSelected=opt.selected,input=document.createElement("input"),input.value="t",input.type="radio",support.radioValue="t"===input.value}();var boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(3!==nType&&8!==nType&&2!==nType)return void 0===elem.getAttribute?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(hooks=jQuery.attrHooks[name.toLowerCase()]||(jQuery.expr.match.bool.test(name)?boolHook:void 0)),void 0!==value?null===value?void jQuery.removeAttr(elem,name):hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?void 0:ret))},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}},removeAttr:function(elem,value){var name,i=0,attrNames=value&&value.match(rnothtmlwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)elem.removeAttribute(name)}}),boolHook={set:function(elem,value,name){return!1===value?jQuery.removeAttr(elem,name):elem.setAttribute(name,name),name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle,lowercaseName=name.toLowerCase();return isXML||(handle=attrHandle[lowercaseName],attrHandle[lowercaseName]=ret,ret=null!=getter(elem,name,isXML)?lowercaseName:null,attrHandle[lowercaseName]=handle),ret}});var rfocusable=/^(?:input|select|textarea|button)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}}),jQuery.extend({prop:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(3!==nType&&8!==nType&&2!==nType)return 1===nType&&jQuery.isXMLDoc(elem)||(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&parent.parentNode&&parent.parentNode.selectedIndex,null},set:function(elem){var parent=elem.parentNode;parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex)}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),jQuery.fn.extend({addClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,getClass(this)))});if("string"==typeof value&&value)for(classes=value.match(rnothtmlwhite)||[];elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&" "+stripAndCollapse(curValue)+" "){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");finalValue=stripAndCollapse(cur),curValue!==finalValue&&elem.setAttribute("class",finalValue)}return this},removeClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,getClass(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof value&&value)for(classes=value.match(rnothtmlwhite)||[];elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&" "+stripAndCollapse(curValue)+" "){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>-1;)cur=cur.replace(" "+clazz+" "," ");finalValue=stripAndCollapse(cur),curValue!==finalValue&&elem.setAttribute("class",finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):jQuery.isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,getClass(this),stateVal),stateVal)}):this.each(function(){var className,i,self,classNames;if("string"===type)for(i=0,self=jQuery(this),classNames=value.match(rnothtmlwhite)||[];className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else void 0!==value&&"boolean"!==type||(className=getClass(this),className&&dataPriv.set(this,"__className__",className),this.setAttribute&&this.setAttribute("class",className||!1===value?"":dataPriv.get(this,"__className__")||""))})},hasClass:function(selector){var className,elem,i=0;for(className=" "+selector+" ";elem=this[i++];)if(1===elem.nodeType&&(" "+stripAndCollapse(getClass(elem))+" ").indexOf(className)>-1)return!0;return!1}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];{if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":Array.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),(hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()])&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))});if(elem)return(hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()])&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)}}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:stripAndCollapse(jQuery.text(elem))}},select:{get:function(elem){var value,option,i,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type,values=one?null:[],max=one?index+1:options.length;for(i=index<0?max:one?index:0;i<max;i++)if(option=options[i],(option.selected||i===index)&&!option.disabled&&(!option.parentNode.disabled||!nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)option=options[i],(option.selected=jQuery.inArray(jQuery.valHooks.option.get(option),values)>-1)&&(optionSet=!0);return optionSet||(elem.selectedIndex=-1),values}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(Array.isArray(value))return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>-1}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})});var rfocusMorph=/^(?:focusinfocus|focusoutblur)$/;jQuery.extend(jQuery.event,{trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>-1&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.rnamespace=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||!1!==special.trigger.apply(elem,data))){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(dataPriv.get(cur,"events")||{})[event.type]&&dataPriv.get(cur,"handle"),handle&&handle.apply(cur,data),(handle=ontype&&cur[ontype])&&handle.apply&&acceptData(cur)&&(event.result=handle.apply(cur,data),!1===event.result&&event.preventDefault());return event.type=type,onlyHandlers||event.isDefaultPrevented()||special._default&&!1!==special._default.apply(eventPath.pop(),data)||!acceptData(elem)||ontype&&jQuery.isFunction(elem[type])&&!jQuery.isWindow(elem)&&(tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type,elem[type](),jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)),event.result}},simulate:function(type,elem,event){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0});jQuery.event.trigger(e,null,elem)}}),jQuery.fn.extend({trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem)return jQuery.event.trigger(type,data,elem,!0)}}),jQuery.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}}),support.focusin="onfocusin"in window,support.focusin||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event))};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix);attaches||doc.addEventListener(orig,handler,!0),dataPriv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix)-1;attaches?dataPriv.access(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),dataPriv.remove(doc,fix))}}});var location=window.location,nonce=jQuery.now(),rquery=/\?/;jQuery.parseXML=function(data){var xml;if(!data||"string"!=typeof data)return null;try{xml=(new window.DOMParser).parseFromString(data,"text/xml")}catch(e){xml=void 0}return xml&&!xml.getElementsByTagName("parsererror").length||jQuery.error("Invalid XML: "+data),xml};var rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,valueOrFunction){var value=jQuery.isFunction(valueOrFunction)?valueOrFunction():valueOrFunction;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(null==value?"":value)};if(Array.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:Array.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});var r20=/%20/g,rhash=/#.*$/,rantiCache=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,prefilters={},transports={},allTypes="*/".concat("*"),originAnchor=document.createElement("a");originAnchor.href=location.href,jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:location.href,type:"GET",isLocal:rlocalProtocol.test(location.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;completed||(completed=!0,timeoutTimer&&window.clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&status<300||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),(modified=jqXHR.getResponseHeader("etag"))&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,!status&&statusText||(statusText="error",status<0&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=void 0),options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,urlAnchor,completed,fireGlobals,i,uncached,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){
var match;if(completed){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return completed?responseHeadersString:null},setRequestHeader:function(name,value){return null==completed&&(name=requestHeadersNames[name.toLowerCase()]=requestHeadersNames[name.toLowerCase()]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return null==completed&&(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(completed)jqXHR.always(map[jqXHR.status]);else for(code in map)statusCode[code]=[statusCode[code],map[code]];return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR),s.url=((url||s.url||location.href)+"").replace(rprotocol,location.protocol+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=(s.dataType||"*").toLowerCase().match(rnothtmlwhite)||[""],null==s.crossDomain){urlAnchor=document.createElement("a");try{urlAnchor.href=s.url,urlAnchor.href=urlAnchor.href,s.crossDomain=originAnchor.protocol+"//"+originAnchor.host!=urlAnchor.protocol+"//"+urlAnchor.host}catch(e){s.crossDomain=!0}}if(s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),completed)return jqXHR;fireGlobals=jQuery.event&&s.global,fireGlobals&&0==jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url.replace(rhash,""),s.hasContent?s.data&&s.processData&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&(s.data=s.data.replace(r20,"+")):(uncached=s.url.slice(cacheURL.length),s.data&&(cacheURL+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),!1===s.cache&&(cacheURL=cacheURL.replace(rantiCache,"$1"),uncached=(rquery.test(cacheURL)?"&":"?")+"_="+nonce+++uncached),s.url=cacheURL+uncached),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&!1!==s.contentType||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(!1===s.beforeSend.call(callbackContext,jqXHR,s)||completed))return jqXHR.abort();if(strAbort="abort",completeDeferred.add(s.complete),jqXHR.done(s.success),jqXHR.fail(s.error),transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){if(jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),completed)return jqXHR;s.async&&s.timeout>0&&(timeoutTimer=window.setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{completed=!1,transport.send(requestHeaders,done)}catch(e){if(completed)throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax(jQuery.extend({url:url,type:method,dataType:type,data:data,success:callback},jQuery.isPlainObject(url)&&url))}}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},jQuery.fn.extend({wrapAll:function(html){var wrap;return this[0]&&(jQuery.isFunction(html)&&(html=html.call(this[0])),wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstElementChild;)elem=elem.firstElementChild;return elem}).append(this)),this},wrapInner:function(html){return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(selector){return this.parent(selector).not("body").each(function(){jQuery(this).replaceWith(this.childNodes)}),this}}),jQuery.expr.pseudos.hidden=function(elem){return!jQuery.expr.pseudos.visible(elem)},jQuery.expr.pseudos.visible=function(elem){return!!(elem.offsetWidth||elem.offsetHeight||elem.getClientRects().length)},jQuery.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest}catch(e){}};var xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(options){var callback,errorCallback;if(support.cors||xhrSupported&&!options.crossDomain)return{send:function(headers,complete){var i,xhr=options.xhr();if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");for(i in headers)xhr.setRequestHeader(i,headers[i]);callback=function(type){return function(){callback&&(callback=errorCallback=xhr.onload=xhr.onerror=xhr.onabort=xhr.onreadystatechange=null,"abort"===type?xhr.abort():"error"===type?"number"!=typeof xhr.status?complete(0,"error"):complete(xhr.status,xhr.statusText):complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,"text"!==(xhr.responseType||"text")||"string"!=typeof xhr.responseText?{binary:xhr.response}:{text:xhr.responseText},xhr.getAllResponseHeaders()))}},xhr.onload=callback(),errorCallback=xhr.onerror=callback("error"),void 0!==xhr.onabort?xhr.onabort=errorCallback:xhr.onreadystatechange=function(){4===xhr.readyState&&window.setTimeout(function(){callback&&errorCallback()})},callback=callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(callback)throw e}},abort:function(){callback&&callback()}}}),jQuery.ajaxPrefilter(function(s){s.crossDomain&&(s.contents.script=!1)}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET")}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove(),callback=null,evt&&complete("error"===evt.type?404:200,evt.type)}),document.head.appendChild(script[0])},abort:function(){callback&&callback()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=!1!==s.jsonp&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||"jsonp"===s.dataTypes[0])return callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):!1!==s.jsonp&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){void 0===overwritten?jQuery(window).removeProp(callbackName):window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"}),support.createHTMLDocument=function(){var body=document.implementation.createHTMLDocument("").body;return body.innerHTML="<form></form><form></form>",2===body.childNodes.length}(),jQuery.parseHTML=function(data,context,keepScripts){if("string"!=typeof data)return[];"boolean"==typeof context&&(keepScripts=context,context=!1);var base,parsed,scripts;return context||(support.createHTMLDocument?(context=document.implementation.createHTMLDocument(""),base=context.createElement("base"),base.href=document.location.href,context.head.appendChild(base)):context=document),parsed=rsingleTag.exec(data),scripts=!keepScripts&&[],parsed?[context.createElement(parsed[1])]:(parsed=buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))},jQuery.fn.load=function(url,params,callback){var selector,type,response,self=this,off=url.indexOf(" ");return off>-1&&(selector=stripAndCollapse(url.slice(off)),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type||"GET",dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).always(callback&&function(jqXHR,status){self.each(function(){callback.apply(this,response||[jqXHR.responseText,status,jqXHR])})}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.expr.pseudos.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length},jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&(curCSSTop+curCSSLeft).indexOf("auto")>-1,calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,jQuery.extend({},curOffset))),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var doc,docElem,rect,win,elem=this[0];if(elem)return elem.getClientRects().length?(rect=elem.getBoundingClientRect(),doc=elem.ownerDocument,docElem=doc.documentElement,win=doc.defaultView,{top:rect.top+win.pageYOffset-docElem.clientTop,left:rect.left+win.pageXOffset-docElem.clientLeft}):{top:0,left:0}},position:function(){if(this[0]){var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset={top:parentOffset.top+jQuery.css(offsetParent[0],"borderTopWidth",!0),left:parentOffset.left+jQuery.css(offsetParent[0],"borderLeftWidth",!0)}),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent;offsetParent&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||documentElement})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win;if(jQuery.isWindow(elem)?win=elem:9===elem.nodeType&&(win=elem.defaultView),void 0===val)return win?win[prop]:elem[method];win?win.scrollTo(top?win.pageXOffset:val,top?val:win.pageYOffset):elem[method]=val},method,val,arguments.length)}}),jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed)return computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(!0===margin||!0===value?"margin":"border");return access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?0===funcName.indexOf("outer")?elem["inner"+name]:elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable)}})}),jQuery.fn.extend({bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}}),jQuery.holdReady=function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},jQuery.isArray=Array.isArray,jQuery.parseJSON=JSON.parse,jQuery.nodeName=nodeName,"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},noGlobal||(window.jQuery=window.$=jQuery),jQuery})},{}],121:[function(require,module,exports){!function(factory){var registeredInModuleLoader=!1;if("function"==typeof define&&define.amd&&(define(factory),registeredInModuleLoader=!0),"object"==typeof exports&&(module.exports=factory(),registeredInModuleLoader=!0),!registeredInModuleLoader){var OldCookies=window.Cookies,api=window.Cookies=factory();api.noConflict=function(){return window.Cookies=OldCookies,api}}}(function(){function extend(){for(var i=0,result={};i<arguments.length;i++){var attributes=arguments[i];for(var key in attributes)result[key]=attributes[key]}return result}function init(converter){function api(key,value,attributes){var result;if("undefined"!=typeof document){if(arguments.length>1){if(attributes=extend({path:"/"},api.defaults,attributes),"number"==typeof attributes.expires){var expires=new Date;expires.setMilliseconds(expires.getMilliseconds()+864e5*attributes.expires),attributes.expires=expires}attributes.expires=attributes.expires?attributes.expires.toUTCString():"";try{result=JSON.stringify(value),/^[\{\[]/.test(result)&&(value=result)}catch(e){}value=converter.write?converter.write(value,key):encodeURIComponent(String(value)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),key=encodeURIComponent(String(key)),key=key.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),key=key.replace(/[\(\)]/g,escape);var stringifiedAttributes="";for(var attributeName in attributes)attributes[attributeName]&&(stringifiedAttributes+="; "+attributeName,!0!==attributes[attributeName]&&(stringifiedAttributes+="="+attributes[attributeName]));return document.cookie=key+"="+value+stringifiedAttributes}key||(result={});for(var cookies=document.cookie?document.cookie.split("; "):[],rdecode=/(%[0-9A-Z]{2})+/g,i=0;i<cookies.length;i++){var parts=cookies[i].split("="),cookie=parts.slice(1).join("=");this.json||'"'!==cookie.charAt(0)||(cookie=cookie.slice(1,-1));try{var name=parts[0].replace(rdecode,decodeURIComponent);if(cookie=converter.read?converter.read(cookie,name):converter(cookie,name)||cookie.replace(rdecode,decodeURIComponent),this.json)try{cookie=JSON.parse(cookie)}catch(e){}if(key===name){result=cookie;break}key||(result[name]=cookie)}catch(e){}}return result}}return api.set=api,api.get=function(key){return api.call(api,key)},api.getJSON=function(){return api.apply({json:!0},[].slice.call(arguments))},api.defaults={},api.remove=function(key,attributes){api(key,"",extend(attributes,{expires:-1}))},api.withConverter=init,api}return init(function(){})})},{}],122:[function(require,module,exports){(function(global){(function(){function apply(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)}function arrayAggregator(array,setter,iteratee,accumulator){for(var index=-1,length=null==array?0:array.length;++index<length;){var value=array[index];setter(accumulator,value,iteratee(value),array)}return accumulator}function arrayEach(array,iteratee){for(var index=-1,length=null==array?0:array.length;++index<length&&!1!==iteratee(array[index],index,array););return array}function arrayEachRight(array,iteratee){for(var length=null==array?0:array.length;length--&&!1!==iteratee(array[length],length,array););return array}function arrayEvery(array,predicate){for(var index=-1,length=null==array?0:array.length;++index<length;)if(!predicate(array[index],index,array))return!1;return!0}function arrayFilter(array,predicate){for(var index=-1,length=null==array?0:array.length,resIndex=0,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[resIndex++]=value)}return result}function arrayIncludes(array,value){return!!(null==array?0:array.length)&&baseIndexOf(array,value,0)>-1}function arrayIncludesWith(array,value,comparator){for(var index=-1,length=null==array?0:array.length;++index<length;)if(comparator(value,array[index]))return!0;return!1}function arrayMap(array,iteratee){for(var index=-1,length=null==array?0:array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}function arrayPush(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}function arrayReduce(array,iteratee,accumulator,initAccum){var index=-1,length=null==array?0:array.length;for(initAccum&&length&&(accumulator=array[++index]);++index<length;)accumulator=iteratee(accumulator,array[index],index,array);return accumulator}function arrayReduceRight(array,iteratee,accumulator,initAccum){var length=null==array?0:array.length;for(initAccum&&length&&(accumulator=array[--length]);length--;)accumulator=iteratee(accumulator,array[length],length,array);return accumulator}function arraySome(array,predicate){for(var index=-1,length=null==array?0:array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1}function asciiToArray(string){return string.split("")}function asciiWords(string){return string.match(reAsciiWord)||[]}function baseFindKey(collection,predicate,eachFunc){var result;return eachFunc(collection,function(value,key,collection){if(predicate(value,key,collection))return result=key,!1}),result}function baseFindIndex(array,predicate,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?1:-1);fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1}function baseIndexOf(array,value,fromIndex){return value===value?strictIndexOf(array,value,fromIndex):baseFindIndex(array,baseIsNaN,fromIndex)}function baseIndexOfWith(array,value,fromIndex,comparator){for(var index=fromIndex-1,length=array.length;++index<length;)if(comparator(array[index],value))return index;return-1}function baseIsNaN(value){return value!==value}function baseMean(array,iteratee){var length=null==array?0:array.length;return length?baseSum(array,iteratee)/length:NAN}function baseProperty(key){return function(object){return null==object?undefined:object[key]}}function basePropertyOf(object){return function(key){return null==object?undefined:object[key]}}function baseReduce(collection,iteratee,accumulator,initAccum,eachFunc){return eachFunc(collection,function(value,index,collection){accumulator=initAccum?(initAccum=!1,value):iteratee(accumulator,value,index,collection)}),accumulator}function baseSortBy(array,comparer){var length=array.length;for(array.sort(comparer);length--;)array[length]=array[length].value;return array}function baseSum(array,iteratee){for(var result,index=-1,length=array.length;++index<length;){var current=iteratee(array[index]);current!==undefined&&(result=result===undefined?current:result+current)}return result}function baseTimes(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}function baseToPairs(object,props){return arrayMap(props,function(key){return[key,object[key]]})}function baseUnary(func){return function(value){return func(value)}}function baseValues(object,props){return arrayMap(props,function(key){return object[key]})}function cacheHas(cache,key){return cache.has(key)}function charsStartIndex(strSymbols,chrSymbols){for(var index=-1,length=strSymbols.length;++index<length&&baseIndexOf(chrSymbols,strSymbols[index],0)>-1;);return index}function charsEndIndex(strSymbols,chrSymbols){for(var index=strSymbols.length;index--&&baseIndexOf(chrSymbols,strSymbols[index],0)>-1;);return index}function countHolders(array,placeholder){for(var length=array.length,result=0;length--;)array[length]===placeholder&&++result;return result}function escapeStringChar(chr){return"\\"+stringEscapes[chr]}function getValue(object,key){return null==object?undefined:object[key]}function hasUnicode(string){return reHasUnicode.test(string)}function hasUnicodeWord(string){return reHasUnicodeWord.test(string)}function iteratorToArray(iterator){for(var data,result=[];!(data=iterator.next()).done;)result.push(data.value);return result}function mapToArray(map){var index=-1,result=Array(map.size);return map.forEach(function(value,key){result[++index]=[key,value]}),result}function overArg(func,transform){return function(arg){return func(transform(arg))}}function replaceHolders(array,placeholder){for(var index=-1,length=array.length,resIndex=0,result=[];++index<length;){var value=array[index];value!==placeholder&&value!==PLACEHOLDER||(array[index]=PLACEHOLDER,result[resIndex++]=index)}return result}function setToArray(set){var index=-1,result=Array(set.size);return set.forEach(function(value){result[++index]=value}),result}function setToPairs(set){var index=-1,result=Array(set.size);return set.forEach(function(value){result[++index]=[value,value]}),result}function strictIndexOf(array,value,fromIndex){for(var index=fromIndex-1,length=array.length;++index<length;)if(array[index]===value)return index;return-1}function strictLastIndexOf(array,value,fromIndex){for(var index=fromIndex+1;index--;)if(array[index]===value)return index;return index}function stringSize(string){return hasUnicode(string)?unicodeSize(string):asciiSize(string)}function stringToArray(string){return hasUnicode(string)?unicodeToArray(string):asciiToArray(string)}function unicodeSize(string){for(var result=reUnicode.lastIndex=0;reUnicode.test(string);)++result;return result}function unicodeToArray(string){return string.match(reUnicode)||[]}function unicodeWords(string){return string.match(reUnicodeWord)||[]}var undefined,LARGE_ARRAY_SIZE=200,CORE_ERROR_TEXT="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",FUNC_ERROR_TEXT="Expected a function",HASH_UNDEFINED="__lodash_hash_undefined__",MAX_MEMOIZE_SIZE=500,PLACEHOLDER="__lodash_placeholder__",CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4,COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2,WRAP_BIND_FLAG=1,WRAP_BIND_KEY_FLAG=2,WRAP_CURRY_BOUND_FLAG=4,WRAP_CURRY_FLAG=8,WRAP_CURRY_RIGHT_FLAG=16,WRAP_PARTIAL_FLAG=32,WRAP_PARTIAL_RIGHT_FLAG=64,WRAP_ARY_FLAG=128,WRAP_REARG_FLAG=256,WRAP_FLIP_FLAG=512,DEFAULT_TRUNC_LENGTH=30,DEFAULT_TRUNC_OMISSION="...",HOT_COUNT=800,HOT_SPAN=16,LAZY_FILTER_FLAG=1,LAZY_MAP_FLAG=2,INFINITY=1/0,MAX_SAFE_INTEGER=9007199254740991,MAX_INTEGER=1.7976931348623157e308,NAN=NaN,MAX_ARRAY_LENGTH=4294967295,MAX_ARRAY_INDEX=MAX_ARRAY_LENGTH-1,HALF_MAX_ARRAY_LENGTH=MAX_ARRAY_LENGTH>>>1,wrapFlags=[["ary",WRAP_ARY_FLAG],["bind",WRAP_BIND_FLAG],["bindKey",WRAP_BIND_KEY_FLAG],["curry",WRAP_CURRY_FLAG],["curryRight",WRAP_CURRY_RIGHT_FLAG],["flip",WRAP_FLIP_FLAG],["partial",WRAP_PARTIAL_FLAG],["partialRight",WRAP_PARTIAL_RIGHT_FLAG],["rearg",WRAP_REARG_FLAG]],argsTag="[object Arguments]",arrayTag="[object Array]",asyncTag="[object AsyncFunction]",boolTag="[object Boolean]",dateTag="[object Date]",domExcTag="[object DOMException]",errorTag="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",numberTag="[object Number]",nullTag="[object Null]",objectTag="[object Object]",proxyTag="[object Proxy]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",undefinedTag="[object Undefined]",weakMapTag="[object WeakMap]",weakSetTag="[object WeakSet]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g,reEscapedHtml=/&(?:amp|lt|gt|quot|#39);/g,reUnescapedHtml=/[&<>"']/g,reHasEscapedHtml=RegExp(reEscapedHtml.source),reHasUnescapedHtml=RegExp(reUnescapedHtml.source),reEscape=/<%-([\s\S]+?)%>/g,reEvaluate=/<%([\s\S]+?)%>/g,reInterpolate=/<%=([\s\S]+?)%>/g,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reHasRegExpChar=RegExp(reRegExpChar.source),reTrim=/^\s+|\s+$/g,reTrimStart=/^\s+/,reTrimEnd=/\s+$/,reWrapComment=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,reWrapDetails=/\{\n\/\* \[wrapped with (.+)\] \*/,reSplitDetails=/,? & /,reAsciiWord=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,reEscapeChar=/\\(\\)?/g,reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,reFlags=/\w*$/,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsHostCtor=/^\[object .+?Constructor\]$/,reIsOctal=/^0o[0-7]+$/i,reIsUint=/^(?:0|[1-9]\d*)$/,reLatin=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,reNoMatch=/($^)/,reUnescapedString=/['\n\r\u2028\u2029\\]/g,rsComboRange="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",rsBreakRange="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",rsBreak="["+rsBreakRange+"]",rsCombo="["+rsComboRange+"]",rsLower="[a-z\\xdf-\\xf6\\xf8-\\xff]",rsMisc="[^\\ud800-\\udfff"+rsBreakRange+"\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsUpper="[A-Z\\xc0-\\xd6\\xd8-\\xde]",rsMiscLower="(?:"+rsLower+"|"+rsMisc+")",reOptMod="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",rsOptJoin="(?:\\u200d(?:"+["[^\\ud800-\\udfff]",rsRegional,rsSurrPair].join("|")+")[\\ufe0e\\ufe0f]?"+reOptMod+")*",rsSeq="[\\ufe0e\\ufe0f]?"+reOptMod+rsOptJoin,rsEmoji="(?:"+["[\\u2700-\\u27bf]",rsRegional,rsSurrPair].join("|")+")"+rsSeq,rsSymbol="(?:"+["[^\\ud800-\\udfff]"+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,"[\\ud800-\\udfff]"].join("|")+")",reApos=RegExp("['’]","g"),reComboMark=RegExp(rsCombo,"g"),reUnicode=RegExp(rsFitz+"(?="+rsFitz+")|"+rsSymbol+rsSeq,"g"),reUnicodeWord=RegExp([rsUpper+"?"+rsLower+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[rsBreak,rsUpper,"$"].join("|")+")","(?:[A-Z\\xc0-\\xd6\\xd8-\\xde]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[rsBreak,rsUpper+rsMiscLower,"$"].join("|")+")",rsUpper+"?"+rsMiscLower+"+(?:['’](?:d|ll|m|re|s|t|ve))?",rsUpper+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",rsEmoji].join("|"),"g"),reHasUnicode=RegExp("[\\u200d\\ud800-\\udfff"+rsComboRange+"\\ufe0e\\ufe0f]"),reHasUnicodeWord=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,contextProps=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],templateCounter=-1,typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var cloneableTags={};cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[dataViewTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[setTag]=cloneableTags[stringTag]=cloneableTags[symbolTag]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;var deburredLetters={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A",
"à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"},htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},htmlUnescapes={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},freeParseFloat=parseFloat,freeParseInt=parseInt,freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,freeProcess=moduleExports&&freeGlobal.process,nodeUtil=function(){try{var types=freeModule&&freeModule.require&&freeModule.require("util").types;return types||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}(),nodeIsArrayBuffer=nodeUtil&&nodeUtil.isArrayBuffer,nodeIsDate=nodeUtil&&nodeUtil.isDate,nodeIsMap=nodeUtil&&nodeUtil.isMap,nodeIsRegExp=nodeUtil&&nodeUtil.isRegExp,nodeIsSet=nodeUtil&&nodeUtil.isSet,nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,asciiSize=baseProperty("length"),deburrLetter=basePropertyOf(deburredLetters),escapeHtmlChar=basePropertyOf(htmlEscapes),unescapeHtmlChar=basePropertyOf(htmlUnescapes),_=function runInContext(context){function lodash(value){if(isObjectLike(value)&&!isArray(value)&&!(value instanceof LazyWrapper)){if(value instanceof LodashWrapper)return value;if(hasOwnProperty.call(value,"__wrapped__"))return wrapperClone(value)}return new LodashWrapper(value)}function baseLodash(){}function LodashWrapper(value,chainAll){this.__wrapped__=value,this.__actions__=[],this.__chain__=!!chainAll,this.__index__=0,this.__values__=undefined}function LazyWrapper(value){this.__wrapped__=value,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=MAX_ARRAY_LENGTH,this.__views__=[]}function lazyClone(){var result=new LazyWrapper(this.__wrapped__);return result.__actions__=copyArray(this.__actions__),result.__dir__=this.__dir__,result.__filtered__=this.__filtered__,result.__iteratees__=copyArray(this.__iteratees__),result.__takeCount__=this.__takeCount__,result.__views__=copyArray(this.__views__),result}function lazyReverse(){if(this.__filtered__){var result=new LazyWrapper(this);result.__dir__=-1,result.__filtered__=!0}else result=this.clone(),result.__dir__*=-1;return result}function lazyValue(){var array=this.__wrapped__.value(),dir=this.__dir__,isArr=isArray(array),isRight=dir<0,arrLength=isArr?array.length:0,view=getView(0,arrLength,this.__views__),start=view.start,end=view.end,length=end-start,index=isRight?end:start-1,iteratees=this.__iteratees__,iterLength=iteratees.length,resIndex=0,takeCount=nativeMin(length,this.__takeCount__);if(!isArr||!isRight&&arrLength==length&&takeCount==length)return baseWrapperValue(array,this.__actions__);var result=[];outer:for(;length--&&resIndex<takeCount;){index+=dir;for(var iterIndex=-1,value=array[index];++iterIndex<iterLength;){var data=iteratees[iterIndex],iteratee=data.iteratee,type=data.type,computed=iteratee(value);if(type==LAZY_MAP_FLAG)value=computed;else if(!computed){if(type==LAZY_FILTER_FLAG)continue outer;break outer}}result[resIndex++]=value}return result}function Hash(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}function hashDelete(key){var result=this.has(key)&&delete this.__data__[key];return this.size-=result?1:0,result}function hashGet(key){var data=this.__data__;if(nativeCreate){var result=data[key];return result===HASH_UNDEFINED?undefined:result}return hasOwnProperty.call(data,key)?data[key]:undefined}function hashHas(key){var data=this.__data__;return nativeCreate?data[key]!==undefined:hasOwnProperty.call(data,key)}function hashSet(key,value){var data=this.__data__;return this.size+=this.has(key)?0:1,data[key]=nativeCreate&&value===undefined?HASH_UNDEFINED:value,this}function ListCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function listCacheClear(){this.__data__=[],this.size=0}function listCacheDelete(key){var data=this.__data__,index=assocIndexOf(data,key);return!(index<0)&&(index==data.length-1?data.pop():splice.call(data,index,1),--this.size,!0)}function listCacheGet(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?undefined:data[index][1]}function listCacheHas(key){return assocIndexOf(this.__data__,key)>-1}function listCacheSet(key,value){var data=this.__data__,index=assocIndexOf(data,key);return index<0?(++this.size,data.push([key,value])):data[index][1]=value,this}function MapCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}}function mapCacheDelete(key){var result=getMapData(this,key).delete(key);return this.size-=result?1:0,result}function mapCacheGet(key){return getMapData(this,key).get(key)}function mapCacheHas(key){return getMapData(this,key).has(key)}function mapCacheSet(key,value){var data=getMapData(this,key),size=data.size;return data.set(key,value),this.size+=data.size==size?0:1,this}function SetCache(values){var index=-1,length=null==values?0:values.length;for(this.__data__=new MapCache;++index<length;)this.add(values[index])}function setCacheAdd(value){return this.__data__.set(value,HASH_UNDEFINED),this}function setCacheHas(value){return this.__data__.has(value)}function Stack(entries){var data=this.__data__=new ListCache(entries);this.size=data.size}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(key){var data=this.__data__,result=data.delete(key);return this.size=data.size,result}function stackGet(key){return this.__data__.get(key)}function stackHas(key){return this.__data__.has(key)}function stackSet(key,value){var data=this.__data__;if(data instanceof ListCache){var pairs=data.__data__;if(!Map||pairs.length<LARGE_ARRAY_SIZE-1)return pairs.push([key,value]),this.size=++data.size,this;data=this.__data__=new MapCache(pairs)}return data.set(key,value),this.size=data.size,this}function arrayLikeKeys(value,inherited){var isArr=isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value)!inherited&&!hasOwnProperty.call(value,key)||skipIndexes&&("length"==key||isBuff&&("offset"==key||"parent"==key)||isType&&("buffer"==key||"byteLength"==key||"byteOffset"==key)||isIndex(key,length))||result.push(key);return result}function arraySample(array){var length=array.length;return length?array[baseRandom(0,length-1)]:undefined}function arraySampleSize(array,n){return shuffleSelf(copyArray(array),baseClamp(n,0,array.length))}function arrayShuffle(array){return shuffleSelf(copyArray(array))}function assignMergeValue(object,key,value){(value===undefined||eq(object[key],value))&&(value!==undefined||key in object)||baseAssignValue(object,key,value)}function assignValue(object,key,value){var objValue=object[key];hasOwnProperty.call(object,key)&&eq(objValue,value)&&(value!==undefined||key in object)||baseAssignValue(object,key,value)}function assocIndexOf(array,key){for(var length=array.length;length--;)if(eq(array[length][0],key))return length;return-1}function baseAggregator(collection,setter,iteratee,accumulator){return baseEach(collection,function(value,key,collection){setter(accumulator,value,iteratee(value),collection)}),accumulator}function baseAssign(object,source){return object&&copyObject(source,keys(source),object)}function baseAssignIn(object,source){return object&&copyObject(source,keysIn(source),object)}function baseAssignValue(object,key,value){"__proto__"==key&&defineProperty?defineProperty(object,key,{configurable:!0,enumerable:!0,value:value,writable:!0}):object[key]=value}function baseAt(object,paths){for(var index=-1,length=paths.length,result=Array(length),skip=null==object;++index<length;)result[index]=skip?undefined:get(object,paths[index]);return result}function baseClamp(number,lower,upper){return number===number&&(upper!==undefined&&(number=number<=upper?number:upper),lower!==undefined&&(number=number>=lower?number:lower)),number}function baseClone(value,bitmask,customizer,key,object,stack){var result,isDeep=bitmask&CLONE_DEEP_FLAG,isFlat=bitmask&CLONE_FLAT_FLAG,isFull=bitmask&CLONE_SYMBOLS_FLAG;if(customizer&&(result=object?customizer(value,key,object,stack):customizer(value)),result!==undefined)return result;if(!isObject(value))return value;var isArr=isArray(value);if(isArr){if(result=initCloneArray(value),!isDeep)return copyArray(value,result)}else{var tag=getTag(value),isFunc=tag==funcTag||tag==genTag;if(isBuffer(value))return cloneBuffer(value,isDeep);if(tag==objectTag||tag==argsTag||isFunc&&!object){if(result=isFlat||isFunc?{}:initCloneObject(value),!isDeep)return isFlat?copySymbolsIn(value,baseAssignIn(result,value)):copySymbols(value,baseAssign(result,value))}else{if(!cloneableTags[tag])return object?value:{};result=initCloneByTag(value,tag,isDeep)}}stack||(stack=new Stack);var stacked=stack.get(value);if(stacked)return stacked;if(stack.set(value,result),isSet(value))return value.forEach(function(subValue){result.add(baseClone(subValue,bitmask,customizer,subValue,value,stack))}),result;if(isMap(value))return value.forEach(function(subValue,key){result.set(key,baseClone(subValue,bitmask,customizer,key,value,stack))}),result;var keysFunc=isFull?isFlat?getAllKeysIn:getAllKeys:isFlat?keysIn:keys,props=isArr?undefined:keysFunc(value);return arrayEach(props||value,function(subValue,key){props&&(key=subValue,subValue=value[key]),assignValue(result,key,baseClone(subValue,bitmask,customizer,key,value,stack))}),result}function baseConforms(source){var props=keys(source);return function(object){return baseConformsTo(object,source,props)}}function baseConformsTo(object,source,props){var length=props.length;if(null==object)return!length;for(object=Object(object);length--;){var key=props[length],predicate=source[key],value=object[key];if(value===undefined&&!(key in object)||!predicate(value))return!1}return!0}function baseDelay(func,wait,args){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return setTimeout(function(){func.apply(undefined,args)},wait)}function baseDifference(array,values,iteratee,comparator){var index=-1,includes=arrayIncludes,isCommon=!0,length=array.length,result=[],valuesLength=values.length;if(!length)return result;iteratee&&(values=arrayMap(values,baseUnary(iteratee))),comparator?(includes=arrayIncludesWith,isCommon=!1):values.length>=LARGE_ARRAY_SIZE&&(includes=cacheHas,isCommon=!1,values=new SetCache(values));outer:for(;++index<length;){var value=array[index],computed=null==iteratee?value:iteratee(value);if(value=comparator||0!==value?value:0,isCommon&&computed===computed){for(var valuesIndex=valuesLength;valuesIndex--;)if(values[valuesIndex]===computed)continue outer;result.push(value)}else includes(values,computed,comparator)||result.push(value)}return result}function baseEvery(collection,predicate){var result=!0;return baseEach(collection,function(value,index,collection){return result=!!predicate(value,index,collection)}),result}function baseExtremum(array,iteratee,comparator){for(var index=-1,length=array.length;++index<length;){var value=array[index],current=iteratee(value);if(null!=current&&(computed===undefined?current===current&&!isSymbol(current):comparator(current,computed)))var computed=current,result=value}return result}function baseFill(array,value,start,end){var length=array.length;for(start=toInteger(start),start<0&&(start=-start>length?0:length+start),end=end===undefined||end>length?length:toInteger(end),end<0&&(end+=length),end=start>end?0:toLength(end);start<end;)array[start++]=value;return array}function baseFilter(collection,predicate){var result=[];return baseEach(collection,function(value,index,collection){predicate(value,index,collection)&&result.push(value)}),result}function baseFlatten(array,depth,predicate,isStrict,result){var index=-1,length=array.length;for(predicate||(predicate=isFlattenable),result||(result=[]);++index<length;){var value=array[index];depth>0&&predicate(value)?depth>1?baseFlatten(value,depth-1,predicate,isStrict,result):arrayPush(result,value):isStrict||(result[result.length]=value)}return result}function baseForOwn(object,iteratee){return object&&baseFor(object,iteratee,keys)}function baseForOwnRight(object,iteratee){return object&&baseForRight(object,iteratee,keys)}function baseFunctions(object,props){return arrayFilter(props,function(key){return isFunction(object[key])})}function baseGet(object,path){path=castPath(path,object);for(var index=0,length=path.length;null!=object&&index<length;)object=object[toKey(path[index++])];return index&&index==length?object:undefined}function baseGetAllKeys(object,keysFunc,symbolsFunc){var result=keysFunc(object);return isArray(object)?result:arrayPush(result,symbolsFunc(object))}function baseGetTag(value){return null==value?value===undefined?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(value)?getRawTag(value):objectToString(value)}function baseGt(value,other){return value>other}function baseHas(object,key){return null!=object&&hasOwnProperty.call(object,key)}function baseHasIn(object,key){return null!=object&&key in Object(object)}function baseInRange(number,start,end){return number>=nativeMin(start,end)&&number<nativeMax(start,end)}function baseIntersection(arrays,iteratee,comparator){for(var includes=comparator?arrayIncludesWith:arrayIncludes,length=arrays[0].length,othLength=arrays.length,othIndex=othLength,caches=Array(othLength),maxLength=1/0,result=[];othIndex--;){var array=arrays[othIndex];othIndex&&iteratee&&(array=arrayMap(array,baseUnary(iteratee))),maxLength=nativeMin(array.length,maxLength),caches[othIndex]=!comparator&&(iteratee||length>=120&&array.length>=120)?new SetCache(othIndex&&array):undefined}array=arrays[0];var index=-1,seen=caches[0];outer:for(;++index<length&&result.length<maxLength;){var value=array[index],computed=iteratee?iteratee(value):value;if(value=comparator||0!==value?value:0,!(seen?cacheHas(seen,computed):includes(result,computed,comparator))){for(othIndex=othLength;--othIndex;){var cache=caches[othIndex];if(!(cache?cacheHas(cache,computed):includes(arrays[othIndex],computed,comparator)))continue outer}seen&&seen.push(computed),result.push(value)}}return result}function baseInverter(object,setter,iteratee,accumulator){return baseForOwn(object,function(value,key,object){setter(accumulator,iteratee(value),key,object)}),accumulator}function baseInvoke(object,path,args){path=castPath(path,object),object=parent(object,path);var func=null==object?object:object[toKey(last(path))];return null==func?undefined:apply(func,object,args)}function baseIsArguments(value){return isObjectLike(value)&&baseGetTag(value)==argsTag}function baseIsArrayBuffer(value){return isObjectLike(value)&&baseGetTag(value)==arrayBufferTag}function baseIsDate(value){return isObjectLike(value)&&baseGetTag(value)==dateTag}function baseIsEqual(value,other,bitmask,customizer,stack){return value===other||(null==value||null==other||!isObjectLike(value)&&!isObjectLike(other)?value!==value&&other!==other:baseIsEqualDeep(value,other,bitmask,customizer,baseIsEqual,stack))}function baseIsEqualDeep(object,other,bitmask,customizer,equalFunc,stack){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=objIsArr?arrayTag:getTag(object),othTag=othIsArr?arrayTag:getTag(other);objTag=objTag==argsTag?objectTag:objTag,othTag=othTag==argsTag?objectTag:othTag;var objIsObj=objTag==objectTag,othIsObj=othTag==objectTag,isSameTag=objTag==othTag;if(isSameTag&&isBuffer(object)){if(!isBuffer(other))return!1;objIsArr=!0,objIsObj=!1}if(isSameTag&&!objIsObj)return stack||(stack=new Stack),objIsArr||isTypedArray(object)?equalArrays(object,other,bitmask,customizer,equalFunc,stack):equalByTag(object,other,objTag,bitmask,customizer,equalFunc,stack);if(!(bitmask&COMPARE_PARTIAL_FLAG)){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped){var objUnwrapped=objIsWrapped?object.value():object,othUnwrapped=othIsWrapped?other.value():other;return stack||(stack=new Stack),equalFunc(objUnwrapped,othUnwrapped,bitmask,customizer,stack)}}return!!isSameTag&&(stack||(stack=new Stack),equalObjects(object,other,bitmask,customizer,equalFunc,stack))}function baseIsMap(value){return isObjectLike(value)&&getTag(value)==mapTag}function baseIsMatch(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=Object(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){data=matchData[index];var key=data[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(objValue===undefined&&!(key in object))return!1}else{var stack=new Stack;if(customizer)var result=customizer(objValue,srcValue,key,object,source,stack);if(!(result===undefined?baseIsEqual(srcValue,objValue,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG,customizer,stack):result))return!1}}return!0}function baseIsNative(value){return!(!isObject(value)||isMasked(value))&&(isFunction(value)?reIsNative:reIsHostCtor).test(toSource(value))}function baseIsRegExp(value){return isObjectLike(value)&&baseGetTag(value)==regexpTag}function baseIsSet(value){return isObjectLike(value)&&getTag(value)==setTag}function baseIsTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]}function baseIteratee(value){return"function"==typeof value?value:null==value?identity:"object"==typeof value?isArray(value)?baseMatchesProperty(value[0],value[1]):baseMatches(value):property(value)}function baseKeys(object){if(!isPrototype(object))return nativeKeys(object);var result=[];for(var key in Object(object))hasOwnProperty.call(object,key)&&"constructor"!=key&&result.push(key);return result}function baseKeysIn(object){if(!isObject(object))return nativeKeysIn(object);var isProto=isPrototype(object),result=[];for(var key in object)("constructor"!=key||!isProto&&hasOwnProperty.call(object,key))&&result.push(key);return result}function baseLt(value,other){return value<other}function baseMap(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value,key,collection){result[++index]=iteratee(value,key,collection)}),result}function baseMatches(source){var matchData=getMatchData(source);return 1==matchData.length&&matchData[0][2]?matchesStrictComparable(matchData[0][0],matchData[0][1]):function(object){return object===source||baseIsMatch(object,source,matchData)}}function baseMatchesProperty(path,srcValue){return isKey(path)&&isStrictComparable(srcValue)?matchesStrictComparable(toKey(path),srcValue):function(object){var objValue=get(object,path);return objValue===undefined&&objValue===srcValue?hasIn(object,path):baseIsEqual(srcValue,objValue,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseMerge(object,source,srcIndex,customizer,stack){object!==source&&baseFor(source,function(srcValue,key){if(isObject(srcValue))stack||(stack=new Stack),baseMergeDeep(object,source,key,srcIndex,baseMerge,customizer,stack);else{var newValue=customizer?customizer(safeGet(object,key),srcValue,key+"",object,source,stack):undefined;newValue===undefined&&(newValue=srcValue),assignMergeValue(object,key,newValue)}},keysIn)}function baseMergeDeep(object,source,key,srcIndex,mergeFunc,customizer,stack){var objValue=safeGet(object,key),srcValue=safeGet(source,key),stacked=stack.get(srcValue);if(stacked)return void assignMergeValue(object,key,stacked);var newValue=customizer?customizer(objValue,srcValue,key+"",object,source,stack):undefined,isCommon=newValue===undefined;if(isCommon){var isArr=isArray(srcValue),isBuff=!isArr&&isBuffer(srcValue),isTyped=!isArr&&!isBuff&&isTypedArray(srcValue);newValue=srcValue,isArr||isBuff||isTyped?isArray(objValue)?newValue=objValue:isArrayLikeObject(objValue)?newValue=copyArray(objValue):isBuff?(isCommon=!1,newValue=cloneBuffer(srcValue,!0)):isTyped?(isCommon=!1,newValue=cloneTypedArray(srcValue,!0)):newValue=[]:isPlainObject(srcValue)||isArguments(srcValue)?(newValue=objValue,isArguments(objValue)?newValue=toPlainObject(objValue):isObject(objValue)&&!isFunction(objValue)||(newValue=initCloneObject(srcValue))):isCommon=!1}isCommon&&(stack.set(srcValue,newValue),mergeFunc(newValue,srcValue,srcIndex,customizer,stack),stack.delete(srcValue)),assignMergeValue(object,key,newValue)}function baseNth(array,n){var length=array.length;if(length)return n+=n<0?length:0,isIndex(n,length)?array[n]:undefined}function baseOrderBy(collection,iteratees,orders){var index=-1;return iteratees=arrayMap(iteratees.length?iteratees:[identity],baseUnary(getIteratee())),baseSortBy(baseMap(collection,function(value,key,collection){return{criteria:arrayMap(iteratees,function(iteratee){return iteratee(value)}),index:++index,value:value}}),function(object,other){return compareMultiple(object,other,orders)})}function basePick(object,paths){return basePickBy(object,paths,function(value,path){return hasIn(object,path)})}function basePickBy(object,paths,predicate){for(var index=-1,length=paths.length,result={};++index<length;){var path=paths[index],value=baseGet(object,path);predicate(value,path)&&baseSet(result,castPath(path,object),value)}return result}function basePropertyDeep(path){return function(object){return baseGet(object,path)}}function basePullAll(array,values,iteratee,comparator){var indexOf=comparator?baseIndexOfWith:baseIndexOf,index=-1,length=values.length,seen=array;for(array===values&&(values=copyArray(values)),iteratee&&(seen=arrayMap(array,baseUnary(iteratee)));++index<length;)for(var fromIndex=0,value=values[index],computed=iteratee?iteratee(value):value;(fromIndex=indexOf(seen,computed,fromIndex,comparator))>-1;)seen!==array&&splice.call(seen,fromIndex,1),splice.call(array,fromIndex,1);return array}function basePullAt(array,indexes){for(var length=array?indexes.length:0,lastIndex=length-1;length--;){var index=indexes[length];if(length==lastIndex||index!==previous){var previous=index;isIndex(index)?splice.call(array,index,1):baseUnset(array,index)}}return array}function baseRandom(lower,upper){return lower+nativeFloor(nativeRandom()*(upper-lower+1))}function baseRange(start,end,step,fromRight){for(var index=-1,length=nativeMax(nativeCeil((end-start)/(step||1)),0),result=Array(length);length--;)result[fromRight?length:++index]=start,start+=step;return result}function baseRepeat(string,n){var result="";if(!string||n<1||n>MAX_SAFE_INTEGER)return result;do{n%2&&(result+=string),(n=nativeFloor(n/2))&&(string+=string)}while(n);return result}function baseRest(func,start){return setToString(overRest(func,start,identity),func+"")}function baseSample(collection){return arraySample(values(collection))}function baseSampleSize(collection,n){var array=values(collection);return shuffleSelf(array,baseClamp(n,0,array.length))}function baseSet(object,path,value,customizer){if(!isObject(object))return object;path=castPath(path,object);for(var index=-1,length=path.length,lastIndex=length-1,nested=object;null!=nested&&++index<length;){var key=toKey(path[index]),newValue=value;if(index!=lastIndex){var objValue=nested[key];newValue=customizer?customizer(objValue,key,nested):undefined,newValue===undefined&&(newValue=isObject(objValue)?objValue:isIndex(path[index+1])?[]:{})}assignValue(nested,key,newValue),nested=nested[key]}return object}function baseShuffle(collection){return shuffleSelf(values(collection))}function baseSlice(array,start,end){var index=-1,length=array.length;start<0&&(start=-start>length?0:length+start),end=end>length?length:end,end<0&&(end+=length),length=start>end?0:end-start>>>0,start>>>=0;for(var result=Array(length);++index<length;)result[index]=array[index+start];return result}function baseSome(collection,predicate){var result;return baseEach(collection,function(value,index,collection){return!(result=predicate(value,index,collection))}),!!result}function baseSortedIndex(array,value,retHighest){var low=0,high=null==array?low:array.length;if("number"==typeof value&&value===value&&high<=HALF_MAX_ARRAY_LENGTH){for(;low<high;){var mid=low+high>>>1,computed=array[mid];null!==computed&&!isSymbol(computed)&&(retHighest?computed<=value:computed<value)?low=mid+1:high=mid}return high}return baseSortedIndexBy(array,value,identity,retHighest)}function baseSortedIndexBy(array,value,iteratee,retHighest){value=iteratee(value);for(var low=0,high=null==array?0:array.length,valIsNaN=value!==value,valIsNull=null===value,valIsSymbol=isSymbol(value),valIsUndefined=value===undefined;low<high;){var mid=nativeFloor((low+high)/2),computed=iteratee(array[mid]),othIsDefined=computed!==undefined,othIsNull=null===computed,othIsReflexive=computed===computed,othIsSymbol=isSymbol(computed);if(valIsNaN)var setLow=retHighest||othIsReflexive;else setLow=valIsUndefined?othIsReflexive&&(retHighest||othIsDefined):valIsNull?othIsReflexive&&othIsDefined&&(retHighest||!othIsNull):valIsSymbol?othIsReflexive&&othIsDefined&&!othIsNull&&(retHighest||!othIsSymbol):!othIsNull&&!othIsSymbol&&(retHighest?computed<=value:computed<value);setLow?low=mid+1:high=mid}return nativeMin(high,MAX_ARRAY_INDEX)}function baseSortedUniq(array,iteratee){for(var index=-1,length=array.length,resIndex=0,result=[];++index<length;){var value=array[index],computed=iteratee?iteratee(value):value;if(!index||!eq(computed,seen)){var seen=computed;result[resIndex++]=0===value?0:value}}return result}function baseToNumber(value){return"number"==typeof value?value:isSymbol(value)?NAN:+value}function baseToString(value){if("string"==typeof value)return value;if(isArray(value))return arrayMap(value,baseToString)+"";if(isSymbol(value))return symbolToString?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-INFINITY?"-0":result}function baseUniq(array,iteratee,comparator){var index=-1,includes=arrayIncludes,length=array.length,isCommon=!0,result=[],seen=result;if(comparator)isCommon=!1,includes=arrayIncludesWith;else if(length>=LARGE_ARRAY_SIZE){var set=iteratee?null:createSet(array);if(set)return setToArray(set);isCommon=!1,includes=cacheHas,seen=new SetCache}else seen=iteratee?[]:result;outer:for(;++index<length;){var value=array[index],computed=iteratee?iteratee(value):value;if(value=comparator||0!==value?value:0,isCommon&&computed===computed){for(var seenIndex=seen.length;seenIndex--;)if(seen[seenIndex]===computed)continue outer;iteratee&&seen.push(computed),result.push(value)}else includes(seen,computed,comparator)||(seen!==result&&seen.push(computed),result.push(value))}return result}function baseUnset(object,path){return path=castPath(path,object),null==(object=parent(object,path))||delete object[toKey(last(path))]}function baseUpdate(object,path,updater,customizer){return baseSet(object,path,updater(baseGet(object,path)),customizer)}function baseWhile(array,predicate,isDrop,fromRight){for(var length=array.length,index=fromRight?length:-1;(fromRight?index--:++index<length)&&predicate(array[index],index,array););return isDrop?baseSlice(array,fromRight?0:index,fromRight?index+1:length):baseSlice(array,fromRight?index+1:0,fromRight?length:index)}function baseWrapperValue(value,actions){var result=value;return result instanceof LazyWrapper&&(result=result.value()),arrayReduce(actions,function(result,action){return action.func.apply(action.thisArg,arrayPush([result],action.args))},result)}function baseXor(arrays,iteratee,comparator){var length=arrays.length;if(length<2)return length?baseUniq(arrays[0]):[];for(var index=-1,result=Array(length);++index<length;)for(var array=arrays[index],othIndex=-1;++othIndex<length;)othIndex!=index&&(result[index]=baseDifference(result[index]||array,arrays[othIndex],iteratee,comparator));return baseUniq(baseFlatten(result,1),iteratee,comparator)}function baseZipObject(props,values,assignFunc){for(var index=-1,length=props.length,valsLength=values.length,result={};++index<length;){var value=index<valsLength?values[index]:undefined;assignFunc(result,props[index],value)}return result}function castArrayLikeObject(value){return isArrayLikeObject(value)?value:[]}function castFunction(value){return"function"==typeof value?value:identity}function castPath(value,object){return isArray(value)?value:isKey(value,object)?[value]:stringToPath(toString(value))}function castSlice(array,start,end){var length=array.length;return end=end===undefined?length:end,!start&&end>=length?array:baseSlice(array,start,end)}function cloneBuffer(buffer,isDeep){if(isDeep)return buffer.slice();var length=buffer.length,result=allocUnsafe?allocUnsafe(length):new buffer.constructor(length);return buffer.copy(result),result}function cloneArrayBuffer(arrayBuffer){var result=new arrayBuffer.constructor(arrayBuffer.byteLength);return new Uint8Array(result).set(new Uint8Array(arrayBuffer)),result}function cloneDataView(dataView,isDeep){var buffer=isDeep?cloneArrayBuffer(dataView.buffer):dataView.buffer;return new dataView.constructor(buffer,dataView.byteOffset,dataView.byteLength)}function cloneRegExp(regexp){var result=new regexp.constructor(regexp.source,reFlags.exec(regexp));return result.lastIndex=regexp.lastIndex,result}function cloneSymbol(symbol){return symbolValueOf?Object(symbolValueOf.call(symbol)):{}}function cloneTypedArray(typedArray,isDeep){var buffer=isDeep?cloneArrayBuffer(typedArray.buffer):typedArray.buffer;return new typedArray.constructor(buffer,typedArray.byteOffset,typedArray.length)}function compareAscending(value,other){if(value!==other){
var valIsDefined=value!==undefined,valIsNull=null===value,valIsReflexive=value===value,valIsSymbol=isSymbol(value),othIsDefined=other!==undefined,othIsNull=null===other,othIsReflexive=other===other,othIsSymbol=isSymbol(other);if(!othIsNull&&!othIsSymbol&&!valIsSymbol&&value>other||valIsSymbol&&othIsDefined&&othIsReflexive&&!othIsNull&&!othIsSymbol||valIsNull&&othIsDefined&&othIsReflexive||!valIsDefined&&othIsReflexive||!valIsReflexive)return 1;if(!valIsNull&&!valIsSymbol&&!othIsSymbol&&value<other||othIsSymbol&&valIsDefined&&valIsReflexive&&!valIsNull&&!valIsSymbol||othIsNull&&valIsDefined&&valIsReflexive||!othIsDefined&&valIsReflexive||!othIsReflexive)return-1}return 0}function compareMultiple(object,other,orders){for(var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;++index<length;){var result=compareAscending(objCriteria[index],othCriteria[index]);if(result){if(index>=ordersLength)return result;return result*("desc"==orders[index]?-1:1)}}return object.index-other.index}function composeArgs(args,partials,holders,isCurried){for(var argsIndex=-1,argsLength=args.length,holdersLength=holders.length,leftIndex=-1,leftLength=partials.length,rangeLength=nativeMax(argsLength-holdersLength,0),result=Array(leftLength+rangeLength),isUncurried=!isCurried;++leftIndex<leftLength;)result[leftIndex]=partials[leftIndex];for(;++argsIndex<holdersLength;)(isUncurried||argsIndex<argsLength)&&(result[holders[argsIndex]]=args[argsIndex]);for(;rangeLength--;)result[leftIndex++]=args[argsIndex++];return result}function composeArgsRight(args,partials,holders,isCurried){for(var argsIndex=-1,argsLength=args.length,holdersIndex=-1,holdersLength=holders.length,rightIndex=-1,rightLength=partials.length,rangeLength=nativeMax(argsLength-holdersLength,0),result=Array(rangeLength+rightLength),isUncurried=!isCurried;++argsIndex<rangeLength;)result[argsIndex]=args[argsIndex];for(var offset=argsIndex;++rightIndex<rightLength;)result[offset+rightIndex]=partials[rightIndex];for(;++holdersIndex<holdersLength;)(isUncurried||argsIndex<argsLength)&&(result[offset+holders[holdersIndex]]=args[argsIndex++]);return result}function copyArray(source,array){var index=-1,length=source.length;for(array||(array=Array(length));++index<length;)array[index]=source[index];return array}function copyObject(source,props,object,customizer){var isNew=!object;object||(object={});for(var index=-1,length=props.length;++index<length;){var key=props[index],newValue=customizer?customizer(object[key],source[key],key,object,source):undefined;newValue===undefined&&(newValue=source[key]),isNew?baseAssignValue(object,key,newValue):assignValue(object,key,newValue)}return object}function copySymbols(source,object){return copyObject(source,getSymbols(source),object)}function copySymbolsIn(source,object){return copyObject(source,getSymbolsIn(source),object)}function createAggregator(setter,initializer){return function(collection,iteratee){var func=isArray(collection)?arrayAggregator:baseAggregator,accumulator=initializer?initializer():{};return func(collection,setter,getIteratee(iteratee,2),accumulator)}}function createAssigner(assigner){return baseRest(function(object,sources){var index=-1,length=sources.length,customizer=length>1?sources[length-1]:undefined,guard=length>2?sources[2]:undefined;for(customizer=assigner.length>3&&"function"==typeof customizer?(length--,customizer):undefined,guard&&isIterateeCall(sources[0],sources[1],guard)&&(customizer=length<3?undefined:customizer,length=1),object=Object(object);++index<length;){var source=sources[index];source&&assigner(object,source,index,customizer)}return object})}function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){if(null==collection)return collection;if(!isArrayLike(collection))return eachFunc(collection,iteratee);for(var length=collection.length,index=fromRight?length:-1,iterable=Object(collection);(fromRight?index--:++index<length)&&!1!==iteratee(iterable[index],index,iterable););return collection}}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){for(var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;length--;){var key=props[fromRight?length:++index];if(!1===iteratee(iterable[key],key,iterable))break}return object}}function createBind(func,bitmask,thisArg){function wrapper(){return(this&&this!==root&&this instanceof wrapper?Ctor:func).apply(isBind?thisArg:this,arguments)}var isBind=bitmask&WRAP_BIND_FLAG,Ctor=createCtor(func);return wrapper}function createCaseFirst(methodName){return function(string){string=toString(string);var strSymbols=hasUnicode(string)?stringToArray(string):undefined,chr=strSymbols?strSymbols[0]:string.charAt(0),trailing=strSymbols?castSlice(strSymbols,1).join(""):string.slice(1);return chr[methodName]()+trailing}}function createCompounder(callback){return function(string){return arrayReduce(words(deburr(string).replace(reApos,"")),callback,"")}}function createCtor(Ctor){return function(){var args=arguments;switch(args.length){case 0:return new Ctor;case 1:return new Ctor(args[0]);case 2:return new Ctor(args[0],args[1]);case 3:return new Ctor(args[0],args[1],args[2]);case 4:return new Ctor(args[0],args[1],args[2],args[3]);case 5:return new Ctor(args[0],args[1],args[2],args[3],args[4]);case 6:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5],args[6])}var thisBinding=baseCreate(Ctor.prototype),result=Ctor.apply(thisBinding,args);return isObject(result)?result:thisBinding}}function createCurry(func,bitmask,arity){function wrapper(){for(var length=arguments.length,args=Array(length),index=length,placeholder=getHolder(wrapper);index--;)args[index]=arguments[index];var holders=length<3&&args[0]!==placeholder&&args[length-1]!==placeholder?[]:replaceHolders(args,placeholder);return(length-=holders.length)<arity?createRecurry(func,bitmask,createHybrid,wrapper.placeholder,undefined,args,holders,undefined,undefined,arity-length):apply(this&&this!==root&&this instanceof wrapper?Ctor:func,this,args)}var Ctor=createCtor(func);return wrapper}function createFind(findIndexFunc){return function(collection,predicate,fromIndex){var iterable=Object(collection);if(!isArrayLike(collection)){var iteratee=getIteratee(predicate,3);collection=keys(collection),predicate=function(key){return iteratee(iterable[key],key,iterable)}}var index=findIndexFunc(collection,predicate,fromIndex);return index>-1?iterable[iteratee?collection[index]:index]:undefined}}function createFlow(fromRight){return flatRest(function(funcs){var length=funcs.length,index=length,prereq=LodashWrapper.prototype.thru;for(fromRight&&funcs.reverse();index--;){var func=funcs[index];if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);if(prereq&&!wrapper&&"wrapper"==getFuncName(func))var wrapper=new LodashWrapper([],!0)}for(index=wrapper?index:length;++index<length;){func=funcs[index];var funcName=getFuncName(func),data="wrapper"==funcName?getData(func):undefined;wrapper=data&&isLaziable(data[0])&&data[1]==(WRAP_ARY_FLAG|WRAP_CURRY_FLAG|WRAP_PARTIAL_FLAG|WRAP_REARG_FLAG)&&!data[4].length&&1==data[9]?wrapper[getFuncName(data[0])].apply(wrapper,data[3]):1==func.length&&isLaziable(func)?wrapper[funcName]():wrapper.thru(func)}return function(){var args=arguments,value=args[0];if(wrapper&&1==args.length&&isArray(value))return wrapper.plant(value).value();for(var index=0,result=length?funcs[index].apply(this,args):value;++index<length;)result=funcs[index].call(this,result);return result}})}function createHybrid(func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity){function wrapper(){for(var length=arguments.length,args=Array(length),index=length;index--;)args[index]=arguments[index];if(isCurried)var placeholder=getHolder(wrapper),holdersCount=countHolders(args,placeholder);if(partials&&(args=composeArgs(args,partials,holders,isCurried)),partialsRight&&(args=composeArgsRight(args,partialsRight,holdersRight,isCurried)),length-=holdersCount,isCurried&&length<arity){var newHolders=replaceHolders(args,placeholder);return createRecurry(func,bitmask,createHybrid,wrapper.placeholder,thisArg,args,newHolders,argPos,ary,arity-length)}var thisBinding=isBind?thisArg:this,fn=isBindKey?thisBinding[func]:func;return length=args.length,argPos?args=reorder(args,argPos):isFlip&&length>1&&args.reverse(),isAry&&ary<length&&(args.length=ary),this&&this!==root&&this instanceof wrapper&&(fn=Ctor||createCtor(fn)),fn.apply(thisBinding,args)}var isAry=bitmask&WRAP_ARY_FLAG,isBind=bitmask&WRAP_BIND_FLAG,isBindKey=bitmask&WRAP_BIND_KEY_FLAG,isCurried=bitmask&(WRAP_CURRY_FLAG|WRAP_CURRY_RIGHT_FLAG),isFlip=bitmask&WRAP_FLIP_FLAG,Ctor=isBindKey?undefined:createCtor(func);return wrapper}function createInverter(setter,toIteratee){return function(object,iteratee){return baseInverter(object,setter,toIteratee(iteratee),{})}}function createMathOperation(operator,defaultValue){return function(value,other){var result;if(value===undefined&&other===undefined)return defaultValue;if(value!==undefined&&(result=value),other!==undefined){if(result===undefined)return other;"string"==typeof value||"string"==typeof other?(value=baseToString(value),other=baseToString(other)):(value=baseToNumber(value),other=baseToNumber(other)),result=operator(value,other)}return result}}function createOver(arrayFunc){return flatRest(function(iteratees){return iteratees=arrayMap(iteratees,baseUnary(getIteratee())),baseRest(function(args){var thisArg=this;return arrayFunc(iteratees,function(iteratee){return apply(iteratee,thisArg,args)})})})}function createPadding(length,chars){chars=chars===undefined?" ":baseToString(chars);var charsLength=chars.length;if(charsLength<2)return charsLength?baseRepeat(chars,length):chars;var result=baseRepeat(chars,nativeCeil(length/stringSize(chars)));return hasUnicode(chars)?castSlice(stringToArray(result),0,length).join(""):result.slice(0,length)}function createPartial(func,bitmask,thisArg,partials){function wrapper(){for(var argsIndex=-1,argsLength=arguments.length,leftIndex=-1,leftLength=partials.length,args=Array(leftLength+argsLength),fn=this&&this!==root&&this instanceof wrapper?Ctor:func;++leftIndex<leftLength;)args[leftIndex]=partials[leftIndex];for(;argsLength--;)args[leftIndex++]=arguments[++argsIndex];return apply(fn,isBind?thisArg:this,args)}var isBind=bitmask&WRAP_BIND_FLAG,Ctor=createCtor(func);return wrapper}function createRange(fromRight){return function(start,end,step){return step&&"number"!=typeof step&&isIterateeCall(start,end,step)&&(end=step=undefined),start=toFinite(start),end===undefined?(end=start,start=0):end=toFinite(end),step=step===undefined?start<end?1:-1:toFinite(step),baseRange(start,end,step,fromRight)}}function createRelationalOperation(operator){return function(value,other){return"string"==typeof value&&"string"==typeof other||(value=toNumber(value),other=toNumber(other)),operator(value,other)}}function createRecurry(func,bitmask,wrapFunc,placeholder,thisArg,partials,holders,argPos,ary,arity){var isCurry=bitmask&WRAP_CURRY_FLAG,newHolders=isCurry?holders:undefined,newHoldersRight=isCurry?undefined:holders,newPartials=isCurry?partials:undefined,newPartialsRight=isCurry?undefined:partials;bitmask|=isCurry?WRAP_PARTIAL_FLAG:WRAP_PARTIAL_RIGHT_FLAG,(bitmask&=~(isCurry?WRAP_PARTIAL_RIGHT_FLAG:WRAP_PARTIAL_FLAG))&WRAP_CURRY_BOUND_FLAG||(bitmask&=~(WRAP_BIND_FLAG|WRAP_BIND_KEY_FLAG));var newData=[func,bitmask,thisArg,newPartials,newHolders,newPartialsRight,newHoldersRight,argPos,ary,arity],result=wrapFunc.apply(undefined,newData);return isLaziable(func)&&setData(result,newData),result.placeholder=placeholder,setWrapToString(result,func,bitmask)}function createRound(methodName){var func=Math[methodName];return function(number,precision){if(number=toNumber(number),precision=null==precision?0:nativeMin(toInteger(precision),292)){var pair=(toString(number)+"e").split("e");return pair=(toString(func(pair[0]+"e"+(+pair[1]+precision)))+"e").split("e"),+(pair[0]+"e"+(+pair[1]-precision))}return func(number)}}function createToPairs(keysFunc){return function(object){var tag=getTag(object);return tag==mapTag?mapToArray(object):tag==setTag?setToPairs(object):baseToPairs(object,keysFunc(object))}}function createWrap(func,bitmask,thisArg,partials,holders,argPos,ary,arity){var isBindKey=bitmask&WRAP_BIND_KEY_FLAG;if(!isBindKey&&"function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);var length=partials?partials.length:0;if(length||(bitmask&=~(WRAP_PARTIAL_FLAG|WRAP_PARTIAL_RIGHT_FLAG),partials=holders=undefined),ary=ary===undefined?ary:nativeMax(toInteger(ary),0),arity=arity===undefined?arity:toInteger(arity),length-=holders?holders.length:0,bitmask&WRAP_PARTIAL_RIGHT_FLAG){var partialsRight=partials,holdersRight=holders;partials=holders=undefined}var data=isBindKey?undefined:getData(func),newData=[func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity];if(data&&mergeData(newData,data),func=newData[0],bitmask=newData[1],thisArg=newData[2],partials=newData[3],holders=newData[4],arity=newData[9]=newData[9]===undefined?isBindKey?0:func.length:nativeMax(newData[9]-length,0),!arity&&bitmask&(WRAP_CURRY_FLAG|WRAP_CURRY_RIGHT_FLAG)&&(bitmask&=~(WRAP_CURRY_FLAG|WRAP_CURRY_RIGHT_FLAG)),bitmask&&bitmask!=WRAP_BIND_FLAG)result=bitmask==WRAP_CURRY_FLAG||bitmask==WRAP_CURRY_RIGHT_FLAG?createCurry(func,bitmask,arity):bitmask!=WRAP_PARTIAL_FLAG&&bitmask!=(WRAP_BIND_FLAG|WRAP_PARTIAL_FLAG)||holders.length?createHybrid.apply(undefined,newData):createPartial(func,bitmask,thisArg,partials);else var result=createBind(func,bitmask,thisArg);return setWrapToString((data?baseSetData:setData)(result,newData),func,bitmask)}function customDefaultsAssignIn(objValue,srcValue,key,object){return objValue===undefined||eq(objValue,objectProto[key])&&!hasOwnProperty.call(object,key)?srcValue:objValue}function customDefaultsMerge(objValue,srcValue,key,object,source,stack){return isObject(objValue)&&isObject(srcValue)&&(stack.set(srcValue,objValue),baseMerge(objValue,srcValue,undefined,customDefaultsMerge,stack),stack.delete(srcValue)),objValue}function customOmitClone(value){return isPlainObject(value)?undefined:value}function equalArrays(array,other,bitmask,customizer,equalFunc,stack){var isPartial=bitmask&COMPARE_PARTIAL_FLAG,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength))return!1;var stacked=stack.get(array);if(stacked&&stack.get(other))return stacked==other;var index=-1,result=!0,seen=bitmask&COMPARE_UNORDERED_FLAG?new SetCache:undefined;for(stack.set(array,other),stack.set(other,array);++index<arrLength;){var arrValue=array[index],othValue=other[index];if(customizer)var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack);if(compared!==undefined){if(compared)continue;result=!1;break}if(seen){if(!arraySome(other,function(othValue,othIndex){if(!cacheHas(seen,othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack)))return seen.push(othIndex)})){result=!1;break}}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,bitmask,customizer,stack)){result=!1;break}}return stack.delete(array),stack.delete(other),result}function equalByTag(object,other,tag,bitmask,customizer,equalFunc,stack){switch(tag){case dataViewTag:if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset)return!1;object=object.buffer,other=other.buffer;case arrayBufferTag:return!(object.byteLength!=other.byteLength||!equalFunc(new Uint8Array(object),new Uint8Array(other)));case boolTag:case dateTag:case numberTag:return eq(+object,+other);case errorTag:return object.name==other.name&&object.message==other.message;case regexpTag:case stringTag:return object==other+"";case mapTag:var convert=mapToArray;case setTag:var isPartial=bitmask&COMPARE_PARTIAL_FLAG;if(convert||(convert=setToArray),object.size!=other.size&&!isPartial)return!1;var stacked=stack.get(object);if(stacked)return stacked==other;bitmask|=COMPARE_UNORDERED_FLAG,stack.set(object,other);var result=equalArrays(convert(object),convert(other),bitmask,customizer,equalFunc,stack);return stack.delete(object),result;case symbolTag:if(symbolValueOf)return symbolValueOf.call(object)==symbolValueOf.call(other)}return!1}function equalObjects(object,other,bitmask,customizer,equalFunc,stack){var isPartial=bitmask&COMPARE_PARTIAL_FLAG,objProps=getAllKeys(object),objLength=objProps.length;if(objLength!=getAllKeys(other).length&&!isPartial)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty.call(other,key)))return!1}var stacked=stack.get(object);if(stacked&&stack.get(other))return stacked==other;var result=!0;stack.set(object,other),stack.set(other,object);for(var skipCtor=isPartial;++index<objLength;){key=objProps[index];var objValue=object[key],othValue=other[key];if(customizer)var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack);if(!(compared===undefined?objValue===othValue||equalFunc(objValue,othValue,bitmask,customizer,stack):compared)){result=!1;break}skipCtor||(skipCtor="constructor"==key)}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;objCtor!=othCtor&&"constructor"in object&&"constructor"in other&&!("function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor)&&(result=!1)}return stack.delete(object),stack.delete(other),result}function flatRest(func){return setToString(overRest(func,undefined,flatten),func+"")}function getAllKeys(object){return baseGetAllKeys(object,keys,getSymbols)}function getAllKeysIn(object){return baseGetAllKeys(object,keysIn,getSymbolsIn)}function getFuncName(func){for(var result=func.name+"",array=realNames[result],length=hasOwnProperty.call(realNames,result)?array.length:0;length--;){var data=array[length],otherFunc=data.func;if(null==otherFunc||otherFunc==func)return data.name}return result}function getHolder(func){return(hasOwnProperty.call(lodash,"placeholder")?lodash:func).placeholder}function getIteratee(){var result=lodash.iteratee||iteratee;return result=result===iteratee?baseIteratee:result,arguments.length?result(arguments[0],arguments[1]):result}function getMapData(map,key){var data=map.__data__;return isKeyable(key)?data["string"==typeof key?"string":"hash"]:data.map}function getMatchData(object){for(var result=keys(object),length=result.length;length--;){var key=result[length],value=object[key];result[length]=[key,value,isStrictComparable(value)]}return result}function getNative(object,key){var value=getValue(object,key);return baseIsNative(value)?value:undefined}function getRawTag(value){var isOwn=hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{value[symToStringTag]=undefined;var unmasked=!0}catch(e){}var result=nativeObjectToString.call(value);return unmasked&&(isOwn?value[symToStringTag]=tag:delete value[symToStringTag]),result}function getView(start,end,transforms){for(var index=-1,length=transforms.length;++index<length;){var data=transforms[index],size=data.size;switch(data.type){case"drop":start+=size;break;case"dropRight":end-=size;break;case"take":end=nativeMin(end,start+size);break;case"takeRight":start=nativeMax(start,end-size)}}return{start:start,end:end}}function getWrapDetails(source){var match=source.match(reWrapDetails);return match?match[1].split(reSplitDetails):[]}function hasPath(object,path,hasFunc){path=castPath(path,object);for(var index=-1,length=path.length,result=!1;++index<length;){var key=toKey(path[index]);if(!(result=null!=object&&hasFunc(object,key)))break;object=object[key]}return result||++index!=length?result:!!(length=null==object?0:object.length)&&isLength(length)&&isIndex(key,length)&&(isArray(object)||isArguments(object))}function initCloneArray(array){var length=array.length,result=new array.constructor(length);return length&&"string"==typeof array[0]&&hasOwnProperty.call(array,"index")&&(result.index=array.index,result.input=array.input),result}function initCloneObject(object){return"function"!=typeof object.constructor||isPrototype(object)?{}:baseCreate(getPrototype(object))}function initCloneByTag(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag:return cloneArrayBuffer(object);case boolTag:case dateTag:return new Ctor(+object);case dataViewTag:return cloneDataView(object,isDeep);case float32Tag:case float64Tag:case int8Tag:case int16Tag:case int32Tag:case uint8Tag:case uint8ClampedTag:case uint16Tag:case uint32Tag:return cloneTypedArray(object,isDeep);case mapTag:return new Ctor;case numberTag:case stringTag:return new Ctor(object);case regexpTag:return cloneRegExp(object);case setTag:return new Ctor;case symbolTag:return cloneSymbol(object)}}function insertWrapDetails(source,details){var length=details.length;if(!length)return source;var lastIndex=length-1;return details[lastIndex]=(length>1?"& ":"")+details[lastIndex],details=details.join(length>2?", ":" "),source.replace(reWrapComment,"{\n/* [wrapped with "+details+"] */\n")}function isFlattenable(value){return isArray(value)||isArguments(value)||!!(spreadableSymbol&&value&&value[spreadableSymbol])}function isIndex(value,length){var type=typeof value;return!!(length=null==length?MAX_SAFE_INTEGER:length)&&("number"==type||"symbol"!=type&&reIsUint.test(value))&&value>-1&&value%1==0&&value<length}function isIterateeCall(value,index,object){if(!isObject(object))return!1;var type=typeof index;return!!("number"==type?isArrayLike(object)&&isIndex(index,object.length):"string"==type&&index in object)&&eq(object[index],value)}function isKey(value,object){if(isArray(value))return!1;var type=typeof value;return!("number"!=type&&"symbol"!=type&&"boolean"!=type&&null!=value&&!isSymbol(value))||(reIsPlainProp.test(value)||!reIsDeepProp.test(value)||null!=object&&value in Object(object))}function isKeyable(value){var type=typeof value;return"string"==type||"number"==type||"symbol"==type||"boolean"==type?"__proto__"!==value:null===value}function isLaziable(func){var funcName=getFuncName(func),other=lodash[funcName];if("function"!=typeof other||!(funcName in LazyWrapper.prototype))return!1;if(func===other)return!0;var data=getData(other);return!!data&&func===data[0]}function isMasked(func){return!!maskSrcKey&&maskSrcKey in func}function isPrototype(value){var Ctor=value&&value.constructor;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto)}function isStrictComparable(value){return value===value&&!isObject(value)}function matchesStrictComparable(key,srcValue){return function(object){return null!=object&&(object[key]===srcValue&&(srcValue!==undefined||key in Object(object)))}}function mergeData(data,source){var bitmask=data[1],srcBitmask=source[1],newBitmask=bitmask|srcBitmask,isCommon=newBitmask<(WRAP_BIND_FLAG|WRAP_BIND_KEY_FLAG|WRAP_ARY_FLAG),isCombo=srcBitmask==WRAP_ARY_FLAG&&bitmask==WRAP_CURRY_FLAG||srcBitmask==WRAP_ARY_FLAG&&bitmask==WRAP_REARG_FLAG&&data[7].length<=source[8]||srcBitmask==(WRAP_ARY_FLAG|WRAP_REARG_FLAG)&&source[7].length<=source[8]&&bitmask==WRAP_CURRY_FLAG;if(!isCommon&&!isCombo)return data;srcBitmask&WRAP_BIND_FLAG&&(data[2]=source[2],newBitmask|=bitmask&WRAP_BIND_FLAG?0:WRAP_CURRY_BOUND_FLAG);var value=source[3];if(value){var partials=data[3];data[3]=partials?composeArgs(partials,value,source[4]):value,data[4]=partials?replaceHolders(data[3],PLACEHOLDER):source[4]}return value=source[5],value&&(partials=data[5],data[5]=partials?composeArgsRight(partials,value,source[6]):value,data[6]=partials?replaceHolders(data[5],PLACEHOLDER):source[6]),value=source[7],value&&(data[7]=value),srcBitmask&WRAP_ARY_FLAG&&(data[8]=null==data[8]?source[8]:nativeMin(data[8],source[8])),null==data[9]&&(data[9]=source[9]),data[0]=source[0],data[1]=newBitmask,data}function nativeKeysIn(object){var result=[];if(null!=object)for(var key in Object(object))result.push(key);return result}function objectToString(value){return nativeObjectToString.call(value)}function overRest(func,start,transform){return start=nativeMax(start===undefined?func.length-1:start,0),function(){for(var args=arguments,index=-1,length=nativeMax(args.length-start,0),array=Array(length);++index<length;)array[index]=args[start+index];index=-1;for(var otherArgs=Array(start+1);++index<start;)otherArgs[index]=args[index];return otherArgs[start]=transform(array),apply(func,this,otherArgs)}}function parent(object,path){return path.length<2?object:baseGet(object,baseSlice(path,0,-1))}function reorder(array,indexes){for(var arrLength=array.length,length=nativeMin(indexes.length,arrLength),oldArray=copyArray(array);length--;){var index=indexes[length];array[length]=isIndex(index,arrLength)?oldArray[index]:undefined}return array}function safeGet(object,key){if("__proto__"!=key)return object[key]}function setWrapToString(wrapper,reference,bitmask){var source=reference+"";return setToString(wrapper,insertWrapDetails(source,updateWrapDetails(getWrapDetails(source),bitmask)))}function shortOut(func){var count=0,lastCalled=0;return function(){var stamp=nativeNow(),remaining=HOT_SPAN-(stamp-lastCalled);if(lastCalled=stamp,remaining>0){if(++count>=HOT_COUNT)return arguments[0]}else count=0;return func.apply(undefined,arguments)}}function shuffleSelf(array,size){var index=-1,length=array.length,lastIndex=length-1;for(size=size===undefined?length:size;++index<size;){var rand=baseRandom(index,lastIndex),value=array[rand];array[rand]=array[index],array[index]=value}return array.length=size,array}function toKey(value){if("string"==typeof value||isSymbol(value))return value;var result=value+"";return"0"==result&&1/value==-INFINITY?"-0":result}function toSource(func){if(null!=func){try{return funcToString.call(func)}catch(e){}try{return func+""}catch(e){}}return""}function updateWrapDetails(details,bitmask){return arrayEach(wrapFlags,function(pair){var value="_."+pair[0];bitmask&pair[1]&&!arrayIncludes(details,value)&&details.push(value)}),details.sort()}function wrapperClone(wrapper){if(wrapper instanceof LazyWrapper)return wrapper.clone();var result=new LodashWrapper(wrapper.__wrapped__,wrapper.__chain__);return result.__actions__=copyArray(wrapper.__actions__),result.__index__=wrapper.__index__,result.__values__=wrapper.__values__,result}function chunk(array,size,guard){size=(guard?isIterateeCall(array,size,guard):size===undefined)?1:nativeMax(toInteger(size),0);var length=null==array?0:array.length;if(!length||size<1)return[];for(var index=0,resIndex=0,result=Array(nativeCeil(length/size));index<length;)result[resIndex++]=baseSlice(array,index,index+=size);return result}function compact(array){for(var index=-1,length=null==array?0:array.length,resIndex=0,result=[];++index<length;){var value=array[index];value&&(result[resIndex++]=value)}return result}function concat(){var length=arguments.length;if(!length)return[];for(var args=Array(length-1),array=arguments[0],index=length;index--;)args[index-1]=arguments[index];return arrayPush(isArray(array)?copyArray(array):[array],baseFlatten(args,1))}function drop(array,n,guard){var length=null==array?0:array.length;return length?(n=guard||n===undefined?1:toInteger(n),baseSlice(array,n<0?0:n,length)):[]}function dropRight(array,n,guard){var length=null==array?0:array.length;return length?(n=guard||n===undefined?1:toInteger(n),n=length-n,baseSlice(array,0,n<0?0:n)):[]}function dropRightWhile(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3),!0,!0):[]}function dropWhile(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3),!0):[]}function fill(array,value,start,end){var length=null==array?0:array.length;return length?(start&&"number"!=typeof start&&isIterateeCall(array,value,start)&&(start=0,end=length),baseFill(array,value,start,end)):[]}function findIndex(array,predicate,fromIndex){var length=null==array?0:array.length;if(!length)return-1;var index=null==fromIndex?0:toInteger(fromIndex);return index<0&&(index=nativeMax(length+index,0)),baseFindIndex(array,getIteratee(predicate,3),index)}function findLastIndex(array,predicate,fromIndex){var length=null==array?0:array.length;if(!length)return-1;var index=length-1;return fromIndex!==undefined&&(index=toInteger(fromIndex),index=fromIndex<0?nativeMax(length+index,0):nativeMin(index,length-1)),baseFindIndex(array,getIteratee(predicate,3),index,!0)}function flatten(array){return(null==array?0:array.length)?baseFlatten(array,1):[]}function flattenDeep(array){return(null==array?0:array.length)?baseFlatten(array,INFINITY):[]}function flattenDepth(array,depth){return(null==array?0:array.length)?(depth=depth===undefined?1:toInteger(depth),baseFlatten(array,depth)):[]}function fromPairs(pairs){for(var index=-1,length=null==pairs?0:pairs.length,result={};++index<length;){var pair=pairs[index];result[pair[0]]=pair[1]}return result}function head(array){return array&&array.length?array[0]:undefined}function indexOf(array,value,fromIndex){var length=null==array?0:array.length;if(!length)return-1;var index=null==fromIndex?0:toInteger(fromIndex);return index<0&&(index=nativeMax(length+index,0)),baseIndexOf(array,value,index)}function initial(array){return(null==array?0:array.length)?baseSlice(array,0,-1):[]}function join(array,separator){return null==array?"":nativeJoin.call(array,separator)}function last(array){var length=null==array?0:array.length;return length?array[length-1]:undefined}function lastIndexOf(array,value,fromIndex){var length=null==array?0:array.length;if(!length)return-1;var index=length;return fromIndex!==undefined&&(index=toInteger(fromIndex),index=index<0?nativeMax(length+index,0):nativeMin(index,length-1)),value===value?strictLastIndexOf(array,value,index):baseFindIndex(array,baseIsNaN,index,!0)}function nth(array,n){return array&&array.length?baseNth(array,toInteger(n)):undefined}function pullAll(array,values){return array&&array.length&&values&&values.length?basePullAll(array,values):array}function pullAllBy(array,values,iteratee){return array&&array.length&&values&&values.length?basePullAll(array,values,getIteratee(iteratee,2)):array}function pullAllWith(array,values,comparator){return array&&array.length&&values&&values.length?basePullAll(array,values,undefined,comparator):array}function remove(array,predicate){var result=[];if(!array||!array.length)return result;var index=-1,indexes=[],length=array.length;for(predicate=getIteratee(predicate,3);++index<length;){var value=array[index];predicate(value,index,array)&&(result.push(value),indexes.push(index))}return basePullAt(array,indexes),result}function reverse(array){return null==array?array:nativeReverse.call(array)}function slice(array,start,end){var length=null==array?0:array.length;return length?(end&&"number"!=typeof end&&isIterateeCall(array,start,end)?(start=0,end=length):(start=null==start?0:toInteger(start),end=end===undefined?length:toInteger(end)),baseSlice(array,start,end)):[]}function sortedIndex(array,value){return baseSortedIndex(array,value)}function sortedIndexBy(array,value,iteratee){return baseSortedIndexBy(array,value,getIteratee(iteratee,2))}function sortedIndexOf(array,value){var length=null==array?0:array.length;if(length){var index=baseSortedIndex(array,value);if(index<length&&eq(array[index],value))return index}return-1}function sortedLastIndex(array,value){return baseSortedIndex(array,value,!0)}function sortedLastIndexBy(array,value,iteratee){return baseSortedIndexBy(array,value,getIteratee(iteratee,2),!0)}function sortedLastIndexOf(array,value){if(null==array?0:array.length){var index=baseSortedIndex(array,value,!0)-1;if(eq(array[index],value))return index}return-1}function sortedUniq(array){return array&&array.length?baseSortedUniq(array):[]}function sortedUniqBy(array,iteratee){
return array&&array.length?baseSortedUniq(array,getIteratee(iteratee,2)):[]}function tail(array){var length=null==array?0:array.length;return length?baseSlice(array,1,length):[]}function take(array,n,guard){return array&&array.length?(n=guard||n===undefined?1:toInteger(n),baseSlice(array,0,n<0?0:n)):[]}function takeRight(array,n,guard){var length=null==array?0:array.length;return length?(n=guard||n===undefined?1:toInteger(n),n=length-n,baseSlice(array,n<0?0:n,length)):[]}function takeRightWhile(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3),!1,!0):[]}function takeWhile(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3)):[]}function uniq(array){return array&&array.length?baseUniq(array):[]}function uniqBy(array,iteratee){return array&&array.length?baseUniq(array,getIteratee(iteratee,2)):[]}function uniqWith(array,comparator){return comparator="function"==typeof comparator?comparator:undefined,array&&array.length?baseUniq(array,undefined,comparator):[]}function unzip(array){if(!array||!array.length)return[];var length=0;return array=arrayFilter(array,function(group){if(isArrayLikeObject(group))return length=nativeMax(group.length,length),!0}),baseTimes(length,function(index){return arrayMap(array,baseProperty(index))})}function unzipWith(array,iteratee){if(!array||!array.length)return[];var result=unzip(array);return null==iteratee?result:arrayMap(result,function(group){return apply(iteratee,undefined,group)})}function zipObject(props,values){return baseZipObject(props||[],values||[],assignValue)}function zipObjectDeep(props,values){return baseZipObject(props||[],values||[],baseSet)}function chain(value){var result=lodash(value);return result.__chain__=!0,result}function tap(value,interceptor){return interceptor(value),value}function thru(value,interceptor){return interceptor(value)}function wrapperChain(){return chain(this)}function wrapperCommit(){return new LodashWrapper(this.value(),this.__chain__)}function wrapperNext(){this.__values__===undefined&&(this.__values__=toArray(this.value()));var done=this.__index__>=this.__values__.length;return{done:done,value:done?undefined:this.__values__[this.__index__++]}}function wrapperToIterator(){return this}function wrapperPlant(value){for(var result,parent=this;parent instanceof baseLodash;){var clone=wrapperClone(parent);clone.__index__=0,clone.__values__=undefined,result?previous.__wrapped__=clone:result=clone;var previous=clone;parent=parent.__wrapped__}return previous.__wrapped__=value,result}function wrapperReverse(){var value=this.__wrapped__;if(value instanceof LazyWrapper){var wrapped=value;return this.__actions__.length&&(wrapped=new LazyWrapper(this)),wrapped=wrapped.reverse(),wrapped.__actions__.push({func:thru,args:[reverse],thisArg:undefined}),new LodashWrapper(wrapped,this.__chain__)}return this.thru(reverse)}function wrapperValue(){return baseWrapperValue(this.__wrapped__,this.__actions__)}function every(collection,predicate,guard){var func=isArray(collection)?arrayEvery:baseEvery;return guard&&isIterateeCall(collection,predicate,guard)&&(predicate=undefined),func(collection,getIteratee(predicate,3))}function filter(collection,predicate){return(isArray(collection)?arrayFilter:baseFilter)(collection,getIteratee(predicate,3))}function flatMap(collection,iteratee){return baseFlatten(map(collection,iteratee),1)}function flatMapDeep(collection,iteratee){return baseFlatten(map(collection,iteratee),INFINITY)}function flatMapDepth(collection,iteratee,depth){return depth=depth===undefined?1:toInteger(depth),baseFlatten(map(collection,iteratee),depth)}function forEach(collection,iteratee){return(isArray(collection)?arrayEach:baseEach)(collection,getIteratee(iteratee,3))}function forEachRight(collection,iteratee){return(isArray(collection)?arrayEachRight:baseEachRight)(collection,getIteratee(iteratee,3))}function includes(collection,value,fromIndex,guard){collection=isArrayLike(collection)?collection:values(collection),fromIndex=fromIndex&&!guard?toInteger(fromIndex):0;var length=collection.length;return fromIndex<0&&(fromIndex=nativeMax(length+fromIndex,0)),isString(collection)?fromIndex<=length&&collection.indexOf(value,fromIndex)>-1:!!length&&baseIndexOf(collection,value,fromIndex)>-1}function map(collection,iteratee){return(isArray(collection)?arrayMap:baseMap)(collection,getIteratee(iteratee,3))}function orderBy(collection,iteratees,orders,guard){return null==collection?[]:(isArray(iteratees)||(iteratees=null==iteratees?[]:[iteratees]),orders=guard?undefined:orders,isArray(orders)||(orders=null==orders?[]:[orders]),baseOrderBy(collection,iteratees,orders))}function reduce(collection,iteratee,accumulator){var func=isArray(collection)?arrayReduce:baseReduce,initAccum=arguments.length<3;return func(collection,getIteratee(iteratee,4),accumulator,initAccum,baseEach)}function reduceRight(collection,iteratee,accumulator){var func=isArray(collection)?arrayReduceRight:baseReduce,initAccum=arguments.length<3;return func(collection,getIteratee(iteratee,4),accumulator,initAccum,baseEachRight)}function reject(collection,predicate){return(isArray(collection)?arrayFilter:baseFilter)(collection,negate(getIteratee(predicate,3)))}function sample(collection){return(isArray(collection)?arraySample:baseSample)(collection)}function sampleSize(collection,n,guard){return n=(guard?isIterateeCall(collection,n,guard):n===undefined)?1:toInteger(n),(isArray(collection)?arraySampleSize:baseSampleSize)(collection,n)}function shuffle(collection){return(isArray(collection)?arrayShuffle:baseShuffle)(collection)}function size(collection){if(null==collection)return 0;if(isArrayLike(collection))return isString(collection)?stringSize(collection):collection.length;var tag=getTag(collection);return tag==mapTag||tag==setTag?collection.size:baseKeys(collection).length}function some(collection,predicate,guard){var func=isArray(collection)?arraySome:baseSome;return guard&&isIterateeCall(collection,predicate,guard)&&(predicate=undefined),func(collection,getIteratee(predicate,3))}function after(n,func){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return n=toInteger(n),function(){if(--n<1)return func.apply(this,arguments)}}function ary(func,n,guard){return n=guard?undefined:n,n=func&&null==n?func.length:n,createWrap(func,WRAP_ARY_FLAG,undefined,undefined,undefined,undefined,n)}function before(n,func){var result;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return n=toInteger(n),function(){return--n>0&&(result=func.apply(this,arguments)),n<=1&&(func=undefined),result}}function curry(func,arity,guard){arity=guard?undefined:arity;var result=createWrap(func,WRAP_CURRY_FLAG,undefined,undefined,undefined,undefined,undefined,arity);return result.placeholder=curry.placeholder,result}function curryRight(func,arity,guard){arity=guard?undefined:arity;var result=createWrap(func,WRAP_CURRY_RIGHT_FLAG,undefined,undefined,undefined,undefined,undefined,arity);return result.placeholder=curryRight.placeholder,result}function debounce(func,wait,options){function invokeFunc(time){var args=lastArgs,thisArg=lastThis;return lastArgs=lastThis=undefined,lastInvokeTime=time,result=func.apply(thisArg,args)}function leadingEdge(time){return lastInvokeTime=time,timerId=setTimeout(timerExpired,wait),leading?invokeFunc(time):result}function remainingWait(time){var timeSinceLastCall=time-lastCallTime,timeSinceLastInvoke=time-lastInvokeTime,timeWaiting=wait-timeSinceLastCall;return maxing?nativeMin(timeWaiting,maxWait-timeSinceLastInvoke):timeWaiting}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime,timeSinceLastInvoke=time-lastInvokeTime;return lastCallTime===undefined||timeSinceLastCall>=wait||timeSinceLastCall<0||maxing&&timeSinceLastInvoke>=maxWait}function timerExpired(){var time=now();if(shouldInvoke(time))return trailingEdge(time);timerId=setTimeout(timerExpired,remainingWait(time))}function trailingEdge(time){return timerId=undefined,trailing&&lastArgs?invokeFunc(time):(lastArgs=lastThis=undefined,result)}function cancel(){timerId!==undefined&&clearTimeout(timerId),lastInvokeTime=0,lastArgs=lastCallTime=lastThis=timerId=undefined}function flush(){return timerId===undefined?result:trailingEdge(now())}function debounced(){var time=now(),isInvoking=shouldInvoke(time);if(lastArgs=arguments,lastThis=this,lastCallTime=time,isInvoking){if(timerId===undefined)return leadingEdge(lastCallTime);if(maxing)return timerId=setTimeout(timerExpired,wait),invokeFunc(lastCallTime)}return timerId===undefined&&(timerId=setTimeout(timerExpired,wait)),result}var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=!1,maxing=!1,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return wait=toNumber(wait)||0,isObject(options)&&(leading=!!options.leading,maxing="maxWait"in options,maxWait=maxing?nativeMax(toNumber(options.maxWait)||0,wait):maxWait,trailing="trailing"in options?!!options.trailing:trailing),debounced.cancel=cancel,debounced.flush=flush,debounced}function flip(func){return createWrap(func,WRAP_FLIP_FLAG)}function memoize(func,resolver){if("function"!=typeof func||null!=resolver&&"function"!=typeof resolver)throw new TypeError(FUNC_ERROR_TEXT);var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result)||cache,result};return memoized.cache=new(memoize.Cache||MapCache),memoized}function negate(predicate){if("function"!=typeof predicate)throw new TypeError(FUNC_ERROR_TEXT);return function(){var args=arguments;switch(args.length){case 0:return!predicate.call(this);case 1:return!predicate.call(this,args[0]);case 2:return!predicate.call(this,args[0],args[1]);case 3:return!predicate.call(this,args[0],args[1],args[2])}return!predicate.apply(this,args)}}function once(func){return before(2,func)}function rest(func,start){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return start=start===undefined?start:toInteger(start),baseRest(func,start)}function spread(func,start){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return start=null==start?0:nativeMax(toInteger(start),0),baseRest(function(args){var array=args[start],otherArgs=castSlice(args,0,start);return array&&arrayPush(otherArgs,array),apply(func,this,otherArgs)})}function throttle(func,wait,options){var leading=!0,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return isObject(options)&&(leading="leading"in options?!!options.leading:leading,trailing="trailing"in options?!!options.trailing:trailing),debounce(func,wait,{leading:leading,maxWait:wait,trailing:trailing})}function unary(func){return ary(func,1)}function wrap(value,wrapper){return partial(castFunction(wrapper),value)}function castArray(){if(!arguments.length)return[];var value=arguments[0];return isArray(value)?value:[value]}function clone(value){return baseClone(value,CLONE_SYMBOLS_FLAG)}function cloneWith(value,customizer){return customizer="function"==typeof customizer?customizer:undefined,baseClone(value,CLONE_SYMBOLS_FLAG,customizer)}function cloneDeep(value){return baseClone(value,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG)}function cloneDeepWith(value,customizer){return customizer="function"==typeof customizer?customizer:undefined,baseClone(value,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG,customizer)}function conformsTo(object,source){return null==source||baseConformsTo(object,source,keys(source))}function eq(value,other){return value===other||value!==value&&other!==other}function isArrayLike(value){return null!=value&&isLength(value.length)&&!isFunction(value)}function isArrayLikeObject(value){return isObjectLike(value)&&isArrayLike(value)}function isBoolean(value){return!0===value||!1===value||isObjectLike(value)&&baseGetTag(value)==boolTag}function isElement(value){return isObjectLike(value)&&1===value.nodeType&&!isPlainObject(value)}function isEmpty(value){if(null==value)return!0;if(isArrayLike(value)&&(isArray(value)||"string"==typeof value||"function"==typeof value.splice||isBuffer(value)||isTypedArray(value)||isArguments(value)))return!value.length;var tag=getTag(value);if(tag==mapTag||tag==setTag)return!value.size;if(isPrototype(value))return!baseKeys(value).length;for(var key in value)if(hasOwnProperty.call(value,key))return!1;return!0}function isEqual(value,other){return baseIsEqual(value,other)}function isEqualWith(value,other,customizer){customizer="function"==typeof customizer?customizer:undefined;var result=customizer?customizer(value,other):undefined;return result===undefined?baseIsEqual(value,other,undefined,customizer):!!result}function isError(value){if(!isObjectLike(value))return!1;var tag=baseGetTag(value);return tag==errorTag||tag==domExcTag||"string"==typeof value.message&&"string"==typeof value.name&&!isPlainObject(value)}function isFinite(value){return"number"==typeof value&&nativeIsFinite(value)}function isFunction(value){if(!isObject(value))return!1;var tag=baseGetTag(value);return tag==funcTag||tag==genTag||tag==asyncTag||tag==proxyTag}function isInteger(value){return"number"==typeof value&&value==toInteger(value)}function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER}function isObject(value){var type=typeof value;return null!=value&&("object"==type||"function"==type)}function isObjectLike(value){return null!=value&&"object"==typeof value}function isMatch(object,source){return object===source||baseIsMatch(object,source,getMatchData(source))}function isMatchWith(object,source,customizer){return customizer="function"==typeof customizer?customizer:undefined,baseIsMatch(object,source,getMatchData(source),customizer)}function isNaN(value){return isNumber(value)&&value!=+value}function isNative(value){if(isMaskable(value))throw new Error(CORE_ERROR_TEXT);return baseIsNative(value)}function isNull(value){return null===value}function isNil(value){return null==value}function isNumber(value){return"number"==typeof value||isObjectLike(value)&&baseGetTag(value)==numberTag}function isPlainObject(value){if(!isObjectLike(value)||baseGetTag(value)!=objectTag)return!1;var proto=getPrototype(value);if(null===proto)return!0;var Ctor=hasOwnProperty.call(proto,"constructor")&&proto.constructor;return"function"==typeof Ctor&&Ctor instanceof Ctor&&funcToString.call(Ctor)==objectCtorString}function isSafeInteger(value){return isInteger(value)&&value>=-MAX_SAFE_INTEGER&&value<=MAX_SAFE_INTEGER}function isString(value){return"string"==typeof value||!isArray(value)&&isObjectLike(value)&&baseGetTag(value)==stringTag}function isSymbol(value){return"symbol"==typeof value||isObjectLike(value)&&baseGetTag(value)==symbolTag}function isUndefined(value){return value===undefined}function isWeakMap(value){return isObjectLike(value)&&getTag(value)==weakMapTag}function isWeakSet(value){return isObjectLike(value)&&baseGetTag(value)==weakSetTag}function toArray(value){if(!value)return[];if(isArrayLike(value))return isString(value)?stringToArray(value):copyArray(value);if(symIterator&&value[symIterator])return iteratorToArray(value[symIterator]());var tag=getTag(value);return(tag==mapTag?mapToArray:tag==setTag?setToArray:values)(value)}function toFinite(value){if(!value)return 0===value?value:0;if((value=toNumber(value))===INFINITY||value===-INFINITY){return(value<0?-1:1)*MAX_INTEGER}return value===value?value:0}function toInteger(value){var result=toFinite(value),remainder=result%1;return result===result?remainder?result-remainder:result:0}function toLength(value){return value?baseClamp(toInteger(value),0,MAX_ARRAY_LENGTH):0}function toNumber(value){if("number"==typeof value)return value;if(isSymbol(value))return NAN;if(isObject(value)){var other="function"==typeof value.valueOf?value.valueOf():value;value=isObject(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=value.replace(reTrim,"");var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NAN:+value}function toPlainObject(value){return copyObject(value,keysIn(value))}function toSafeInteger(value){return value?baseClamp(toInteger(value),-MAX_SAFE_INTEGER,MAX_SAFE_INTEGER):0===value?value:0}function toString(value){return null==value?"":baseToString(value)}function create(prototype,properties){var result=baseCreate(prototype);return null==properties?result:baseAssign(result,properties)}function findKey(object,predicate){return baseFindKey(object,getIteratee(predicate,3),baseForOwn)}function findLastKey(object,predicate){return baseFindKey(object,getIteratee(predicate,3),baseForOwnRight)}function forIn(object,iteratee){return null==object?object:baseFor(object,getIteratee(iteratee,3),keysIn)}function forInRight(object,iteratee){return null==object?object:baseForRight(object,getIteratee(iteratee,3),keysIn)}function forOwn(object,iteratee){return object&&baseForOwn(object,getIteratee(iteratee,3))}function forOwnRight(object,iteratee){return object&&baseForOwnRight(object,getIteratee(iteratee,3))}function functions(object){return null==object?[]:baseFunctions(object,keys(object))}function functionsIn(object){return null==object?[]:baseFunctions(object,keysIn(object))}function get(object,path,defaultValue){var result=null==object?undefined:baseGet(object,path);return result===undefined?defaultValue:result}function has(object,path){return null!=object&&hasPath(object,path,baseHas)}function hasIn(object,path){return null!=object&&hasPath(object,path,baseHasIn)}function keys(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}function keysIn(object){return isArrayLike(object)?arrayLikeKeys(object,!0):baseKeysIn(object)}function mapKeys(object,iteratee){var result={};return iteratee=getIteratee(iteratee,3),baseForOwn(object,function(value,key,object){baseAssignValue(result,iteratee(value,key,object),value)}),result}function mapValues(object,iteratee){var result={};return iteratee=getIteratee(iteratee,3),baseForOwn(object,function(value,key,object){baseAssignValue(result,key,iteratee(value,key,object))}),result}function omitBy(object,predicate){return pickBy(object,negate(getIteratee(predicate)))}function pickBy(object,predicate){if(null==object)return{};var props=arrayMap(getAllKeysIn(object),function(prop){return[prop]});return predicate=getIteratee(predicate),basePickBy(object,props,function(value,path){return predicate(value,path[0])})}function result(object,path,defaultValue){path=castPath(path,object);var index=-1,length=path.length;for(length||(length=1,object=undefined);++index<length;){var value=null==object?undefined:object[toKey(path[index])];value===undefined&&(index=length,value=defaultValue),object=isFunction(value)?value.call(object):value}return object}function set(object,path,value){return null==object?object:baseSet(object,path,value)}function setWith(object,path,value,customizer){return customizer="function"==typeof customizer?customizer:undefined,null==object?object:baseSet(object,path,value,customizer)}function transform(object,iteratee,accumulator){var isArr=isArray(object),isArrLike=isArr||isBuffer(object)||isTypedArray(object);if(iteratee=getIteratee(iteratee,4),null==accumulator){var Ctor=object&&object.constructor;accumulator=isArrLike?isArr?new Ctor:[]:isObject(object)&&isFunction(Ctor)?baseCreate(getPrototype(object)):{}}return(isArrLike?arrayEach:baseForOwn)(object,function(value,index,object){return iteratee(accumulator,value,index,object)}),accumulator}function unset(object,path){return null==object||baseUnset(object,path)}function update(object,path,updater){return null==object?object:baseUpdate(object,path,castFunction(updater))}function updateWith(object,path,updater,customizer){return customizer="function"==typeof customizer?customizer:undefined,null==object?object:baseUpdate(object,path,castFunction(updater),customizer)}function values(object){return null==object?[]:baseValues(object,keys(object))}function valuesIn(object){return null==object?[]:baseValues(object,keysIn(object))}function clamp(number,lower,upper){return upper===undefined&&(upper=lower,lower=undefined),upper!==undefined&&(upper=toNumber(upper),upper=upper===upper?upper:0),lower!==undefined&&(lower=toNumber(lower),lower=lower===lower?lower:0),baseClamp(toNumber(number),lower,upper)}function inRange(number,start,end){return start=toFinite(start),end===undefined?(end=start,start=0):end=toFinite(end),number=toNumber(number),baseInRange(number,start,end)}function random(lower,upper,floating){if(floating&&"boolean"!=typeof floating&&isIterateeCall(lower,upper,floating)&&(upper=floating=undefined),floating===undefined&&("boolean"==typeof upper?(floating=upper,upper=undefined):"boolean"==typeof lower&&(floating=lower,lower=undefined)),lower===undefined&&upper===undefined?(lower=0,upper=1):(lower=toFinite(lower),upper===undefined?(upper=lower,lower=0):upper=toFinite(upper)),lower>upper){var temp=lower;lower=upper,upper=temp}if(floating||lower%1||upper%1){var rand=nativeRandom();return nativeMin(lower+rand*(upper-lower+freeParseFloat("1e-"+((rand+"").length-1))),upper)}return baseRandom(lower,upper)}function capitalize(string){return upperFirst(toString(string).toLowerCase())}function deburr(string){return(string=toString(string))&&string.replace(reLatin,deburrLetter).replace(reComboMark,"")}function endsWith(string,target,position){string=toString(string),target=baseToString(target);var length=string.length;position=position===undefined?length:baseClamp(toInteger(position),0,length);var end=position;return(position-=target.length)>=0&&string.slice(position,end)==target}function escape(string){return string=toString(string),string&&reHasUnescapedHtml.test(string)?string.replace(reUnescapedHtml,escapeHtmlChar):string}function escapeRegExp(string){return string=toString(string),string&&reHasRegExpChar.test(string)?string.replace(reRegExpChar,"\\$&"):string}function pad(string,length,chars){string=toString(string),length=toInteger(length);var strLength=length?stringSize(string):0;if(!length||strLength>=length)return string;var mid=(length-strLength)/2;return createPadding(nativeFloor(mid),chars)+string+createPadding(nativeCeil(mid),chars)}function padEnd(string,length,chars){string=toString(string),length=toInteger(length);var strLength=length?stringSize(string):0;return length&&strLength<length?string+createPadding(length-strLength,chars):string}function padStart(string,length,chars){string=toString(string),length=toInteger(length);var strLength=length?stringSize(string):0;return length&&strLength<length?createPadding(length-strLength,chars)+string:string}function parseInt(string,radix,guard){return guard||null==radix?radix=0:radix&&(radix=+radix),nativeParseInt(toString(string).replace(reTrimStart,""),radix||0)}function repeat(string,n,guard){return n=(guard?isIterateeCall(string,n,guard):n===undefined)?1:toInteger(n),baseRepeat(toString(string),n)}function replace(){var args=arguments,string=toString(args[0]);return args.length<3?string:string.replace(args[1],args[2])}function split(string,separator,limit){return limit&&"number"!=typeof limit&&isIterateeCall(string,separator,limit)&&(separator=limit=undefined),(limit=limit===undefined?MAX_ARRAY_LENGTH:limit>>>0)?(string=toString(string),string&&("string"==typeof separator||null!=separator&&!isRegExp(separator))&&!(separator=baseToString(separator))&&hasUnicode(string)?castSlice(stringToArray(string),0,limit):string.split(separator,limit)):[]}function startsWith(string,target,position){return string=toString(string),position=null==position?0:baseClamp(toInteger(position),0,string.length),target=baseToString(target),string.slice(position,position+target.length)==target}function template(string,options,guard){var settings=lodash.templateSettings;guard&&isIterateeCall(string,options,guard)&&(options=undefined),string=toString(string),options=assignInWith({},options,settings,customDefaultsAssignIn);var isEscaping,isEvaluating,imports=assignInWith({},options.imports,settings.imports,customDefaultsAssignIn),importsKeys=keys(imports),importsValues=baseValues(imports,importsKeys),index=0,interpolate=options.interpolate||reNoMatch,source="__p += '",reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g"),sourceURL="//# sourceURL="+("sourceURL"in options?options.sourceURL:"lodash.templateSources["+ ++templateCounter+"]")+"\n";string.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){return interpolateValue||(interpolateValue=esTemplateValue),source+=string.slice(index,offset).replace(reUnescapedString,escapeStringChar),escapeValue&&(isEscaping=!0,source+="' +\n__e("+escapeValue+") +\n'"),evaluateValue&&(isEvaluating=!0,source+="';\n"+evaluateValue+";\n__p += '"),interpolateValue&&(source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"),index=offset+match.length,match}),source+="';\n";var variable=options.variable;variable||(source="with (obj) {\n"+source+"\n}\n"),source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;"),source="function("+(variable||"obj")+") {\n"+(variable?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(isEscaping?", __e = _.escape":"")+(isEvaluating?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var result=attempt(function(){return Function(importsKeys,sourceURL+"return "+source).apply(undefined,importsValues)});if(result.source=source,isError(result))throw result;return result}function toLower(value){return toString(value).toLowerCase()}function toUpper(value){return toString(value).toUpperCase()}function trim(string,chars,guard){if((string=toString(string))&&(guard||chars===undefined))return string.replace(reTrim,"");if(!string||!(chars=baseToString(chars)))return string;var strSymbols=stringToArray(string),chrSymbols=stringToArray(chars);return castSlice(strSymbols,charsStartIndex(strSymbols,chrSymbols),charsEndIndex(strSymbols,chrSymbols)+1).join("")}function trimEnd(string,chars,guard){if((string=toString(string))&&(guard||chars===undefined))return string.replace(reTrimEnd,"");if(!string||!(chars=baseToString(chars)))return string;var strSymbols=stringToArray(string);return castSlice(strSymbols,0,charsEndIndex(strSymbols,stringToArray(chars))+1).join("")}function trimStart(string,chars,guard){if((string=toString(string))&&(guard||chars===undefined))return string.replace(reTrimStart,"");if(!string||!(chars=baseToString(chars)))return string;var strSymbols=stringToArray(string);return castSlice(strSymbols,charsStartIndex(strSymbols,stringToArray(chars))).join("")}function truncate(string,options){var length=DEFAULT_TRUNC_LENGTH,omission=DEFAULT_TRUNC_OMISSION;if(isObject(options)){var separator="separator"in options?options.separator:separator;length="length"in options?toInteger(options.length):length,omission="omission"in options?baseToString(options.omission):omission}string=toString(string);var strLength=string.length;if(hasUnicode(string)){var strSymbols=stringToArray(string);strLength=strSymbols.length}if(length>=strLength)return string;var end=length-stringSize(omission);if(end<1)return omission;var result=strSymbols?castSlice(strSymbols,0,end).join(""):string.slice(0,end);if(separator===undefined)return result+omission;if(strSymbols&&(end+=result.length-end),isRegExp(separator)){if(string.slice(end).search(separator)){var match,substring=result;for(separator.global||(separator=RegExp(separator.source,toString(reFlags.exec(separator))+"g")),separator.lastIndex=0;match=separator.exec(substring);)var newEnd=match.index;result=result.slice(0,newEnd===undefined?end:newEnd)}}else if(string.indexOf(baseToString(separator),end)!=end){var index=result.lastIndexOf(separator);index>-1&&(result=result.slice(0,index))}return result+omission}function unescape(string){return string=toString(string),string&&reHasEscapedHtml.test(string)?string.replace(reEscapedHtml,unescapeHtmlChar):string}function words(string,pattern,guard){return string=toString(string),pattern=guard?undefined:pattern,pattern===undefined?hasUnicodeWord(string)?unicodeWords(string):asciiWords(string):string.match(pattern)||[]}function cond(pairs){var length=null==pairs?0:pairs.length,toIteratee=getIteratee();return pairs=length?arrayMap(pairs,function(pair){if("function"!=typeof pair[1])throw new TypeError(FUNC_ERROR_TEXT);return[toIteratee(pair[0]),pair[1]]}):[],baseRest(function(args){for(var index=-1;++index<length;){var pair=pairs[index];if(apply(pair[0],this,args))return apply(pair[1],this,args)}})}function conforms(source){return baseConforms(baseClone(source,CLONE_DEEP_FLAG))}function constant(value){return function(){return value}}function defaultTo(value,defaultValue){return null==value||value!==value?defaultValue:value}function identity(value){return value}function iteratee(func){return baseIteratee("function"==typeof func?func:baseClone(func,CLONE_DEEP_FLAG))}function matches(source){return baseMatches(baseClone(source,CLONE_DEEP_FLAG))}function matchesProperty(path,srcValue){return baseMatchesProperty(path,baseClone(srcValue,CLONE_DEEP_FLAG))}function mixin(object,source,options){var props=keys(source),methodNames=baseFunctions(source,props);null!=options||isObject(source)&&(methodNames.length||!props.length)||(options=source,source=object,object=this,methodNames=baseFunctions(source,keys(source)));var chain=!(isObject(options)&&"chain"in options&&!options.chain),isFunc=isFunction(object);return arrayEach(methodNames,function(methodName){var func=source[methodName];object[methodName]=func,isFunc&&(object.prototype[methodName]=function(){var chainAll=this.__chain__;if(chain||chainAll){var result=object(this.__wrapped__);return(result.__actions__=copyArray(this.__actions__)).push({func:func,args:arguments,thisArg:object}),result.__chain__=chainAll,result}return func.apply(object,arrayPush([this.value()],arguments))})}),object}function noConflict(){return root._===this&&(root._=oldDash),this}function noop(){}function nthArg(n){return n=toInteger(n),baseRest(function(args){return baseNth(args,n)})}function property(path){return isKey(path)?baseProperty(toKey(path)):basePropertyDeep(path)}function propertyOf(object){return function(path){return null==object?undefined:baseGet(object,path)}}function stubArray(){return[]}function stubFalse(){return!1}function stubObject(){return{}}function stubString(){return""}function stubTrue(){return!0}function times(n,iteratee){if((n=toInteger(n))<1||n>MAX_SAFE_INTEGER)return[];var index=MAX_ARRAY_LENGTH,length=nativeMin(n,MAX_ARRAY_LENGTH);iteratee=getIteratee(iteratee),n-=MAX_ARRAY_LENGTH;for(var result=baseTimes(length,iteratee);++index<n;)iteratee(index);return result}function toPath(value){return isArray(value)?arrayMap(value,toKey):isSymbol(value)?[value]:copyArray(stringToPath(toString(value)))}function uniqueId(prefix){var id=++idCounter;return toString(prefix)+id}function max(array){return array&&array.length?baseExtremum(array,identity,baseGt):undefined}function maxBy(array,iteratee){return array&&array.length?baseExtremum(array,getIteratee(iteratee,2),baseGt):undefined}function mean(array){return baseMean(array,identity)}function meanBy(array,iteratee){return baseMean(array,getIteratee(iteratee,2))}function min(array){return array&&array.length?baseExtremum(array,identity,baseLt):undefined}function minBy(array,iteratee){return array&&array.length?baseExtremum(array,getIteratee(iteratee,2),baseLt):undefined}function sum(array){return array&&array.length?baseSum(array,identity):0}function sumBy(array,iteratee){return array&&array.length?baseSum(array,getIteratee(iteratee,2)):0}
context=null==context?root:_.defaults(root.Object(),context,_.pick(root,contextProps));var Array=context.Array,Date=context.Date,Error=context.Error,Function=context.Function,Math=context.Math,Object=context.Object,RegExp=context.RegExp,String=context.String,TypeError=context.TypeError,arrayProto=Array.prototype,funcProto=Function.prototype,objectProto=Object.prototype,coreJsData=context["__core-js_shared__"],funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,idCounter=0,maskSrcKey=function(){var uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||"");return uid?"Symbol(src)_1."+uid:""}(),nativeObjectToString=objectProto.toString,objectCtorString=funcToString.call(Object),oldDash=root._,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Buffer=moduleExports?context.Buffer:undefined,Symbol=context.Symbol,Uint8Array=context.Uint8Array,allocUnsafe=Buffer?Buffer.allocUnsafe:undefined,getPrototype=overArg(Object.getPrototypeOf,Object),objectCreate=Object.create,propertyIsEnumerable=objectProto.propertyIsEnumerable,splice=arrayProto.splice,spreadableSymbol=Symbol?Symbol.isConcatSpreadable:undefined,symIterator=Symbol?Symbol.iterator:undefined,symToStringTag=Symbol?Symbol.toStringTag:undefined,defineProperty=function(){try{var func=getNative(Object,"defineProperty");return func({},"",{}),func}catch(e){}}(),ctxClearTimeout=context.clearTimeout!==root.clearTimeout&&context.clearTimeout,ctxNow=Date&&Date.now!==root.Date.now&&Date.now,ctxSetTimeout=context.setTimeout!==root.setTimeout&&context.setTimeout,nativeCeil=Math.ceil,nativeFloor=Math.floor,nativeGetSymbols=Object.getOwnPropertySymbols,nativeIsBuffer=Buffer?Buffer.isBuffer:undefined,nativeIsFinite=context.isFinite,nativeJoin=arrayProto.join,nativeKeys=overArg(Object.keys,Object),nativeMax=Math.max,nativeMin=Math.min,nativeNow=Date.now,nativeParseInt=context.parseInt,nativeRandom=Math.random,nativeReverse=arrayProto.reverse,DataView=getNative(context,"DataView"),Map=getNative(context,"Map"),Promise=getNative(context,"Promise"),Set=getNative(context,"Set"),WeakMap=getNative(context,"WeakMap"),nativeCreate=getNative(Object,"create"),metaMap=WeakMap&&new WeakMap,realNames={},dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise),setCtorString=toSource(Set),weakMapCtorString=toSource(WeakMap),symbolProto=Symbol?Symbol.prototype:undefined,symbolValueOf=symbolProto?symbolProto.valueOf:undefined,symbolToString=symbolProto?symbolProto.toString:undefined,baseCreate=function(){function object(){}return function(proto){if(!isObject(proto))return{};if(objectCreate)return objectCreate(proto);object.prototype=proto;var result=new object;return object.prototype=undefined,result}}();lodash.templateSettings={escape:reEscape,evaluate:reEvaluate,interpolate:reInterpolate,variable:"",imports:{_:lodash}},lodash.prototype=baseLodash.prototype,lodash.prototype.constructor=lodash,LodashWrapper.prototype=baseCreate(baseLodash.prototype),LodashWrapper.prototype.constructor=LodashWrapper,LazyWrapper.prototype=baseCreate(baseLodash.prototype),LazyWrapper.prototype.constructor=LazyWrapper,Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet,ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet,MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet,SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas,Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;var baseEach=createBaseEach(baseForOwn),baseEachRight=createBaseEach(baseForOwnRight,!0),baseFor=createBaseFor(),baseForRight=createBaseFor(!0),baseSetData=metaMap?function(func,data){return metaMap.set(func,data),func}:identity,baseSetToString=defineProperty?function(func,string){return defineProperty(func,"toString",{configurable:!0,enumerable:!1,value:constant(string),writable:!0})}:identity,castRest=baseRest,clearTimeout=ctxClearTimeout||function(id){return root.clearTimeout(id)},createSet=Set&&1/setToArray(new Set([,-0]))[1]==INFINITY?function(values){return new Set(values)}:noop,getData=metaMap?function(func){return metaMap.get(func)}:noop,getSymbols=nativeGetSymbols?function(object){return null==object?[]:(object=Object(object),arrayFilter(nativeGetSymbols(object),function(symbol){return propertyIsEnumerable.call(object,symbol)}))}:stubArray,getSymbolsIn=nativeGetSymbols?function(object){for(var result=[];object;)arrayPush(result,getSymbols(object)),object=getPrototype(object);return result}:stubArray,getTag=baseGetTag;(DataView&&getTag(new DataView(new ArrayBuffer(1)))!=dataViewTag||Map&&getTag(new Map)!=mapTag||Promise&&"[object Promise]"!=getTag(Promise.resolve())||Set&&getTag(new Set)!=setTag||WeakMap&&getTag(new WeakMap)!=weakMapTag)&&(getTag=function(value){var result=baseGetTag(value),Ctor=result==objectTag?value.constructor:undefined,ctorString=Ctor?toSource(Ctor):"";if(ctorString)switch(ctorString){case dataViewCtorString:return dataViewTag;case mapCtorString:return mapTag;case promiseCtorString:return"[object Promise]";case setCtorString:return setTag;case weakMapCtorString:return weakMapTag}return result});var isMaskable=coreJsData?isFunction:stubFalse,setData=shortOut(baseSetData),setTimeout=ctxSetTimeout||function(func,wait){return root.setTimeout(func,wait)},setToString=shortOut(baseSetToString),stringToPath=function(func){var result=memoize(func,function(key){return cache.size===MAX_MEMOIZE_SIZE&&cache.clear(),key}),cache=result.cache;return result}(function(string){var result=[];return 46===string.charCodeAt(0)&&result.push(""),string.replace(rePropName,function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,"$1"):number||match)}),result}),difference=baseRest(function(array,values){return isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,1,isArrayLikeObject,!0)):[]}),differenceBy=baseRest(function(array,values){var iteratee=last(values);return isArrayLikeObject(iteratee)&&(iteratee=undefined),isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,1,isArrayLikeObject,!0),getIteratee(iteratee,2)):[]}),differenceWith=baseRest(function(array,values){var comparator=last(values);return isArrayLikeObject(comparator)&&(comparator=undefined),isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,1,isArrayLikeObject,!0),undefined,comparator):[]}),intersection=baseRest(function(arrays){var mapped=arrayMap(arrays,castArrayLikeObject);return mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped):[]}),intersectionBy=baseRest(function(arrays){var iteratee=last(arrays),mapped=arrayMap(arrays,castArrayLikeObject);return iteratee===last(mapped)?iteratee=undefined:mapped.pop(),mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped,getIteratee(iteratee,2)):[]}),intersectionWith=baseRest(function(arrays){var comparator=last(arrays),mapped=arrayMap(arrays,castArrayLikeObject);return comparator="function"==typeof comparator?comparator:undefined,comparator&&mapped.pop(),mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped,undefined,comparator):[]}),pull=baseRest(pullAll),pullAt=flatRest(function(array,indexes){var length=null==array?0:array.length,result=baseAt(array,indexes);return basePullAt(array,arrayMap(indexes,function(index){return isIndex(index,length)?+index:index}).sort(compareAscending)),result}),union=baseRest(function(arrays){return baseUniq(baseFlatten(arrays,1,isArrayLikeObject,!0))}),unionBy=baseRest(function(arrays){var iteratee=last(arrays);return isArrayLikeObject(iteratee)&&(iteratee=undefined),baseUniq(baseFlatten(arrays,1,isArrayLikeObject,!0),getIteratee(iteratee,2))}),unionWith=baseRest(function(arrays){var comparator=last(arrays);return comparator="function"==typeof comparator?comparator:undefined,baseUniq(baseFlatten(arrays,1,isArrayLikeObject,!0),undefined,comparator)}),without=baseRest(function(array,values){return isArrayLikeObject(array)?baseDifference(array,values):[]}),xor=baseRest(function(arrays){return baseXor(arrayFilter(arrays,isArrayLikeObject))}),xorBy=baseRest(function(arrays){var iteratee=last(arrays);return isArrayLikeObject(iteratee)&&(iteratee=undefined),baseXor(arrayFilter(arrays,isArrayLikeObject),getIteratee(iteratee,2))}),xorWith=baseRest(function(arrays){var comparator=last(arrays);return comparator="function"==typeof comparator?comparator:undefined,baseXor(arrayFilter(arrays,isArrayLikeObject),undefined,comparator)}),zip=baseRest(unzip),zipWith=baseRest(function(arrays){var length=arrays.length,iteratee=length>1?arrays[length-1]:undefined;return iteratee="function"==typeof iteratee?(arrays.pop(),iteratee):undefined,unzipWith(arrays,iteratee)}),wrapperAt=flatRest(function(paths){var length=paths.length,start=length?paths[0]:0,value=this.__wrapped__,interceptor=function(object){return baseAt(object,paths)};return!(length>1||this.__actions__.length)&&value instanceof LazyWrapper&&isIndex(start)?(value=value.slice(start,+start+(length?1:0)),value.__actions__.push({func:thru,args:[interceptor],thisArg:undefined}),new LodashWrapper(value,this.__chain__).thru(function(array){return length&&!array.length&&array.push(undefined),array})):this.thru(interceptor)}),countBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?++result[key]:baseAssignValue(result,key,1)}),find=createFind(findIndex),findLast=createFind(findLastIndex),groupBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?result[key].push(value):baseAssignValue(result,key,[value])}),invokeMap=baseRest(function(collection,path,args){var index=-1,isFunc="function"==typeof path,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value){result[++index]=isFunc?apply(path,value,args):baseInvoke(value,path,args)}),result}),keyBy=createAggregator(function(result,value,key){baseAssignValue(result,key,value)}),partition=createAggregator(function(result,value,key){result[key?0:1].push(value)},function(){return[[],[]]}),sortBy=baseRest(function(collection,iteratees){if(null==collection)return[];var length=iteratees.length;return length>1&&isIterateeCall(collection,iteratees[0],iteratees[1])?iteratees=[]:length>2&&isIterateeCall(iteratees[0],iteratees[1],iteratees[2])&&(iteratees=[iteratees[0]]),baseOrderBy(collection,baseFlatten(iteratees,1),[])}),now=ctxNow||function(){return root.Date.now()},bind=baseRest(function(func,thisArg,partials){var bitmask=WRAP_BIND_FLAG;if(partials.length){var holders=replaceHolders(partials,getHolder(bind));bitmask|=WRAP_PARTIAL_FLAG}return createWrap(func,bitmask,thisArg,partials,holders)}),bindKey=baseRest(function(object,key,partials){var bitmask=WRAP_BIND_FLAG|WRAP_BIND_KEY_FLAG;if(partials.length){var holders=replaceHolders(partials,getHolder(bindKey));bitmask|=WRAP_PARTIAL_FLAG}return createWrap(key,bitmask,object,partials,holders)}),defer=baseRest(function(func,args){return baseDelay(func,1,args)}),delay=baseRest(function(func,wait,args){return baseDelay(func,toNumber(wait)||0,args)});memoize.Cache=MapCache;var overArgs=castRest(function(func,transforms){transforms=1==transforms.length&&isArray(transforms[0])?arrayMap(transforms[0],baseUnary(getIteratee())):arrayMap(baseFlatten(transforms,1),baseUnary(getIteratee()));var funcsLength=transforms.length;return baseRest(function(args){for(var index=-1,length=nativeMin(args.length,funcsLength);++index<length;)args[index]=transforms[index].call(this,args[index]);return apply(func,this,args)})}),partial=baseRest(function(func,partials){var holders=replaceHolders(partials,getHolder(partial));return createWrap(func,WRAP_PARTIAL_FLAG,undefined,partials,holders)}),partialRight=baseRest(function(func,partials){var holders=replaceHolders(partials,getHolder(partialRight));return createWrap(func,WRAP_PARTIAL_RIGHT_FLAG,undefined,partials,holders)}),rearg=flatRest(function(func,indexes){return createWrap(func,WRAP_REARG_FLAG,undefined,undefined,undefined,indexes)}),gt=createRelationalOperation(baseGt),gte=createRelationalOperation(function(value,other){return value>=other}),isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")},isArray=Array.isArray,isArrayBuffer=nodeIsArrayBuffer?baseUnary(nodeIsArrayBuffer):baseIsArrayBuffer,isBuffer=nativeIsBuffer||stubFalse,isDate=nodeIsDate?baseUnary(nodeIsDate):baseIsDate,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap,isRegExp=nodeIsRegExp?baseUnary(nodeIsRegExp):baseIsRegExp,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,lt=createRelationalOperation(baseLt),lte=createRelationalOperation(function(value,other){return value<=other}),assign=createAssigner(function(object,source){if(isPrototype(source)||isArrayLike(source))return void copyObject(source,keys(source),object);for(var key in source)hasOwnProperty.call(source,key)&&assignValue(object,key,source[key])}),assignIn=createAssigner(function(object,source){copyObject(source,keysIn(source),object)}),assignInWith=createAssigner(function(object,source,srcIndex,customizer){copyObject(source,keysIn(source),object,customizer)}),assignWith=createAssigner(function(object,source,srcIndex,customizer){copyObject(source,keys(source),object,customizer)}),at=flatRest(baseAt),defaults=baseRest(function(object,sources){object=Object(object);var index=-1,length=sources.length,guard=length>2?sources[2]:undefined;for(guard&&isIterateeCall(sources[0],sources[1],guard)&&(length=1);++index<length;)for(var source=sources[index],props=keysIn(source),propsIndex=-1,propsLength=props.length;++propsIndex<propsLength;){var key=props[propsIndex],value=object[key];(value===undefined||eq(value,objectProto[key])&&!hasOwnProperty.call(object,key))&&(object[key]=source[key])}return object}),defaultsDeep=baseRest(function(args){return args.push(undefined,customDefaultsMerge),apply(mergeWith,undefined,args)}),invert=createInverter(function(result,value,key){null!=value&&"function"!=typeof value.toString&&(value=nativeObjectToString.call(value)),result[value]=key},constant(identity)),invertBy=createInverter(function(result,value,key){null!=value&&"function"!=typeof value.toString&&(value=nativeObjectToString.call(value)),hasOwnProperty.call(result,value)?result[value].push(key):result[value]=[key]},getIteratee),invoke=baseRest(baseInvoke),merge=createAssigner(function(object,source,srcIndex){baseMerge(object,source,srcIndex)}),mergeWith=createAssigner(function(object,source,srcIndex,customizer){baseMerge(object,source,srcIndex,customizer)}),omit=flatRest(function(object,paths){var result={};if(null==object)return result;var isDeep=!1;paths=arrayMap(paths,function(path){return path=castPath(path,object),isDeep||(isDeep=path.length>1),path}),copyObject(object,getAllKeysIn(object),result),isDeep&&(result=baseClone(result,CLONE_DEEP_FLAG|CLONE_FLAT_FLAG|CLONE_SYMBOLS_FLAG,customOmitClone));for(var length=paths.length;length--;)baseUnset(result,paths[length]);return result}),pick=flatRest(function(object,paths){return null==object?{}:basePick(object,paths)}),toPairs=createToPairs(keys),toPairsIn=createToPairs(keysIn),camelCase=createCompounder(function(result,word,index){return word=word.toLowerCase(),result+(index?capitalize(word):word)}),kebabCase=createCompounder(function(result,word,index){return result+(index?"-":"")+word.toLowerCase()}),lowerCase=createCompounder(function(result,word,index){return result+(index?" ":"")+word.toLowerCase()}),lowerFirst=createCaseFirst("toLowerCase"),snakeCase=createCompounder(function(result,word,index){return result+(index?"_":"")+word.toLowerCase()}),startCase=createCompounder(function(result,word,index){return result+(index?" ":"")+upperFirst(word)}),upperCase=createCompounder(function(result,word,index){return result+(index?" ":"")+word.toUpperCase()}),upperFirst=createCaseFirst("toUpperCase"),attempt=baseRest(function(func,args){try{return apply(func,undefined,args)}catch(e){return isError(e)?e:new Error(e)}}),bindAll=flatRest(function(object,methodNames){return arrayEach(methodNames,function(key){key=toKey(key),baseAssignValue(object,key,bind(object[key],object))}),object}),flow=createFlow(),flowRight=createFlow(!0),method=baseRest(function(path,args){return function(object){return baseInvoke(object,path,args)}}),methodOf=baseRest(function(object,args){return function(path){return baseInvoke(object,path,args)}}),over=createOver(arrayMap),overEvery=createOver(arrayEvery),overSome=createOver(arraySome),range=createRange(),rangeRight=createRange(!0),add=createMathOperation(function(augend,addend){return augend+addend},0),ceil=createRound("ceil"),divide=createMathOperation(function(dividend,divisor){return dividend/divisor},1),floor=createRound("floor"),multiply=createMathOperation(function(multiplier,multiplicand){return multiplier*multiplicand},1),round=createRound("round"),subtract=createMathOperation(function(minuend,subtrahend){return minuend-subtrahend},0);return lodash.after=after,lodash.ary=ary,lodash.assign=assign,lodash.assignIn=assignIn,lodash.assignInWith=assignInWith,lodash.assignWith=assignWith,lodash.at=at,lodash.before=before,lodash.bind=bind,lodash.bindAll=bindAll,lodash.bindKey=bindKey,lodash.castArray=castArray,lodash.chain=chain,lodash.chunk=chunk,lodash.compact=compact,lodash.concat=concat,lodash.cond=cond,lodash.conforms=conforms,lodash.constant=constant,lodash.countBy=countBy,lodash.create=create,lodash.curry=curry,lodash.curryRight=curryRight,lodash.debounce=debounce,lodash.defaults=defaults,lodash.defaultsDeep=defaultsDeep,lodash.defer=defer,lodash.delay=delay,lodash.difference=difference,lodash.differenceBy=differenceBy,lodash.differenceWith=differenceWith,lodash.drop=drop,lodash.dropRight=dropRight,lodash.dropRightWhile=dropRightWhile,lodash.dropWhile=dropWhile,lodash.fill=fill,lodash.filter=filter,lodash.flatMap=flatMap,lodash.flatMapDeep=flatMapDeep,lodash.flatMapDepth=flatMapDepth,lodash.flatten=flatten,lodash.flattenDeep=flattenDeep,lodash.flattenDepth=flattenDepth,lodash.flip=flip,lodash.flow=flow,lodash.flowRight=flowRight,lodash.fromPairs=fromPairs,lodash.functions=functions,lodash.functionsIn=functionsIn,lodash.groupBy=groupBy,lodash.initial=initial,lodash.intersection=intersection,lodash.intersectionBy=intersectionBy,lodash.intersectionWith=intersectionWith,lodash.invert=invert,lodash.invertBy=invertBy,lodash.invokeMap=invokeMap,lodash.iteratee=iteratee,lodash.keyBy=keyBy,lodash.keys=keys,lodash.keysIn=keysIn,lodash.map=map,lodash.mapKeys=mapKeys,lodash.mapValues=mapValues,lodash.matches=matches,lodash.matchesProperty=matchesProperty,lodash.memoize=memoize,lodash.merge=merge,lodash.mergeWith=mergeWith,lodash.method=method,lodash.methodOf=methodOf,lodash.mixin=mixin,lodash.negate=negate,lodash.nthArg=nthArg,lodash.omit=omit,lodash.omitBy=omitBy,lodash.once=once,lodash.orderBy=orderBy,lodash.over=over,lodash.overArgs=overArgs,lodash.overEvery=overEvery,lodash.overSome=overSome,lodash.partial=partial,lodash.partialRight=partialRight,lodash.partition=partition,lodash.pick=pick,lodash.pickBy=pickBy,lodash.property=property,lodash.propertyOf=propertyOf,lodash.pull=pull,lodash.pullAll=pullAll,lodash.pullAllBy=pullAllBy,lodash.pullAllWith=pullAllWith,lodash.pullAt=pullAt,lodash.range=range,lodash.rangeRight=rangeRight,lodash.rearg=rearg,lodash.reject=reject,lodash.remove=remove,lodash.rest=rest,lodash.reverse=reverse,lodash.sampleSize=sampleSize,lodash.set=set,lodash.setWith=setWith,lodash.shuffle=shuffle,lodash.slice=slice,lodash.sortBy=sortBy,lodash.sortedUniq=sortedUniq,lodash.sortedUniqBy=sortedUniqBy,lodash.split=split,lodash.spread=spread,lodash.tail=tail,lodash.take=take,lodash.takeRight=takeRight,lodash.takeRightWhile=takeRightWhile,lodash.takeWhile=takeWhile,lodash.tap=tap,lodash.throttle=throttle,lodash.thru=thru,lodash.toArray=toArray,lodash.toPairs=toPairs,lodash.toPairsIn=toPairsIn,lodash.toPath=toPath,lodash.toPlainObject=toPlainObject,lodash.transform=transform,lodash.unary=unary,lodash.union=union,lodash.unionBy=unionBy,lodash.unionWith=unionWith,lodash.uniq=uniq,lodash.uniqBy=uniqBy,lodash.uniqWith=uniqWith,lodash.unset=unset,lodash.unzip=unzip,lodash.unzipWith=unzipWith,lodash.update=update,lodash.updateWith=updateWith,lodash.values=values,lodash.valuesIn=valuesIn,lodash.without=without,lodash.words=words,lodash.wrap=wrap,lodash.xor=xor,lodash.xorBy=xorBy,lodash.xorWith=xorWith,lodash.zip=zip,lodash.zipObject=zipObject,lodash.zipObjectDeep=zipObjectDeep,lodash.zipWith=zipWith,lodash.entries=toPairs,lodash.entriesIn=toPairsIn,lodash.extend=assignIn,lodash.extendWith=assignInWith,mixin(lodash,lodash),lodash.add=add,lodash.attempt=attempt,lodash.camelCase=camelCase,lodash.capitalize=capitalize,lodash.ceil=ceil,lodash.clamp=clamp,lodash.clone=clone,lodash.cloneDeep=cloneDeep,lodash.cloneDeepWith=cloneDeepWith,lodash.cloneWith=cloneWith,lodash.conformsTo=conformsTo,lodash.deburr=deburr,lodash.defaultTo=defaultTo,lodash.divide=divide,lodash.endsWith=endsWith,lodash.eq=eq,lodash.escape=escape,lodash.escapeRegExp=escapeRegExp,lodash.every=every,lodash.find=find,lodash.findIndex=findIndex,lodash.findKey=findKey,lodash.findLast=findLast,lodash.findLastIndex=findLastIndex,lodash.findLastKey=findLastKey,lodash.floor=floor,lodash.forEach=forEach,lodash.forEachRight=forEachRight,lodash.forIn=forIn,lodash.forInRight=forInRight,lodash.forOwn=forOwn,lodash.forOwnRight=forOwnRight,lodash.get=get,lodash.gt=gt,lodash.gte=gte,lodash.has=has,lodash.hasIn=hasIn,lodash.head=head,lodash.identity=identity,lodash.includes=includes,lodash.indexOf=indexOf,lodash.inRange=inRange,lodash.invoke=invoke,lodash.isArguments=isArguments,lodash.isArray=isArray,lodash.isArrayBuffer=isArrayBuffer,lodash.isArrayLike=isArrayLike,lodash.isArrayLikeObject=isArrayLikeObject,lodash.isBoolean=isBoolean,lodash.isBuffer=isBuffer,lodash.isDate=isDate,lodash.isElement=isElement,lodash.isEmpty=isEmpty,lodash.isEqual=isEqual,lodash.isEqualWith=isEqualWith,lodash.isError=isError,lodash.isFinite=isFinite,lodash.isFunction=isFunction,lodash.isInteger=isInteger,lodash.isLength=isLength,lodash.isMap=isMap,lodash.isMatch=isMatch,lodash.isMatchWith=isMatchWith,lodash.isNaN=isNaN,lodash.isNative=isNative,lodash.isNil=isNil,lodash.isNull=isNull,lodash.isNumber=isNumber,lodash.isObject=isObject,lodash.isObjectLike=isObjectLike,lodash.isPlainObject=isPlainObject,lodash.isRegExp=isRegExp,lodash.isSafeInteger=isSafeInteger,lodash.isSet=isSet,lodash.isString=isString,lodash.isSymbol=isSymbol,lodash.isTypedArray=isTypedArray,lodash.isUndefined=isUndefined,lodash.isWeakMap=isWeakMap,lodash.isWeakSet=isWeakSet,lodash.join=join,lodash.kebabCase=kebabCase,lodash.last=last,lodash.lastIndexOf=lastIndexOf,lodash.lowerCase=lowerCase,lodash.lowerFirst=lowerFirst,lodash.lt=lt,lodash.lte=lte,lodash.max=max,lodash.maxBy=maxBy,lodash.mean=mean,lodash.meanBy=meanBy,lodash.min=min,lodash.minBy=minBy,lodash.stubArray=stubArray,lodash.stubFalse=stubFalse,lodash.stubObject=stubObject,lodash.stubString=stubString,lodash.stubTrue=stubTrue,lodash.multiply=multiply,lodash.nth=nth,lodash.noConflict=noConflict,lodash.noop=noop,lodash.now=now,lodash.pad=pad,lodash.padEnd=padEnd,lodash.padStart=padStart,lodash.parseInt=parseInt,lodash.random=random,lodash.reduce=reduce,lodash.reduceRight=reduceRight,lodash.repeat=repeat,lodash.replace=replace,lodash.result=result,lodash.round=round,lodash.runInContext=runInContext,lodash.sample=sample,lodash.size=size,lodash.snakeCase=snakeCase,lodash.some=some,lodash.sortedIndex=sortedIndex,lodash.sortedIndexBy=sortedIndexBy,lodash.sortedIndexOf=sortedIndexOf,lodash.sortedLastIndex=sortedLastIndex,lodash.sortedLastIndexBy=sortedLastIndexBy,lodash.sortedLastIndexOf=sortedLastIndexOf,lodash.startCase=startCase,lodash.startsWith=startsWith,lodash.subtract=subtract,lodash.sum=sum,lodash.sumBy=sumBy,lodash.template=template,lodash.times=times,lodash.toFinite=toFinite,lodash.toInteger=toInteger,lodash.toLength=toLength,lodash.toLower=toLower,lodash.toNumber=toNumber,lodash.toSafeInteger=toSafeInteger,lodash.toString=toString,lodash.toUpper=toUpper,lodash.trim=trim,lodash.trimEnd=trimEnd,lodash.trimStart=trimStart,lodash.truncate=truncate,lodash.unescape=unescape,lodash.uniqueId=uniqueId,lodash.upperCase=upperCase,lodash.upperFirst=upperFirst,lodash.each=forEach,lodash.eachRight=forEachRight,lodash.first=head,mixin(lodash,function(){var source={};return baseForOwn(lodash,function(func,methodName){hasOwnProperty.call(lodash.prototype,methodName)||(source[methodName]=func)}),source}(),{chain:!1}),lodash.VERSION="4.17.11",arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],function(methodName){lodash[methodName].placeholder=lodash}),arrayEach(["drop","take"],function(methodName,index){LazyWrapper.prototype[methodName]=function(n){n=n===undefined?1:nativeMax(toInteger(n),0);var result=this.__filtered__&&!index?new LazyWrapper(this):this.clone();return result.__filtered__?result.__takeCount__=nativeMin(n,result.__takeCount__):result.__views__.push({size:nativeMin(n,MAX_ARRAY_LENGTH),type:methodName+(result.__dir__<0?"Right":"")}),result},LazyWrapper.prototype[methodName+"Right"]=function(n){return this.reverse()[methodName](n).reverse()}}),arrayEach(["filter","map","takeWhile"],function(methodName,index){var type=index+1,isFilter=type==LAZY_FILTER_FLAG||3==type;LazyWrapper.prototype[methodName]=function(iteratee){var result=this.clone();return result.__iteratees__.push({iteratee:getIteratee(iteratee,3),type:type}),result.__filtered__=result.__filtered__||isFilter,result}}),arrayEach(["head","last"],function(methodName,index){var takeName="take"+(index?"Right":"");LazyWrapper.prototype[methodName]=function(){return this[takeName](1).value()[0]}}),arrayEach(["initial","tail"],function(methodName,index){var dropName="drop"+(index?"":"Right");LazyWrapper.prototype[methodName]=function(){return this.__filtered__?new LazyWrapper(this):this[dropName](1)}}),LazyWrapper.prototype.compact=function(){return this.filter(identity)},LazyWrapper.prototype.find=function(predicate){return this.filter(predicate).head()},LazyWrapper.prototype.findLast=function(predicate){return this.reverse().find(predicate)},LazyWrapper.prototype.invokeMap=baseRest(function(path,args){return"function"==typeof path?new LazyWrapper(this):this.map(function(value){return baseInvoke(value,path,args)})}),LazyWrapper.prototype.reject=function(predicate){return this.filter(negate(getIteratee(predicate)))},LazyWrapper.prototype.slice=function(start,end){start=toInteger(start);var result=this;return result.__filtered__&&(start>0||end<0)?new LazyWrapper(result):(start<0?result=result.takeRight(-start):start&&(result=result.drop(start)),end!==undefined&&(end=toInteger(end),result=end<0?result.dropRight(-end):result.take(end-start)),result)},LazyWrapper.prototype.takeRightWhile=function(predicate){return this.reverse().takeWhile(predicate).reverse()},LazyWrapper.prototype.toArray=function(){return this.take(MAX_ARRAY_LENGTH)},baseForOwn(LazyWrapper.prototype,function(func,methodName){var checkIteratee=/^(?:filter|find|map|reject)|While$/.test(methodName),isTaker=/^(?:head|last)$/.test(methodName),lodashFunc=lodash[isTaker?"take"+("last"==methodName?"Right":""):methodName],retUnwrapped=isTaker||/^find/.test(methodName);lodashFunc&&(lodash.prototype[methodName]=function(){var value=this.__wrapped__,args=isTaker?[1]:arguments,isLazy=value instanceof LazyWrapper,iteratee=args[0],useLazy=isLazy||isArray(value),interceptor=function(value){var result=lodashFunc.apply(lodash,arrayPush([value],args));return isTaker&&chainAll?result[0]:result};useLazy&&checkIteratee&&"function"==typeof iteratee&&1!=iteratee.length&&(isLazy=useLazy=!1);var chainAll=this.__chain__,isHybrid=!!this.__actions__.length,isUnwrapped=retUnwrapped&&!chainAll,onlyLazy=isLazy&&!isHybrid;if(!retUnwrapped&&useLazy){value=onlyLazy?value:new LazyWrapper(this);var result=func.apply(value,args);return result.__actions__.push({func:thru,args:[interceptor],thisArg:undefined}),new LodashWrapper(result,chainAll)}return isUnwrapped&&onlyLazy?func.apply(this,args):(result=this.thru(interceptor),isUnwrapped?isTaker?result.value()[0]:result.value():result)})}),arrayEach(["pop","push","shift","sort","splice","unshift"],function(methodName){var func=arrayProto[methodName],chainName=/^(?:push|sort|unshift)$/.test(methodName)?"tap":"thru",retUnwrapped=/^(?:pop|shift)$/.test(methodName);lodash.prototype[methodName]=function(){var args=arguments;if(retUnwrapped&&!this.__chain__){var value=this.value();return func.apply(isArray(value)?value:[],args)}return this[chainName](function(value){return func.apply(isArray(value)?value:[],args)})}}),baseForOwn(LazyWrapper.prototype,function(func,methodName){var lodashFunc=lodash[methodName];if(lodashFunc){var key=lodashFunc.name+"";(realNames[key]||(realNames[key]=[])).push({name:methodName,func:lodashFunc})}}),realNames[createHybrid(undefined,WRAP_BIND_KEY_FLAG).name]=[{name:"wrapper",func:undefined}],LazyWrapper.prototype.clone=lazyClone,LazyWrapper.prototype.reverse=lazyReverse,LazyWrapper.prototype.value=lazyValue,lodash.prototype.at=wrapperAt,lodash.prototype.chain=wrapperChain,lodash.prototype.commit=wrapperCommit,lodash.prototype.next=wrapperNext,lodash.prototype.plant=wrapperPlant,lodash.prototype.reverse=wrapperReverse,lodash.prototype.toJSON=lodash.prototype.valueOf=lodash.prototype.value=wrapperValue,lodash.prototype.first=lodash.prototype.head,symIterator&&(lodash.prototype[symIterator]=wrapperToIterator),lodash}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(root._=_,define(function(){return _})):freeModule?((freeModule.exports=_)._=_,freeExports._=_):root._=_}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],123:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _addMiniSignalBinding(self,node){return self._head?(self._tail._next=node,node._prev=self._tail,self._tail=node):(self._head=node,self._tail=node),node._owner=self,node}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),MiniSignalBinding=function(){function MiniSignalBinding(fn,once,thisArg){void 0===once&&(once=!1),_classCallCheck(this,MiniSignalBinding),this._fn=fn,this._once=once,this._thisArg=thisArg,this._next=this._prev=this._owner=null}return _createClass(MiniSignalBinding,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),MiniSignalBinding}(),MiniSignal=function(){function MiniSignal(){_classCallCheck(this,MiniSignal),this._head=this._tail=void 0}return _createClass(MiniSignal,[{key:"handlers",value:function(){
var exists=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],node=this._head;if(exists)return!!node;for(var ee=[];node;)ee.push(node),node=node._next;return ee}},{key:"has",value:function(node){if(!(node instanceof MiniSignalBinding))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return node._owner===this}},{key:"dispatch",value:function(){var node=this._head;if(!node)return!1;for(;node;)node._once&&this.detach(node),node._fn.apply(node._thisArg,arguments),node=node._next;return!0}},{key:"add",value:function(fn){var thisArg=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof fn)throw new Error("MiniSignal#add(): First arg must be a Function.");return _addMiniSignalBinding(this,new MiniSignalBinding(fn,!1,thisArg))}},{key:"once",value:function(fn){var thisArg=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof fn)throw new Error("MiniSignal#once(): First arg must be a Function.");return _addMiniSignalBinding(this,new MiniSignalBinding(fn,!0,thisArg))}},{key:"detach",value:function(node){if(!(node instanceof MiniSignalBinding))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return node._owner!==this?this:(node._prev&&(node._prev._next=node._next),node._next&&(node._next._prev=node._prev),node===this._head?(this._head=node._next,null===node._next&&(this._tail=null)):node===this._tail&&(this._tail=node._prev,this._tail._next=null),node._owner=null,this)}},{key:"detachAll",value:function(){var node=this._head;if(!node)return this;for(this._head=this._tail=null;node;)node._owner=null,node=node._next;return this}}]),MiniSignal}();MiniSignal.MiniSignalBinding=MiniSignalBinding,exports.default=MiniSignal,module.exports=exports.default},{}],124:[function(require,module,exports){"use strict";function toObject(val){if(null===val||void 0===val)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(val)}var getOwnPropertySymbols=Object.getOwnPropertySymbols,hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;module.exports=function(){try{if(!Object.assign)return!1;var test1=new String("abc");if(test1[5]="de","5"===Object.getOwnPropertyNames(test1)[0])return!1;for(var test2={},i=0;i<10;i++)test2["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(test2).map(function(n){return test2[n]}).join(""))return!1;var test3={};return"abcdefghijklmnopqrst".split("").forEach(function(letter){test3[letter]=letter}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},test3)).join("")}catch(err){return!1}}()?Object.assign:function(target,source){for(var from,symbols,to=toObject(target),s=1;s<arguments.length;s++){from=Object(arguments[s]);for(var key in from)hasOwnProperty.call(from,key)&&(to[key]=from[key]);if(getOwnPropertySymbols){symbols=getOwnPropertySymbols(from);for(var i=0;i<symbols.length;i++)propIsEnumerable.call(from,symbols[i])&&(to[symbols[i]]=from[symbols[i]])}}return to}},{}],125:[function(require,module,exports){"use strict";module.exports=function(str,opts){opts=opts||{};for(var o={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},m=o.parser[opts.strictMode?"strict":"loose"].exec(str),uri={},i=14;i--;)uri[o.key[i]]=m[i]||"";return uri[o.q.name]={},uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){$1&&(uri[o.q.name][$1]=$2)}),uri}},{}],126:[function(require,module,exports){(function(process){function normalizeArray(parts,allowAboveRoot){for(var up=0,i=parts.length-1;i>=0;i--){var last=parts[i];"."===last?parts.splice(i,1):".."===last?(parts.splice(i,1),up++):up&&(parts.splice(i,1),up--)}if(allowAboveRoot)for(;up--;up)parts.unshift("..");return parts}function basename(path){"string"!=typeof path&&(path+="");var i,start=0,end=-1,matchedSlash=!0;for(i=path.length-1;i>=0;--i)if(47===path.charCodeAt(i)){if(!matchedSlash){start=i+1;break}}else-1===end&&(matchedSlash=!1,end=i+1);return-1===end?"":path.slice(start,end)}function filter(xs,f){if(xs.filter)return xs.filter(f);for(var res=[],i=0;i<xs.length;i++)f(xs[i],i,xs)&&res.push(xs[i]);return res}exports.resolve=function(){for(var resolvedPath="",resolvedAbsolute=!1,i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if("string"!=typeof path)throw new TypeError("Arguments to path.resolve must be strings");path&&(resolvedPath=path+"/"+resolvedPath,resolvedAbsolute="/"===path.charAt(0))}return resolvedPath=normalizeArray(filter(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/"),(resolvedAbsolute?"/":"")+resolvedPath||"."},exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash="/"===substr(path,-1);return path=normalizeArray(filter(path.split("/"),function(p){return!!p}),!isAbsolute).join("/"),path||isAbsolute||(path="."),path&&trailingSlash&&(path+="/"),(isAbsolute?"/":"")+path},exports.isAbsolute=function(path){return"/"===path.charAt(0)},exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,function(p,index){if("string"!=typeof p)throw new TypeError("Arguments to path.join must be strings");return p}).join("/"))},exports.relative=function(from,to){function trim(arr){for(var start=0;start<arr.length&&""===arr[start];start++);for(var end=arr.length-1;end>=0&&""===arr[end];end--);return start>end?[]:arr.slice(start,end-start+1)}from=exports.resolve(from).substr(1),to=exports.resolve(to).substr(1);for(var fromParts=trim(from.split("/")),toParts=trim(to.split("/")),length=Math.min(fromParts.length,toParts.length),samePartsLength=length,i=0;i<length;i++)if(fromParts[i]!==toParts[i]){samePartsLength=i;break}for(var outputParts=[],i=samePartsLength;i<fromParts.length;i++)outputParts.push("..");return outputParts=outputParts.concat(toParts.slice(samePartsLength)),outputParts.join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(path){if("string"!=typeof path&&(path+=""),0===path.length)return".";for(var code=path.charCodeAt(0),hasRoot=47===code,end=-1,matchedSlash=!0,i=path.length-1;i>=1;--i)if(47===(code=path.charCodeAt(i))){if(!matchedSlash){end=i;break}}else matchedSlash=!1;return-1===end?hasRoot?"/":".":hasRoot&&1===end?"/":path.slice(0,end)},exports.basename=function(path,ext){var f=basename(path);return ext&&f.substr(-1*ext.length)===ext&&(f=f.substr(0,f.length-ext.length)),f},exports.extname=function(path){"string"!=typeof path&&(path+="");for(var startDot=-1,startPart=0,end=-1,matchedSlash=!0,preDotState=0,i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(47!==code)-1===end&&(matchedSlash=!1,end=i+1),46===code?-1===startDot?startDot=i:1!==preDotState&&(preDotState=1):-1!==startDot&&(preDotState=-1);else if(!matchedSlash){startPart=i+1;break}}return-1===startDot||-1===end||0===preDotState||1===preDotState&&startDot===end-1&&startDot===startPart+1?"":path.slice(startDot,end)};var substr="b"==="ab".substr(-1)?function(str,start,len){return str.substr(start,len)}:function(str,start,len){return start<0&&(start=str.length+start),str.substr(start,len)}}).call(this,require("_process"))},{_process:294}],127:[function(require,module,exports){var EMPTY_ARRAY_BUFFER=new ArrayBuffer(0),Buffer=function(gl,type,data,drawType){this.gl=gl,this.buffer=gl.createBuffer(),this.type=type||gl.ARRAY_BUFFER,this.drawType=drawType||gl.STATIC_DRAW,this.data=EMPTY_ARRAY_BUFFER,data&&this.upload(data),this._updateID=0};Buffer.prototype.upload=function(data,offset,dontBind){dontBind||this.bind();var gl=this.gl;data=data||this.data,offset=offset||0,this.data.byteLength>=data.byteLength?gl.bufferSubData(this.type,offset,data):gl.bufferData(this.type,data,this.drawType),this.data=data},Buffer.prototype.bind=function(){this.gl.bindBuffer(this.type,this.buffer)},Buffer.createVertexBuffer=function(gl,data,drawType){return new Buffer(gl,gl.ARRAY_BUFFER,data,drawType)},Buffer.createIndexBuffer=function(gl,data,drawType){return new Buffer(gl,gl.ELEMENT_ARRAY_BUFFER,data,drawType)},Buffer.create=function(gl,type,data,drawType){return new Buffer(gl,type,data,drawType)},Buffer.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)},module.exports=Buffer},{}],128:[function(require,module,exports){var Texture=require("./GLTexture"),Framebuffer=function(gl,width,height){this.gl=gl,this.framebuffer=gl.createFramebuffer(),this.stencil=null,this.texture=null,this.width=width||100,this.height=height||100};Framebuffer.prototype.enableTexture=function(texture){var gl=this.gl;this.texture=texture||new Texture(gl),this.texture.bind(),this.bind(),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,this.texture.texture,0)},Framebuffer.prototype.enableStencil=function(){if(!this.stencil){var gl=this.gl;this.stencil=gl.createRenderbuffer(),gl.bindRenderbuffer(gl.RENDERBUFFER,this.stencil),gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_STENCIL_ATTACHMENT,gl.RENDERBUFFER,this.stencil),gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,this.width,this.height)}},Framebuffer.prototype.clear=function(r,g,b,a){this.bind();var gl=this.gl;gl.clearColor(r,g,b,a),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT)},Framebuffer.prototype.bind=function(){var gl=this.gl;gl.bindFramebuffer(gl.FRAMEBUFFER,this.framebuffer)},Framebuffer.prototype.unbind=function(){var gl=this.gl;gl.bindFramebuffer(gl.FRAMEBUFFER,null)},Framebuffer.prototype.resize=function(width,height){var gl=this.gl;this.width=width,this.height=height,this.texture&&this.texture.uploadData(null,width,height),this.stencil&&(gl.bindRenderbuffer(gl.RENDERBUFFER,this.stencil),gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,width,height))},Framebuffer.prototype.destroy=function(){var gl=this.gl;this.texture&&this.texture.destroy(),gl.deleteFramebuffer(this.framebuffer),this.gl=null,this.stencil=null,this.texture=null},Framebuffer.createRGBA=function(gl,width,height,data){var texture=Texture.fromData(gl,null,width,height);texture.enableNearestScaling(),texture.enableWrapClamp();var fbo=new Framebuffer(gl,width,height);return fbo.enableTexture(texture),fbo.unbind(),fbo},Framebuffer.createFloat32=function(gl,width,height,data){var texture=new Texture.fromData(gl,data,width,height);texture.enableNearestScaling(),texture.enableWrapClamp();var fbo=new Framebuffer(gl,width,height);return fbo.enableTexture(texture),fbo.unbind(),fbo},module.exports=Framebuffer},{"./GLTexture":130}],129:[function(require,module,exports){var compileProgram=require("./shader/compileProgram"),extractAttributes=require("./shader/extractAttributes"),extractUniforms=require("./shader/extractUniforms"),setPrecision=require("./shader/setPrecision"),generateUniformAccessObject=require("./shader/generateUniformAccessObject"),Shader=function(gl,vertexSrc,fragmentSrc,precision,attributeLocations){this.gl=gl,precision&&(vertexSrc=setPrecision(vertexSrc,precision),fragmentSrc=setPrecision(fragmentSrc,precision)),this.program=compileProgram(gl,vertexSrc,fragmentSrc,attributeLocations),this.attributes=extractAttributes(gl,this.program),this.uniformData=extractUniforms(gl,this.program),this.uniforms=generateUniformAccessObject(gl,this.uniformData)};Shader.prototype.bind=function(){return this.gl.useProgram(this.program),this},Shader.prototype.destroy=function(){this.attributes=null,this.uniformData=null,this.uniforms=null,this.gl.deleteProgram(this.program)},module.exports=Shader},{"./shader/compileProgram":135,"./shader/extractAttributes":137,"./shader/extractUniforms":138,"./shader/generateUniformAccessObject":139,"./shader/setPrecision":143}],130:[function(require,module,exports){var Texture=function(gl,width,height,format,type){this.gl=gl,this.texture=gl.createTexture(),this.mipmap=!1,this.premultiplyAlpha=!1,this.width=width||-1,this.height=height||-1,this.format=format||gl.RGBA,this.type=type||gl.UNSIGNED_BYTE};Texture.prototype.upload=function(source){this.bind();var gl=this.gl;gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);var newWidth=source.videoWidth||source.width,newHeight=source.videoHeight||source.height;newHeight!==this.height||newWidth!==this.width?gl.texImage2D(gl.TEXTURE_2D,0,this.format,this.format,this.type,source):gl.texSubImage2D(gl.TEXTURE_2D,0,0,0,this.format,this.type,source),this.width=newWidth,this.height=newHeight};var FLOATING_POINT_AVAILABLE=!1;Texture.prototype.uploadData=function(data,width,height){this.bind();var gl=this.gl;if(data instanceof Float32Array){if(!FLOATING_POINT_AVAILABLE){if(!gl.getExtension("OES_texture_float"))throw new Error("floating point textures not available");FLOATING_POINT_AVAILABLE=!0}this.type=gl.FLOAT}else this.type=this.type||gl.UNSIGNED_BYTE;gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),width!==this.width||height!==this.height?gl.texImage2D(gl.TEXTURE_2D,0,this.format,width,height,0,this.format,this.type,data||null):gl.texSubImage2D(gl.TEXTURE_2D,0,0,0,width,height,this.format,this.type,data||null),this.width=width,this.height=height},Texture.prototype.bind=function(location){var gl=this.gl;void 0!==location&&gl.activeTexture(gl.TEXTURE0+location),gl.bindTexture(gl.TEXTURE_2D,this.texture)},Texture.prototype.unbind=function(){var gl=this.gl;gl.bindTexture(gl.TEXTURE_2D,null)},Texture.prototype.minFilter=function(linear){var gl=this.gl;this.bind(),this.mipmap?gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,linear?gl.LINEAR_MIPMAP_LINEAR:gl.NEAREST_MIPMAP_NEAREST):gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,linear?gl.LINEAR:gl.NEAREST)},Texture.prototype.magFilter=function(linear){var gl=this.gl;this.bind(),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,linear?gl.LINEAR:gl.NEAREST)},Texture.prototype.enableMipmap=function(){var gl=this.gl;this.bind(),this.mipmap=!0,gl.generateMipmap(gl.TEXTURE_2D)},Texture.prototype.enableLinearScaling=function(){this.minFilter(!0),this.magFilter(!0)},Texture.prototype.enableNearestScaling=function(){this.minFilter(!1),this.magFilter(!1)},Texture.prototype.enableWrapClamp=function(){var gl=this.gl;this.bind(),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE)},Texture.prototype.enableWrapRepeat=function(){var gl=this.gl;this.bind(),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.REPEAT),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.REPEAT)},Texture.prototype.enableWrapMirrorRepeat=function(){var gl=this.gl;this.bind(),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.MIRRORED_REPEAT),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.MIRRORED_REPEAT)},Texture.prototype.destroy=function(){this.gl.deleteTexture(this.texture)},Texture.fromSource=function(gl,source,premultiplyAlpha){var texture=new Texture(gl);return texture.premultiplyAlpha=premultiplyAlpha||!1,texture.upload(source),texture},Texture.fromData=function(gl,data,width,height){var texture=new Texture(gl);return texture.uploadData(data,width,height),texture},module.exports=Texture},{}],131:[function(require,module,exports){function VertexArrayObject(gl,state){if(this.nativeVaoExtension=null,VertexArrayObject.FORCE_NATIVE||(this.nativeVaoExtension=gl.getExtension("OES_vertex_array_object")||gl.getExtension("MOZ_OES_vertex_array_object")||gl.getExtension("WEBKIT_OES_vertex_array_object")),this.nativeState=state,this.nativeVaoExtension){this.nativeVao=this.nativeVaoExtension.createVertexArrayOES();var maxAttribs=gl.getParameter(gl.MAX_VERTEX_ATTRIBS);this.nativeState={tempAttribState:new Array(maxAttribs),attribState:new Array(maxAttribs)}}this.gl=gl,this.attributes=[],this.indexBuffer=null,this.dirty=!1}var setVertexAttribArrays=require("./setVertexAttribArrays");VertexArrayObject.prototype.constructor=VertexArrayObject,module.exports=VertexArrayObject,VertexArrayObject.FORCE_NATIVE=!1,VertexArrayObject.prototype.bind=function(){if(this.nativeVao){if(this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.dirty)return this.dirty=!1,this.activate(),this;this.indexBuffer&&this.indexBuffer.bind()}else this.activate();return this},VertexArrayObject.prototype.unbind=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(null),this},VertexArrayObject.prototype.activate=function(){for(var gl=this.gl,lastBuffer=null,i=0;i<this.attributes.length;i++){var attrib=this.attributes[i];lastBuffer!==attrib.buffer&&(attrib.buffer.bind(),lastBuffer=attrib.buffer),gl.vertexAttribPointer(attrib.attribute.location,attrib.attribute.size,attrib.type||gl.FLOAT,attrib.normalized||!1,attrib.stride||0,attrib.start||0)}return setVertexAttribArrays(gl,this.attributes,this.nativeState),this.indexBuffer&&this.indexBuffer.bind(),this},VertexArrayObject.prototype.addAttribute=function(buffer,attribute,type,normalized,stride,start){return this.attributes.push({buffer:buffer,attribute:attribute,location:attribute.location,type:type||this.gl.FLOAT,normalized:normalized||!1,stride:stride||0,start:start||0}),this.dirty=!0,this},VertexArrayObject.prototype.addIndex=function(buffer){return this.indexBuffer=buffer,this.dirty=!0,this},VertexArrayObject.prototype.clear=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.attributes.length=0,this.indexBuffer=null,this},VertexArrayObject.prototype.draw=function(type,size,start){var gl=this.gl;return this.indexBuffer?gl.drawElements(type,size||this.indexBuffer.data.length,gl.UNSIGNED_SHORT,2*(start||0)):gl.drawArrays(type,start,size||this.getSize()),this},VertexArrayObject.prototype.destroy=function(){this.gl=null,this.indexBuffer=null,this.attributes=null,this.nativeState=null,this.nativeVao&&this.nativeVaoExtension.deleteVertexArrayOES(this.nativeVao),this.nativeVaoExtension=null,this.nativeVao=null},VertexArrayObject.prototype.getSize=function(){var attrib=this.attributes[0];return attrib.buffer.data.length/(attrib.stride/4||attrib.attribute.size)}},{"./setVertexAttribArrays":134}],132:[function(require,module,exports){var createContext=function(canvas,options){var gl=canvas.getContext("webgl",options)||canvas.getContext("experimental-webgl",options);if(!gl)throw new Error("This browser does not support webGL. Try using the canvas renderer");return gl};module.exports=createContext},{}],133:[function(require,module,exports){var gl={createContext:require("./createContext"),setVertexAttribArrays:require("./setVertexAttribArrays"),GLBuffer:require("./GLBuffer"),GLFramebuffer:require("./GLFramebuffer"),GLShader:require("./GLShader"),GLTexture:require("./GLTexture"),VertexArrayObject:require("./VertexArrayObject"),shader:require("./shader")};void 0!==module&&module.exports&&(module.exports=gl),"undefined"!=typeof window&&(window.PIXI=window.PIXI||{},window.PIXI.glCore=gl)},{"./GLBuffer":127,"./GLFramebuffer":128,"./GLShader":129,"./GLTexture":130,"./VertexArrayObject":131,"./createContext":132,"./setVertexAttribArrays":134,"./shader":140}],134:[function(require,module,exports){var setVertexAttribArrays=function(gl,attribs,state){var i;if(state){var tempAttribState=state.tempAttribState,attribState=state.attribState;for(i=0;i<tempAttribState.length;i++)tempAttribState[i]=!1;for(i=0;i<attribs.length;i++)tempAttribState[attribs[i].attribute.location]=!0;for(i=0;i<attribState.length;i++)attribState[i]!==tempAttribState[i]&&(attribState[i]=tempAttribState[i],state.attribState[i]?gl.enableVertexAttribArray(i):gl.disableVertexAttribArray(i))}else for(i=0;i<attribs.length;i++){var attrib=attribs[i];gl.enableVertexAttribArray(attrib.attribute.location)}};module.exports=setVertexAttribArrays},{}],135:[function(require,module,exports){var compileProgram=function(gl,vertexSrc,fragmentSrc,attributeLocations){var glVertShader=compileShader(gl,gl.VERTEX_SHADER,vertexSrc),glFragShader=compileShader(gl,gl.FRAGMENT_SHADER,fragmentSrc),program=gl.createProgram();if(gl.attachShader(program,glVertShader),gl.attachShader(program,glFragShader),attributeLocations)for(var i in attributeLocations)gl.bindAttribLocation(program,attributeLocations[i],i);return gl.linkProgram(program),gl.getProgramParameter(program,gl.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",gl.getProgramParameter(program,gl.VALIDATE_STATUS)),console.error("gl.getError()",gl.getError()),""!==gl.getProgramInfoLog(program)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",gl.getProgramInfoLog(program)),gl.deleteProgram(program),program=null),gl.deleteShader(glVertShader),gl.deleteShader(glFragShader),program},compileShader=function(gl,type,src){var shader=gl.createShader(type);return gl.shaderSource(shader,src),gl.compileShader(shader),gl.getShaderParameter(shader,gl.COMPILE_STATUS)?shader:(console.log(gl.getShaderInfoLog(shader)),null)};module.exports=compileProgram},{}],136:[function(require,module,exports){var defaultValue=function(type,size){switch(type){case"float":return 0;case"vec2":return new Float32Array(2*size);case"vec3":return new Float32Array(3*size);case"vec4":return new Float32Array(4*size);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*size);case"ivec3":return new Int32Array(3*size);case"ivec4":return new Int32Array(4*size);case"bool":return!1;case"bvec2":return booleanArray(2*size);case"bvec3":return booleanArray(3*size);case"bvec4":return booleanArray(4*size);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},booleanArray=function(size){for(var array=new Array(size),i=0;i<array.length;i++)array[i]=!1;return array};module.exports=defaultValue},{}],137:[function(require,module,exports){var mapType=require("./mapType"),mapSize=require("./mapSize"),extractAttributes=function(gl,program){for(var attributes={},totalAttributes=gl.getProgramParameter(program,gl.ACTIVE_ATTRIBUTES),i=0;i<totalAttributes;i++){var attribData=gl.getActiveAttrib(program,i),type=mapType(gl,attribData.type);attributes[attribData.name]={type:type,size:mapSize(type),location:gl.getAttribLocation(program,attribData.name),pointer:pointer}}return attributes},pointer=function(type,normalized,stride,start){gl.vertexAttribPointer(this.location,this.size,type||gl.FLOAT,normalized||!1,stride||0,start||0)};module.exports=extractAttributes},{"./mapSize":141,"./mapType":142}],138:[function(require,module,exports){var mapType=require("./mapType"),defaultValue=require("./defaultValue"),extractUniforms=function(gl,program){for(var uniforms={},totalUniforms=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS),i=0;i<totalUniforms;i++){var uniformData=gl.getActiveUniform(program,i),name=uniformData.name.replace(/\[.*?\]/,""),type=mapType(gl,uniformData.type);uniforms[name]={type:type,size:uniformData.size,location:gl.getUniformLocation(program,name),value:defaultValue(type,uniformData.size)}}return uniforms};module.exports=extractUniforms},{"./defaultValue":136,"./mapType":142}],139:[function(require,module,exports){function generateSetter(name,uniform){return function(value){this.data[name].value=value;var location=this.data[name].location;1===uniform.size?GLSL_SINGLE_SETTERS[uniform.type](this.gl,location,value):GLSL_ARRAY_SETTERS[uniform.type](this.gl,location,value)}}function getUniformGroup(nameTokens,uniform){for(var cur=uniform,i=0;i<nameTokens.length-1;i++){var o=cur[nameTokens[i]]||{data:{}};cur[nameTokens[i]]=o,cur=o}return cur}var generateUniformAccessObject=function(gl,uniformData){var uniforms={data:{}};uniforms.gl=gl;for(var uniformKeys=Object.keys(uniformData),i=0;i<uniformKeys.length;i++){var fullName=uniformKeys[i],nameTokens=fullName.split("."),name=nameTokens[nameTokens.length-1],uniformGroup=getUniformGroup(nameTokens,uniforms),uniform=uniformData[fullName];uniformGroup.data[name]=uniform,uniformGroup.gl=gl,Object.defineProperty(uniformGroup,name,{get:generateGetter(name),set:generateSetter(name,uniform)})}return uniforms},generateGetter=function(name){return function(){return this.data[name].value}},GLSL_SINGLE_SETTERS={float:function(gl,location,value){gl.uniform1f(location,value)},vec2:function(gl,location,value){gl.uniform2f(location,value[0],value[1])},vec3:function(gl,location,value){gl.uniform3f(location,value[0],value[1],value[2])},vec4:function(gl,location,value){gl.uniform4f(location,value[0],value[1],value[2],value[3])},int:function(gl,location,value){gl.uniform1i(location,value)},ivec2:function(gl,location,value){gl.uniform2i(location,value[0],value[1])},ivec3:function(gl,location,value){gl.uniform3i(location,value[0],value[1],value[2])},ivec4:function(gl,location,value){gl.uniform4i(location,value[0],value[1],value[2],value[3])},bool:function(gl,location,value){gl.uniform1i(location,value)},bvec2:function(gl,location,value){gl.uniform2i(location,value[0],value[1])},bvec3:function(gl,location,value){gl.uniform3i(location,value[0],value[1],value[2])},bvec4:function(gl,location,value){gl.uniform4i(location,value[0],value[1],value[2],value[3])},mat2:function(gl,location,value){gl.uniformMatrix2fv(location,!1,value)},mat3:function(gl,location,value){gl.uniformMatrix3fv(location,!1,value)},mat4:function(gl,location,value){gl.uniformMatrix4fv(location,!1,value)},sampler2D:function(gl,location,value){gl.uniform1i(location,value)}},GLSL_ARRAY_SETTERS={float:function(gl,location,value){gl.uniform1fv(location,value)},vec2:function(gl,location,value){gl.uniform2fv(location,value)},vec3:function(gl,location,value){gl.uniform3fv(location,value)},vec4:function(gl,location,value){gl.uniform4fv(location,value)},int:function(gl,location,value){gl.uniform1iv(location,value)},ivec2:function(gl,location,value){gl.uniform2iv(location,value)},ivec3:function(gl,location,value){gl.uniform3iv(location,value)},ivec4:function(gl,location,value){gl.uniform4iv(location,value)},bool:function(gl,location,value){gl.uniform1iv(location,value)},bvec2:function(gl,location,value){gl.uniform2iv(location,value)},bvec3:function(gl,location,value){gl.uniform3iv(location,value)},bvec4:function(gl,location,value){gl.uniform4iv(location,value)},sampler2D:function(gl,location,value){gl.uniform1iv(location,value)}};module.exports=generateUniformAccessObject},{}],140:[function(require,module,exports){module.exports={compileProgram:require("./compileProgram"),defaultValue:require("./defaultValue"),extractAttributes:require("./extractAttributes"),extractUniforms:require("./extractUniforms"),generateUniformAccessObject:require("./generateUniformAccessObject"),setPrecision:require("./setPrecision"),mapSize:require("./mapSize"),mapType:require("./mapType")}},{"./compileProgram":135,"./defaultValue":136,"./extractAttributes":137,"./extractUniforms":138,"./generateUniformAccessObject":139,"./mapSize":141,"./mapType":142,"./setPrecision":143}],141:[function(require,module,exports){var mapSize=function(type){return GLSL_TO_SIZE[type]},GLSL_TO_SIZE={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};module.exports=mapSize},{}],142:[function(require,module,exports){var mapType=function(gl,type){if(!GL_TABLE){var typeNames=Object.keys(GL_TO_GLSL_TYPES);GL_TABLE={};for(var i=0;i<typeNames.length;++i){var tn=typeNames[i];GL_TABLE[gl[tn]]=GL_TO_GLSL_TYPES[tn]}}return GL_TABLE[type]},GL_TABLE=null,GL_TO_GLSL_TYPES={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"};module.exports=mapType},{}],143:[function(require,module,exports){var setPrecision=function(src,precision){return"precision"!==src.substring(0,9)?"precision "+precision+" float;\n"+src:src};module.exports=setPrecision},{}],144:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _core=require("../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),_ismobilejs=require("ismobilejs"),_ismobilejs2=_interopRequireDefault(_ismobilejs),_accessibleTarget=require("./accessibleTarget"),_accessibleTarget2=_interopRequireDefault(_accessibleTarget);core.utils.mixins.delayMixin(core.DisplayObject.prototype,_accessibleTarget2.default);var DIV_TOUCH_SIZE=100,DIV_TOUCH_POS_X=0,DIV_TOUCH_POS_Y=0,DIV_TOUCH_ZINDEX=2,AccessibilityManager=function(){function AccessibilityManager(renderer){_classCallCheck(this,AccessibilityManager),!_ismobilejs2.default.tablet&&!_ismobilejs2.default.phone||navigator.isCocoonJS||this.createTouchHook();var div=document.createElement("div");div.style.width=DIV_TOUCH_SIZE+"px",div.style.height=DIV_TOUCH_SIZE+"px",div.style.position="absolute",div.style.top=DIV_TOUCH_POS_X+"px",div.style.left=DIV_TOUCH_POS_Y+"px",div.style.zIndex=DIV_TOUCH_ZINDEX,this.div=div,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=renderer,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessabillity=!1,window.addEventListener("keydown",this._onKeyDown,!1)}return AccessibilityManager.prototype.createTouchHook=function(){var _this=this,hookDiv=document.createElement("button");hookDiv.style.width="1px",hookDiv.style.height="1px",hookDiv.style.position="absolute",hookDiv.style.top="-1000px",hookDiv.style.left="-1000px",hookDiv.style.zIndex=2,hookDiv.style.backgroundColor="#FF0000",hookDiv.title="HOOK DIV",hookDiv.addEventListener("focus",function(){_this.isMobileAccessabillity=!0,_this.activate(),document.body.removeChild(hookDiv)}),document.body.appendChild(hookDiv)},AccessibilityManager.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},AccessibilityManager.prototype.deactivate=function(){this.isActive&&!this.isMobileAccessabillity&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},AccessibilityManager.prototype.updateAccessibleObjects=function(displayObject){if(displayObject.visible){displayObject.accessible&&displayObject.interactive&&(displayObject._accessibleActive||this.addChild(displayObject),displayObject.renderId=this.renderId);for(var children=displayObject.children,i=0;i<children.length;i++)this.updateAccessibleObjects(children[i])}},AccessibilityManager.prototype.update=function(){if(this.renderer.renderingToScreen){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var rect=this.renderer.view.getBoundingClientRect(),sx=rect.width/this.renderer.width,sy=rect.height/this.renderer.height,div=this.div;div.style.left=rect.left+"px",div.style.top=rect.top+"px",div.style.width=this.renderer.width+"px",div.style.height=this.renderer.height+"px"
;for(var i=0;i<this.children.length;i++){var child=this.children[i];if(child.renderId!==this.renderId)child._accessibleActive=!1,core.utils.removeItems(this.children,i,1),this.div.removeChild(child._accessibleDiv),this.pool.push(child._accessibleDiv),child._accessibleDiv=null,i--,0===this.children.length&&this.deactivate();else{div=child._accessibleDiv;var hitArea=child.hitArea,wt=child.worldTransform;child.hitArea?(div.style.left=(wt.tx+hitArea.x*wt.a)*sx+"px",div.style.top=(wt.ty+hitArea.y*wt.d)*sy+"px",div.style.width=hitArea.width*wt.a*sx+"px",div.style.height=hitArea.height*wt.d*sy+"px"):(hitArea=child.getBounds(),this.capHitArea(hitArea),div.style.left=hitArea.x*sx+"px",div.style.top=hitArea.y*sy+"px",div.style.width=hitArea.width*sx+"px",div.style.height=hitArea.height*sy+"px",div.title!==child.accessibleTitle&&null!==child.accessibleTitle&&(div.title=child.accessibleTitle),div.getAttribute("aria-label")!==child.accessibleHint&&null!==child.accessibleHint&&div.setAttribute("aria-label",child.accessibleHint))}}this.renderId++}},AccessibilityManager.prototype.capHitArea=function(hitArea){hitArea.x<0&&(hitArea.width+=hitArea.x,hitArea.x=0),hitArea.y<0&&(hitArea.height+=hitArea.y,hitArea.y=0),hitArea.x+hitArea.width>this.renderer.width&&(hitArea.width=this.renderer.width-hitArea.x),hitArea.y+hitArea.height>this.renderer.height&&(hitArea.height=this.renderer.height-hitArea.y)},AccessibilityManager.prototype.addChild=function(displayObject){var div=this.pool.pop();div||(div=document.createElement("button"),div.style.width=DIV_TOUCH_SIZE+"px",div.style.height=DIV_TOUCH_SIZE+"px",div.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent",div.style.position="absolute",div.style.zIndex=DIV_TOUCH_ZINDEX,div.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?div.setAttribute("aria-live","off"):div.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?div.setAttribute("aria-relevant","additions"):div.setAttribute("aria-relevant","text"),div.addEventListener("click",this._onClick.bind(this)),div.addEventListener("focus",this._onFocus.bind(this)),div.addEventListener("focusout",this._onFocusOut.bind(this))),displayObject.accessibleTitle&&null!==displayObject.accessibleTitle?div.title=displayObject.accessibleTitle:displayObject.accessibleHint&&null!==displayObject.accessibleHint||(div.title="displayObject "+displayObject.tabIndex),displayObject.accessibleHint&&null!==displayObject.accessibleHint&&div.setAttribute("aria-label",displayObject.accessibleHint),displayObject._accessibleActive=!0,displayObject._accessibleDiv=div,div.displayObject=displayObject,this.children.push(displayObject),this.div.appendChild(displayObject._accessibleDiv),displayObject._accessibleDiv.tabIndex=displayObject.tabIndex},AccessibilityManager.prototype._onClick=function(e){var interactionManager=this.renderer.plugins.interaction;interactionManager.dispatchEvent(e.target.displayObject,"click",interactionManager.eventData)},AccessibilityManager.prototype._onFocus=function(e){e.target.getAttribute("aria-live","off")||e.target.setAttribute("aria-live","assertive");var interactionManager=this.renderer.plugins.interaction;interactionManager.dispatchEvent(e.target.displayObject,"mouseover",interactionManager.eventData)},AccessibilityManager.prototype._onFocusOut=function(e){e.target.getAttribute("aria-live","off")||e.target.setAttribute("aria-live","polite");var interactionManager=this.renderer.plugins.interaction;interactionManager.dispatchEvent(e.target.displayObject,"mouseout",interactionManager.eventData)},AccessibilityManager.prototype._onKeyDown=function(e){9===e.keyCode&&this.activate()},AccessibilityManager.prototype._onMouseMove=function(e){0===e.movementX&&0===e.movementY||this.deactivate()},AccessibilityManager.prototype.destroy=function(){this.div=null;for(var i=0;i<this.children.length;i++)this.children[i].div=null;window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},AccessibilityManager}();exports.default=AccessibilityManager,core.WebGLRenderer.registerPlugin("accessibility",AccessibilityManager),core.CanvasRenderer.registerPlugin("accessibility",AccessibilityManager)},{"../core":169,"./accessibleTarget":145,ismobilejs:119}],145:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1}},{}],146:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.__esModule=!0;var _accessibleTarget=require("./accessibleTarget");Object.defineProperty(exports,"accessibleTarget",{enumerable:!0,get:function(){return _interopRequireDefault(_accessibleTarget).default}});var _AccessibilityManager=require("./AccessibilityManager");Object.defineProperty(exports,"AccessibilityManager",{enumerable:!0,get:function(){return _interopRequireDefault(_AccessibilityManager).default}})},{"./AccessibilityManager":144,"./accessibleTarget":145}],147:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_autoDetectRenderer=require("./autoDetectRenderer"),_Container=require("./display/Container"),_Container2=_interopRequireDefault(_Container),_ticker=require("./ticker"),_settings=require("./settings"),_settings2=_interopRequireDefault(_settings),_const=require("./const"),Application=function(){function Application(options,arg2,arg3,arg4,arg5){_classCallCheck(this,Application),"number"==typeof options&&(options=Object.assign({width:options,height:arg2||_settings2.default.RENDER_OPTIONS.height,forceCanvas:!!arg4,sharedTicker:!!arg5},arg3)),this._options=options=Object.assign({autoStart:!0,sharedTicker:!1,forceCanvas:!1,sharedLoader:!1},options),this.renderer=(0,_autoDetectRenderer.autoDetectRenderer)(options),this.stage=new _Container2.default,this._ticker=null,this.ticker=options.sharedTicker?_ticker.shared:new _ticker.Ticker,options.autoStart&&this.start()}return Application.prototype.render=function(){this.renderer.render(this.stage)},Application.prototype.stop=function(){this._ticker.stop()},Application.prototype.start=function(){this._ticker.start()},Application.prototype.destroy=function(removeView,stageOptions){if(this._ticker){var oldTicker=this._ticker;this.ticker=null,oldTicker.destroy()}this.stage.destroy(stageOptions),this.stage=null,this.renderer.destroy(removeView),this.renderer=null,this._options=null},_createClass(Application,[{key:"ticker",set:function(ticker){this._ticker&&this._ticker.remove(this.render,this),this._ticker=ticker,ticker&&ticker.add(this.render,this,_const.UPDATE_PRIORITY.LOW)},get:function(){return this._ticker}},{key:"view",get:function(){return this.renderer.view}},{key:"screen",get:function(){return this.renderer.screen}}]),Application}();exports.default=Application},{"./autoDetectRenderer":149,"./const":150,"./display/Container":152,"./settings":205,"./ticker":225}],148:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function checkPrecision(src,def){if(src instanceof Array){if("precision"!==src[0].substring(0,9)){var copy=src.slice(0);return copy.unshift("precision "+def+" float;"),copy}}else if("precision"!==src.trim().substring(0,9))return"precision "+def+" float;\n"+src;return src}exports.__esModule=!0;var _pixiGlCore=require("pixi-gl-core"),_settings=require("./settings"),_settings2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_settings),Shader=function(_GLShader){function Shader(gl,vertexSrc,fragmentSrc,attributeLocations,precision){return _classCallCheck(this,Shader),_possibleConstructorReturn(this,_GLShader.call(this,gl,checkPrecision(vertexSrc,precision||_settings2.default.PRECISION_VERTEX),checkPrecision(fragmentSrc,precision||_settings2.default.PRECISION_FRAGMENT),void 0,attributeLocations))}return _inherits(Shader,_GLShader),Shader}(_pixiGlCore.GLShader);exports.default=Shader},{"./settings":205,"pixi-gl-core":133}],149:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function autoDetectRenderer(options,arg1,arg2,arg3){var forceCanvas=options&&options.forceCanvas;return void 0!==arg3&&(forceCanvas=arg3),!forceCanvas&&utils.isWebGLSupported()?new _WebGLRenderer2.default(options,arg1,arg2):new _CanvasRenderer2.default(options,arg1,arg2)}exports.__esModule=!0,exports.autoDetectRenderer=autoDetectRenderer;var _utils=require("./utils"),utils=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_utils),_CanvasRenderer=require("./renderers/canvas/CanvasRenderer"),_CanvasRenderer2=_interopRequireDefault(_CanvasRenderer),_WebGLRenderer=require("./renderers/webgl/WebGLRenderer"),_WebGLRenderer2=_interopRequireDefault(_WebGLRenderer)},{"./renderers/canvas/CanvasRenderer":181,"./renderers/webgl/WebGLRenderer":188,"./utils":229}],150:[function(require,module,exports){"use strict";exports.__esModule=!0;exports.VERSION="4.8.2",exports.PI_2=2*Math.PI,exports.RAD_TO_DEG=180/Math.PI,exports.DEG_TO_RAD=Math.PI/180,exports.RENDERER_TYPE={UNKNOWN:0,WEBGL:1,CANVAS:2},exports.BLEND_MODES={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,NORMAL_NPM:17,ADD_NPM:18,SCREEN_NPM:19},exports.DRAW_MODES={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},exports.SCALE_MODES={LINEAR:0,NEAREST:1},exports.WRAP_MODES={CLAMP:0,REPEAT:1,MIRRORED_REPEAT:2},exports.GC_MODES={AUTO:0,MANUAL:1},exports.URL_FILE_EXTENSION=/\.(\w{3,4})(?:$|\?|#)/i,exports.DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i,exports.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,exports.SHAPES={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},exports.PRECISION={LOW:"lowp",MEDIUM:"mediump",HIGH:"highp"},exports.TRANSFORM_MODE={STATIC:0,DYNAMIC:1},exports.TEXT_GRADIENT={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1},exports.UPDATE_PRIORITY={INTERACTION:50,HIGH:25,NORMAL:0,LOW:-25,UTILITY:-50}},{}],151:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _math=require("../math"),Bounds=function(){function Bounds(){_classCallCheck(this,Bounds),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null}return Bounds.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},Bounds.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},Bounds.prototype.getRectangle=function(rect){return this.minX>this.maxX||this.minY>this.maxY?_math.Rectangle.EMPTY:(rect=rect||new _math.Rectangle(0,0,1,1),rect.x=this.minX,rect.y=this.minY,rect.width=this.maxX-this.minX,rect.height=this.maxY-this.minY,rect)},Bounds.prototype.addPoint=function(point){this.minX=Math.min(this.minX,point.x),this.maxX=Math.max(this.maxX,point.x),this.minY=Math.min(this.minY,point.y),this.maxY=Math.max(this.maxY,point.y)},Bounds.prototype.addQuad=function(vertices){var minX=this.minX,minY=this.minY,maxX=this.maxX,maxY=this.maxY,x=vertices[0],y=vertices[1];minX=x<minX?x:minX,minY=y<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY,x=vertices[2],y=vertices[3],minX=x<minX?x:minX,minY=y<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY,x=vertices[4],y=vertices[5],minX=x<minX?x:minX,minY=y<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY,x=vertices[6],y=vertices[7],minX=x<minX?x:minX,minY=y<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY,this.minX=minX,this.minY=minY,this.maxX=maxX,this.maxY=maxY},Bounds.prototype.addFrame=function(transform,x0,y0,x1,y1){var matrix=transform.worldTransform,a=matrix.a,b=matrix.b,c=matrix.c,d=matrix.d,tx=matrix.tx,ty=matrix.ty,minX=this.minX,minY=this.minY,maxX=this.maxX,maxY=this.maxY,x=a*x0+c*y0+tx,y=b*x0+d*y0+ty;minX=x<minX?x:minX,minY=y<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY,x=a*x1+c*y0+tx,y=b*x1+d*y0+ty,minX=x<minX?x:minX,minY=y<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY,x=a*x0+c*y1+tx,y=b*x0+d*y1+ty,minX=x<minX?x:minX,minY=y<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY,x=a*x1+c*y1+tx,y=b*x1+d*y1+ty,minX=x<minX?x:minX,minY=y<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY,this.minX=minX,this.minY=minY,this.maxX=maxX,this.maxY=maxY},Bounds.prototype.addVertices=function(transform,vertices,beginOffset,endOffset){for(var matrix=transform.worldTransform,a=matrix.a,b=matrix.b,c=matrix.c,d=matrix.d,tx=matrix.tx,ty=matrix.ty,minX=this.minX,minY=this.minY,maxX=this.maxX,maxY=this.maxY,i=beginOffset;i<endOffset;i+=2){var rawX=vertices[i],rawY=vertices[i+1],x=a*rawX+c*rawY+tx,y=d*rawY+b*rawX+ty;minX=x<minX?x:minX,minY=y<minY?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY}this.minX=minX,this.minY=minY,this.maxX=maxX,this.maxY=maxY},Bounds.prototype.addBounds=function(bounds){var minX=this.minX,minY=this.minY,maxX=this.maxX,maxY=this.maxY;this.minX=bounds.minX<minX?bounds.minX:minX,this.minY=bounds.minY<minY?bounds.minY:minY,this.maxX=bounds.maxX>maxX?bounds.maxX:maxX,this.maxY=bounds.maxY>maxY?bounds.maxY:maxY},Bounds.prototype.addBoundsMask=function(bounds,mask){var _minX=bounds.minX>mask.minX?bounds.minX:mask.minX,_minY=bounds.minY>mask.minY?bounds.minY:mask.minY,_maxX=bounds.maxX<mask.maxX?bounds.maxX:mask.maxX,_maxY=bounds.maxY<mask.maxY?bounds.maxY:mask.maxY;if(_minX<=_maxX&&_minY<=_maxY){var minX=this.minX,minY=this.minY,maxX=this.maxX,maxY=this.maxY;this.minX=_minX<minX?_minX:minX,this.minY=_minY<minY?_minY:minY,this.maxX=_maxX>maxX?_maxX:maxX,this.maxY=_maxY>maxY?_maxY:maxY}},Bounds.prototype.addBoundsArea=function(bounds,area){var _minX=bounds.minX>area.x?bounds.minX:area.x,_minY=bounds.minY>area.y?bounds.minY:area.y,_maxX=bounds.maxX<area.x+area.width?bounds.maxX:area.x+area.width,_maxY=bounds.maxY<area.y+area.height?bounds.maxY:area.y+area.height;if(_minX<=_maxX&&_minY<=_maxY){var minX=this.minX,minY=this.minY,maxX=this.maxX,maxY=this.maxY;this.minX=_minX<minX?_minX:minX,this.minY=_minY<minY?_minY:minY,this.maxX=_maxX>maxX?_maxX:maxX,this.maxY=_maxY>maxY?_maxY:maxY}},Bounds}();exports.default=Bounds},{"../math":174}],152:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_utils=require("../utils"),_DisplayObject2=require("./DisplayObject"),_DisplayObject3=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_DisplayObject2),Container=function(_DisplayObject){function Container(){_classCallCheck(this,Container);var _this=_possibleConstructorReturn(this,_DisplayObject.call(this));return _this.children=[],_this}return _inherits(Container,_DisplayObject),Container.prototype.onChildrenChange=function(){},Container.prototype.addChild=function(child){var argumentsLength=arguments.length;if(argumentsLength>1)for(var i=0;i<argumentsLength;i++)this.addChild(arguments[i]);else child.parent&&child.parent.removeChild(child),child.parent=this,child.transform._parentID=-1,this.children.push(child),this._boundsID++,this.onChildrenChange(this.children.length-1),child.emit("added",this);return child},Container.prototype.addChildAt=function(child,index){if(index<0||index>this.children.length)throw new Error(child+"addChildAt: The index "+index+" supplied is out of bounds "+this.children.length);return child.parent&&child.parent.removeChild(child),child.parent=this,child.transform._parentID=-1,this.children.splice(index,0,child),this._boundsID++,this.onChildrenChange(index),child.emit("added",this),child},Container.prototype.swapChildren=function(child,child2){if(child!==child2){var index1=this.getChildIndex(child),index2=this.getChildIndex(child2);this.children[index1]=child2,this.children[index2]=child,this.onChildrenChange(index1<index2?index1:index2)}},Container.prototype.getChildIndex=function(child){var index=this.children.indexOf(child);if(-1===index)throw new Error("The supplied DisplayObject must be a child of the caller");return index},Container.prototype.setChildIndex=function(child,index){if(index<0||index>=this.children.length)throw new Error("The index "+index+" supplied is out of bounds "+this.children.length);var currentIndex=this.getChildIndex(child);(0,_utils.removeItems)(this.children,currentIndex,1),this.children.splice(index,0,child),this.onChildrenChange(index)},Container.prototype.getChildAt=function(index){if(index<0||index>=this.children.length)throw new Error("getChildAt: Index ("+index+") does not exist.");return this.children[index]},Container.prototype.removeChild=function(child){var argumentsLength=arguments.length;if(argumentsLength>1)for(var i=0;i<argumentsLength;i++)this.removeChild(arguments[i]);else{var index=this.children.indexOf(child);if(-1===index)return null;child.parent=null,child.transform._parentID=-1,(0,_utils.removeItems)(this.children,index,1),this._boundsID++,this.onChildrenChange(index),child.emit("removed",this)}return child},Container.prototype.removeChildAt=function(index){var child=this.getChildAt(index);return child.parent=null,child.transform._parentID=-1,(0,_utils.removeItems)(this.children,index,1),this._boundsID++,this.onChildrenChange(index),child.emit("removed",this),child},Container.prototype.removeChildren=function(){var beginIndex=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,endIndex=arguments[1],begin=beginIndex,end="number"==typeof endIndex?endIndex:this.children.length,range=end-begin,removed=void 0;if(range>0&&range<=end){removed=this.children.splice(begin,range);for(var i=0;i<removed.length;++i)removed[i].parent=null,removed[i].transform&&(removed[i].transform._parentID=-1);this._boundsID++,this.onChildrenChange(beginIndex);for(var _i=0;_i<removed.length;++_i)removed[_i].emit("removed",this);return removed}if(0===range&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},Container.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var i=0,j=this.children.length;i<j;++i){var child=this.children[i];child.visible&&child.updateTransform()}},Container.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var i=0;i<this.children.length;i++){var child=this.children[i];child.visible&&child.renderable&&(child.calculateBounds(),child._mask?(child._mask.calculateBounds(),this._bounds.addBoundsMask(child._bounds,child._mask._bounds)):child.filterArea?this._bounds.addBoundsArea(child._bounds,child.filterArea):this._bounds.addBounds(child._bounds))}this._lastBoundsID=this._boundsID},Container.prototype._calculateBounds=function(){},Container.prototype.renderWebGL=function(renderer){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this._filters)this.renderAdvancedWebGL(renderer);else{this._renderWebGL(renderer);for(var i=0,j=this.children.length;i<j;++i)this.children[i].renderWebGL(renderer)}},Container.prototype.renderAdvancedWebGL=function(renderer){renderer.flush();var filters=this._filters,mask=this._mask;if(filters){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<filters.length;i++)filters[i].enabled&&this._enabledFilters.push(filters[i]);this._enabledFilters.length&&renderer.filterManager.pushFilter(this,this._enabledFilters)}mask&&renderer.maskManager.pushMask(this,this._mask),this._renderWebGL(renderer);for(var _i2=0,j=this.children.length;_i2<j;_i2++)this.children[_i2].renderWebGL(renderer);renderer.flush(),mask&&renderer.maskManager.popMask(this,this._mask),filters&&this._enabledFilters&&this._enabledFilters.length&&renderer.filterManager.popFilter()},Container.prototype._renderWebGL=function(renderer){},Container.prototype._renderCanvas=function(renderer){},Container.prototype.renderCanvas=function(renderer){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&renderer.maskManager.pushMask(this._mask),this._renderCanvas(renderer);for(var i=0,j=this.children.length;i<j;++i)this.children[i].renderCanvas(renderer);this._mask&&renderer.maskManager.popMask(renderer)}},Container.prototype.destroy=function(options){_DisplayObject.prototype.destroy.call(this);var destroyChildren="boolean"==typeof options?options:options&&options.children,oldChildren=this.removeChildren(0,this.children.length);if(destroyChildren)for(var i=0;i<oldChildren.length;++i)oldChildren[i].destroy(options)},_createClass(Container,[{key:"width",get:function(){return this.scale.x*this.getLocalBounds().width},set:function(value){var width=this.getLocalBounds().width;this.scale.x=0!==width?value/width:1,this._width=value}},{key:"height",get:function(){return this.scale.y*this.getLocalBounds().height},set:function(value){var height=this.getLocalBounds().height;this.scale.y=0!==height?value/height:1,this._height=value}}]),Container}(_DisplayObject3.default);exports.default=Container,Container.prototype.containerUpdateTransform=Container.prototype.updateTransform},{"../utils":229,"./DisplayObject":153}],153:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_eventemitter=require("eventemitter3"),_eventemitter2=_interopRequireDefault(_eventemitter),_const=require("../const"),_settings=require("../settings"),_settings2=_interopRequireDefault(_settings),_TransformStatic=require("./TransformStatic"),_TransformStatic2=_interopRequireDefault(_TransformStatic),_Transform=require("./Transform"),_Transform2=_interopRequireDefault(_Transform),_Bounds=require("./Bounds"),_Bounds2=_interopRequireDefault(_Bounds),_math=require("../math"),DisplayObject=function(_EventEmitter){function DisplayObject(){_classCallCheck(this,DisplayObject);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this)),TransformClass=_settings2.default.TRANSFORM_MODE===_const.TRANSFORM_MODE.STATIC?_TransformStatic2.default:_Transform2.default;return _this.tempDisplayObjectParent=null,_this.transform=new TransformClass,_this.alpha=1,_this.visible=!0,_this.renderable=!0,_this.parent=null,_this.worldAlpha=1,_this.filterArea=null,_this._filters=null,_this._enabledFilters=null,_this._bounds=new _Bounds2.default,_this._boundsID=0,_this._lastBoundsID=-1,_this._boundsRect=null,_this._localBoundsRect=null,_this._mask=null,_this._destroyed=!1,_this}return _inherits(DisplayObject,_EventEmitter),DisplayObject.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},DisplayObject.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},DisplayObject.prototype.getBounds=function(skipUpdate,rect){return skipUpdate||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&this.calculateBounds(),rect||(this._boundsRect||(this._boundsRect=new _math.Rectangle),rect=this._boundsRect),this._bounds.getRectangle(rect)},DisplayObject.prototype.getLocalBounds=function(rect){var transformRef=this.transform,parentRef=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,rect||(this._localBoundsRect||(this._localBoundsRect=new _math.Rectangle),rect=this._localBoundsRect);var bounds=this.getBounds(!1,rect);return this.parent=parentRef,this.transform=transformRef,bounds},DisplayObject.prototype.toGlobal=function(position,point){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(position,point)},DisplayObject.prototype.toLocal=function(position,from,point,skipUpdate){return from&&(position=from.toGlobal(position,point,skipUpdate)),skipUpdate||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(position,point)},DisplayObject.prototype.renderWebGL=function(renderer){},DisplayObject.prototype.renderCanvas=function(renderer){},DisplayObject.prototype.setParent=function(container){if(!container||!container.addChild)throw new Error("setParent: Argument must be a Container");return container.addChild(this),container},DisplayObject.prototype.setTransform=function(){var x=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,scaleX=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,scaleY=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,rotation=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,skewX=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,skewY=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,pivotX=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,pivotY=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;return this.position.x=x,this.position.y=y,this.scale.x=scaleX||1,this.scale.y=scaleY||1,this.rotation=rotation,this.skew.x=skewX,this.skew.y=skewY,this.pivot.x=pivotX,this.pivot.y=pivotY,this},DisplayObject.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filterArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},_createClass(DisplayObject,[{key:"_tempDisplayObjectParent",get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new DisplayObject),this.tempDisplayObjectParent}},{key:"x",get:function(){return this.position.x},set:function(value){this.transform.position.x=value}},{key:"y",get:function(){return this.position.y},set:function(value){this.transform.position.y=value}},{key:"worldTransform",get:function(){return this.transform.worldTransform}},{key:"localTransform",get:function(){return this.transform.localTransform}},{key:"position",get:function(){return this.transform.position},set:function(value){this.transform.position.copy(value)}},{key:"scale",get:function(){return this.transform.scale},set:function(value){this.transform.scale.copy(value)}},{key:"pivot",get:function(){return this.transform.pivot},set:function(value){this.transform.pivot.copy(value)}},{key:"skew",get:function(){return this.transform.skew},set:function(value){this.transform.skew.copy(value)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(value){this.transform.rotation=value}},{key:"worldVisible",get:function(){var item=this;do{if(!item.visible)return!1;item=item.parent}while(item);return!0}},{key:"mask",get:function(){return this._mask},set:function(value){this._mask&&(this._mask.renderable=!0,this._mask.isMask=!1),this._mask=value,this._mask&&(this._mask.renderable=!1,this._mask.isMask=!0)}},{key:"filters",get:function(){return this._filters&&this._filters.slice()},set:function(value){this._filters=value&&value.slice()}}]),DisplayObject}(_eventemitter2.default);exports.default=DisplayObject,
DisplayObject.prototype.displayObjectUpdateTransform=DisplayObject.prototype.updateTransform},{"../const":150,"../math":174,"../settings":205,"./Bounds":151,"./Transform":154,"./TransformStatic":156,eventemitter3:118}],154:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_math=require("../math"),_TransformBase2=require("./TransformBase"),_TransformBase3=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_TransformBase2),Transform=function(_TransformBase){function Transform(){_classCallCheck(this,Transform);var _this=_possibleConstructorReturn(this,_TransformBase.call(this));return _this.position=new _math.Point(0,0),_this.scale=new _math.Point(1,1),_this.skew=new _math.ObservablePoint(_this.updateSkew,_this,0,0),_this.pivot=new _math.Point(0,0),_this._rotation=0,_this._cx=1,_this._sx=0,_this._cy=0,_this._sy=1,_this}return _inherits(Transform,_TransformBase),Transform.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x)},Transform.prototype.updateLocalTransform=function(){var lt=this.localTransform;lt.a=this._cx*this.scale.x,lt.b=this._sx*this.scale.x,lt.c=this._cy*this.scale.y,lt.d=this._sy*this.scale.y,lt.tx=this.position.x-(this.pivot.x*lt.a+this.pivot.y*lt.c),lt.ty=this.position.y-(this.pivot.x*lt.b+this.pivot.y*lt.d)},Transform.prototype.updateTransform=function(parentTransform){var lt=this.localTransform;lt.a=this._cx*this.scale.x,lt.b=this._sx*this.scale.x,lt.c=this._cy*this.scale.y,lt.d=this._sy*this.scale.y,lt.tx=this.position.x-(this.pivot.x*lt.a+this.pivot.y*lt.c),lt.ty=this.position.y-(this.pivot.x*lt.b+this.pivot.y*lt.d);var pt=parentTransform.worldTransform,wt=this.worldTransform;wt.a=lt.a*pt.a+lt.b*pt.c,wt.b=lt.a*pt.b+lt.b*pt.d,wt.c=lt.c*pt.a+lt.d*pt.c,wt.d=lt.c*pt.b+lt.d*pt.d,wt.tx=lt.tx*pt.a+lt.ty*pt.c+pt.tx,wt.ty=lt.tx*pt.b+lt.ty*pt.d+pt.ty,this._worldID++},Transform.prototype.setFromMatrix=function(matrix){matrix.decompose(this)},_createClass(Transform,[{key:"rotation",get:function(){return this._rotation},set:function(value){this._rotation=value,this.updateSkew()}}]),Transform}(_TransformBase3.default);exports.default=Transform},{"../math":174,"./TransformBase":155}],155:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _math=require("../math"),TransformBase=function(){function TransformBase(){_classCallCheck(this,TransformBase),this.worldTransform=new _math.Matrix,this.localTransform=new _math.Matrix,this._worldID=0,this._parentID=0}return TransformBase.prototype.updateLocalTransform=function(){},TransformBase.prototype.updateTransform=function(parentTransform){var pt=parentTransform.worldTransform,wt=this.worldTransform,lt=this.localTransform;wt.a=lt.a*pt.a+lt.b*pt.c,wt.b=lt.a*pt.b+lt.b*pt.d,wt.c=lt.c*pt.a+lt.d*pt.c,wt.d=lt.c*pt.b+lt.d*pt.d,wt.tx=lt.tx*pt.a+lt.ty*pt.c+pt.tx,wt.ty=lt.tx*pt.b+lt.ty*pt.d+pt.ty,this._worldID++},TransformBase}();exports.default=TransformBase,TransformBase.prototype.updateWorldTransform=TransformBase.prototype.updateTransform,TransformBase.IDENTITY=new TransformBase},{"../math":174}],156:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_math=require("../math"),_TransformBase2=require("./TransformBase"),_TransformBase3=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_TransformBase2),TransformStatic=function(_TransformBase){function TransformStatic(){_classCallCheck(this,TransformStatic);var _this=_possibleConstructorReturn(this,_TransformBase.call(this));return _this.position=new _math.ObservablePoint(_this.onChange,_this,0,0),_this.scale=new _math.ObservablePoint(_this.onChange,_this,1,1),_this.pivot=new _math.ObservablePoint(_this.onChange,_this,0,0),_this.skew=new _math.ObservablePoint(_this.updateSkew,_this,0,0),_this._rotation=0,_this._cx=1,_this._sx=0,_this._cy=0,_this._sy=1,_this._localID=0,_this._currentLocalID=0,_this}return _inherits(TransformStatic,_TransformBase),TransformStatic.prototype.onChange=function(){this._localID++},TransformStatic.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x),this._localID++},TransformStatic.prototype.updateLocalTransform=function(){var lt=this.localTransform;this._localID!==this._currentLocalID&&(lt.a=this._cx*this.scale._x,lt.b=this._sx*this.scale._x,lt.c=this._cy*this.scale._y,lt.d=this._sy*this.scale._y,lt.tx=this.position._x-(this.pivot._x*lt.a+this.pivot._y*lt.c),lt.ty=this.position._y-(this.pivot._x*lt.b+this.pivot._y*lt.d),this._currentLocalID=this._localID,this._parentID=-1)},TransformStatic.prototype.updateTransform=function(parentTransform){var lt=this.localTransform;if(this._localID!==this._currentLocalID&&(lt.a=this._cx*this.scale._x,lt.b=this._sx*this.scale._x,lt.c=this._cy*this.scale._y,lt.d=this._sy*this.scale._y,lt.tx=this.position._x-(this.pivot._x*lt.a+this.pivot._y*lt.c),lt.ty=this.position._y-(this.pivot._x*lt.b+this.pivot._y*lt.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==parentTransform._worldID){var pt=parentTransform.worldTransform,wt=this.worldTransform;wt.a=lt.a*pt.a+lt.b*pt.c,wt.b=lt.a*pt.b+lt.b*pt.d,wt.c=lt.c*pt.a+lt.d*pt.c,wt.d=lt.c*pt.b+lt.d*pt.d,wt.tx=lt.tx*pt.a+lt.ty*pt.c+pt.tx,wt.ty=lt.tx*pt.b+lt.ty*pt.d+pt.ty,this._parentID=parentTransform._worldID,this._worldID++}},TransformStatic.prototype.setFromMatrix=function(matrix){matrix.decompose(this),this._localID++},_createClass(TransformStatic,[{key:"rotation",get:function(){return this._rotation},set:function(value){this._rotation=value,this.updateSkew()}}]),TransformStatic}(_TransformBase3.default);exports.default=TransformStatic},{"../math":174,"./TransformBase":155}],157:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _Container2=require("../display/Container"),_Container3=_interopRequireDefault(_Container2),_RenderTexture=require("../textures/RenderTexture"),_RenderTexture2=_interopRequireDefault(_RenderTexture),_Texture=require("../textures/Texture"),_Texture2=_interopRequireDefault(_Texture),_GraphicsData=require("./GraphicsData"),_GraphicsData2=_interopRequireDefault(_GraphicsData),_Sprite=require("../sprites/Sprite"),_Sprite2=_interopRequireDefault(_Sprite),_math=require("../math"),_utils=require("../utils"),_const=require("../const"),_Bounds=require("../display/Bounds"),_Bounds2=_interopRequireDefault(_Bounds),_bezierCurveTo2=require("./utils/bezierCurveTo"),_bezierCurveTo3=_interopRequireDefault(_bezierCurveTo2),_CanvasRenderer=require("../renderers/canvas/CanvasRenderer"),_CanvasRenderer2=_interopRequireDefault(_CanvasRenderer),canvasRenderer=void 0,tempMatrix=new _math.Matrix,tempPoint=new _math.Point,tempColor1=new Float32Array(4),tempColor2=new Float32Array(4),Graphics=function(_Container){function Graphics(){var nativeLines=arguments.length>0&&void 0!==arguments[0]&&arguments[0];_classCallCheck(this,Graphics);var _this=_possibleConstructorReturn(this,_Container.call(this));return _this.fillAlpha=1,_this.lineWidth=0,_this.nativeLines=nativeLines,_this.lineColor=0,_this.lineAlignment=.5,_this.graphicsData=[],_this.tint=16777215,_this._prevTint=16777215,_this.blendMode=_const.BLEND_MODES.NORMAL,_this.currentPath=null,_this._webGL={},_this.isMask=!1,_this.boundsPadding=0,_this._localBounds=new _Bounds2.default,_this.dirty=0,_this.fastRectDirty=-1,_this.clearDirty=0,_this.boundsDirty=-1,_this.cachedSpriteDirty=!1,_this._spriteRect=null,_this._fastRect=!1,_this._prevRectTint=null,_this._prevRectFillColor=null,_this}return _inherits(Graphics,_Container),Graphics.prototype.clone=function(){var clone=new Graphics;clone.renderable=this.renderable,clone.fillAlpha=this.fillAlpha,clone.lineWidth=this.lineWidth,clone.lineColor=this.lineColor,clone.lineAlignment=this.lineAlignment,clone.tint=this.tint,clone.blendMode=this.blendMode,clone.isMask=this.isMask,clone.boundsPadding=this.boundsPadding,clone.dirty=0,clone.cachedSpriteDirty=this.cachedSpriteDirty;for(var i=0;i<this.graphicsData.length;++i)clone.graphicsData.push(this.graphicsData[i].clone());return clone.currentPath=clone.graphicsData[clone.graphicsData.length-1],clone.updateLocalBounds(),clone},Graphics.prototype._quadraticCurveLength=function(fromX,fromY,cpX,cpY,toX,toY){var ax=fromX-(2*cpX+toX),ay=fromY-(2*cpY+toY),bx=(cpX-2)*fromX*2,by=(cpY-2)*fromY*2,a=4*(ax*ax+ay*ay),b=4*(ax*bx+ay*by),c=bx*bx+by*by,s=2*Math.sqrt(a+b+c),a2=Math.sqrt(a),a32=2*a*a2,c2=2*Math.sqrt(c),ba=b/a2;return(a32*s+a2*b*(s-c2)+(4*c*a-b*b)*Math.log((2*a2+ba+s)/(ba+c2)))/(4*a32)},Graphics.prototype._bezierCurveLength=function(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY){for(var result=0,t=0,t2=0,t3=0,nt=0,nt2=0,nt3=0,x=0,y=0,dx=0,dy=0,prevX=fromX,prevY=fromY,i=1;i<=10;++i)t=i/10,t2=t*t,t3=t2*t,nt=1-t,nt2=nt*nt,nt3=nt2*nt,x=nt3*fromX+3*nt2*t*cpX+3*nt*t2*cpX2+t3*toX,y=nt3*fromY+3*nt2*t*cpY+3*nt*t2*cpY2+t3*toY,dx=prevX-x,dy=prevY-y,prevX=x,prevY=y,result+=Math.sqrt(dx*dx+dy*dy);return result},Graphics.prototype._segmentsCount=function(length){var result=Math.ceil(length/Graphics.CURVES.maxLength);return result<Graphics.CURVES.minSegments?result=Graphics.CURVES.minSegments:result>Graphics.CURVES.maxSegments&&(result=Graphics.CURVES.maxSegments),result},Graphics.prototype.lineStyle=function(){var lineWidth=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,color=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,alpha=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,alignment=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;if(this.lineWidth=lineWidth,this.lineColor=color,this.lineAlpha=alpha,this.lineAlignment=alignment,this.currentPath)if(this.currentPath.shape.points.length){var shape=new _math.Polygon(this.currentPath.shape.points.slice(-2));shape.closed=!1,this.drawShape(shape)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha,this.currentPath.lineAlignment=this.lineAlignment;return this},Graphics.prototype.moveTo=function(x,y){var shape=new _math.Polygon([x,y]);return shape.closed=!1,this.drawShape(shape),this},Graphics.prototype.lineTo=function(x,y){var points=this.currentPath.shape.points,fromX=points[points.length-2],fromY=points[points.length-1];return fromX===x&&fromY===y||(points.push(x,y),this.dirty++),this},Graphics.prototype.quadraticCurveTo=function(cpX,cpY,toX,toY){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var points=this.currentPath.shape.points,xa=0,ya=0;0===points.length&&this.moveTo(0,0);for(var fromX=points[points.length-2],fromY=points[points.length-1],n=Graphics.CURVES.adaptive?this._segmentsCount(this._quadraticCurveLength(fromX,fromY,cpX,cpY,toX,toY)):20,i=1;i<=n;++i){var j=i/n;xa=fromX+(cpX-fromX)*j,ya=fromY+(cpY-fromY)*j,points.push(xa+(cpX+(toX-cpX)*j-xa)*j,ya+(cpY+(toY-cpY)*j-ya)*j)}return this.dirty++,this},Graphics.prototype.bezierCurveTo=function(cpX,cpY,cpX2,cpY2,toX,toY){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var points=this.currentPath.shape.points,fromX=points[points.length-2],fromY=points[points.length-1];points.length-=2;var n=Graphics.CURVES.adaptive?this._segmentsCount(this._bezierCurveLength(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY)):20;return(0,_bezierCurveTo3.default)(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY,n,points),this.dirty++,this},Graphics.prototype.arcTo=function(x1,y1,x2,y2,radius){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(x1,y1):this.moveTo(x1,y1);var points=this.currentPath.shape.points,fromX=points[points.length-2],fromY=points[points.length-1],a1=fromY-y1,b1=fromX-x1,a2=y2-y1,b2=x2-x1,mm=Math.abs(a1*b2-b1*a2);if(mm<1e-8||0===radius)points[points.length-2]===x1&&points[points.length-1]===y1||points.push(x1,y1);else{var dd=a1*a1+b1*b1,cc=a2*a2+b2*b2,tt=a1*a2+b1*b2,k1=radius*Math.sqrt(dd)/mm,k2=radius*Math.sqrt(cc)/mm,j1=k1*tt/dd,j2=k2*tt/cc,cx=k1*b2+k2*b1,cy=k1*a2+k2*a1,px=b1*(k2+j1),py=a1*(k2+j1),qx=b2*(k1+j2),qy=a2*(k1+j2),startAngle=Math.atan2(py-cy,px-cx),endAngle=Math.atan2(qy-cy,qx-cx);this.arc(cx+x1,cy+y1,radius,startAngle,endAngle,b1*a2>b2*a1)}return this.dirty++,this},Graphics.prototype.arc=function(cx,cy,radius,startAngle,endAngle){var anticlockwise=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(startAngle===endAngle)return this;!anticlockwise&&endAngle<=startAngle?endAngle+=_const.PI_2:anticlockwise&&startAngle<=endAngle&&(startAngle+=_const.PI_2);var sweep=endAngle-startAngle,segs=Graphics.CURVES.adaptive?this._segmentsCount(Math.abs(sweep)*radius):40*Math.ceil(Math.abs(sweep)/_const.PI_2);if(0===sweep)return this;var startX=cx+Math.cos(startAngle)*radius,startY=cy+Math.sin(startAngle)*radius,points=this.currentPath?this.currentPath.shape.points:null;if(points){var xDiff=Math.abs(points[points.length-2]-startX),yDiff=Math.abs(points[points.length-1]-startY);xDiff<.001&&yDiff<.001||points.push(startX,startY)}else this.moveTo(startX,startY),points=this.currentPath.shape.points;for(var theta=sweep/(2*segs),theta2=2*theta,cTheta=Math.cos(theta),sTheta=Math.sin(theta),segMinus=segs-1,remainder=segMinus%1/segMinus,i=0;i<=segMinus;++i){var real=i+remainder*i,angle=theta+startAngle+theta2*real,c=Math.cos(angle),s=-Math.sin(angle);points.push((cTheta*c+sTheta*s)*radius+cx,(cTheta*-s+sTheta*c)*radius+cy)}return this.dirty++,this},Graphics.prototype.beginFill=function(){var color=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,alpha=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.filling=!0,this.fillColor=color,this.fillAlpha=alpha,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},Graphics.prototype.drawRect=function(x,y,width,height){return this.drawShape(new _math.Rectangle(x,y,width,height)),this},Graphics.prototype.drawRoundedRect=function(x,y,width,height,radius){return this.drawShape(new _math.RoundedRectangle(x,y,width,height,radius)),this},Graphics.prototype.drawCircle=function(x,y,radius){return this.drawShape(new _math.Circle(x,y,radius)),this},Graphics.prototype.drawEllipse=function(x,y,width,height){return this.drawShape(new _math.Ellipse(x,y,width,height)),this},Graphics.prototype.drawPolygon=function(path){var points=path,closed=!0;if(points instanceof _math.Polygon&&(closed=points.closed,points=points.points),!Array.isArray(points)){points=new Array(arguments.length);for(var i=0;i<points.length;++i)points[i]=arguments[i]}var shape=new _math.Polygon(points);return shape.closed=closed,this.drawShape(shape),this},Graphics.prototype.drawStar=function(x,y,points,radius,innerRadius){var rotation=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;innerRadius=innerRadius||radius/2;for(var startAngle=-1*Math.PI/2+rotation,len=2*points,delta=_const.PI_2/len,polygon=[],i=0;i<len;i++){var r=i%2?innerRadius:radius,angle=i*delta+startAngle;polygon.push(x+r*Math.cos(angle),y+r*Math.sin(angle))}return this.drawPolygon(polygon)},Graphics.prototype.clear=function(){return(this.lineWidth||this.filling||this.graphicsData.length>0)&&(this.lineWidth=0,this.lineAlignment=.5,this.filling=!1,this.boundsDirty=-1,this.canvasTintDirty=-1,this.dirty++,this.clearDirty++,this.graphicsData.length=0),this.currentPath=null,this._spriteRect=null,this},Graphics.prototype.isFastRect=function(){return 1===this.graphicsData.length&&this.graphicsData[0].shape.type===_const.SHAPES.RECT&&!this.graphicsData[0].lineWidth},Graphics.prototype._renderWebGL=function(renderer){this.dirty!==this.fastRectDirty&&(this.fastRectDirty=this.dirty,this._fastRect=this.isFastRect()),this._fastRect?this._renderSpriteRect(renderer):(renderer.setObjectRenderer(renderer.plugins.graphics),renderer.plugins.graphics.render(this))},Graphics.prototype._renderSpriteRect=function(renderer){var rect=this.graphicsData[0].shape;this._spriteRect||(this._spriteRect=new _Sprite2.default(new _Texture2.default(_Texture2.default.WHITE)));var sprite=this._spriteRect,fillColor=this.graphicsData[0].fillColor;if(16777215===this.tint)sprite.tint=fillColor;else if(this.tint!==this._prevRectTint||fillColor!==this._prevRectFillColor){var t1=tempColor1,t2=tempColor2;(0,_utils.hex2rgb)(fillColor,t1),(0,_utils.hex2rgb)(this.tint,t2),t1[0]*=t2[0],t1[1]*=t2[1],t1[2]*=t2[2],sprite.tint=(0,_utils.rgb2hex)(t1),this._prevRectTint=this.tint,this._prevRectFillColor=fillColor}sprite.alpha=this.graphicsData[0].fillAlpha,sprite.worldAlpha=this.worldAlpha*sprite.alpha,sprite.blendMode=this.blendMode,sprite._texture._frame.width=rect.width,sprite._texture._frame.height=rect.height,sprite.transform.worldTransform=this.transform.worldTransform,sprite.anchor.set(-rect.x/rect.width,-rect.y/rect.height),sprite._onAnchorUpdate(),sprite._renderWebGL(renderer)},Graphics.prototype._renderCanvas=function(renderer){!0!==this.isMask&&renderer.plugins.graphics.render(this)},Graphics.prototype._calculateBounds=function(){this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.updateLocalBounds(),this.cachedSpriteDirty=!0);var lb=this._localBounds;this._bounds.addFrame(this.transform,lb.minX,lb.minY,lb.maxX,lb.maxY)},Graphics.prototype.containsPoint=function(point){this.worldTransform.applyInverse(point,tempPoint);for(var graphicsData=this.graphicsData,i=0;i<graphicsData.length;++i){var data=graphicsData[i];if(data.fill&&(data.shape&&data.shape.contains(tempPoint.x,tempPoint.y))){if(data.holes)for(var _i=0;_i<data.holes.length;_i++){var hole=data.holes[_i];if(hole.contains(tempPoint.x,tempPoint.y))return!1}return!0}}return!1},Graphics.prototype.updateLocalBounds=function(){var minX=1/0,maxX=-1/0,minY=1/0,maxY=-1/0;if(this.graphicsData.length)for(var shape=0,x=0,y=0,w=0,h=0,i=0;i<this.graphicsData.length;i++){var data=this.graphicsData[i],type=data.type,lineWidth=data.lineWidth;if(shape=data.shape,type===_const.SHAPES.RECT||type===_const.SHAPES.RREC)x=shape.x-lineWidth/2,y=shape.y-lineWidth/2,w=shape.width+lineWidth,h=shape.height+lineWidth,minX=x<minX?x:minX,maxX=x+w>maxX?x+w:maxX,minY=y<minY?y:minY,maxY=y+h>maxY?y+h:maxY;else if(type===_const.SHAPES.CIRC)x=shape.x,y=shape.y,w=shape.radius+lineWidth/2,h=shape.radius+lineWidth/2,minX=x-w<minX?x-w:minX,maxX=x+w>maxX?x+w:maxX,minY=y-h<minY?y-h:minY,maxY=y+h>maxY?y+h:maxY;else if(type===_const.SHAPES.ELIP)x=shape.x,y=shape.y,w=shape.width+lineWidth/2,h=shape.height+lineWidth/2,minX=x-w<minX?x-w:minX,maxX=x+w>maxX?x+w:maxX,minY=y-h<minY?y-h:minY,maxY=y+h>maxY?y+h:maxY;else for(var points=shape.points,x2=0,y2=0,dx=0,dy=0,rw=0,rh=0,cx=0,cy=0,j=0;j+2<points.length;j+=2)x=points[j],y=points[j+1],x2=points[j+2],y2=points[j+3],dx=Math.abs(x2-x),dy=Math.abs(y2-y),h=lineWidth,(w=Math.sqrt(dx*dx+dy*dy))<1e-9||(rw=(h/w*dy+dx)/2,rh=(h/w*dx+dy)/2,cx=(x2+x)/2,cy=(y2+y)/2,minX=cx-rw<minX?cx-rw:minX,maxX=cx+rw>maxX?cx+rw:maxX,minY=cy-rh<minY?cy-rh:minY,maxY=cy+rh>maxY?cy+rh:maxY)}else minX=0,maxX=0,minY=0,maxY=0;var padding=this.boundsPadding;this._localBounds.minX=minX-padding,this._localBounds.maxX=maxX+padding,this._localBounds.minY=minY-padding,this._localBounds.maxY=maxY+padding},Graphics.prototype.drawShape=function(shape){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var data=new _GraphicsData2.default(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,this.nativeLines,shape,this.lineAlignment);return this.graphicsData.push(data),data.type===_const.SHAPES.POLY&&(data.shape.closed=data.shape.closed,this.currentPath=data),this.dirty++,data},Graphics.prototype.generateCanvasTexture=function(scaleMode){var resolution=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,bounds=this.getLocalBounds(),canvasBuffer=_RenderTexture2.default.create(bounds.width,bounds.height,scaleMode,resolution);canvasRenderer||(canvasRenderer=new _CanvasRenderer2.default),this.transform.updateLocalTransform(),this.transform.localTransform.copy(tempMatrix),tempMatrix.invert(),tempMatrix.tx-=bounds.x,tempMatrix.ty-=bounds.y,canvasRenderer.render(this,canvasBuffer,!0,tempMatrix);var texture=_Texture2.default.fromCanvas(canvasBuffer.baseTexture._canvasRenderTarget.canvas,scaleMode,"graphics");return texture.baseTexture.resolution=resolution,texture.baseTexture.update(),texture},Graphics.prototype.closePath=function(){var currentPath=this.currentPath;return currentPath&&currentPath.shape&&currentPath.shape.close(),this},Graphics.prototype.addHole=function(){var hole=this.graphicsData.pop();return this.currentPath=this.graphicsData[this.graphicsData.length-1],this.currentPath.addHole(hole.shape),this.currentPath=null,this},Graphics.prototype.destroy=function(options){_Container.prototype.destroy.call(this,options);for(var i=0;i<this.graphicsData.length;++i)this.graphicsData[i].destroy();for(var id in this._webGL)for(var j=0;j<this._webGL[id].data.length;++j)this._webGL[id].data[j].destroy();this._spriteRect&&this._spriteRect.destroy(),this.graphicsData=null,this.currentPath=null,this._webGL=null,this._localBounds=null},Graphics}(_Container3.default);exports.default=Graphics,Graphics._SPRITE_TEXTURE=null,Graphics.CURVES={adaptive:!1,maxLength:10,minSegments:8,maxSegments:2048}},{"../const":150,"../display/Bounds":151,"../display/Container":152,"../math":174,"../renderers/canvas/CanvasRenderer":181,"../sprites/Sprite":206,"../textures/RenderTexture":217,"../textures/Texture":219,"../utils":229,"./GraphicsData":158,"./utils/bezierCurveTo":160}],158:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var GraphicsData=function(){function GraphicsData(lineWidth,lineColor,lineAlpha,fillColor,fillAlpha,fill,nativeLines,shape,lineAlignment){_classCallCheck(this,GraphicsData),this.lineWidth=lineWidth,this.lineAlignment=lineAlignment,this.nativeLines=nativeLines,this.lineColor=lineColor,this.lineAlpha=lineAlpha,this._lineTint=lineColor,this.fillColor=fillColor,this.fillAlpha=fillAlpha,this._fillTint=fillColor,this.fill=fill,this.holes=[],this.shape=shape,this.type=shape.type}return GraphicsData.prototype.clone=function(){return new GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.nativeLines,this.shape)},GraphicsData.prototype.addHole=function(shape){this.holes.push(shape)},GraphicsData.prototype.destroy=function(){this.shape=null,this.holes=null},GraphicsData}();exports.default=GraphicsData},{}],159:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _CanvasRenderer=require("../../renderers/canvas/CanvasRenderer"),_CanvasRenderer2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_CanvasRenderer),_const=require("../../const"),CanvasGraphicsRenderer=function(){function CanvasGraphicsRenderer(renderer){_classCallCheck(this,CanvasGraphicsRenderer),this.renderer=renderer}return CanvasGraphicsRenderer.prototype.render=function(graphics){var renderer=this.renderer,context=renderer.context,worldAlpha=graphics.worldAlpha,transform=graphics.transform.worldTransform,resolution=renderer.resolution;context.setTransform(transform.a*resolution,transform.b*resolution,transform.c*resolution,transform.d*resolution,transform.tx*resolution,transform.ty*resolution),graphics.canvasTintDirty===graphics.dirty&&graphics._prevTint===graphics.tint||this.updateGraphicsTint(graphics),renderer.setBlendMode(graphics.blendMode);for(var i=0;i<graphics.graphicsData.length;i++){var data=graphics.graphicsData[i],shape=data.shape,fillColor=data._fillTint,lineColor=data._lineTint;if(context.lineWidth=data.lineWidth,data.type===_const.SHAPES.POLY){context.beginPath(),this.renderPolygon(shape.points,shape.closed,context);for(var j=0;j<data.holes.length;j++)this.renderPolygon(data.holes[j].points,!0,context);data.fill&&(context.globalAlpha=data.fillAlpha*worldAlpha,context.fillStyle="#"+("00000"+(0|fillColor).toString(16)).substr(-6),context.fill()),data.lineWidth&&(context.globalAlpha=data.lineAlpha*worldAlpha,context.strokeStyle="#"+("00000"+(0|lineColor).toString(16)).substr(-6),context.stroke())}else if(data.type===_const.SHAPES.RECT)(data.fillColor||0===data.fillColor)&&(context.globalAlpha=data.fillAlpha*worldAlpha,context.fillStyle="#"+("00000"+(0|fillColor).toString(16)).substr(-6),context.fillRect(shape.x,shape.y,shape.width,shape.height)),data.lineWidth&&(context.globalAlpha=data.lineAlpha*worldAlpha,context.strokeStyle="#"+("00000"+(0|lineColor).toString(16)).substr(-6),context.strokeRect(shape.x,shape.y,shape.width,shape.height));else if(data.type===_const.SHAPES.CIRC)context.beginPath(),context.arc(shape.x,shape.y,shape.radius,0,2*Math.PI),context.closePath(),data.fill&&(context.globalAlpha=data.fillAlpha*worldAlpha,context.fillStyle="#"+("00000"+(0|fillColor).toString(16)).substr(-6),context.fill()),data.lineWidth&&(context.globalAlpha=data.lineAlpha*worldAlpha,context.strokeStyle="#"+("00000"+(0|lineColor).toString(16)).substr(-6),context.stroke());else if(data.type===_const.SHAPES.ELIP){var w=2*shape.width,h=2*shape.height,x=shape.x-w/2,y=shape.y-h/2;context.beginPath();var ox=w/2*.5522848,oy=h/2*.5522848,xe=x+w,ye=y+h,xm=x+w/2,ym=y+h/2;context.moveTo(x,ym),context.bezierCurveTo(x,ym-oy,xm-ox,y,xm,y),context.bezierCurveTo(xm+ox,y,xe,ym-oy,xe,ym),context.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye),context.bezierCurveTo(xm-ox,ye,x,ym+oy,x,ym),context.closePath(),data.fill&&(context.globalAlpha=data.fillAlpha*worldAlpha,context.fillStyle="#"+("00000"+(0|fillColor).toString(16)).substr(-6),context.fill()),data.lineWidth&&(context.globalAlpha=data.lineAlpha*worldAlpha,context.strokeStyle="#"+("00000"+(0|lineColor).toString(16)).substr(-6),context.stroke())}else if(data.type===_const.SHAPES.RREC){var rx=shape.x,ry=shape.y,width=shape.width,height=shape.height,radius=shape.radius,maxRadius=Math.min(width,height)/2|0;radius=radius>maxRadius?maxRadius:radius,context.beginPath(),context.moveTo(rx,ry+radius),context.lineTo(rx,ry+height-radius),context.quadraticCurveTo(rx,ry+height,rx+radius,ry+height),context.lineTo(rx+width-radius,ry+height),context.quadraticCurveTo(rx+width,ry+height,rx+width,ry+height-radius),context.lineTo(rx+width,ry+radius),context.quadraticCurveTo(rx+width,ry,rx+width-radius,ry),context.lineTo(rx+radius,ry),context.quadraticCurveTo(rx,ry,rx,ry+radius),context.closePath(),(data.fillColor||0===data.fillColor)&&(context.globalAlpha=data.fillAlpha*worldAlpha,context.fillStyle="#"+("00000"+(0|fillColor).toString(16)).substr(-6),context.fill()),data.lineWidth&&(context.globalAlpha=data.lineAlpha*worldAlpha,context.strokeStyle="#"+("00000"+(0|lineColor).toString(16)).substr(-6),context.stroke())}}},CanvasGraphicsRenderer.prototype.updateGraphicsTint=function(graphics){graphics._prevTint=graphics.tint,graphics.canvasTintDirty=graphics.dirty;for(var tintR=(graphics.tint>>16&255)/255,tintG=(graphics.tint>>8&255)/255,tintB=(255&graphics.tint)/255,i=0;i<graphics.graphicsData.length;++i){var data=graphics.graphicsData[i],fillColor=0|data.fillColor,lineColor=0|data.lineColor;data._fillTint=((fillColor>>16&255)/255*tintR*255<<16)+((fillColor>>8&255)/255*tintG*255<<8)+(255&fillColor)/255*tintB*255,data._lineTint=((lineColor>>16&255)/255*tintR*255<<16)+((lineColor>>8&255)/255*tintG*255<<8)+(255&lineColor)/255*tintB*255}},CanvasGraphicsRenderer.prototype.renderPolygon=function(points,close,context){context.moveTo(points[0],points[1]);for(var j=1;j<points.length/2;++j)context.lineTo(points[2*j],points[2*j+1]);close&&context.closePath()},CanvasGraphicsRenderer.prototype.destroy=function(){this.renderer=null},CanvasGraphicsRenderer}();exports.default=CanvasGraphicsRenderer,_CanvasRenderer2.default.registerPlugin("graphics",CanvasGraphicsRenderer)},{"../../const":150,"../../renderers/canvas/CanvasRenderer":181}],
160:[function(require,module,exports){"use strict";function bezierCurveTo(fromX,fromY,cpX,cpY,cpX2,cpY2,toX,toY,n){var path=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[],dt=0,dt2=0,dt3=0,t2=0,t3=0;path.push(fromX,fromY);for(var i=1,j=0;i<=n;++i)j=i/n,dt=1-j,dt2=dt*dt,dt3=dt2*dt,t2=j*j,t3=t2*j,path.push(dt3*fromX+3*dt2*j*cpX+3*dt*t2*cpX2+t3*toX,dt3*fromY+3*dt2*j*cpY+3*dt*t2*cpY2+t3*toY);return path}exports.__esModule=!0,exports.default=bezierCurveTo},{}],161:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _utils=require("../../utils"),_const=require("../../const"),_ObjectRenderer2=require("../../renderers/webgl/utils/ObjectRenderer"),_ObjectRenderer3=_interopRequireDefault(_ObjectRenderer2),_WebGLRenderer=require("../../renderers/webgl/WebGLRenderer"),_WebGLRenderer2=_interopRequireDefault(_WebGLRenderer),_WebGLGraphicsData=require("./WebGLGraphicsData"),_WebGLGraphicsData2=_interopRequireDefault(_WebGLGraphicsData),_PrimitiveShader=require("./shaders/PrimitiveShader"),_PrimitiveShader2=_interopRequireDefault(_PrimitiveShader),_buildPoly=require("./utils/buildPoly"),_buildPoly2=_interopRequireDefault(_buildPoly),_buildRectangle=require("./utils/buildRectangle"),_buildRectangle2=_interopRequireDefault(_buildRectangle),_buildRoundedRectangle=require("./utils/buildRoundedRectangle"),_buildRoundedRectangle2=_interopRequireDefault(_buildRoundedRectangle),_buildCircle=require("./utils/buildCircle"),_buildCircle2=_interopRequireDefault(_buildCircle),GraphicsRenderer=function(_ObjectRenderer){function GraphicsRenderer(renderer){_classCallCheck(this,GraphicsRenderer);var _this=_possibleConstructorReturn(this,_ObjectRenderer.call(this,renderer));return _this.graphicsDataPool=[],_this.primitiveShader=null,_this.gl=renderer.gl,_this.CONTEXT_UID=0,_this}return _inherits(GraphicsRenderer,_ObjectRenderer),GraphicsRenderer.prototype.onContextChange=function(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.primitiveShader=new _PrimitiveShader2.default(this.gl)},GraphicsRenderer.prototype.destroy=function(){_ObjectRenderer3.default.prototype.destroy.call(this);for(var i=0;i<this.graphicsDataPool.length;++i)this.graphicsDataPool[i].destroy();this.graphicsDataPool=null},GraphicsRenderer.prototype.render=function(graphics){var renderer=this.renderer,gl=renderer.gl,webGLData=void 0,webGL=graphics._webGL[this.CONTEXT_UID];webGL&&graphics.dirty===webGL.dirty||(this.updateGraphics(graphics),webGL=graphics._webGL[this.CONTEXT_UID]);var shader=this.primitiveShader;renderer.bindShader(shader),renderer.state.setBlendMode(graphics.blendMode);for(var i=0,n=webGL.data.length;i<n;i++){webGLData=webGL.data[i];var shaderTemp=webGLData.shader;renderer.bindShader(shaderTemp),shaderTemp.uniforms.translationMatrix=graphics.transform.worldTransform.toArray(!0),shaderTemp.uniforms.tint=(0,_utils.hex2rgb)(graphics.tint),shaderTemp.uniforms.alpha=graphics.worldAlpha,renderer.bindVao(webGLData.vao),webGLData.nativeLines?gl.drawArrays(gl.LINES,0,webGLData.points.length/6):webGLData.vao.draw(gl.TRIANGLE_STRIP,webGLData.indices.length)}},GraphicsRenderer.prototype.updateGraphics=function(graphics){var gl=this.renderer.gl,webGL=graphics._webGL[this.CONTEXT_UID];if(webGL||(webGL=graphics._webGL[this.CONTEXT_UID]={lastIndex:0,data:[],gl:gl,clearDirty:-1,dirty:-1}),webGL.dirty=graphics.dirty,graphics.clearDirty!==webGL.clearDirty){webGL.clearDirty=graphics.clearDirty;for(var i=0;i<webGL.data.length;i++)this.graphicsDataPool.push(webGL.data[i]);webGL.data.length=0,webGL.lastIndex=0}for(var webGLData=void 0,webGLDataNativeLines=void 0,_i=webGL.lastIndex;_i<graphics.graphicsData.length;_i++){var data=graphics.graphicsData[_i];webGLData=this.getWebGLData(webGL,0),data.nativeLines&&data.lineWidth&&(webGLDataNativeLines=this.getWebGLData(webGL,0,!0),webGL.lastIndex++),data.type===_const.SHAPES.POLY&&(0,_buildPoly2.default)(data,webGLData,webGLDataNativeLines),data.type===_const.SHAPES.RECT?(0,_buildRectangle2.default)(data,webGLData,webGLDataNativeLines):data.type===_const.SHAPES.CIRC||data.type===_const.SHAPES.ELIP?(0,_buildCircle2.default)(data,webGLData,webGLDataNativeLines):data.type===_const.SHAPES.RREC&&(0,_buildRoundedRectangle2.default)(data,webGLData,webGLDataNativeLines),webGL.lastIndex++}this.renderer.bindVao(null);for(var _i2=0;_i2<webGL.data.length;_i2++)webGLData=webGL.data[_i2],webGLData.dirty&&webGLData.upload()},GraphicsRenderer.prototype.getWebGLData=function(gl,type,nativeLines){var webGLData=gl.data[gl.data.length-1];return(!webGLData||webGLData.nativeLines!==nativeLines||webGLData.points.length>32e4)&&(webGLData=this.graphicsDataPool.pop()||new _WebGLGraphicsData2.default(this.renderer.gl,this.primitiveShader,this.renderer.state.attribsState),webGLData.nativeLines=nativeLines,webGLData.reset(type),gl.data.push(webGLData)),webGLData.dirty=!0,webGLData},GraphicsRenderer}(_ObjectRenderer3.default);exports.default=GraphicsRenderer,_WebGLRenderer2.default.registerPlugin("graphics",GraphicsRenderer)},{"../../const":150,"../../renderers/webgl/WebGLRenderer":188,"../../renderers/webgl/utils/ObjectRenderer":198,"../../utils":229,"./WebGLGraphicsData":162,"./shaders/PrimitiveShader":163,"./utils/buildCircle":164,"./utils/buildPoly":166,"./utils/buildRectangle":167,"./utils/buildRoundedRectangle":168}],162:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _pixiGlCore=require("pixi-gl-core"),_pixiGlCore2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_pixiGlCore),WebGLGraphicsData=function(){function WebGLGraphicsData(gl,shader,attribsState){_classCallCheck(this,WebGLGraphicsData),this.gl=gl,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl),this.indexBuffer=_pixiGlCore2.default.GLBuffer.createIndexBuffer(gl),this.dirty=!0,this.nativeLines=!1,this.glPoints=null,this.glIndices=null,this.shader=shader,this.vao=new _pixiGlCore2.default.VertexArrayObject(gl,attribsState).addIndex(this.indexBuffer).addAttribute(this.buffer,shader.attributes.aVertexPosition,gl.FLOAT,!1,24,0).addAttribute(this.buffer,shader.attributes.aColor,gl.FLOAT,!1,24,8)}return WebGLGraphicsData.prototype.reset=function(){this.points.length=0,this.indices.length=0},WebGLGraphicsData.prototype.upload=function(){this.glPoints=new Float32Array(this.points),this.buffer.upload(this.glPoints),this.glIndices=new Uint16Array(this.indices),this.indexBuffer.upload(this.glIndices),this.dirty=!1},WebGLGraphicsData.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.vao.destroy(),this.buffer.destroy(),this.indexBuffer.destroy(),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null},WebGLGraphicsData}();exports.default=WebGLGraphicsData},{"pixi-gl-core":133}],163:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _Shader2=require("../../../Shader"),_Shader3=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Shader2),PrimitiveShader=function(_Shader){function PrimitiveShader(gl){return _classCallCheck(this,PrimitiveShader),_possibleConstructorReturn(this,_Shader.call(this,gl,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n")))}return _inherits(PrimitiveShader,_Shader),PrimitiveShader}(_Shader3.default);exports.default=PrimitiveShader},{"../../../Shader":148}],164:[function(require,module,exports){"use strict";function buildCircle(graphicsData,webGLData,webGLDataNativeLines){var circleData=graphicsData.shape,x=circleData.x,y=circleData.y,width=void 0,height=void 0;if(graphicsData.type===_const.SHAPES.CIRC?(width=circleData.radius,height=circleData.radius):(width=circleData.width,height=circleData.height),0!==width&&0!==height){var totalSegs=Math.floor(30*Math.sqrt(circleData.radius))||Math.floor(15*Math.sqrt(circleData.width+circleData.height)),seg=2*Math.PI/totalSegs;if(graphicsData.fill){var color=(0,_utils.hex2rgb)(graphicsData.fillColor),alpha=graphicsData.fillAlpha,r=color[0]*alpha,g=color[1]*alpha,b=color[2]*alpha,verts=webGLData.points,indices=webGLData.indices,vecPos=verts.length/6;indices.push(vecPos);for(var i=0;i<totalSegs+1;i++)verts.push(x,y,r,g,b,alpha),verts.push(x+Math.sin(seg*i)*width,y+Math.cos(seg*i)*height,r,g,b,alpha),indices.push(vecPos++,vecPos++);indices.push(vecPos-1)}if(graphicsData.lineWidth){var tempPoints=graphicsData.points;graphicsData.points=[];for(var _i=0;_i<totalSegs;_i++)graphicsData.points.push(x+Math.sin(seg*-_i)*width,y+Math.cos(seg*-_i)*height);graphicsData.points.push(graphicsData.points[0],graphicsData.points[1]),(0,_buildLine2.default)(graphicsData,webGLData,webGLDataNativeLines),graphicsData.points=tempPoints}}}exports.__esModule=!0,exports.default=buildCircle;var _buildLine=require("./buildLine"),_buildLine2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_buildLine),_const=require("../../../const"),_utils=require("../../../utils")},{"../../../const":150,"../../../utils":229,"./buildLine":165}],165:[function(require,module,exports){"use strict";function buildLine(graphicsData,webGLData){var points=graphicsData.points;if(0!==points.length){var firstPoint=new _math.Point(points[0],points[1]),lastPoint=new _math.Point(points[points.length-2],points[points.length-1]);if(firstPoint.x===lastPoint.x&&firstPoint.y===lastPoint.y){points=points.slice(),points.pop(),points.pop(),lastPoint=new _math.Point(points[points.length-2],points[points.length-1]);var midPointX=lastPoint.x+.5*(firstPoint.x-lastPoint.x),midPointY=lastPoint.y+.5*(firstPoint.y-lastPoint.y);points.unshift(midPointX,midPointY),points.push(midPointX,midPointY)}var verts=webGLData.points,indices=webGLData.indices,length=points.length/2,indexCount=points.length,indexStart=verts.length/6,width=graphicsData.lineWidth/2,color=(0,_utils.hex2rgb)(graphicsData.lineColor),alpha=graphicsData.lineAlpha,r=color[0]*alpha,g=color[1]*alpha,b=color[2]*alpha,p1x=points[0],p1y=points[1],p2x=points[2],p2y=points[3],p3x=0,p3y=0,perpx=-(p1y-p2y),perpy=p1x-p2x,perp2x=0,perp2y=0,perp3x=0,perp3y=0,dist=Math.sqrt(perpx*perpx+perpy*perpy);perpx/=dist,perpy/=dist,perpx*=width,perpy*=width;var ratio=graphicsData.lineAlignment,r1=2*(1-ratio),r2=2*ratio;verts.push(p1x-perpx*r1,p1y-perpy*r1,r,g,b,alpha),verts.push(p1x+perpx*r2,p1y+perpy*r2,r,g,b,alpha);for(var i=1;i<length-1;++i){p1x=points[2*(i-1)],p1y=points[2*(i-1)+1],p2x=points[2*i],p2y=points[2*i+1],p3x=points[2*(i+1)],p3y=points[2*(i+1)+1],perpx=-(p1y-p2y),perpy=p1x-p2x,dist=Math.sqrt(perpx*perpx+perpy*perpy),perpx/=dist,perpy/=dist,perpx*=width,perpy*=width,perp2x=-(p2y-p3y),perp2y=p2x-p3x,dist=Math.sqrt(perp2x*perp2x+perp2y*perp2y),perp2x/=dist,perp2y/=dist,perp2x*=width,perp2y*=width;var a1=-perpy+p1y-(-perpy+p2y),b1=-perpx+p2x-(-perpx+p1x),c1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y),a2=-perp2y+p3y-(-perp2y+p2y),b2=-perp2x+p2x-(-perp2x+p3x),c2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y),denom=a1*b2-a2*b1;if(Math.abs(denom)<.1)denom+=10.1,verts.push(p2x-perpx*r1,p2y-perpy*r1,r,g,b,alpha),verts.push(p2x+perpx*r2,p2y+perpy*r2,r,g,b,alpha);else{var px=(b1*c2-b2*c1)/denom,py=(a2*c1-a1*c2)/denom;(px-p2x)*(px-p2x)+(py-p2y)*(py-p2y)>196*width*width?(perp3x=perpx-perp2x,perp3y=perpy-perp2y,dist=Math.sqrt(perp3x*perp3x+perp3y*perp3y),perp3x/=dist,perp3y/=dist,perp3x*=width,perp3y*=width,verts.push(p2x-perp3x*r1,p2y-perp3y*r1),verts.push(r,g,b,alpha),verts.push(p2x+perp3x*r2,p2y+perp3y*r2),verts.push(r,g,b,alpha),verts.push(p2x-perp3x*r2*r1,p2y-perp3y*r1),verts.push(r,g,b,alpha),indexCount++):(verts.push(p2x+(px-p2x)*r1,p2y+(py-p2y)*r1),verts.push(r,g,b,alpha),verts.push(p2x-(px-p2x)*r2,p2y-(py-p2y)*r2),verts.push(r,g,b,alpha))}}p1x=points[2*(length-2)],p1y=points[2*(length-2)+1],p2x=points[2*(length-1)],p2y=points[2*(length-1)+1],perpx=-(p1y-p2y),perpy=p1x-p2x,dist=Math.sqrt(perpx*perpx+perpy*perpy),perpx/=dist,perpy/=dist,perpx*=width,perpy*=width,verts.push(p2x-perpx*r1,p2y-perpy*r1),verts.push(r,g,b,alpha),verts.push(p2x+perpx*r2,p2y+perpy*r2),verts.push(r,g,b,alpha),indices.push(indexStart);for(var _i=0;_i<indexCount;++_i)indices.push(indexStart++);indices.push(indexStart-1)}}function buildNativeLine(graphicsData,webGLData){var i=0,points=graphicsData.points;if(0!==points.length){var verts=webGLData.points,length=points.length/2,color=(0,_utils.hex2rgb)(graphicsData.lineColor),alpha=graphicsData.lineAlpha,r=color[0]*alpha,g=color[1]*alpha,b=color[2]*alpha;for(i=1;i<length;i++){var p1x=points[2*(i-1)],p1y=points[2*(i-1)+1],p2x=points[2*i],p2y=points[2*i+1];verts.push(p1x,p1y),verts.push(r,g,b,alpha),verts.push(p2x,p2y),verts.push(r,g,b,alpha)}}}exports.__esModule=!0,exports.default=function(graphicsData,webGLData,webGLDataNativeLines){graphicsData.nativeLines?buildNativeLine(graphicsData,webGLDataNativeLines):buildLine(graphicsData,webGLData)};var _math=require("../../../math"),_utils=require("../../../utils")},{"../../../math":174,"../../../utils":229}],166:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function buildPoly(graphicsData,webGLData,webGLDataNativeLines){graphicsData.points=graphicsData.shape.points.slice();var points=graphicsData.points;if(graphicsData.fill&&points.length>=6){for(var holeArray=[],holes=graphicsData.holes,i=0;i<holes.length;i++){var hole=holes[i];holeArray.push(points.length/2),points=points.concat(hole.points)}var verts=webGLData.points,indices=webGLData.indices,length=points.length/2,color=(0,_utils.hex2rgb)(graphicsData.fillColor),alpha=graphicsData.fillAlpha,r=color[0]*alpha,g=color[1]*alpha,b=color[2]*alpha,triangles=(0,_earcut2.default)(points,holeArray,2);if(!triangles)return;for(var vertPos=verts.length/6,_i=0;_i<triangles.length;_i+=3)indices.push(triangles[_i]+vertPos),indices.push(triangles[_i]+vertPos),indices.push(triangles[_i+1]+vertPos),indices.push(triangles[_i+2]+vertPos),indices.push(triangles[_i+2]+vertPos);for(var _i2=0;_i2<length;_i2++)verts.push(points[2*_i2],points[2*_i2+1],r,g,b,alpha)}graphicsData.lineWidth>0&&(0,_buildLine2.default)(graphicsData,webGLData,webGLDataNativeLines)}exports.__esModule=!0,exports.default=buildPoly;var _buildLine=require("./buildLine"),_buildLine2=_interopRequireDefault(_buildLine),_utils=require("../../../utils"),_earcut=require("earcut"),_earcut2=_interopRequireDefault(_earcut)},{"../../../utils":229,"./buildLine":165,earcut:116}],167:[function(require,module,exports){"use strict";function buildRectangle(graphicsData,webGLData,webGLDataNativeLines){var rectData=graphicsData.shape,x=rectData.x,y=rectData.y,width=rectData.width,height=rectData.height;if(graphicsData.fill){var color=(0,_utils.hex2rgb)(graphicsData.fillColor),alpha=graphicsData.fillAlpha,r=color[0]*alpha,g=color[1]*alpha,b=color[2]*alpha,verts=webGLData.points,indices=webGLData.indices,vertPos=verts.length/6;verts.push(x,y),verts.push(r,g,b,alpha),verts.push(x+width,y),verts.push(r,g,b,alpha),verts.push(x,y+height),verts.push(r,g,b,alpha),verts.push(x+width,y+height),verts.push(r,g,b,alpha),indices.push(vertPos,vertPos,vertPos+1,vertPos+2,vertPos+3,vertPos+3)}if(graphicsData.lineWidth){var tempPoints=graphicsData.points;graphicsData.points=[x,y,x+width,y,x+width,y+height,x,y+height,x,y],(0,_buildLine2.default)(graphicsData,webGLData,webGLDataNativeLines),graphicsData.points=tempPoints}}exports.__esModule=!0,exports.default=buildRectangle;var _buildLine=require("./buildLine"),_buildLine2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_buildLine),_utils=require("../../../utils")},{"../../../utils":229,"./buildLine":165}],168:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function buildRoundedRectangle(graphicsData,webGLData,webGLDataNativeLines){var rrectData=graphicsData.shape,x=rrectData.x,y=rrectData.y,width=rrectData.width,height=rrectData.height,radius=rrectData.radius,recPoints=[];if(recPoints.push(x,y+radius),quadraticBezierCurve(x,y+height-radius,x,y+height,x+radius,y+height,recPoints),quadraticBezierCurve(x+width-radius,y+height,x+width,y+height,x+width,y+height-radius,recPoints),quadraticBezierCurve(x+width,y+radius,x+width,y,x+width-radius,y,recPoints),quadraticBezierCurve(x+radius,y,x,y,x,y+radius+1e-10,recPoints),graphicsData.fill){for(var color=(0,_utils.hex2rgb)(graphicsData.fillColor),alpha=graphicsData.fillAlpha,r=color[0]*alpha,g=color[1]*alpha,b=color[2]*alpha,verts=webGLData.points,indices=webGLData.indices,vecPos=verts.length/6,triangles=(0,_earcut2.default)(recPoints,null,2),i=0,j=triangles.length;i<j;i+=3)indices.push(triangles[i]+vecPos),indices.push(triangles[i]+vecPos),indices.push(triangles[i+1]+vecPos),indices.push(triangles[i+2]+vecPos),indices.push(triangles[i+2]+vecPos);for(var _i=0,_j=recPoints.length;_i<_j;_i++)verts.push(recPoints[_i],recPoints[++_i],r,g,b,alpha)}if(graphicsData.lineWidth){var tempPoints=graphicsData.points;graphicsData.points=recPoints,(0,_buildLine2.default)(graphicsData,webGLData,webGLDataNativeLines),graphicsData.points=tempPoints}}function getPt(n1,n2,perc){return n1+(n2-n1)*perc}function quadraticBezierCurve(fromX,fromY,cpX,cpY,toX,toY){for(var out=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],points=out,xa=0,ya=0,xb=0,yb=0,x=0,y=0,i=0,j=0;i<=20;++i)j=i/20,xa=getPt(fromX,cpX,j),ya=getPt(fromY,cpY,j),xb=getPt(cpX,toX,j),yb=getPt(cpY,toY,j),x=getPt(xa,xb,j),y=getPt(ya,yb,j),points.push(x,y);return points}exports.__esModule=!0,exports.default=buildRoundedRectangle;var _earcut=require("earcut"),_earcut2=_interopRequireDefault(_earcut),_buildLine=require("./buildLine"),_buildLine2=_interopRequireDefault(_buildLine),_utils=require("../../../utils")},{"../../../utils":229,"./buildLine":165,earcut:116}],169:[function(require,module,exports){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.__esModule=!0,exports.autoDetectRenderer=exports.Application=exports.Filter=exports.SpriteMaskFilter=exports.Quad=exports.RenderTarget=exports.ObjectRenderer=exports.WebGLManager=exports.Shader=exports.CanvasRenderTarget=exports.TextureUvs=exports.VideoBaseTexture=exports.BaseRenderTexture=exports.RenderTexture=exports.BaseTexture=exports.TextureMatrix=exports.Texture=exports.Spritesheet=exports.CanvasGraphicsRenderer=exports.GraphicsRenderer=exports.GraphicsData=exports.Graphics=exports.TextMetrics=exports.TextStyle=exports.Text=exports.SpriteRenderer=exports.CanvasTinter=exports.CanvasSpriteRenderer=exports.Sprite=exports.TransformBase=exports.TransformStatic=exports.Transform=exports.Container=exports.DisplayObject=exports.Bounds=exports.glCore=exports.WebGLRenderer=exports.CanvasRenderer=exports.ticker=exports.utils=exports.settings=void 0;var _const=require("./const");Object.keys(_const).forEach(function(key){"default"!==key&&"__esModule"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _const[key]}})});var _math=require("./math");Object.keys(_math).forEach(function(key){"default"!==key&&"__esModule"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _math[key]}})});var _pixiGlCore=require("pixi-gl-core");Object.defineProperty(exports,"glCore",{enumerable:!0,get:function(){return _interopRequireDefault(_pixiGlCore).default}});var _Bounds=require("./display/Bounds");Object.defineProperty(exports,"Bounds",{enumerable:!0,get:function(){return _interopRequireDefault(_Bounds).default}});var _DisplayObject=require("./display/DisplayObject");Object.defineProperty(exports,"DisplayObject",{enumerable:!0,get:function(){return _interopRequireDefault(_DisplayObject).default}});var _Container=require("./display/Container");Object.defineProperty(exports,"Container",{enumerable:!0,get:function(){return _interopRequireDefault(_Container).default}});var _Transform=require("./display/Transform");Object.defineProperty(exports,"Transform",{enumerable:!0,get:function(){return _interopRequireDefault(_Transform).default}});var _TransformStatic=require("./display/TransformStatic");Object.defineProperty(exports,"TransformStatic",{enumerable:!0,get:function(){return _interopRequireDefault(_TransformStatic).default}});var _TransformBase=require("./display/TransformBase");Object.defineProperty(exports,"TransformBase",{enumerable:!0,get:function(){return _interopRequireDefault(_TransformBase).default}});var _Sprite=require("./sprites/Sprite");Object.defineProperty(exports,"Sprite",{enumerable:!0,get:function(){return _interopRequireDefault(_Sprite).default}});var _CanvasSpriteRenderer=require("./sprites/canvas/CanvasSpriteRenderer");Object.defineProperty(exports,"CanvasSpriteRenderer",{enumerable:!0,get:function(){return _interopRequireDefault(_CanvasSpriteRenderer).default}});var _CanvasTinter=require("./sprites/canvas/CanvasTinter");Object.defineProperty(exports,"CanvasTinter",{enumerable:!0,get:function(){return _interopRequireDefault(_CanvasTinter).default}});var _SpriteRenderer=require("./sprites/webgl/SpriteRenderer");Object.defineProperty(exports,"SpriteRenderer",{enumerable:!0,get:function(){return _interopRequireDefault(_SpriteRenderer).default}});var _Text=require("./text/Text");Object.defineProperty(exports,"Text",{enumerable:!0,get:function(){return _interopRequireDefault(_Text).default}});var _TextStyle=require("./text/TextStyle");Object.defineProperty(exports,"TextStyle",{enumerable:!0,get:function(){return _interopRequireDefault(_TextStyle).default}});var _TextMetrics=require("./text/TextMetrics");Object.defineProperty(exports,"TextMetrics",{enumerable:!0,get:function(){return _interopRequireDefault(_TextMetrics).default}});var _Graphics=require("./graphics/Graphics");Object.defineProperty(exports,"Graphics",{enumerable:!0,get:function(){return _interopRequireDefault(_Graphics).default}});var _GraphicsData=require("./graphics/GraphicsData");Object.defineProperty(exports,"GraphicsData",{enumerable:!0,get:function(){return _interopRequireDefault(_GraphicsData).default}});var _GraphicsRenderer=require("./graphics/webgl/GraphicsRenderer");Object.defineProperty(exports,"GraphicsRenderer",{enumerable:!0,get:function(){return _interopRequireDefault(_GraphicsRenderer).default}});var _CanvasGraphicsRenderer=require("./graphics/canvas/CanvasGraphicsRenderer");Object.defineProperty(exports,"CanvasGraphicsRenderer",{enumerable:!0,get:function(){return _interopRequireDefault(_CanvasGraphicsRenderer).default}});var _Spritesheet=require("./textures/Spritesheet");Object.defineProperty(exports,"Spritesheet",{enumerable:!0,get:function(){return _interopRequireDefault(_Spritesheet).default}});var _Texture=require("./textures/Texture");Object.defineProperty(exports,"Texture",{enumerable:!0,get:function(){return _interopRequireDefault(_Texture).default}});var _TextureMatrix=require("./textures/TextureMatrix");Object.defineProperty(exports,"TextureMatrix",{enumerable:!0,get:function(){return _interopRequireDefault(_TextureMatrix).default}});var _BaseTexture=require("./textures/BaseTexture");Object.defineProperty(exports,"BaseTexture",{enumerable:!0,get:function(){return _interopRequireDefault(_BaseTexture).default}});var _RenderTexture=require("./textures/RenderTexture");Object.defineProperty(exports,"RenderTexture",{enumerable:!0,get:function(){return _interopRequireDefault(_RenderTexture).default}});var _BaseRenderTexture=require("./textures/BaseRenderTexture");Object.defineProperty(exports,"BaseRenderTexture",{enumerable:!0,get:function(){return _interopRequireDefault(_BaseRenderTexture).default}});var _VideoBaseTexture=require("./textures/VideoBaseTexture");Object.defineProperty(exports,"VideoBaseTexture",{enumerable:!0,get:function(){return _interopRequireDefault(_VideoBaseTexture).default}});var _TextureUvs=require("./textures/TextureUvs");Object.defineProperty(exports,"TextureUvs",{enumerable:!0,get:function(){return _interopRequireDefault(_TextureUvs).default}});var _CanvasRenderTarget=require("./renderers/canvas/utils/CanvasRenderTarget");Object.defineProperty(exports,"CanvasRenderTarget",{enumerable:!0,get:function(){return _interopRequireDefault(_CanvasRenderTarget).default}});var _Shader=require("./Shader");Object.defineProperty(exports,"Shader",{enumerable:!0,get:function(){return _interopRequireDefault(_Shader).default}});var _WebGLManager=require("./renderers/webgl/managers/WebGLManager");Object.defineProperty(exports,"WebGLManager",{enumerable:!0,get:function(){return _interopRequireDefault(_WebGLManager).default}});var _ObjectRenderer=require("./renderers/webgl/utils/ObjectRenderer");Object.defineProperty(exports,"ObjectRenderer",{enumerable:!0,get:function(){return _interopRequireDefault(_ObjectRenderer).default}});var _RenderTarget=require("./renderers/webgl/utils/RenderTarget");Object.defineProperty(exports,"RenderTarget",{enumerable:!0,get:function(){return _interopRequireDefault(_RenderTarget).default}});var _Quad=require("./renderers/webgl/utils/Quad");Object.defineProperty(exports,"Quad",{enumerable:!0,get:function(){return _interopRequireDefault(_Quad).default}});var _SpriteMaskFilter=require("./renderers/webgl/filters/spriteMask/SpriteMaskFilter");Object.defineProperty(exports,"SpriteMaskFilter",{enumerable:!0,get:function(){return _interopRequireDefault(_SpriteMaskFilter).default}});var _Filter=require("./renderers/webgl/filters/Filter");Object.defineProperty(exports,"Filter",{enumerable:!0,get:function(){return _interopRequireDefault(_Filter).default}});var _Application=require("./Application");Object.defineProperty(exports,"Application",{enumerable:!0,get:function(){return _interopRequireDefault(_Application).default}});var _autoDetectRenderer=require("./autoDetectRenderer");Object.defineProperty(exports,"autoDetectRenderer",{enumerable:!0,get:function(){return _autoDetectRenderer.autoDetectRenderer}});var _utils=require("./utils"),utils=_interopRequireWildcard(_utils),_ticker=require("./ticker"),ticker=_interopRequireWildcard(_ticker),_settings=require("./settings"),_settings2=_interopRequireDefault(_settings),_CanvasRenderer=require("./renderers/canvas/CanvasRenderer"),_CanvasRenderer2=_interopRequireDefault(_CanvasRenderer),_WebGLRenderer=require("./renderers/webgl/WebGLRenderer"),_WebGLRenderer2=_interopRequireDefault(_WebGLRenderer);exports.settings=_settings2.default,exports.utils=utils,exports.ticker=ticker,exports.CanvasRenderer=_CanvasRenderer2.default,exports.WebGLRenderer=_WebGLRenderer2.default},{"./Application":147,"./Shader":148,"./autoDetectRenderer":149,"./const":150,"./display/Bounds":151,"./display/Container":152,"./display/DisplayObject":153,"./display/Transform":154,"./display/TransformBase":155,"./display/TransformStatic":156,"./graphics/Graphics":157,"./graphics/GraphicsData":158,"./graphics/canvas/CanvasGraphicsRenderer":159,"./graphics/webgl/GraphicsRenderer":161,"./math":174,"./renderers/canvas/CanvasRenderer":181,"./renderers/canvas/utils/CanvasRenderTarget":183,"./renderers/webgl/WebGLRenderer":188,"./renderers/webgl/filters/Filter":190,"./renderers/webgl/filters/spriteMask/SpriteMaskFilter":193,"./renderers/webgl/managers/WebGLManager":197,"./renderers/webgl/utils/ObjectRenderer":198,"./renderers/webgl/utils/Quad":199,"./renderers/webgl/utils/RenderTarget":200,"./settings":205,"./sprites/Sprite":206,"./sprites/canvas/CanvasSpriteRenderer":207,"./sprites/canvas/CanvasTinter":208,"./sprites/webgl/SpriteRenderer":210,"./text/Text":212,"./text/TextMetrics":213,"./text/TextStyle":214,"./textures/BaseRenderTexture":215,"./textures/BaseTexture":216,"./textures/RenderTexture":217,"./textures/Spritesheet":218,"./textures/Texture":219,"./textures/TextureMatrix":220,"./textures/TextureUvs":221,"./textures/VideoBaseTexture":222,"./ticker":225,"./utils":229,"pixi-gl-core":133}],170:[function(require,module,exports){"use strict";function signum(x){return x<0?-1:x>0?1:0}exports.__esModule=!0;var _Matrix=require("./Matrix"),_Matrix2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Matrix),ux=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],uy=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],vx=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],vy=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],tempMatrices=[],mul=[];!function(){for(var i=0;i<16;i++){var row=[];mul.push(row);for(var j=0;j<16;j++)for(var _ux=signum(ux[i]*ux[j]+vx[i]*uy[j]),_uy=signum(uy[i]*ux[j]+vy[i]*uy[j]),_vx=signum(ux[i]*vx[j]+vx[i]*vy[j]),_vy=signum(uy[i]*vx[j]+vy[i]*vy[j]),k=0;k<16;k++)if(ux[k]===_ux&&uy[k]===_uy&&vx[k]===_vx&&vy[k]===_vy){row.push(k);break}}for(var _i=0;_i<16;_i++){var mat=new _Matrix2.default;mat.set(ux[_i],uy[_i],vx[_i],vy[_i],0,0),tempMatrices.push(mat)}}();var GroupD8={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(ind){return ux[ind]},uY:function(ind){return uy[ind]},vX:function(ind){return vx[ind]},vY:function(ind){return vy[ind]},inv:function(rotation){return 8&rotation?15&rotation:7&-rotation},add:function(rotationSecond,rotationFirst){return mul[rotationSecond][rotationFirst]},sub:function(rotationSecond,rotationFirst){return mul[rotationSecond][GroupD8.inv(rotationFirst)]},rotate180:function(rotation){return 4^rotation},isVertical:function(rotation){return 2==(3&rotation)},byDirection:function(dx,dy){return 2*Math.abs(dx)<=Math.abs(dy)?dy>=0?GroupD8.S:GroupD8.N:2*Math.abs(dy)<=Math.abs(dx)?dx>0?GroupD8.E:GroupD8.W:dy>0?dx>0?GroupD8.SE:GroupD8.SW:dx>0?GroupD8.NE:GroupD8.NW},matrixAppendRotationInv:function(matrix,rotation){
var tx=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,ty=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,mat=tempMatrices[GroupD8.inv(rotation)];mat.tx=tx,mat.ty=ty,matrix.append(mat)}};exports.default=GroupD8},{"./Matrix":171}],171:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Point=require("./Point"),_Point2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Point),_const=require("../const"),Matrix=function(){function Matrix(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,tx=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,ty=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;_classCallCheck(this,Matrix),this.a=a,this.b=b,this.c=c,this.d=d,this.tx=tx,this.ty=ty,this.array=null}return Matrix.prototype.fromArray=function(array){this.a=array[0],this.b=array[1],this.c=array[3],this.d=array[4],this.tx=array[2],this.ty=array[5]},Matrix.prototype.set=function(a,b,c,d,tx,ty){return this.a=a,this.b=b,this.c=c,this.d=d,this.tx=tx,this.ty=ty,this},Matrix.prototype.toArray=function(transpose,out){this.array||(this.array=new Float32Array(9));var array=out||this.array;return transpose?(array[0]=this.a,array[1]=this.b,array[2]=0,array[3]=this.c,array[4]=this.d,array[5]=0,array[6]=this.tx,array[7]=this.ty,array[8]=1):(array[0]=this.a,array[1]=this.c,array[2]=this.tx,array[3]=this.b,array[4]=this.d,array[5]=this.ty,array[6]=0,array[7]=0,array[8]=1),array},Matrix.prototype.apply=function(pos,newPos){newPos=newPos||new _Point2.default;var x=pos.x,y=pos.y;return newPos.x=this.a*x+this.c*y+this.tx,newPos.y=this.b*x+this.d*y+this.ty,newPos},Matrix.prototype.applyInverse=function(pos,newPos){newPos=newPos||new _Point2.default;var id=1/(this.a*this.d+this.c*-this.b),x=pos.x,y=pos.y;return newPos.x=this.d*id*x+-this.c*id*y+(this.ty*this.c-this.tx*this.d)*id,newPos.y=this.a*id*y+-this.b*id*x+(-this.ty*this.a+this.tx*this.b)*id,newPos},Matrix.prototype.translate=function(x,y){return this.tx+=x,this.ty+=y,this},Matrix.prototype.scale=function(x,y){return this.a*=x,this.d*=y,this.c*=x,this.b*=y,this.tx*=x,this.ty*=y,this},Matrix.prototype.rotate=function(angle){var cos=Math.cos(angle),sin=Math.sin(angle),a1=this.a,c1=this.c,tx1=this.tx;return this.a=a1*cos-this.b*sin,this.b=a1*sin+this.b*cos,this.c=c1*cos-this.d*sin,this.d=c1*sin+this.d*cos,this.tx=tx1*cos-this.ty*sin,this.ty=tx1*sin+this.ty*cos,this},Matrix.prototype.append=function(matrix){var a1=this.a,b1=this.b,c1=this.c,d1=this.d;return this.a=matrix.a*a1+matrix.b*c1,this.b=matrix.a*b1+matrix.b*d1,this.c=matrix.c*a1+matrix.d*c1,this.d=matrix.c*b1+matrix.d*d1,this.tx=matrix.tx*a1+matrix.ty*c1+this.tx,this.ty=matrix.tx*b1+matrix.ty*d1+this.ty,this},Matrix.prototype.setTransform=function(x,y,pivotX,pivotY,scaleX,scaleY,rotation,skewX,skewY){return this.a=Math.cos(rotation+skewY)*scaleX,this.b=Math.sin(rotation+skewY)*scaleX,this.c=-Math.sin(rotation-skewX)*scaleY,this.d=Math.cos(rotation-skewX)*scaleY,this.tx=x-(pivotX*this.a+pivotY*this.c),this.ty=y-(pivotX*this.b+pivotY*this.d),this},Matrix.prototype.prepend=function(matrix){var tx1=this.tx;if(1!==matrix.a||0!==matrix.b||0!==matrix.c||1!==matrix.d){var a1=this.a,c1=this.c;this.a=a1*matrix.a+this.b*matrix.c,this.b=a1*matrix.b+this.b*matrix.d,this.c=c1*matrix.a+this.d*matrix.c,this.d=c1*matrix.b+this.d*matrix.d}return this.tx=tx1*matrix.a+this.ty*matrix.c+matrix.tx,this.ty=tx1*matrix.b+this.ty*matrix.d+matrix.ty,this},Matrix.prototype.decompose=function(transform){var a=this.a,b=this.b,c=this.c,d=this.d,skewX=-Math.atan2(-c,d),skewY=Math.atan2(b,a),delta=Math.abs(skewX+skewY);return delta<1e-5||Math.abs(_const.PI_2-delta)<1e-5?(transform.rotation=skewY,a<0&&d>=0&&(transform.rotation+=transform.rotation<=0?Math.PI:-Math.PI),transform.skew.x=transform.skew.y=0):(transform.rotation=0,transform.skew.x=skewX,transform.skew.y=skewY),transform.scale.x=Math.sqrt(a*a+b*b),transform.scale.y=Math.sqrt(c*c+d*d),transform.position.x=this.tx,transform.position.y=this.ty,transform},Matrix.prototype.invert=function(){var a1=this.a,b1=this.b,c1=this.c,d1=this.d,tx1=this.tx,n=a1*d1-b1*c1;return this.a=d1/n,this.b=-b1/n,this.c=-c1/n,this.d=a1/n,this.tx=(c1*this.ty-d1*tx1)/n,this.ty=-(a1*this.ty-b1*tx1)/n,this},Matrix.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Matrix.prototype.clone=function(){var matrix=new Matrix;return matrix.a=this.a,matrix.b=this.b,matrix.c=this.c,matrix.d=this.d,matrix.tx=this.tx,matrix.ty=this.ty,matrix},Matrix.prototype.copy=function(matrix){return matrix.a=this.a,matrix.b=this.b,matrix.c=this.c,matrix.d=this.d,matrix.tx=this.tx,matrix.ty=this.ty,matrix},_createClass(Matrix,null,[{key:"IDENTITY",get:function(){return new Matrix}},{key:"TEMP_MATRIX",get:function(){return new Matrix}}]),Matrix}();exports.default=Matrix},{"../const":150,"./Point":173}],172:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),ObservablePoint=function(){function ObservablePoint(cb,scope){var x=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,y=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,ObservablePoint),this._x=x,this._y=y,this.cb=cb,this.scope=scope}return ObservablePoint.prototype.clone=function(){var cb=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,scope=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new ObservablePoint(cb||this.cb,scope||this.scope,this._x,this._y)},ObservablePoint.prototype.set=function(x,y){var _x=x||0,_y=y||(0!==y?_x:0);this._x===_x&&this._y===_y||(this._x=_x,this._y=_y,this.cb.call(this.scope))},ObservablePoint.prototype.copy=function(point){this._x===point.x&&this._y===point.y||(this._x=point.x,this._y=point.y,this.cb.call(this.scope))},ObservablePoint.prototype.equals=function(p){return p.x===this._x&&p.y===this._y},_createClass(ObservablePoint,[{key:"x",get:function(){return this._x},set:function(value){this._x!==value&&(this._x=value,this.cb.call(this.scope))}},{key:"y",get:function(){return this._y},set:function(value){this._y!==value&&(this._y=value,this.cb.call(this.scope))}}]),ObservablePoint}();exports.default=ObservablePoint},{}],173:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var Point=function(){function Point(){var x=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;_classCallCheck(this,Point),this.x=x,this.y=y}return Point.prototype.clone=function(){return new Point(this.x,this.y)},Point.prototype.copy=function(p){this.set(p.x,p.y)},Point.prototype.equals=function(p){return p.x===this.x&&p.y===this.y},Point.prototype.set=function(x,y){this.x=x||0,this.y=y||(0!==y?this.x:0)},Point}();exports.default=Point},{}],174:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.__esModule=!0;var _Point=require("./Point");Object.defineProperty(exports,"Point",{enumerable:!0,get:function(){return _interopRequireDefault(_Point).default}});var _ObservablePoint=require("./ObservablePoint");Object.defineProperty(exports,"ObservablePoint",{enumerable:!0,get:function(){return _interopRequireDefault(_ObservablePoint).default}});var _Matrix=require("./Matrix");Object.defineProperty(exports,"Matrix",{enumerable:!0,get:function(){return _interopRequireDefault(_Matrix).default}});var _GroupD=require("./GroupD8");Object.defineProperty(exports,"GroupD8",{enumerable:!0,get:function(){return _interopRequireDefault(_GroupD).default}});var _Circle=require("./shapes/Circle");Object.defineProperty(exports,"Circle",{enumerable:!0,get:function(){return _interopRequireDefault(_Circle).default}});var _Ellipse=require("./shapes/Ellipse");Object.defineProperty(exports,"Ellipse",{enumerable:!0,get:function(){return _interopRequireDefault(_Ellipse).default}});var _Polygon=require("./shapes/Polygon");Object.defineProperty(exports,"Polygon",{enumerable:!0,get:function(){return _interopRequireDefault(_Polygon).default}});var _Rectangle=require("./shapes/Rectangle");Object.defineProperty(exports,"Rectangle",{enumerable:!0,get:function(){return _interopRequireDefault(_Rectangle).default}});var _RoundedRectangle=require("./shapes/RoundedRectangle");Object.defineProperty(exports,"RoundedRectangle",{enumerable:!0,get:function(){return _interopRequireDefault(_RoundedRectangle).default}})},{"./GroupD8":170,"./Matrix":171,"./ObservablePoint":172,"./Point":173,"./shapes/Circle":175,"./shapes/Ellipse":176,"./shapes/Polygon":177,"./shapes/Rectangle":178,"./shapes/RoundedRectangle":179}],175:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Rectangle=require("./Rectangle"),_Rectangle2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Rectangle),_const=require("../../const"),Circle=function(){function Circle(){var x=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,radius=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;_classCallCheck(this,Circle),this.x=x,this.y=y,this.radius=radius,this.type=_const.SHAPES.CIRC}return Circle.prototype.clone=function(){return new Circle(this.x,this.y,this.radius)},Circle.prototype.contains=function(x,y){if(this.radius<=0)return!1;var r2=this.radius*this.radius,dx=this.x-x,dy=this.y-y;return dx*=dx,dy*=dy,dx+dy<=r2},Circle.prototype.getBounds=function(){return new _Rectangle2.default(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},Circle}();exports.default=Circle},{"../../const":150,"./Rectangle":178}],176:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Rectangle=require("./Rectangle"),_Rectangle2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Rectangle),_const=require("../../const"),Ellipse=function(){function Ellipse(){var x=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,width=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,height=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,Ellipse),this.x=x,this.y=y,this.width=width,this.height=height,this.type=_const.SHAPES.ELIP}return Ellipse.prototype.clone=function(){return new Ellipse(this.x,this.y,this.width,this.height)},Ellipse.prototype.contains=function(x,y){if(this.width<=0||this.height<=0)return!1;var normx=(x-this.x)/this.width,normy=(y-this.y)/this.height;return normx*=normx,normy*=normy,normx+normy<=1},Ellipse.prototype.getBounds=function(){return new _Rectangle2.default(this.x-this.width,this.y-this.height,this.width,this.height)},Ellipse}();exports.default=Ellipse},{"../../const":150,"./Rectangle":178}],177:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _Point=require("../Point"),_Point2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Point),_const=require("../../const"),Polygon=function(){function Polygon(){for(var _len=arguments.length,points=Array(_len),_key=0;_key<_len;_key++)points[_key]=arguments[_key];if(_classCallCheck(this,Polygon),Array.isArray(points[0])&&(points=points[0]),points[0]instanceof _Point2.default){for(var p=[],i=0,il=points.length;i<il;i++)p.push(points[i].x,points[i].y);points=p}this.closed=!0,this.points=points,this.type=_const.SHAPES.POLY}return Polygon.prototype.clone=function(){return new Polygon(this.points.slice())},Polygon.prototype.close=function(){var points=this.points;points[0]===points[points.length-2]&&points[1]===points[points.length-1]||points.push(points[0],points[1])},Polygon.prototype.contains=function(x,y){for(var inside=!1,length=this.points.length/2,i=0,j=length-1;i<length;j=i++){var xi=this.points[2*i],yi=this.points[2*i+1],xj=this.points[2*j],yj=this.points[2*j+1];yi>y!=yj>y&&x<(y-yi)/(yj-yi)*(xj-xi)+xi&&(inside=!inside)}return inside},Polygon}();exports.default=Polygon},{"../../const":150,"../Point":173}],178:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_const=require("../../const"),Rectangle=function(){function Rectangle(){var x=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,width=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,height=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,Rectangle),this.x=Number(x),this.y=Number(y),this.width=Number(width),this.height=Number(height),this.type=_const.SHAPES.RECT}return Rectangle.prototype.clone=function(){return new Rectangle(this.x,this.y,this.width,this.height)},Rectangle.prototype.copy=function(rectangle){return this.x=rectangle.x,this.y=rectangle.y,this.width=rectangle.width,this.height=rectangle.height,this},Rectangle.prototype.contains=function(x,y){return!(this.width<=0||this.height<=0)&&(x>=this.x&&x<this.x+this.width&&y>=this.y&&y<this.y+this.height)},Rectangle.prototype.pad=function(paddingX,paddingY){paddingX=paddingX||0,paddingY=paddingY||(0!==paddingY?paddingX:0),this.x-=paddingX,this.y-=paddingY,this.width+=2*paddingX,this.height+=2*paddingY},Rectangle.prototype.fit=function(rectangle){this.x<rectangle.x&&(this.width+=this.x,this.width<0&&(this.width=0),this.x=rectangle.x),this.y<rectangle.y&&(this.height+=this.y,this.height<0&&(this.height=0),this.y=rectangle.y),this.x+this.width>rectangle.x+rectangle.width&&(this.width=rectangle.width-this.x,this.width<0&&(this.width=0)),this.y+this.height>rectangle.y+rectangle.height&&(this.height=rectangle.height-this.y,this.height<0&&(this.height=0))},Rectangle.prototype.enlarge=function(rectangle){var x1=Math.min(this.x,rectangle.x),x2=Math.max(this.x+this.width,rectangle.x+rectangle.width),y1=Math.min(this.y,rectangle.y),y2=Math.max(this.y+this.height,rectangle.y+rectangle.height);this.x=x1,this.width=x2-x1,this.y=y1,this.height=y2-y1},_createClass(Rectangle,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}}],[{key:"EMPTY",get:function(){return new Rectangle(0,0,0,0)}}]),Rectangle}();exports.default=Rectangle},{"../../const":150}],179:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _const=require("../../const"),RoundedRectangle=function(){function RoundedRectangle(){var x=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,width=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,height=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,radius=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20;_classCallCheck(this,RoundedRectangle),this.x=x,this.y=y,this.width=width,this.height=height,this.radius=radius,this.type=_const.SHAPES.RREC}return RoundedRectangle.prototype.clone=function(){return new RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)},RoundedRectangle.prototype.contains=function(x,y){if(this.width<=0||this.height<=0)return!1;if(x>=this.x&&x<=this.x+this.width&&y>=this.y&&y<=this.y+this.height){if(y>=this.y+this.radius&&y<=this.y+this.height-this.radius||x>=this.x+this.radius&&x<=this.x+this.width-this.radius)return!0;var dx=x-(this.x+this.radius),dy=y-(this.y+this.radius),radius2=this.radius*this.radius;if(dx*dx+dy*dy<=radius2)return!0;if((dx=x-(this.x+this.width-this.radius))*dx+dy*dy<=radius2)return!0;if(dy=y-(this.y+this.height-this.radius),dx*dx+dy*dy<=radius2)return!0;if((dx=x-(this.x+this.radius))*dx+dy*dy<=radius2)return!0}return!1},RoundedRectangle}();exports.default=RoundedRectangle},{"../../const":150}],180:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_utils=require("../utils"),_math=require("../math"),_const=require("../const"),_settings=require("../settings"),_settings2=_interopRequireDefault(_settings),_Container=require("../display/Container"),_Container2=_interopRequireDefault(_Container),_RenderTexture=require("../textures/RenderTexture"),_RenderTexture2=_interopRequireDefault(_RenderTexture),_eventemitter=require("eventemitter3"),_eventemitter2=_interopRequireDefault(_eventemitter),tempMatrix=new _math.Matrix,SystemRenderer=function(_EventEmitter){function SystemRenderer(system,options,arg2,arg3){_classCallCheck(this,SystemRenderer);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));return(0,_utils.sayHello)(system),"number"==typeof options&&(options=Object.assign({width:options,height:arg2||_settings2.default.RENDER_OPTIONS.height},arg3)),options=Object.assign({},_settings2.default.RENDER_OPTIONS,options),_this.options=options,_this.type=_const.RENDERER_TYPE.UNKNOWN,_this.screen=new _math.Rectangle(0,0,options.width,options.height),_this.view=options.view||document.createElement("canvas"),_this.resolution=options.resolution||_settings2.default.RESOLUTION,_this.transparent=options.transparent,_this.autoResize=options.autoResize||!1,_this.blendModes=null,_this.preserveDrawingBuffer=options.preserveDrawingBuffer,_this.clearBeforeRender=options.clearBeforeRender,_this.roundPixels=options.roundPixels,_this._backgroundColor=0,_this._backgroundColorRgba=[0,0,0,0],_this._backgroundColorString="#000000",_this.backgroundColor=options.backgroundColor||_this._backgroundColor,_this._tempDisplayObjectParent=new _Container2.default,_this._lastObjectRendered=_this._tempDisplayObjectParent,_this}return _inherits(SystemRenderer,_EventEmitter),SystemRenderer.prototype.resize=function(screenWidth,screenHeight){this.screen.width=screenWidth,this.screen.height=screenHeight,this.view.width=screenWidth*this.resolution,this.view.height=screenHeight*this.resolution,this.autoResize&&(this.view.style.width=screenWidth+"px",this.view.style.height=screenHeight+"px")},SystemRenderer.prototype.generateTexture=function(displayObject,scaleMode,resolution,region){region=region||displayObject.getLocalBounds();var renderTexture=_RenderTexture2.default.create(0|region.width,0|region.height,scaleMode,resolution);return tempMatrix.tx=-region.x,tempMatrix.ty=-region.y,this.render(displayObject,renderTexture,!1,tempMatrix,!!displayObject.parent),renderTexture},SystemRenderer.prototype.destroy=function(removeView){removeView&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=_const.RENDERER_TYPE.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},_createClass(SystemRenderer,[{key:"width",get:function(){return this.view.width}},{key:"height",get:function(){return this.view.height}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(value){this._backgroundColor=value,this._backgroundColorString=(0,_utils.hex2string)(value),(0,_utils.hex2rgb)(value,this._backgroundColorRgba)}}]),SystemRenderer}(_eventemitter2.default);exports.default=SystemRenderer},{"../const":150,"../display/Container":152,"../math":174,"../settings":205,"../textures/RenderTexture":217,"../utils":229,eventemitter3:118}],181:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _SystemRenderer2=require("../SystemRenderer"),_SystemRenderer3=_interopRequireDefault(_SystemRenderer2),_CanvasMaskManager=require("./utils/CanvasMaskManager"),_CanvasMaskManager2=_interopRequireDefault(_CanvasMaskManager),_CanvasRenderTarget=require("./utils/CanvasRenderTarget"),_CanvasRenderTarget2=_interopRequireDefault(_CanvasRenderTarget),_mapCanvasBlendModesToPixi=require("./utils/mapCanvasBlendModesToPixi"),_mapCanvasBlendModesToPixi2=_interopRequireDefault(_mapCanvasBlendModesToPixi),_utils=require("../../utils"),_const=require("../../const"),_settings=require("../../settings"),_settings2=_interopRequireDefault(_settings),CanvasRenderer=function(_SystemRenderer){function CanvasRenderer(options,arg2,arg3){_classCallCheck(this,CanvasRenderer);var _this=_possibleConstructorReturn(this,_SystemRenderer.call(this,"Canvas",options,arg2,arg3));return _this.type=_const.RENDERER_TYPE.CANVAS,_this.rootContext=_this.view.getContext("2d",{alpha:_this.transparent}),_this.context=_this.rootContext,_this.refresh=!0,_this.maskManager=new _CanvasMaskManager2.default(_this),_this.smoothProperty="imageSmoothingEnabled",_this.rootContext.imageSmoothingEnabled||(_this.rootContext.webkitImageSmoothingEnabled?_this.smoothProperty="webkitImageSmoothingEnabled":_this.rootContext.mozImageSmoothingEnabled?_this.smoothProperty="mozImageSmoothingEnabled":_this.rootContext.oImageSmoothingEnabled?_this.smoothProperty="oImageSmoothingEnabled":_this.rootContext.msImageSmoothingEnabled&&(_this.smoothProperty="msImageSmoothingEnabled")),_this.initPlugins(),_this.blendModes=(0,_mapCanvasBlendModesToPixi2.default)(),_this._activeBlendMode=null,_this.renderingToScreen=!1,_this.resize(_this.options.width,_this.options.height),_this}return _inherits(CanvasRenderer,_SystemRenderer),CanvasRenderer.prototype.render=function(displayObject,renderTexture,clear,transform,skipUpdateTransform){if(this.view){this.renderingToScreen=!renderTexture,this.emit("prerender");var rootResolution=this.resolution;renderTexture?(renderTexture=renderTexture.baseTexture||renderTexture,renderTexture._canvasRenderTarget||(renderTexture._canvasRenderTarget=new _CanvasRenderTarget2.default(renderTexture.width,renderTexture.height,renderTexture.resolution),renderTexture.source=renderTexture._canvasRenderTarget.canvas,renderTexture.valid=!0),this.context=renderTexture._canvasRenderTarget.context,this.resolution=renderTexture._canvasRenderTarget.resolution):this.context=this.rootContext;var context=this.context;if(renderTexture||(this._lastObjectRendered=displayObject),!skipUpdateTransform){var cacheParent=displayObject.parent,tempWt=this._tempDisplayObjectParent.transform.worldTransform;transform?(transform.copy(tempWt),this._tempDisplayObjectParent.transform._worldID=-1):tempWt.identity(),displayObject.parent=this._tempDisplayObjectParent,displayObject.updateTransform(),displayObject.parent=cacheParent}context.save(),context.setTransform(1,0,0,1,0,0),context.globalAlpha=1,this._activeBlendMode=_const.BLEND_MODES.NORMAL,context.globalCompositeOperation=this.blendModes[_const.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(context.fillStyle="black",context.clear()),(void 0!==clear?clear:this.clearBeforeRender)&&this.renderingToScreen&&(this.transparent?context.clearRect(0,0,this.width,this.height):(context.fillStyle=this._backgroundColorString,context.fillRect(0,0,this.width,this.height)));var tempContext=this.context;this.context=context,displayObject.renderCanvas(this),this.context=tempContext,context.restore(),this.resolution=rootResolution,this.emit("postrender")}},CanvasRenderer.prototype.clear=function(clearColor){var context=this.context;clearColor=clearColor||this._backgroundColorString,!this.transparent&&clearColor?(context.fillStyle=clearColor,context.fillRect(0,0,this.width,this.height)):context.clearRect(0,0,this.width,this.height)},CanvasRenderer.prototype.setBlendMode=function(blendMode){this._activeBlendMode!==blendMode&&(this._activeBlendMode=blendMode,this.context.globalCompositeOperation=this.blendModes[blendMode])},CanvasRenderer.prototype.destroy=function(removeView){this.destroyPlugins(),_SystemRenderer.prototype.destroy.call(this,removeView),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},CanvasRenderer.prototype.resize=function(screenWidth,screenHeight){_SystemRenderer.prototype.resize.call(this,screenWidth,screenHeight),this.smoothProperty&&(this.rootContext[this.smoothProperty]=_settings2.default.SCALE_MODE===_const.SCALE_MODES.LINEAR)},CanvasRenderer.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},CanvasRenderer}(_SystemRenderer3.default);exports.default=CanvasRenderer,_utils.pluginTarget.mixin(CanvasRenderer)},{"../../const":150,"../../settings":205,"../../utils":229,"../SystemRenderer":180,"./utils/CanvasMaskManager":182,"./utils/CanvasRenderTarget":183,"./utils/mapCanvasBlendModesToPixi":185}],182:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _const=require("../../../const"),CanvasMaskManager=function(){function CanvasMaskManager(renderer){_classCallCheck(this,CanvasMaskManager),this.renderer=renderer}return CanvasMaskManager.prototype.pushMask=function(maskData){var renderer=this.renderer;renderer.context.save();var cacheAlpha=maskData.alpha,transform=maskData.transform.worldTransform,resolution=renderer.resolution;renderer.context.setTransform(transform.a*resolution,transform.b*resolution,transform.c*resolution,transform.d*resolution,transform.tx*resolution,transform.ty*resolution),maskData._texture||(this.renderGraphicsShape(maskData),renderer.context.clip()),maskData.worldAlpha=cacheAlpha},CanvasMaskManager.prototype.renderGraphicsShape=function(graphics){var context=this.renderer.context,len=graphics.graphicsData.length;if(0!==len){context.beginPath();for(var i=0;i<len;i++){var data=graphics.graphicsData[i],shape=data.shape;if(data.type===_const.SHAPES.POLY){var points=shape.points;context.moveTo(points[0],points[1]);for(var j=1;j<points.length/2;j++)context.lineTo(points[2*j],points[2*j+1]);points[0]===points[points.length-2]&&points[1]===points[points.length-1]&&context.closePath()}else if(data.type===_const.SHAPES.RECT)context.rect(shape.x,shape.y,shape.width,shape.height),context.closePath();else if(data.type===_const.SHAPES.CIRC)context.arc(shape.x,shape.y,shape.radius,0,2*Math.PI),context.closePath();else if(data.type===_const.SHAPES.ELIP){var w=2*shape.width,h=2*shape.height,x=shape.x-w/2,y=shape.y-h/2,ox=w/2*.5522848,oy=h/2*.5522848,xe=x+w,ye=y+h,xm=x+w/2,ym=y+h/2;context.moveTo(x,ym),context.bezierCurveTo(x,ym-oy,xm-ox,y,xm,y),context.bezierCurveTo(xm+ox,y,xe,ym-oy,xe,ym),context.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye),context.bezierCurveTo(xm-ox,ye,x,ym+oy,x,ym),context.closePath()}else if(data.type===_const.SHAPES.RREC){var rx=shape.x,ry=shape.y,width=shape.width,height=shape.height,radius=shape.radius,maxRadius=Math.min(width,height)/2|0;radius=radius>maxRadius?maxRadius:radius,context.moveTo(rx,ry+radius),context.lineTo(rx,ry+height-radius),context.quadraticCurveTo(rx,ry+height,rx+radius,ry+height),context.lineTo(rx+width-radius,ry+height),context.quadraticCurveTo(rx+width,ry+height,rx+width,ry+height-radius),context.lineTo(rx+width,ry+radius),context.quadraticCurveTo(rx+width,ry,rx+width-radius,ry),context.lineTo(rx+radius,ry),context.quadraticCurveTo(rx,ry,rx,ry+radius),context.closePath()}}}},
CanvasMaskManager.prototype.popMask=function(renderer){renderer.context.restore(),renderer.invalidateBlendMode()},CanvasMaskManager.prototype.destroy=function(){},CanvasMaskManager}();exports.default=CanvasMaskManager},{"../../../const":150}],183:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_settings=require("../../../settings"),_settings2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_settings),CanvasRenderTarget=function(){function CanvasRenderTarget(width,height,resolution){_classCallCheck(this,CanvasRenderTarget),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=resolution||_settings2.default.RESOLUTION,this.resize(width,height)}return CanvasRenderTarget.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},CanvasRenderTarget.prototype.resize=function(width,height){this.canvas.width=width*this.resolution,this.canvas.height=height*this.resolution},CanvasRenderTarget.prototype.destroy=function(){this.context=null,this.canvas=null},_createClass(CanvasRenderTarget,[{key:"width",get:function(){return this.canvas.width},set:function(val){this.canvas.width=val}},{key:"height",get:function(){return this.canvas.height},set:function(val){this.canvas.height=val}}]),CanvasRenderTarget}();exports.default=CanvasRenderTarget},{"../../../settings":205}],184:[function(require,module,exports){"use strict";function createColoredCanvas(color){var canvas=document.createElement("canvas");canvas.width=6,canvas.height=1;var context=canvas.getContext("2d");return context.fillStyle=color,context.fillRect(0,0,6,1),canvas}function canUseNewCanvasBlendModes(){if("undefined"==typeof document)return!1;var magenta=createColoredCanvas("#ff00ff"),yellow=createColoredCanvas("#ffff00"),canvas=document.createElement("canvas");canvas.width=6,canvas.height=1;var context=canvas.getContext("2d");context.globalCompositeOperation="multiply",context.drawImage(magenta,0,0),context.drawImage(yellow,2,0);var imageData=context.getImageData(2,0,1,1);if(!imageData)return!1;var data=imageData.data;return 255===data[0]&&0===data[1]&&0===data[2]}exports.__esModule=!0,exports.default=canUseNewCanvasBlendModes},{}],185:[function(require,module,exports){"use strict";function mapCanvasBlendModesToPixi(){var array=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,_canUseNewCanvasBlendModes2.default)()?(array[_const.BLEND_MODES.NORMAL]="source-over",array[_const.BLEND_MODES.ADD]="lighter",array[_const.BLEND_MODES.MULTIPLY]="multiply",array[_const.BLEND_MODES.SCREEN]="screen",array[_const.BLEND_MODES.OVERLAY]="overlay",array[_const.BLEND_MODES.DARKEN]="darken",array[_const.BLEND_MODES.LIGHTEN]="lighten",array[_const.BLEND_MODES.COLOR_DODGE]="color-dodge",array[_const.BLEND_MODES.COLOR_BURN]="color-burn",array[_const.BLEND_MODES.HARD_LIGHT]="hard-light",array[_const.BLEND_MODES.SOFT_LIGHT]="soft-light",array[_const.BLEND_MODES.DIFFERENCE]="difference",array[_const.BLEND_MODES.EXCLUSION]="exclusion",array[_const.BLEND_MODES.HUE]="hue",array[_const.BLEND_MODES.SATURATION]="saturate",array[_const.BLEND_MODES.COLOR]="color",array[_const.BLEND_MODES.LUMINOSITY]="luminosity"):(array[_const.BLEND_MODES.NORMAL]="source-over",array[_const.BLEND_MODES.ADD]="lighter",array[_const.BLEND_MODES.MULTIPLY]="source-over",array[_const.BLEND_MODES.SCREEN]="source-over",array[_const.BLEND_MODES.OVERLAY]="source-over",array[_const.BLEND_MODES.DARKEN]="source-over",array[_const.BLEND_MODES.LIGHTEN]="source-over",array[_const.BLEND_MODES.COLOR_DODGE]="source-over",array[_const.BLEND_MODES.COLOR_BURN]="source-over",array[_const.BLEND_MODES.HARD_LIGHT]="source-over",array[_const.BLEND_MODES.SOFT_LIGHT]="source-over",array[_const.BLEND_MODES.DIFFERENCE]="source-over",array[_const.BLEND_MODES.EXCLUSION]="source-over",array[_const.BLEND_MODES.HUE]="source-over",array[_const.BLEND_MODES.SATURATION]="source-over",array[_const.BLEND_MODES.COLOR]="source-over",array[_const.BLEND_MODES.LUMINOSITY]="source-over"),array[_const.BLEND_MODES.NORMAL_NPM]=array[_const.BLEND_MODES.NORMAL],array[_const.BLEND_MODES.ADD_NPM]=array[_const.BLEND_MODES.ADD],array[_const.BLEND_MODES.SCREEN_NPM]=array[_const.BLEND_MODES.SCREEN],array}exports.__esModule=!0,exports.default=mapCanvasBlendModesToPixi;var _const=require("../../../const"),_canUseNewCanvasBlendModes=require("./canUseNewCanvasBlendModes"),_canUseNewCanvasBlendModes2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_canUseNewCanvasBlendModes)},{"../../../const":150,"./canUseNewCanvasBlendModes":184}],186:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _const=require("../../const"),_settings=require("../../settings"),_settings2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_settings),TextureGarbageCollector=function(){function TextureGarbageCollector(renderer){_classCallCheck(this,TextureGarbageCollector),this.renderer=renderer,this.count=0,this.checkCount=0,this.maxIdle=_settings2.default.GC_MAX_IDLE,this.checkCountMax=_settings2.default.GC_MAX_CHECK_COUNT,this.mode=_settings2.default.GC_MODE}return TextureGarbageCollector.prototype.update=function(){this.count++,this.mode!==_const.GC_MODES.MANUAL&&++this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())},TextureGarbageCollector.prototype.run=function(){for(var tm=this.renderer.textureManager,managedTextures=tm._managedTextures,wasRemoved=!1,i=0;i<managedTextures.length;i++){var texture=managedTextures[i];!texture._glRenderTargets&&this.count-texture.touched>this.maxIdle&&(tm.destroyTexture(texture,!0),managedTextures[i]=null,wasRemoved=!0)}if(wasRemoved){for(var j=0,_i=0;_i<managedTextures.length;_i++)null!==managedTextures[_i]&&(managedTextures[j++]=managedTextures[_i]);managedTextures.length=j}},TextureGarbageCollector.prototype.unload=function(displayObject){var tm=this.renderer.textureManager;displayObject._texture&&displayObject._texture._glRenderTargets&&tm.destroyTexture(displayObject._texture,!0);for(var i=displayObject.children.length-1;i>=0;i--)this.unload(displayObject.children[i])},TextureGarbageCollector}();exports.default=TextureGarbageCollector},{"../../const":150,"../../settings":205}],187:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _pixiGlCore=require("pixi-gl-core"),_const=require("../../const"),_RenderTarget=require("./utils/RenderTarget"),_RenderTarget2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_RenderTarget),_utils=require("../../utils"),TextureManager=function(){function TextureManager(renderer){_classCallCheck(this,TextureManager),this.renderer=renderer,this.gl=renderer.gl,this._managedTextures=[]}return TextureManager.prototype.bindTexture=function(){},TextureManager.prototype.getTexture=function(){},TextureManager.prototype.updateTexture=function(texture,location){var gl=this.gl,isRenderTexture=!!texture._glRenderTargets;if(!texture.hasLoaded)return null;var boundTextures=this.renderer.boundTextures;if(void 0===location){location=0;for(var i=0;i<boundTextures.length;++i)if(boundTextures[i]===texture){location=i;break}}boundTextures[location]=texture,gl.activeTexture(gl.TEXTURE0+location);var glTexture=texture._glTextures[this.renderer.CONTEXT_UID];if(glTexture)isRenderTexture?texture._glRenderTargets[this.renderer.CONTEXT_UID].resize(texture.width,texture.height):glTexture.upload(texture.source);else{if(isRenderTexture){var renderTarget=new _RenderTarget2.default(this.gl,texture.width,texture.height,texture.scaleMode,texture.resolution);renderTarget.resize(texture.width,texture.height),texture._glRenderTargets[this.renderer.CONTEXT_UID]=renderTarget,glTexture=renderTarget.texture}else glTexture=new _pixiGlCore.GLTexture(this.gl,null,null,null,null),glTexture.bind(location),glTexture.premultiplyAlpha=!0,glTexture.upload(texture.source);texture._glTextures[this.renderer.CONTEXT_UID]=glTexture,texture.on("update",this.updateTexture,this),texture.on("dispose",this.destroyTexture,this),this._managedTextures.push(texture),texture.isPowerOfTwo?(texture.mipmap&&glTexture.enableMipmap(),texture.wrapMode===_const.WRAP_MODES.CLAMP?glTexture.enableWrapClamp():texture.wrapMode===_const.WRAP_MODES.REPEAT?glTexture.enableWrapRepeat():glTexture.enableWrapMirrorRepeat()):glTexture.enableWrapClamp(),texture.scaleMode===_const.SCALE_MODES.NEAREST?glTexture.enableNearestScaling():glTexture.enableLinearScaling()}return glTexture},TextureManager.prototype.destroyTexture=function(texture,skipRemove){if(texture=texture.baseTexture||texture,texture.hasLoaded){var uid=this.renderer.CONTEXT_UID,glTextures=texture._glTextures,glRenderTargets=texture._glRenderTargets;if(glTextures[uid]&&(this.renderer.unbindTexture(texture),glTextures[uid].destroy(),texture.off("update",this.updateTexture,this),texture.off("dispose",this.destroyTexture,this),delete glTextures[uid],!skipRemove)){var i=this._managedTextures.indexOf(texture);-1!==i&&(0,_utils.removeItems)(this._managedTextures,i,1)}glRenderTargets&&glRenderTargets[uid]&&(glRenderTargets[uid].destroy(),delete glRenderTargets[uid])}},TextureManager.prototype.removeAll=function(){for(var i=0;i<this._managedTextures.length;++i){var texture=this._managedTextures[i];texture._glTextures[this.renderer.CONTEXT_UID]&&delete texture._glTextures[this.renderer.CONTEXT_UID]}},TextureManager.prototype.destroy=function(){for(var i=0;i<this._managedTextures.length;++i){var texture=this._managedTextures[i];this.destroyTexture(texture,!0),texture.off("update",this.updateTexture,this),texture.off("dispose",this.destroyTexture,this)}this._managedTextures=null},TextureManager}();exports.default=TextureManager},{"../../const":150,"../../utils":229,"./utils/RenderTarget":200,"pixi-gl-core":133}],188:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _SystemRenderer2=require("../SystemRenderer"),_SystemRenderer3=_interopRequireDefault(_SystemRenderer2),_MaskManager=require("./managers/MaskManager"),_MaskManager2=_interopRequireDefault(_MaskManager),_StencilManager=require("./managers/StencilManager"),_StencilManager2=_interopRequireDefault(_StencilManager),_FilterManager=require("./managers/FilterManager"),_FilterManager2=_interopRequireDefault(_FilterManager),_RenderTarget=require("./utils/RenderTarget"),_RenderTarget2=_interopRequireDefault(_RenderTarget),_ObjectRenderer=require("./utils/ObjectRenderer"),_ObjectRenderer2=_interopRequireDefault(_ObjectRenderer),_TextureManager=require("./TextureManager"),_TextureManager2=_interopRequireDefault(_TextureManager),_BaseTexture=require("../../textures/BaseTexture"),_BaseTexture2=_interopRequireDefault(_BaseTexture),_TextureGarbageCollector=require("./TextureGarbageCollector"),_TextureGarbageCollector2=_interopRequireDefault(_TextureGarbageCollector),_WebGLState=require("./WebGLState"),_WebGLState2=_interopRequireDefault(_WebGLState),_mapWebGLDrawModesToPixi=require("./utils/mapWebGLDrawModesToPixi"),_mapWebGLDrawModesToPixi2=_interopRequireDefault(_mapWebGLDrawModesToPixi),_validateContext=require("./utils/validateContext"),_validateContext2=_interopRequireDefault(_validateContext),_utils=require("../../utils"),_pixiGlCore=require("pixi-gl-core"),_pixiGlCore2=_interopRequireDefault(_pixiGlCore),_const=require("../../const"),CONTEXT_UID=0,WebGLRenderer=function(_SystemRenderer){function WebGLRenderer(options,arg2,arg3){_classCallCheck(this,WebGLRenderer);var _this=_possibleConstructorReturn(this,_SystemRenderer.call(this,"WebGL",options,arg2,arg3));return _this.legacy=_this.options.legacy,_this.legacy&&(_pixiGlCore2.default.VertexArrayObject.FORCE_NATIVE=!0),_this.type=_const.RENDERER_TYPE.WEBGL,_this.handleContextLost=_this.handleContextLost.bind(_this),_this.handleContextRestored=_this.handleContextRestored.bind(_this),_this.view.addEventListener("webglcontextlost",_this.handleContextLost,!1),_this.view.addEventListener("webglcontextrestored",_this.handleContextRestored,!1),_this._contextOptions={alpha:_this.transparent,antialias:_this.options.antialias,premultipliedAlpha:_this.transparent&&"notMultiplied"!==_this.transparent,stencil:!0,preserveDrawingBuffer:_this.options.preserveDrawingBuffer,powerPreference:_this.options.powerPreference},_this._backgroundColorRgba[3]=_this.transparent?0:1,_this.maskManager=new _MaskManager2.default(_this),_this.stencilManager=new _StencilManager2.default(_this),_this.emptyRenderer=new _ObjectRenderer2.default(_this),_this.currentRenderer=_this.emptyRenderer,_this.textureManager=null,_this.filterManager=null,_this.initPlugins(),_this.options.context&&(0,_validateContext2.default)(_this.options.context),_this.gl=_this.options.context||_pixiGlCore2.default.createContext(_this.view,_this._contextOptions),_this.CONTEXT_UID=CONTEXT_UID++,_this.state=new _WebGLState2.default(_this.gl),_this.renderingToScreen=!0,_this.boundTextures=null,_this._activeShader=null,_this._activeVao=null,_this._activeRenderTarget=null,_this._initContext(),_this.drawModes=(0,_mapWebGLDrawModesToPixi2.default)(_this.gl),_this._nextTextureLocation=0,_this.setBlendMode(0),_this}return _inherits(WebGLRenderer,_SystemRenderer),WebGLRenderer.prototype._initContext=function(){var gl=this.gl;gl.isContextLost()&&gl.getExtension("WEBGL_lose_context")&&gl.getExtension("WEBGL_lose_context").restoreContext();var maxTextures=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);this._activeShader=null,this._activeVao=null,this.boundTextures=new Array(maxTextures),this.emptyTextures=new Array(maxTextures),this.textureManager=new _TextureManager2.default(this),this.filterManager=new _FilterManager2.default(this),this.textureGC=new _TextureGarbageCollector2.default(this),this.state.resetToDefault(),this.rootRenderTarget=new _RenderTarget2.default(gl,this.width,this.height,null,this.resolution,!0),this.rootRenderTarget.clearColor=this._backgroundColorRgba,this.bindRenderTarget(this.rootRenderTarget);var emptyGLTexture=new _pixiGlCore2.default.GLTexture.fromData(gl,null,1,1),tempObj={_glTextures:{}};tempObj._glTextures[this.CONTEXT_UID]={};for(var i=0;i<maxTextures;i++){var empty=new _BaseTexture2.default;empty._glTextures[this.CONTEXT_UID]=emptyGLTexture,this.boundTextures[i]=tempObj,this.emptyTextures[i]=empty,this.bindTexture(null,i)}this.emit("context",gl),this.resize(this.screen.width,this.screen.height)},WebGLRenderer.prototype.render=function(displayObject,renderTexture,clear,transform,skipUpdateTransform){if(this.renderingToScreen=!renderTexture,this.emit("prerender"),this.gl&&!this.gl.isContextLost()){if(this._nextTextureLocation=0,renderTexture||(this._lastObjectRendered=displayObject),!skipUpdateTransform){var cacheParent=displayObject.parent;displayObject.parent=this._tempDisplayObjectParent,displayObject.updateTransform(),displayObject.parent=cacheParent}this.bindRenderTexture(renderTexture,transform),this.currentRenderer.start(),(void 0!==clear?clear:this.clearBeforeRender)&&this._activeRenderTarget.clear(),displayObject.renderWebGL(this),this.currentRenderer.flush(),this.textureGC.update(),this.emit("postrender")}},WebGLRenderer.prototype.setObjectRenderer=function(objectRenderer){this.currentRenderer!==objectRenderer&&(this.currentRenderer.stop(),this.currentRenderer=objectRenderer,this.currentRenderer.start())},WebGLRenderer.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},WebGLRenderer.prototype.resize=function(screenWidth,screenHeight){_SystemRenderer3.default.prototype.resize.call(this,screenWidth,screenHeight),this.rootRenderTarget.resize(screenWidth,screenHeight),this._activeRenderTarget===this.rootRenderTarget&&(this.rootRenderTarget.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=this.rootRenderTarget.projectionMatrix.toArray(!0)))},WebGLRenderer.prototype.setBlendMode=function(blendMode){this.state.setBlendMode(blendMode)},WebGLRenderer.prototype.clear=function(clearColor){this._activeRenderTarget.clear(clearColor)},WebGLRenderer.prototype.setTransform=function(matrix){this._activeRenderTarget.transform=matrix},WebGLRenderer.prototype.clearRenderTexture=function(renderTexture,clearColor){var baseTexture=renderTexture.baseTexture,renderTarget=baseTexture._glRenderTargets[this.CONTEXT_UID];return renderTarget&&renderTarget.clear(clearColor),this},WebGLRenderer.prototype.bindRenderTexture=function(renderTexture,transform){var renderTarget=void 0;if(renderTexture){var baseTexture=renderTexture.baseTexture;baseTexture._glRenderTargets[this.CONTEXT_UID]||this.textureManager.updateTexture(baseTexture,0),this.unbindTexture(baseTexture),renderTarget=baseTexture._glRenderTargets[this.CONTEXT_UID],renderTarget.setFrame(renderTexture.frame)}else renderTarget=this.rootRenderTarget;return renderTarget.transform=transform,this.bindRenderTarget(renderTarget),this},WebGLRenderer.prototype.bindRenderTarget=function(renderTarget){return renderTarget!==this._activeRenderTarget&&(this._activeRenderTarget=renderTarget,renderTarget.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=renderTarget.projectionMatrix.toArray(!0)),this.stencilManager.setMaskStack(renderTarget.stencilMaskStack)),this},WebGLRenderer.prototype.bindShader=function(shader,autoProject){return this._activeShader!==shader&&(this._activeShader=shader,shader.bind(),!1!==autoProject&&(shader.uniforms.projectionMatrix=this._activeRenderTarget.projectionMatrix.toArray(!0))),this},WebGLRenderer.prototype.bindTexture=function(texture,location,forceLocation){if(texture=texture||this.emptyTextures[location],texture=texture.baseTexture||texture,texture.touched=this.textureGC.count,forceLocation)location=location||0;else{for(var i=0;i<this.boundTextures.length;i++)if(this.boundTextures[i]===texture)return i;void 0===location&&(this._nextTextureLocation++,this._nextTextureLocation%=this.boundTextures.length,location=this.boundTextures.length-this._nextTextureLocation-1)}var gl=this.gl,glTexture=texture._glTextures[this.CONTEXT_UID];return glTexture?(this.boundTextures[location]=texture,gl.activeTexture(gl.TEXTURE0+location),gl.bindTexture(gl.TEXTURE_2D,glTexture.texture)):this.textureManager.updateTexture(texture,location),location},WebGLRenderer.prototype.unbindTexture=function(texture){var gl=this.gl;texture=texture.baseTexture||texture;for(var i=0;i<this.boundTextures.length;i++)this.boundTextures[i]===texture&&(this.boundTextures[i]=this.emptyTextures[i],gl.activeTexture(gl.TEXTURE0+i),gl.bindTexture(gl.TEXTURE_2D,this.emptyTextures[i]._glTextures[this.CONTEXT_UID].texture));return this},WebGLRenderer.prototype.createVao=function(){return new _pixiGlCore2.default.VertexArrayObject(this.gl,this.state.attribState)},WebGLRenderer.prototype.bindVao=function(vao){return this._activeVao===vao?this:(vao?vao.bind():this._activeVao&&this._activeVao.unbind(),this._activeVao=vao,this)},WebGLRenderer.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer),this.bindVao(null),this._activeShader=null,this._activeRenderTarget=this.rootRenderTarget;for(var i=0;i<this.boundTextures.length;i++)this.boundTextures[i]=this.emptyTextures[i];return this.rootRenderTarget.activate(),this.state.resetToDefault(),this},WebGLRenderer.prototype.handleContextLost=function(event){event.preventDefault()},WebGLRenderer.prototype.handleContextRestored=function(){this.textureManager.removeAll(),this.filterManager.destroy(!0),this._initContext()},WebGLRenderer.prototype.destroy=function(removeView){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored),this.textureManager.destroy(),_SystemRenderer.prototype.destroy.call(this,removeView),this.uid=0,this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.maskManager=null,this.filterManager=null,this.textureManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.gl.useProgram(null),this.gl.getExtension("WEBGL_lose_context")&&this.gl.getExtension("WEBGL_lose_context").loseContext(),this.gl=null},WebGLRenderer}(_SystemRenderer3.default);exports.default=WebGLRenderer,_utils.pluginTarget.mixin(WebGLRenderer)},{"../../const":150,"../../textures/BaseTexture":216,"../../utils":229,"../SystemRenderer":180,"./TextureGarbageCollector":186,"./TextureManager":187,"./WebGLState":189,"./managers/FilterManager":194,"./managers/MaskManager":195,"./managers/StencilManager":196,"./utils/ObjectRenderer":198,"./utils/RenderTarget":200,"./utils/mapWebGLDrawModesToPixi":203,"./utils/validateContext":204,"pixi-gl-core":133}],189:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _mapWebGLBlendModesToPixi=require("./utils/mapWebGLBlendModesToPixi"),_mapWebGLBlendModesToPixi2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_mapWebGLBlendModesToPixi),WebGLState=function(){function WebGLState(gl){_classCallCheck(this,WebGLState),this.activeState=new Uint8Array(16),this.defaultState=new Uint8Array(16),this.defaultState[0]=1,this.stackIndex=0,this.stack=[],this.gl=gl,this.maxAttribs=gl.getParameter(gl.MAX_VERTEX_ATTRIBS),this.attribState={tempAttribState:new Array(this.maxAttribs),attribState:new Array(this.maxAttribs)},this.blendModes=(0,_mapWebGLBlendModesToPixi2.default)(gl),this.nativeVaoExtension=gl.getExtension("OES_vertex_array_object")||gl.getExtension("MOZ_OES_vertex_array_object")||gl.getExtension("WEBKIT_OES_vertex_array_object")}return WebGLState.prototype.push=function(){var state=this.stack[this.stackIndex];state||(state=this.stack[this.stackIndex]=new Uint8Array(16)),++this.stackIndex;for(var i=0;i<this.activeState.length;i++)state[i]=this.activeState[i]},WebGLState.prototype.pop=function(){var state=this.stack[--this.stackIndex];this.setState(state)},WebGLState.prototype.setState=function(state){this.setBlend(state[0]),this.setDepthTest(state[1]),this.setFrontFace(state[2]),this.setCullFace(state[3]),this.setBlendMode(state[4])},WebGLState.prototype.setBlend=function(value){value=value?1:0,this.activeState[0]!==value&&(this.activeState[0]=value,this.gl[value?"enable":"disable"](this.gl.BLEND))},WebGLState.prototype.setBlendMode=function(value){if(value!==this.activeState[4]){this.activeState[4]=value;var mode=this.blendModes[value];2===mode.length?this.gl.blendFunc(mode[0],mode[1]):this.gl.blendFuncSeparate(mode[0],mode[1],mode[2],mode[3])}},WebGLState.prototype.setDepthTest=function(value){value=value?1:0,this.activeState[1]!==value&&(this.activeState[1]=value,this.gl[value?"enable":"disable"](this.gl.DEPTH_TEST))},WebGLState.prototype.setCullFace=function(value){value=value?1:0,this.activeState[3]!==value&&(this.activeState[3]=value,this.gl[value?"enable":"disable"](this.gl.CULL_FACE))},WebGLState.prototype.setFrontFace=function(value){value=value?1:0,this.activeState[2]!==value&&(this.activeState[2]=value,this.gl.frontFace(this.gl[value?"CW":"CCW"]))},WebGLState.prototype.resetAttributes=function(){for(var i=0;i<this.attribState.tempAttribState.length;i++)this.attribState.tempAttribState[i]=0;for(var _i=0;_i<this.attribState.attribState.length;_i++)this.attribState.attribState[_i]=0;for(var _i2=1;_i2<this.maxAttribs;_i2++)this.gl.disableVertexAttribArray(_i2)},WebGLState.prototype.resetToDefault=function(){this.nativeVaoExtension&&this.nativeVaoExtension.bindVertexArrayOES(null),this.resetAttributes();for(var i=0;i<this.activeState.length;++i)this.activeState[i]=32;this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.setState(this.defaultState)},WebGLState}();exports.default=WebGLState},{"./utils/mapWebGLBlendModesToPixi":202}],190:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_extractUniformsFromSrc=require("./extractUniformsFromSrc"),_extractUniformsFromSrc2=_interopRequireDefault(_extractUniformsFromSrc),_utils=require("../../../utils"),_const=require("../../../const"),_settings=require("../../../settings"),_settings2=_interopRequireDefault(_settings),SOURCE_KEY_MAP={},Filter=function(){function Filter(vertexSrc,fragmentSrc,uniforms){_classCallCheck(this,Filter),this.vertexSrc=vertexSrc||Filter.defaultVertexSrc,this.fragmentSrc=fragmentSrc||Filter.defaultFragmentSrc,this._blendMode=_const.BLEND_MODES.NORMAL,this.uniformData=uniforms||(0,_extractUniformsFromSrc2.default)(this.vertexSrc,this.fragmentSrc,"projectionMatrix|uSampler"),this.uniforms={};for(var i in this.uniformData)this.uniforms[i]=this.uniformData[i].value,this.uniformData[i].type&&(this.uniformData[i].type=this.uniformData[i].type.toLowerCase());this.glShaders={},SOURCE_KEY_MAP[this.vertexSrc+this.fragmentSrc]||(SOURCE_KEY_MAP[this.vertexSrc+this.fragmentSrc]=(0,_utils.uid)()),this.glShaderKey=SOURCE_KEY_MAP[this.vertexSrc+this.fragmentSrc],this.padding=4,this.resolution=_settings2.default.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0}return Filter.prototype.apply=function(filterManager,input,output,clear,currentState){filterManager.applyFilter(this,input,output,clear)},_createClass(Filter,[{key:"blendMode",get:function(){return this._blendMode},set:function(value){this._blendMode=value}}],[{key:"defaultVertexSrc",get:function(){return["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 projectionMatrix;","uniform mat3 filterMatrix;","varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;","   vTextureCoord = aTextureCoord ;","}"].join("\n")}},{key:"defaultFragmentSrc",get:function(){return["varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","uniform sampler2D uSampler;","uniform sampler2D filterSampler;","void main(void){","   vec4 masky = texture2D(filterSampler, vFilterCoord);","   vec4 sample = texture2D(uSampler, vTextureCoord);","   vec4 color;","   if(mod(vFilterCoord.x, 1.0) > 0.5)","   {","     color = vec4(1.0, 0.0, 0.0, 1.0);","   }","   else","   {","     color = vec4(0.0, 1.0, 0.0, 1.0);","   }","   gl_FragColor = mix(sample, masky, 0.5);","   gl_FragColor *= sample.a;","}"].join("\n")}}]),Filter}();exports.default=Filter},{"../../../const":150,"../../../settings":205,"../../../utils":229,"./extractUniformsFromSrc":191}],191:[function(require,module,exports){"use strict";function extractUniformsFromSrc(vertexSrc,fragmentSrc,mask){var vertUniforms=extractUniformsFromString(vertexSrc),fragUniforms=extractUniformsFromString(fragmentSrc);return Object.assign(vertUniforms,fragUniforms)}function extractUniformsFromString(string){for(var maskRegex=new RegExp("^(projectionMatrix|uSampler|filterArea|filterClamp)$"),uniforms={},nameSplit=void 0,lines=string.replace(/\s+/g," ").split(/\s*;\s*/),i=0;i<lines.length;i++){var line=lines[i].trim();if(line.indexOf("uniform")>-1){var splitLine=line.split(" "),type=splitLine[1],name=splitLine[2],size=1;name.indexOf("[")>-1&&(nameSplit=name.split(/\[|]/),name=nameSplit[0],size*=Number(nameSplit[1])),name.match(maskRegex)||(uniforms[name]={value:defaultValue(type,size),name:name,type:type})}}return uniforms}exports.__esModule=!0,exports.default=extractUniformsFromSrc;var _pixiGlCore=require("pixi-gl-core"),_pixiGlCore2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_pixiGlCore),defaultValue=_pixiGlCore2.default.shader.defaultValue},{"pixi-gl-core":133}],192:[function(require,module,exports){"use strict";function calculateScreenSpaceMatrix(outputMatrix,filterArea,textureSize){var mappedMatrix=outputMatrix.identity();return mappedMatrix.translate(filterArea.x/textureSize.width,filterArea.y/textureSize.height),mappedMatrix.scale(textureSize.width,textureSize.height),mappedMatrix}function calculateNormalizedScreenSpaceMatrix(outputMatrix,filterArea,textureSize){var mappedMatrix=outputMatrix.identity();mappedMatrix.translate(filterArea.x/textureSize.width,filterArea.y/textureSize.height);var translateScaleX=textureSize.width/filterArea.width,translateScaleY=textureSize.height/filterArea.height;return mappedMatrix.scale(translateScaleX,translateScaleY),mappedMatrix}function calculateSpriteMatrix(outputMatrix,filterArea,textureSize,sprite){var orig=sprite._texture.orig,mappedMatrix=outputMatrix.set(textureSize.width,0,0,textureSize.height,filterArea.x,filterArea.y),worldTransform=sprite.worldTransform.copy(_math.Matrix.TEMP_MATRIX);return worldTransform.invert(),mappedMatrix.prepend(worldTransform),mappedMatrix.scale(1/orig.width,1/orig.height),mappedMatrix.translate(sprite.anchor.x,sprite.anchor.y),mappedMatrix}exports.__esModule=!0,exports.calculateScreenSpaceMatrix=calculateScreenSpaceMatrix,exports.calculateNormalizedScreenSpaceMatrix=calculateNormalizedScreenSpaceMatrix,exports.calculateSpriteMatrix=calculateSpriteMatrix;var _math=require("../../../math")},{"../../../math":174}],193:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
;return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _Filter2=require("../Filter"),_Filter3=_interopRequireDefault(_Filter2),_math=require("../../../../math"),_TextureMatrix=(require("path"),require("../../../../textures/TextureMatrix")),_TextureMatrix2=_interopRequireDefault(_TextureMatrix),SpriteMaskFilter=function(_Filter){function SpriteMaskFilter(sprite){_classCallCheck(this,SpriteMaskFilter);var maskMatrix=new _math.Matrix,_this=_possibleConstructorReturn(this,_Filter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n\n    original *= (masky.r * masky.a * alpha * clip);\n\n    gl_FragColor = original;\n}\n"));return sprite.renderable=!1,_this.maskSprite=sprite,_this.maskMatrix=maskMatrix,_this}return _inherits(SpriteMaskFilter,_Filter),SpriteMaskFilter.prototype.apply=function(filterManager,input,output){var maskSprite=this.maskSprite,tex=this.maskSprite.texture;tex.valid&&(tex.transform||(tex.transform=new _TextureMatrix2.default(tex,0)),tex.transform.update(),this.uniforms.mask=tex,this.uniforms.otherMatrix=filterManager.calculateSpriteMatrix(this.maskMatrix,maskSprite).prepend(tex.transform.mapCoord),this.uniforms.alpha=maskSprite.worldAlpha,this.uniforms.maskClamp=tex.transform.uClampFrame,filterManager.applyFilter(this,input,output))},SpriteMaskFilter}(_Filter3.default);exports.default=SpriteMaskFilter},{"../../../../math":174,"../../../../textures/TextureMatrix":220,"../Filter":190,path:126}],194:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _WebGLManager2=require("./WebGLManager"),_WebGLManager3=_interopRequireDefault(_WebGLManager2),_RenderTarget=require("../utils/RenderTarget"),_RenderTarget2=_interopRequireDefault(_RenderTarget),_Quad=require("../utils/Quad"),_Quad2=_interopRequireDefault(_Quad),_math=require("../../../math"),_Shader=require("../../../Shader"),_Shader2=_interopRequireDefault(_Shader),_filterTransforms=require("../filters/filterTransforms"),filterTransforms=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_filterTransforms),_bitTwiddle=require("bit-twiddle"),_bitTwiddle2=_interopRequireDefault(_bitTwiddle),FilterState=function(){function FilterState(){_classCallCheck(this,FilterState),this.renderTarget=null,this.target=null,this.resolution=1,this.sourceFrame=new _math.Rectangle,this.destinationFrame=new _math.Rectangle,this.filters=[]}return FilterState.prototype.clear=function(){this.filters=null,this.target=null,this.renderTarget=null},FilterState}(),FilterManager=function(_WebGLManager){function FilterManager(renderer){_classCallCheck(this,FilterManager);var _this=_possibleConstructorReturn(this,_WebGLManager.call(this,renderer));return _this.gl=_this.renderer.gl,_this.quad=new _Quad2.default(_this.gl,renderer.state.attribState),_this.shaderCache={},_this.pool={},_this.filterData=null,_this.managedFilters=[],_this.renderer.on("prerender",_this.onPrerender,_this),_this._screenWidth=renderer.view.width,_this._screenHeight=renderer.view.height,_this}return _inherits(FilterManager,_WebGLManager),FilterManager.prototype.pushFilter=function(target,filters){var renderer=this.renderer,filterData=this.filterData;if(!filterData){filterData=this.renderer._activeRenderTarget.filterStack;var filterState=new FilterState;filterState.sourceFrame=filterState.destinationFrame=this.renderer._activeRenderTarget.size,filterState.renderTarget=renderer._activeRenderTarget,this.renderer._activeRenderTarget.filterData=filterData={index:0,stack:[filterState]},this.filterData=filterData}var currentState=filterData.stack[++filterData.index],renderTargetFrame=filterData.stack[0].destinationFrame;currentState||(currentState=filterData.stack[filterData.index]=new FilterState);var fullScreen=target.filterArea&&0===target.filterArea.x&&0===target.filterArea.y&&target.filterArea.width===renderer.screen.width&&target.filterArea.height===renderer.screen.height,resolution=filters[0].resolution,padding=0|filters[0].padding,targetBounds=fullScreen?renderer.screen:target.filterArea||target.getBounds(!0),sourceFrame=currentState.sourceFrame,destinationFrame=currentState.destinationFrame;sourceFrame.x=(targetBounds.x*resolution|0)/resolution,sourceFrame.y=(targetBounds.y*resolution|0)/resolution,sourceFrame.width=(targetBounds.width*resolution|0)/resolution,sourceFrame.height=(targetBounds.height*resolution|0)/resolution,fullScreen||(filterData.stack[0].renderTarget.transform||filters[0].autoFit&&sourceFrame.fit(renderTargetFrame),sourceFrame.pad(padding)),destinationFrame.width=sourceFrame.width,destinationFrame.height=sourceFrame.height;var renderTarget=this.getPotRenderTarget(renderer.gl,sourceFrame.width,sourceFrame.height,resolution);currentState.target=target,currentState.filters=filters,currentState.resolution=resolution,currentState.renderTarget=renderTarget,renderTarget.setFrame(destinationFrame,sourceFrame),renderer.bindRenderTarget(renderTarget),renderTarget.clear()},FilterManager.prototype.popFilter=function(){var filterData=this.filterData,lastState=filterData.stack[filterData.index-1],currentState=filterData.stack[filterData.index];this.quad.map(currentState.renderTarget.size,currentState.sourceFrame).upload();var filters=currentState.filters;if(1===filters.length)filters[0].apply(this,currentState.renderTarget,lastState.renderTarget,!1,currentState),this.freePotRenderTarget(currentState.renderTarget);else{var flip=currentState.renderTarget,flop=this.getPotRenderTarget(this.renderer.gl,currentState.sourceFrame.width,currentState.sourceFrame.height,currentState.resolution);flop.setFrame(currentState.destinationFrame,currentState.sourceFrame),flop.clear();var i=0;for(i=0;i<filters.length-1;++i){filters[i].apply(this,flip,flop,!0,currentState);var t=flip;flip=flop,flop=t}filters[i].apply(this,flip,lastState.renderTarget,!1,currentState),this.freePotRenderTarget(flip),this.freePotRenderTarget(flop)}currentState.clear(),0===--filterData.index&&(this.filterData=null)},FilterManager.prototype.applyFilter=function(filter,input,output,clear){var renderer=this.renderer,gl=renderer.gl,shader=filter.glShaders[renderer.CONTEXT_UID];shader||(filter.glShaderKey?(shader=this.shaderCache[filter.glShaderKey])||(shader=new _Shader2.default(this.gl,filter.vertexSrc,filter.fragmentSrc),filter.glShaders[renderer.CONTEXT_UID]=this.shaderCache[filter.glShaderKey]=shader,this.managedFilters.push(filter)):(shader=filter.glShaders[renderer.CONTEXT_UID]=new _Shader2.default(this.gl,filter.vertexSrc,filter.fragmentSrc),this.managedFilters.push(filter)),renderer.bindVao(null),this.quad.initVao(shader)),renderer.bindVao(this.quad.vao),renderer.bindRenderTarget(output),clear&&(gl.disable(gl.SCISSOR_TEST),renderer.clear(),gl.enable(gl.SCISSOR_TEST)),output===renderer.maskManager.scissorRenderTarget&&renderer.maskManager.pushScissorMask(null,renderer.maskManager.scissorData),renderer.bindShader(shader);var tex=this.renderer.emptyTextures[0];this.renderer.boundTextures[0]=tex,this.syncUniforms(shader,filter),renderer.state.setBlendMode(filter.blendMode),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,input.texture.texture),this.quad.vao.draw(this.renderer.gl.TRIANGLES,6,0),gl.bindTexture(gl.TEXTURE_2D,tex._glTextures[this.renderer.CONTEXT_UID].texture)},FilterManager.prototype.syncUniforms=function(shader,filter){var uniformData=filter.uniformData,uniforms=filter.uniforms,textureCount=1,currentState=void 0;if(shader.uniforms.filterArea){currentState=this.filterData.stack[this.filterData.index];var filterArea=shader.uniforms.filterArea;filterArea[0]=currentState.renderTarget.size.width,filterArea[1]=currentState.renderTarget.size.height,filterArea[2]=currentState.sourceFrame.x,filterArea[3]=currentState.sourceFrame.y,shader.uniforms.filterArea=filterArea}if(shader.uniforms.filterClamp){currentState=currentState||this.filterData.stack[this.filterData.index];var filterClamp=shader.uniforms.filterClamp;filterClamp[0]=0,filterClamp[1]=0,filterClamp[2]=(currentState.sourceFrame.width-1)/currentState.renderTarget.size.width,filterClamp[3]=(currentState.sourceFrame.height-1)/currentState.renderTarget.size.height,shader.uniforms.filterClamp=filterClamp}for(var i in uniformData){var type=uniformData[i].type;if("sampler2d"===type&&0!==uniforms[i]){if(uniforms[i].baseTexture)shader.uniforms[i]=this.renderer.bindTexture(uniforms[i].baseTexture,textureCount);else{shader.uniforms[i]=textureCount;var gl=this.renderer.gl;this.renderer.boundTextures[textureCount]=this.renderer.emptyTextures[textureCount],gl.activeTexture(gl.TEXTURE0+textureCount),uniforms[i].texture.bind()}textureCount++}else if("mat3"===type)void 0!==uniforms[i].a?shader.uniforms[i]=uniforms[i].toArray(!0):shader.uniforms[i]=uniforms[i];else if("vec2"===type)if(void 0!==uniforms[i].x){var val=shader.uniforms[i]||new Float32Array(2);val[0]=uniforms[i].x,val[1]=uniforms[i].y,shader.uniforms[i]=val}else shader.uniforms[i]=uniforms[i];else"float"===type?shader.uniforms.data[i].value!==uniformData[i]&&(shader.uniforms[i]=uniforms[i]):shader.uniforms[i]=uniforms[i]}},FilterManager.prototype.getRenderTarget=function(clear,resolution){var currentState=this.filterData.stack[this.filterData.index],renderTarget=this.getPotRenderTarget(this.renderer.gl,currentState.sourceFrame.width,currentState.sourceFrame.height,resolution||currentState.resolution);return renderTarget.setFrame(currentState.destinationFrame,currentState.sourceFrame),renderTarget},FilterManager.prototype.returnRenderTarget=function(renderTarget){this.freePotRenderTarget(renderTarget)},FilterManager.prototype.calculateScreenSpaceMatrix=function(outputMatrix){var currentState=this.filterData.stack[this.filterData.index];return filterTransforms.calculateScreenSpaceMatrix(outputMatrix,currentState.sourceFrame,currentState.renderTarget.size)},FilterManager.prototype.calculateNormalizedScreenSpaceMatrix=function(outputMatrix){var currentState=this.filterData.stack[this.filterData.index];return filterTransforms.calculateNormalizedScreenSpaceMatrix(outputMatrix,currentState.sourceFrame,currentState.renderTarget.size,currentState.destinationFrame)},FilterManager.prototype.calculateSpriteMatrix=function(outputMatrix,sprite){var currentState=this.filterData.stack[this.filterData.index];return filterTransforms.calculateSpriteMatrix(outputMatrix,currentState.sourceFrame,currentState.renderTarget.size,sprite)},FilterManager.prototype.destroy=function(){var contextLost=arguments.length>0&&void 0!==arguments[0]&&arguments[0],renderer=this.renderer,filters=this.managedFilters;renderer.off("prerender",this.onPrerender,this);for(var i=0;i<filters.length;i++)contextLost||filters[i].glShaders[renderer.CONTEXT_UID].destroy(),delete filters[i].glShaders[renderer.CONTEXT_UID];this.shaderCache={},contextLost?this.pool={}:this.emptyPool()},FilterManager.prototype.getPotRenderTarget=function(gl,minWidth,minHeight,resolution){var key="screen";minWidth*=resolution,minHeight*=resolution,minWidth===this._screenWidth&&minHeight===this._screenHeight||(minWidth=_bitTwiddle2.default.nextPow2(minWidth),minHeight=_bitTwiddle2.default.nextPow2(minHeight),key=(65535&minWidth)<<16|65535&minHeight),this.pool[key]||(this.pool[key]=[]);var renderTarget=this.pool[key].pop();if(!renderTarget){var tex=this.renderer.boundTextures[0];gl.activeTexture(gl.TEXTURE0),renderTarget=new _RenderTarget2.default(gl,minWidth,minHeight,null,1),gl.bindTexture(gl.TEXTURE_2D,tex._glTextures[this.renderer.CONTEXT_UID].texture)}return renderTarget.resolution=resolution,renderTarget.defaultFrame.width=renderTarget.size.width=minWidth/resolution,renderTarget.defaultFrame.height=renderTarget.size.height=minHeight/resolution,renderTarget.filterPoolKey=key,renderTarget},FilterManager.prototype.emptyPool=function(){for(var i in this.pool){var textures=this.pool[i];if(textures)for(var j=0;j<textures.length;j++)textures[j].destroy(!0)}this.pool={}},FilterManager.prototype.freePotRenderTarget=function(renderTarget){this.pool[renderTarget.filterPoolKey].push(renderTarget)},FilterManager.prototype.onPrerender=function(){if(this._screenWidth!==this.renderer.view.width||this._screenHeight!==this.renderer.view.height){this._screenWidth=this.renderer.view.width,this._screenHeight=this.renderer.view.height;var textures=this.pool.screen;if(textures)for(var j=0;j<textures.length;j++)textures[j].destroy(!0);this.pool.screen=[]}},FilterManager}(_WebGLManager3.default);exports.default=FilterManager},{"../../../Shader":148,"../../../math":174,"../filters/filterTransforms":192,"../utils/Quad":199,"../utils/RenderTarget":200,"./WebGLManager":197,"bit-twiddle":114}],195:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _WebGLManager2=require("./WebGLManager"),_WebGLManager3=_interopRequireDefault(_WebGLManager2),_SpriteMaskFilter=require("../filters/spriteMask/SpriteMaskFilter"),_SpriteMaskFilter2=_interopRequireDefault(_SpriteMaskFilter),MaskManager=function(_WebGLManager){function MaskManager(renderer){_classCallCheck(this,MaskManager);var _this=_possibleConstructorReturn(this,_WebGLManager.call(this,renderer));return _this.scissor=!1,_this.scissorData=null,_this.scissorRenderTarget=null,_this.enableScissor=!0,_this.alphaMaskPool=[],_this.alphaMaskIndex=0,_this}return _inherits(MaskManager,_WebGLManager),MaskManager.prototype.pushMask=function(target,maskData){if(maskData.texture)this.pushSpriteMask(target,maskData);else if(this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencilManager.stencilMaskStack.length&&maskData.isFastRect()){var matrix=maskData.worldTransform,rot=Math.atan2(matrix.b,matrix.a);rot=Math.round(rot*(180/Math.PI)),rot%90?this.pushStencilMask(maskData):this.pushScissorMask(target,maskData)}else this.pushStencilMask(maskData)},MaskManager.prototype.popMask=function(target,maskData){maskData.texture?this.popSpriteMask(target,maskData):this.enableScissor&&!this.renderer.stencilManager.stencilMaskStack.length?this.popScissorMask(target,maskData):this.popStencilMask(target,maskData)},MaskManager.prototype.pushSpriteMask=function(target,maskData){var alphaMaskFilter=this.alphaMaskPool[this.alphaMaskIndex];alphaMaskFilter||(alphaMaskFilter=this.alphaMaskPool[this.alphaMaskIndex]=[new _SpriteMaskFilter2.default(maskData)]),alphaMaskFilter[0].resolution=this.renderer.resolution,alphaMaskFilter[0].maskSprite=maskData,target.filterArea=maskData.getBounds(!0),this.renderer.filterManager.pushFilter(target,alphaMaskFilter),this.alphaMaskIndex++},MaskManager.prototype.popSpriteMask=function(){this.renderer.filterManager.popFilter(),this.alphaMaskIndex--},MaskManager.prototype.pushStencilMask=function(maskData){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.pushStencil(maskData)},MaskManager.prototype.popStencilMask=function(){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.popStencil()},MaskManager.prototype.pushScissorMask=function(target,maskData){maskData.renderable=!0;var renderTarget=this.renderer._activeRenderTarget,bounds=maskData.getBounds();bounds.fit(renderTarget.size),maskData.renderable=!1,this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var resolution=this.renderer.resolution;this.renderer.gl.scissor(bounds.x*resolution,(renderTarget.root?renderTarget.size.height-bounds.y-bounds.height:bounds.y)*resolution,bounds.width*resolution,bounds.height*resolution),this.scissorRenderTarget=renderTarget,this.scissorData=maskData,this.scissor=!0},MaskManager.prototype.popScissorMask=function(){this.scissorRenderTarget=null,this.scissorData=null,this.scissor=!1;var gl=this.renderer.gl;gl.disable(gl.SCISSOR_TEST)},MaskManager}(_WebGLManager3.default);exports.default=MaskManager},{"../filters/spriteMask/SpriteMaskFilter":193,"./WebGLManager":197}],196:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _WebGLManager2=require("./WebGLManager"),_WebGLManager3=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_WebGLManager2),StencilManager=function(_WebGLManager){function StencilManager(renderer){_classCallCheck(this,StencilManager);var _this=_possibleConstructorReturn(this,_WebGLManager.call(this,renderer));return _this.stencilMaskStack=null,_this}return _inherits(StencilManager,_WebGLManager),StencilManager.prototype.setMaskStack=function(stencilMaskStack){this.stencilMaskStack=stencilMaskStack;var gl=this.renderer.gl;0===stencilMaskStack.length?gl.disable(gl.STENCIL_TEST):gl.enable(gl.STENCIL_TEST)},StencilManager.prototype.pushStencil=function(graphics){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.renderer._activeRenderTarget.attachStencilBuffer();var gl=this.renderer.gl,prevMaskCount=this.stencilMaskStack.length;0===prevMaskCount&&gl.enable(gl.STENCIL_TEST),this.stencilMaskStack.push(graphics),gl.colorMask(!1,!1,!1,!1),gl.stencilFunc(gl.EQUAL,prevMaskCount,this._getBitwiseMask()),gl.stencilOp(gl.KEEP,gl.KEEP,gl.INCR),this.renderer.plugins.graphics.render(graphics),this._useCurrent()},StencilManager.prototype.popStencil=function(){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);var gl=this.renderer.gl,graphics=this.stencilMaskStack.pop();0===this.stencilMaskStack.length?(gl.disable(gl.STENCIL_TEST),gl.clear(gl.STENCIL_BUFFER_BIT),gl.clearStencil(0)):(gl.colorMask(!1,!1,!1,!1),gl.stencilOp(gl.KEEP,gl.KEEP,gl.DECR),this.renderer.plugins.graphics.render(graphics),this._useCurrent())},StencilManager.prototype._useCurrent=function(){var gl=this.renderer.gl;gl.colorMask(!0,!0,!0,!0),gl.stencilFunc(gl.EQUAL,this.stencilMaskStack.length,this._getBitwiseMask()),gl.stencilOp(gl.KEEP,gl.KEEP,gl.KEEP)},StencilManager.prototype._getBitwiseMask=function(){return(1<<this.stencilMaskStack.length)-1},StencilManager.prototype.destroy=function(){_WebGLManager3.default.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},StencilManager}(_WebGLManager3.default);exports.default=StencilManager},{"./WebGLManager":197}],197:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var WebGLManager=function(){function WebGLManager(renderer){_classCallCheck(this,WebGLManager),this.renderer=renderer,this.renderer.on("context",this.onContextChange,this)}return WebGLManager.prototype.onContextChange=function(){},WebGLManager.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null},WebGLManager}();exports.default=WebGLManager},{}],198:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _WebGLManager2=require("../managers/WebGLManager"),_WebGLManager3=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_WebGLManager2),ObjectRenderer=function(_WebGLManager){function ObjectRenderer(){return _classCallCheck(this,ObjectRenderer),_possibleConstructorReturn(this,_WebGLManager.apply(this,arguments))}return _inherits(ObjectRenderer,_WebGLManager),ObjectRenderer.prototype.start=function(){},ObjectRenderer.prototype.stop=function(){this.flush()},ObjectRenderer.prototype.flush=function(){},ObjectRenderer.prototype.render=function(object){},ObjectRenderer}(_WebGLManager3.default);exports.default=ObjectRenderer},{"../managers/WebGLManager":197}],199:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _pixiGlCore=require("pixi-gl-core"),_pixiGlCore2=_interopRequireDefault(_pixiGlCore),_createIndicesForQuads=require("../../../utils/createIndicesForQuads"),_createIndicesForQuads2=_interopRequireDefault(_createIndicesForQuads),Quad=function(){function Quad(gl,state){_classCallCheck(this,Quad),this.gl=gl,this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.interleaved=new Float32Array(16);for(var i=0;i<4;i++)this.interleaved[4*i]=this.vertices[2*i],this.interleaved[4*i+1]=this.vertices[2*i+1],this.interleaved[4*i+2]=this.uvs[2*i],this.interleaved[4*i+3]=this.uvs[2*i+1];this.indices=(0,_createIndicesForQuads2.default)(1),this.vertexBuffer=_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl,this.interleaved,gl.STATIC_DRAW),this.indexBuffer=_pixiGlCore2.default.GLBuffer.createIndexBuffer(gl,this.indices,gl.STATIC_DRAW),this.vao=new _pixiGlCore2.default.VertexArrayObject(gl,state)}return Quad.prototype.initVao=function(shader){this.vao.clear().addIndex(this.indexBuffer).addAttribute(this.vertexBuffer,shader.attributes.aVertexPosition,this.gl.FLOAT,!1,16,0).addAttribute(this.vertexBuffer,shader.attributes.aTextureCoord,this.gl.FLOAT,!1,16,8)},Quad.prototype.map=function(targetTextureFrame,destinationFrame){var x=0,y=0;return this.uvs[0]=x,this.uvs[1]=y,this.uvs[2]=x+destinationFrame.width/targetTextureFrame.width,this.uvs[3]=y,this.uvs[4]=x+destinationFrame.width/targetTextureFrame.width,this.uvs[5]=y+destinationFrame.height/targetTextureFrame.height,this.uvs[6]=x,this.uvs[7]=y+destinationFrame.height/targetTextureFrame.height,x=destinationFrame.x,y=destinationFrame.y,this.vertices[0]=x,this.vertices[1]=y,this.vertices[2]=x+destinationFrame.width,this.vertices[3]=y,this.vertices[4]=x+destinationFrame.width,this.vertices[5]=y+destinationFrame.height,this.vertices[6]=x,this.vertices[7]=y+destinationFrame.height,this},Quad.prototype.upload=function(){for(var i=0;i<4;i++)this.interleaved[4*i]=this.vertices[2*i],this.interleaved[4*i+1]=this.vertices[2*i+1],this.interleaved[4*i+2]=this.uvs[2*i],this.interleaved[4*i+3]=this.uvs[2*i+1];return this.vertexBuffer.upload(this.interleaved),this},Quad.prototype.destroy=function(){var gl=this.gl;gl.deleteBuffer(this.vertexBuffer),gl.deleteBuffer(this.indexBuffer)},Quad}();exports.default=Quad},{"../../../utils/createIndicesForQuads":227,"pixi-gl-core":133}],200:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _math=require("../../../math"),_const=require("../../../const"),_settings=require("../../../settings"),_settings2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_settings),_pixiGlCore=require("pixi-gl-core"),RenderTarget=function(){function RenderTarget(gl,width,height,scaleMode,resolution,root){_classCallCheck(this,RenderTarget),this.gl=gl,this.frameBuffer=null,this.texture=null,this.clearColor=[0,0,0,0],this.size=new _math.Rectangle(0,0,1,1),this.resolution=resolution||_settings2.default.RESOLUTION,this.projectionMatrix=new _math.Matrix,this.transform=null,this.frame=null,this.defaultFrame=new _math.Rectangle,this.destinationFrame=null,this.sourceFrame=null,this.stencilBuffer=null,this.stencilMaskStack=[],this.filterData=null,this.filterPoolKey="",this.scaleMode=void 0!==scaleMode?scaleMode:_settings2.default.SCALE_MODE,this.root=root,this.root?(this.frameBuffer=new _pixiGlCore.GLFramebuffer(gl,100,100),this.frameBuffer.framebuffer=null):(this.frameBuffer=_pixiGlCore.GLFramebuffer.createRGBA(gl,100,100),this.scaleMode===_const.SCALE_MODES.NEAREST?this.frameBuffer.texture.enableNearestScaling():this.frameBuffer.texture.enableLinearScaling(),this.texture=this.frameBuffer.texture),this.setFrame(),this.resize(width,height)}return RenderTarget.prototype.clear=function(clearColor){var cc=clearColor||this.clearColor;this.frameBuffer.clear(cc[0],cc[1],cc[2],cc[3])},RenderTarget.prototype.attachStencilBuffer=function(){this.root||this.frameBuffer.enableStencil()},RenderTarget.prototype.setFrame=function(destinationFrame,sourceFrame){this.destinationFrame=destinationFrame||this.destinationFrame||this.defaultFrame,this.sourceFrame=sourceFrame||this.sourceFrame||this.destinationFrame},RenderTarget.prototype.activate=function(){var gl=this.gl;this.frameBuffer.bind(),this.calculateProjection(this.destinationFrame,this.sourceFrame),this.transform&&this.projectionMatrix.append(this.transform),this.destinationFrame!==this.sourceFrame?(gl.enable(gl.SCISSOR_TEST),gl.scissor(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)):gl.disable(gl.SCISSOR_TEST),gl.viewport(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)},RenderTarget.prototype.calculateProjection=function(destinationFrame,sourceFrame){var pm=this.projectionMatrix;sourceFrame=sourceFrame||destinationFrame,pm.identity(),this.root?(pm.a=1/destinationFrame.width*2,pm.d=-1/destinationFrame.height*2,pm.tx=-1-sourceFrame.x*pm.a,pm.ty=1-sourceFrame.y*pm.d):(pm.a=1/destinationFrame.width*2,pm.d=1/destinationFrame.height*2,pm.tx=-1-sourceFrame.x*pm.a,pm.ty=-1-sourceFrame.y*pm.d)},RenderTarget.prototype.resize=function(width,height){if(width|=0,height|=0,this.size.width!==width||this.size.height!==height){this.size.width=width,this.size.height=height,this.defaultFrame.width=width,this.defaultFrame.height=height,this.frameBuffer.resize(width*this.resolution,height*this.resolution);var projectionFrame=this.frame||this.size;this.calculateProjection(projectionFrame)}},RenderTarget.prototype.destroy=function(){this.frameBuffer.destroy(),this.frameBuffer=null,this.texture=null},RenderTarget}();exports.default=RenderTarget},{"../../../const":150,"../../../math":174,"../../../settings":205,"pixi-gl-core":133}],201:[function(require,module,exports){"use strict";function checkMaxIfStatmentsInShader(maxIfs,gl){var createTempContext=!gl;if(0===maxIfs)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");if(createTempContext){var tinyCanvas=document.createElement("canvas");tinyCanvas.width=1,tinyCanvas.height=1,gl=_pixiGlCore2.default.createContext(tinyCanvas)}for(var shader=gl.createShader(gl.FRAGMENT_SHADER);;){var fragmentSrc=fragTemplate.replace(/%forloop%/gi,generateIfTestSrc(maxIfs));if(gl.shaderSource(shader,fragmentSrc),gl.compileShader(shader),gl.getShaderParameter(shader,gl.COMPILE_STATUS))break;maxIfs=maxIfs/2|0}return createTempContext&&gl.getExtension("WEBGL_lose_context")&&gl.getExtension("WEBGL_lose_context").loseContext(),maxIfs}function generateIfTestSrc(maxIfs){for(var src="",i=0;i<maxIfs;++i)i>0&&(src+="\nelse "),i<maxIfs-1&&(src+="if(test == "+i+".0){}");return src}exports.__esModule=!0,exports.default=checkMaxIfStatmentsInShader;var _pixiGlCore=require("pixi-gl-core"),_pixiGlCore2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_pixiGlCore),fragTemplate=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n")},{"pixi-gl-core":133}],202:[function(require,module,exports){"use strict";function mapWebGLBlendModesToPixi(gl){var array=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return array[_const.BLEND_MODES.NORMAL]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.ADD]=[gl.ONE,gl.DST_ALPHA],array[_const.BLEND_MODES.MULTIPLY]=[gl.DST_COLOR,gl.ONE_MINUS_SRC_ALPHA],
array[_const.BLEND_MODES.SCREEN]=[gl.ONE,gl.ONE_MINUS_SRC_COLOR],array[_const.BLEND_MODES.OVERLAY]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.DARKEN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.LIGHTEN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.COLOR_DODGE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.COLOR_BURN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.HARD_LIGHT]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.SOFT_LIGHT]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.DIFFERENCE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.EXCLUSION]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.HUE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.SATURATION]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.COLOR]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.LUMINOSITY]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.NORMAL_NPM]=[gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA],array[_const.BLEND_MODES.ADD_NPM]=[gl.SRC_ALPHA,gl.DST_ALPHA,gl.ONE,gl.DST_ALPHA],array[_const.BLEND_MODES.SCREEN_NPM]=[gl.SRC_ALPHA,gl.ONE_MINUS_SRC_COLOR,gl.ONE,gl.ONE_MINUS_SRC_COLOR],array}exports.__esModule=!0,exports.default=mapWebGLBlendModesToPixi;var _const=require("../../../const")},{"../../../const":150}],203:[function(require,module,exports){"use strict";function mapWebGLDrawModesToPixi(gl){var object=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return object[_const.DRAW_MODES.POINTS]=gl.POINTS,object[_const.DRAW_MODES.LINES]=gl.LINES,object[_const.DRAW_MODES.LINE_LOOP]=gl.LINE_LOOP,object[_const.DRAW_MODES.LINE_STRIP]=gl.LINE_STRIP,object[_const.DRAW_MODES.TRIANGLES]=gl.TRIANGLES,object[_const.DRAW_MODES.TRIANGLE_STRIP]=gl.TRIANGLE_STRIP,object[_const.DRAW_MODES.TRIANGLE_FAN]=gl.TRIANGLE_FAN,object}exports.__esModule=!0,exports.default=mapWebGLDrawModesToPixi;var _const=require("../../../const")},{"../../../const":150}],204:[function(require,module,exports){"use strict";function validateContext(gl){gl.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")}exports.__esModule=!0,exports.default=validateContext},{}],205:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.__esModule=!0;var _maxRecommendedTextures=require("./utils/maxRecommendedTextures"),_maxRecommendedTextures2=_interopRequireDefault(_maxRecommendedTextures),_canUploadSameBuffer=require("./utils/canUploadSameBuffer"),_canUploadSameBuffer2=_interopRequireDefault(_canUploadSameBuffer);exports.default={TARGET_FPMS:.06,MIPMAP_TEXTURES:!0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:(0,_maxRecommendedTextures2.default)(32),SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@([0-9\.]+)x/,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1,width:800,height:600,legacy:!1},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:0,SCALE_MODE:0,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:"mediump",CAN_UPLOAD_SAME_BUFFER:(0,_canUploadSameBuffer2.default)(),MESH_CANVAS_PADDING:0}},{"./utils/canUploadSameBuffer":226,"./utils/maxRecommendedTextures":231}],206:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_math=require("../math"),_utils=require("../utils"),_const=require("../const"),_Texture=require("../textures/Texture"),_Texture2=_interopRequireDefault(_Texture),_Container2=require("../display/Container"),_Container3=_interopRequireDefault(_Container2),tempPoint=new _math.Point,Sprite=function(_Container){function Sprite(texture){_classCallCheck(this,Sprite);var _this=_possibleConstructorReturn(this,_Container.call(this));return _this._anchor=new _math.ObservablePoint(_this._onAnchorUpdate,_this,texture?texture.defaultAnchor.x:0,texture?texture.defaultAnchor.y:0),_this._texture=null,_this._width=0,_this._height=0,_this._tint=null,_this._tintRGB=null,_this.tint=16777215,_this.blendMode=_const.BLEND_MODES.NORMAL,_this.shader=null,_this.cachedTint=16777215,_this.texture=texture||_Texture2.default.EMPTY,_this.vertexData=new Float32Array(8),_this.vertexTrimmedData=null,_this._transformID=-1,_this._textureID=-1,_this._transformTrimmedID=-1,_this._textureTrimmedID=-1,_this.pluginName="sprite",_this}return _inherits(Sprite,_Container),Sprite.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this.cachedTint=16777215,this._width&&(this.scale.x=(0,_utils.sign)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=(0,_utils.sign)(this.scale.y)*this._height/this._texture.orig.height)},Sprite.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},Sprite.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID||this._textureID!==this._texture._updateID){this._transformID=this.transform._worldID,this._textureID=this._texture._updateID;var texture=this._texture,wt=this.transform.worldTransform,a=wt.a,b=wt.b,c=wt.c,d=wt.d,tx=wt.tx,ty=wt.ty,vertexData=this.vertexData,trim=texture.trim,orig=texture.orig,anchor=this._anchor,w0=0,w1=0,h0=0,h1=0;trim?(w1=trim.x-anchor._x*orig.width,w0=w1+trim.width,h1=trim.y-anchor._y*orig.height,h0=h1+trim.height):(w1=-anchor._x*orig.width,w0=w1+orig.width,h1=-anchor._y*orig.height,h0=h1+orig.height),vertexData[0]=a*w1+c*h1+tx,vertexData[1]=d*h1+b*w1+ty,vertexData[2]=a*w0+c*h1+tx,vertexData[3]=d*h1+b*w0+ty,vertexData[4]=a*w0+c*h0+tx,vertexData[5]=d*h0+b*w0+ty,vertexData[6]=a*w1+c*h0+tx,vertexData[7]=d*h0+b*w1+ty}},Sprite.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var texture=this._texture,vertexData=this.vertexTrimmedData,orig=texture.orig,anchor=this._anchor,wt=this.transform.worldTransform,a=wt.a,b=wt.b,c=wt.c,d=wt.d,tx=wt.tx,ty=wt.ty,w1=-anchor._x*orig.width,w0=w1+orig.width,h1=-anchor._y*orig.height,h0=h1+orig.height;vertexData[0]=a*w1+c*h1+tx,vertexData[1]=d*h1+b*w1+ty,vertexData[2]=a*w0+c*h1+tx,vertexData[3]=d*h1+b*w0+ty,vertexData[4]=a*w0+c*h0+tx,vertexData[5]=d*h0+b*w0+ty,vertexData[6]=a*w1+c*h0+tx,vertexData[7]=d*h0+b*w1+ty},Sprite.prototype._renderWebGL=function(renderer){this.calculateVertices(),renderer.setObjectRenderer(renderer.plugins[this.pluginName]),renderer.plugins[this.pluginName].render(this)},Sprite.prototype._renderCanvas=function(renderer){renderer.plugins[this.pluginName].render(this)},Sprite.prototype._calculateBounds=function(){var trim=this._texture.trim,orig=this._texture.orig;!trim||trim.width===orig.width&&trim.height===orig.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},Sprite.prototype.getLocalBounds=function(rect){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),rect||(this._localBoundsRect||(this._localBoundsRect=new _math.Rectangle),rect=this._localBoundsRect),this._bounds.getRectangle(rect)):_Container.prototype.getLocalBounds.call(this,rect)},Sprite.prototype.containsPoint=function(point){this.worldTransform.applyInverse(point,tempPoint);var width=this._texture.orig.width,height=this._texture.orig.height,x1=-width*this.anchor.x,y1=0;return tempPoint.x>=x1&&tempPoint.x<x1+width&&(y1=-height*this.anchor.y,tempPoint.y>=y1&&tempPoint.y<y1+height)},Sprite.prototype.destroy=function(options){if(_Container.prototype.destroy.call(this,options),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof options?options:options&&options.texture){var destroyBaseTexture="boolean"==typeof options?options:options&&options.baseTexture;this._texture.destroy(!!destroyBaseTexture)}this._texture=null,this.shader=null},Sprite.from=function(source){return new Sprite(_Texture2.default.from(source))},Sprite.fromFrame=function(frameId){var texture=_utils.TextureCache[frameId];if(!texture)throw new Error('The frameId "'+frameId+'" does not exist in the texture cache');return new Sprite(texture)},Sprite.fromImage=function(imageId,crossorigin,scaleMode){return new Sprite(_Texture2.default.fromImage(imageId,crossorigin,scaleMode))},_createClass(Sprite,[{key:"width",get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(value){var s=(0,_utils.sign)(this.scale.x)||1;this.scale.x=s*value/this._texture.orig.width,this._width=value}},{key:"height",get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(value){var s=(0,_utils.sign)(this.scale.y)||1;this.scale.y=s*value/this._texture.orig.height,this._height=value}},{key:"anchor",get:function(){return this._anchor},set:function(value){this._anchor.copy(value)}},{key:"tint",get:function(){return this._tint},set:function(value){this._tint=value,this._tintRGB=(value>>16)+(65280&value)+((255&value)<<16)}},{key:"texture",get:function(){return this._texture},set:function(value){this._texture!==value&&(this._texture=value||_Texture2.default.EMPTY,this.cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,value&&(value.baseTexture.hasLoaded?this._onTextureUpdate():value.once("update",this._onTextureUpdate,this)))}}]),Sprite}(_Container3.default);exports.default=Sprite},{"../const":150,"../display/Container":152,"../math":174,"../textures/Texture":219,"../utils":229}],207:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _CanvasRenderer=require("../../renderers/canvas/CanvasRenderer"),_CanvasRenderer2=_interopRequireDefault(_CanvasRenderer),_const=require("../../const"),_math=require("../../math"),_CanvasTinter=require("./CanvasTinter"),_CanvasTinter2=_interopRequireDefault(_CanvasTinter),canvasRenderWorldTransform=new _math.Matrix,CanvasSpriteRenderer=function(){function CanvasSpriteRenderer(renderer){_classCallCheck(this,CanvasSpriteRenderer),this.renderer=renderer}return CanvasSpriteRenderer.prototype.render=function(sprite){var texture=sprite._texture,renderer=this.renderer,width=texture._frame.width,height=texture._frame.height,wt=sprite.transform.worldTransform,dx=0,dy=0;if(!(texture.orig.width<=0||texture.orig.height<=0)&&texture.baseTexture.source&&(renderer.setBlendMode(sprite.blendMode),texture.valid)){renderer.context.globalAlpha=sprite.worldAlpha;var smoothingEnabled=texture.baseTexture.scaleMode===_const.SCALE_MODES.LINEAR;renderer.smoothProperty&&renderer.context[renderer.smoothProperty]!==smoothingEnabled&&(renderer.context[renderer.smoothProperty]=smoothingEnabled),texture.trim?(dx=texture.trim.width/2+texture.trim.x-sprite.anchor.x*texture.orig.width,dy=texture.trim.height/2+texture.trim.y-sprite.anchor.y*texture.orig.height):(dx=(.5-sprite.anchor.x)*texture.orig.width,dy=(.5-sprite.anchor.y)*texture.orig.height),texture.rotate&&(wt.copy(canvasRenderWorldTransform),wt=canvasRenderWorldTransform,_math.GroupD8.matrixAppendRotationInv(wt,texture.rotate,dx,dy),dx=0,dy=0),dx-=width/2,dy-=height/2,renderer.roundPixels?(renderer.context.setTransform(wt.a,wt.b,wt.c,wt.d,wt.tx*renderer.resolution|0,wt.ty*renderer.resolution|0),dx|=0,dy|=0):renderer.context.setTransform(wt.a,wt.b,wt.c,wt.d,wt.tx*renderer.resolution,wt.ty*renderer.resolution);var resolution=texture.baseTexture.resolution;16777215!==sprite.tint?(sprite.cachedTint===sprite.tint&&sprite.tintedTexture.tintId===sprite._texture._updateID||(sprite.cachedTint=sprite.tint,sprite.tintedTexture=_CanvasTinter2.default.getTintedTexture(sprite,sprite.tint)),renderer.context.drawImage(sprite.tintedTexture,0,0,width*resolution,height*resolution,dx*renderer.resolution,dy*renderer.resolution,width*renderer.resolution,height*renderer.resolution)):renderer.context.drawImage(texture.baseTexture.source,texture._frame.x*resolution,texture._frame.y*resolution,width*resolution,height*resolution,dx*renderer.resolution,dy*renderer.resolution,width*renderer.resolution,height*renderer.resolution)}},CanvasSpriteRenderer.prototype.destroy=function(){this.renderer=null},CanvasSpriteRenderer}();exports.default=CanvasSpriteRenderer,_CanvasRenderer2.default.registerPlugin("sprite",CanvasSpriteRenderer)},{"../../const":150,"../../math":174,"../../renderers/canvas/CanvasRenderer":181,"./CanvasTinter":208}],208:[function(require,module,exports){"use strict";exports.__esModule=!0;var _utils=require("../../utils"),_canUseNewCanvasBlendModes=require("../../renderers/canvas/utils/canUseNewCanvasBlendModes"),_canUseNewCanvasBlendModes2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_canUseNewCanvasBlendModes),CanvasTinter={getTintedTexture:function(sprite,color){var texture=sprite._texture;color=CanvasTinter.roundColor(color);var stringColor="#"+("00000"+(0|color).toString(16)).substr(-6);texture.tintCache=texture.tintCache||{};var cachedTexture=texture.tintCache[stringColor],canvas=void 0;if(cachedTexture){if(cachedTexture.tintId===texture._updateID)return texture.tintCache[stringColor];canvas=texture.tintCache[stringColor]}else canvas=CanvasTinter.canvas||document.createElement("canvas");if(CanvasTinter.tintMethod(texture,color,canvas),canvas.tintId=texture._updateID,CanvasTinter.convertTintToImage){var tintImage=new Image;tintImage.src=canvas.toDataURL(),texture.tintCache[stringColor]=tintImage}else texture.tintCache[stringColor]=canvas,CanvasTinter.canvas=null;return canvas},tintWithMultiply:function(texture,color,canvas){var context=canvas.getContext("2d"),crop=texture._frame.clone(),resolution=texture.baseTexture.resolution;crop.x*=resolution,crop.y*=resolution,crop.width*=resolution,crop.height*=resolution,canvas.width=Math.ceil(crop.width),canvas.height=Math.ceil(crop.height),context.save(),context.fillStyle="#"+("00000"+(0|color).toString(16)).substr(-6),context.fillRect(0,0,crop.width,crop.height),context.globalCompositeOperation="multiply",context.drawImage(texture.baseTexture.source,crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height),context.globalCompositeOperation="destination-atop",context.drawImage(texture.baseTexture.source,crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height),context.restore()},tintWithOverlay:function(texture,color,canvas){var context=canvas.getContext("2d"),crop=texture._frame.clone(),resolution=texture.baseTexture.resolution;crop.x*=resolution,crop.y*=resolution,crop.width*=resolution,crop.height*=resolution,canvas.width=Math.ceil(crop.width),canvas.height=Math.ceil(crop.height),context.save(),context.globalCompositeOperation="copy",context.fillStyle="#"+("00000"+(0|color).toString(16)).substr(-6),context.fillRect(0,0,crop.width,crop.height),context.globalCompositeOperation="destination-atop",context.drawImage(texture.baseTexture.source,crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height),context.restore()},tintWithPerPixel:function(texture,color,canvas){var context=canvas.getContext("2d"),crop=texture._frame.clone(),resolution=texture.baseTexture.resolution;crop.x*=resolution,crop.y*=resolution,crop.width*=resolution,crop.height*=resolution,canvas.width=Math.ceil(crop.width),canvas.height=Math.ceil(crop.height),context.save(),context.globalCompositeOperation="copy",context.drawImage(texture.baseTexture.source,crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height),context.restore();for(var rgbValues=(0,_utils.hex2rgb)(color),r=rgbValues[0],g=rgbValues[1],b=rgbValues[2],pixelData=context.getImageData(0,0,crop.width,crop.height),pixels=pixelData.data,i=0;i<pixels.length;i+=4)pixels[i+0]*=r,pixels[i+1]*=g,pixels[i+2]*=b;context.putImageData(pixelData,0,0)},roundColor:function(color){var step=CanvasTinter.cacheStepsPerColorChannel,rgbValues=(0,_utils.hex2rgb)(color);return rgbValues[0]=Math.min(255,rgbValues[0]/step*step),rgbValues[1]=Math.min(255,rgbValues[1]/step*step),rgbValues[2]=Math.min(255,rgbValues[2]/step*step),(0,_utils.rgb2hex)(rgbValues)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:(0,_canUseNewCanvasBlendModes2.default)(),tintMethod:0};CanvasTinter.tintMethod=CanvasTinter.canUseMultiply?CanvasTinter.tintWithMultiply:CanvasTinter.tintWithPerPixel,exports.default=CanvasTinter},{"../../renderers/canvas/utils/canUseNewCanvasBlendModes":184,"../../utils":229}],209:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var Buffer=function(){function Buffer(size){_classCallCheck(this,Buffer),this.vertices=new ArrayBuffer(size),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)}return Buffer.prototype.destroy=function(){this.vertices=null,this.positions=null,this.uvs=null,this.colors=null},Buffer}();exports.default=Buffer},{}],210:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _ObjectRenderer2=require("../../renderers/webgl/utils/ObjectRenderer"),_ObjectRenderer3=_interopRequireDefault(_ObjectRenderer2),_WebGLRenderer=require("../../renderers/webgl/WebGLRenderer"),_WebGLRenderer2=_interopRequireDefault(_WebGLRenderer),_createIndicesForQuads=require("../../utils/createIndicesForQuads"),_createIndicesForQuads2=_interopRequireDefault(_createIndicesForQuads),_generateMultiTextureShader=require("./generateMultiTextureShader"),_generateMultiTextureShader2=_interopRequireDefault(_generateMultiTextureShader),_checkMaxIfStatmentsInShader=require("../../renderers/webgl/utils/checkMaxIfStatmentsInShader"),_checkMaxIfStatmentsInShader2=_interopRequireDefault(_checkMaxIfStatmentsInShader),_BatchBuffer=require("./BatchBuffer"),_BatchBuffer2=_interopRequireDefault(_BatchBuffer),_settings=require("../../settings"),_settings2=_interopRequireDefault(_settings),_utils=require("../../utils"),_pixiGlCore=require("pixi-gl-core"),_pixiGlCore2=_interopRequireDefault(_pixiGlCore),_bitTwiddle=require("bit-twiddle"),_bitTwiddle2=_interopRequireDefault(_bitTwiddle),TICK=0,TEXTURE_TICK=0,SpriteRenderer=function(_ObjectRenderer){function SpriteRenderer(renderer){_classCallCheck(this,SpriteRenderer);var _this=_possibleConstructorReturn(this,_ObjectRenderer.call(this,renderer));_this.vertSize=5,_this.vertByteSize=4*_this.vertSize,_this.size=_settings2.default.SPRITE_BATCH_SIZE,_this.buffers=[];for(var i=1;i<=_bitTwiddle2.default.nextPow2(_this.size);i*=2)_this.buffers.push(new _BatchBuffer2.default(4*i*_this.vertByteSize));_this.indices=(0,_createIndicesForQuads2.default)(_this.size),_this.shader=null,_this.currentIndex=0,_this.groups=[];for(var k=0;k<_this.size;k++)_this.groups[k]={textures:[],textureCount:0,ids:[],size:0,start:0,blend:0};return _this.sprites=[],_this.vertexBuffers=[],_this.vaos=[],_this.vaoMax=2,_this.vertexCount=0,_this.renderer.on("prerender",_this.onPrerender,_this),_this}return _inherits(SpriteRenderer,_ObjectRenderer),SpriteRenderer.prototype.onContextChange=function(){var gl=this.renderer.gl;this.renderer.legacy?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS),_settings2.default.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=(0,_checkMaxIfStatmentsInShader2.default)(this.MAX_TEXTURES,gl)),this.shader=(0,_generateMultiTextureShader2.default)(gl,this.MAX_TEXTURES),this.indexBuffer=_pixiGlCore2.default.GLBuffer.createIndexBuffer(gl,this.indices,gl.STATIC_DRAW),this.renderer.bindVao(null);for(var attrs=this.shader.attributes,i=0;i<this.vaoMax;i++){var vertexBuffer=this.vertexBuffers[i]=_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl,null,gl.STREAM_DRAW),vao=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(vertexBuffer,attrs.aVertexPosition,gl.FLOAT,!1,this.vertByteSize,0).addAttribute(vertexBuffer,attrs.aTextureCoord,gl.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(vertexBuffer,attrs.aColor,gl.UNSIGNED_BYTE,!0,this.vertByteSize,12);attrs.aTextureId&&vao.addAttribute(vertexBuffer,attrs.aTextureId,gl.FLOAT,!1,this.vertByteSize,16),this.vaos[i]=vao}this.vao=this.vaos[0],this.currentBlendMode=99999,this.boundTextures=new Array(this.MAX_TEXTURES)},SpriteRenderer.prototype.onPrerender=function(){this.vertexCount=0},SpriteRenderer.prototype.render=function(sprite){this.currentIndex>=this.size&&this.flush(),sprite._texture._uvs&&(this.sprites[this.currentIndex++]=sprite)},SpriteRenderer.prototype.flush=function(){if(0!==this.currentIndex){var gl=this.renderer.gl,MAX_TEXTURES=this.MAX_TEXTURES,np2=_bitTwiddle2.default.nextPow2(this.currentIndex),log2=_bitTwiddle2.default.log2(np2),buffer=this.buffers[log2],sprites=this.sprites,groups=this.groups,float32View=buffer.float32View,uint32View=buffer.uint32View,boundTextures=this.boundTextures,rendererBoundTextures=this.renderer.boundTextures,touch=this.renderer.textureGC.count,index=0,nextTexture=void 0,currentTexture=void 0,groupCount=1,textureCount=0,currentGroup=groups[0],vertexData=void 0,uvs=void 0,blendMode=_utils.premultiplyBlendMode[sprites[0]._texture.baseTexture.premultipliedAlpha?1:0][sprites[0].blendMode];currentGroup.textureCount=0,currentGroup.start=0,currentGroup.blend=blendMode,TICK++;var i=void 0;for(i=0;i<MAX_TEXTURES;++i){var bt=rendererBoundTextures[i];bt._enabled!==TICK?(boundTextures[i]=bt,bt._virtalBoundId=i,bt._enabled=TICK):boundTextures[i]=this.renderer.emptyTextures[i]}for(TICK++,i=0;i<this.currentIndex;++i){var sprite=sprites[i];sprites[i]=null,nextTexture=sprite._texture.baseTexture;var spriteBlendMode=_utils.premultiplyBlendMode[Number(nextTexture.premultipliedAlpha)][sprite.blendMode];if(blendMode!==spriteBlendMode&&(blendMode=spriteBlendMode,currentTexture=null,textureCount=MAX_TEXTURES,TICK++),currentTexture!==nextTexture&&(currentTexture=nextTexture,nextTexture._enabled!==TICK)){if(textureCount===MAX_TEXTURES&&(TICK++,currentGroup.size=i-currentGroup.start,textureCount=0,currentGroup=groups[groupCount++],currentGroup.blend=blendMode,currentGroup.textureCount=0,currentGroup.start=i),nextTexture.touched=touch,-1===nextTexture._virtalBoundId)for(var j=0;j<MAX_TEXTURES;++j){var tIndex=(j+TEXTURE_TICK)%MAX_TEXTURES,t=boundTextures[tIndex];if(t._enabled!==TICK){TEXTURE_TICK++,t._virtalBoundId=-1,nextTexture._virtalBoundId=tIndex,boundTextures[tIndex]=nextTexture;break}}nextTexture._enabled=TICK,currentGroup.textureCount++,currentGroup.ids[textureCount]=nextTexture._virtalBoundId,currentGroup.textures[textureCount++]=nextTexture}if(vertexData=sprite.vertexData,uvs=sprite._texture._uvs.uvsUint32,this.renderer.roundPixels){var resolution=this.renderer.resolution;float32View[index]=(vertexData[0]*resolution|0)/resolution,float32View[index+1]=(vertexData[1]*resolution|0)/resolution,float32View[index+5]=(vertexData[2]*resolution|0)/resolution,float32View[index+6]=(vertexData[3]*resolution|0)/resolution,float32View[index+10]=(vertexData[4]*resolution|0)/resolution,float32View[index+11]=(vertexData[5]*resolution|0)/resolution,float32View[index+15]=(vertexData[6]*resolution|0)/resolution,float32View[index+16]=(vertexData[7]*resolution|0)/resolution}else float32View[index]=vertexData[0],float32View[index+1]=vertexData[1],float32View[index+5]=vertexData[2],float32View[index+6]=vertexData[3],float32View[index+10]=vertexData[4],float32View[index+11]=vertexData[5],float32View[index+15]=vertexData[6],float32View[index+16]=vertexData[7];uint32View[index+2]=uvs[0],uint32View[index+7]=uvs[1],uint32View[index+12]=uvs[2],uint32View[index+17]=uvs[3];var alpha=Math.min(sprite.worldAlpha,1),argb=alpha<1&&nextTexture.premultipliedAlpha?(0,_utils.premultiplyTint)(sprite._tintRGB,alpha):sprite._tintRGB+(255*alpha<<24);uint32View[index+3]=uint32View[index+8]=uint32View[index+13]=uint32View[index+18]=argb,float32View[index+4]=float32View[index+9]=float32View[index+14]=float32View[index+19]=nextTexture._virtalBoundId,index+=20}if(currentGroup.size=i-currentGroup.start,_settings2.default.CAN_UPLOAD_SAME_BUFFER)this.vertexBuffers[this.vertexCount].upload(buffer.vertices,0,!0);else{if(this.vaoMax<=this.vertexCount){this.vaoMax++;var attrs=this.shader.attributes,vertexBuffer=this.vertexBuffers[this.vertexCount]=_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl,null,gl.STREAM_DRAW),vao=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(vertexBuffer,attrs.aVertexPosition,gl.FLOAT,!1,this.vertByteSize,0).addAttribute(vertexBuffer,attrs.aTextureCoord,gl.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(vertexBuffer,attrs.aColor,gl.UNSIGNED_BYTE,!0,this.vertByteSize,12);attrs.aTextureId&&vao.addAttribute(vertexBuffer,attrs.aTextureId,gl.FLOAT,!1,this.vertByteSize,16),this.vaos[this.vertexCount]=vao}this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].upload(buffer.vertices,0,!1),this.vertexCount++}for(i=0;i<MAX_TEXTURES;++i)rendererBoundTextures[i]._virtalBoundId=-1;for(i=0;i<groupCount;++i){for(var group=groups[i],groupTextureCount=group.textureCount,_j=0;_j<groupTextureCount;_j++)currentTexture=group.textures[_j],rendererBoundTextures[group.ids[_j]]!==currentTexture&&this.renderer.bindTexture(currentTexture,group.ids[_j],!0),currentTexture._virtalBoundId=-1;this.renderer.state.setBlendMode(group.blend),gl.drawElements(gl.TRIANGLES,6*group.size,gl.UNSIGNED_SHORT,6*group.start*2)}this.currentIndex=0}},SpriteRenderer.prototype.start=function(){this.renderer.bindShader(this.shader),_settings2.default.CAN_UPLOAD_SAME_BUFFER&&(this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].bind())},SpriteRenderer.prototype.stop=function(){this.flush()},SpriteRenderer.prototype.destroy=function(){for(var i=0;i<this.vaoMax;i++)this.vertexBuffers[i]&&this.vertexBuffers[i].destroy(),this.vaos[i]&&this.vaos[i].destroy();this.indexBuffer&&this.indexBuffer.destroy(),this.renderer.off("prerender",this.onPrerender,this),_ObjectRenderer.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.vertexBuffers=null,this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null;for(var _i=0;_i<this.buffers.length;++_i)this.buffers[_i].destroy()},SpriteRenderer}(_ObjectRenderer3.default);exports.default=SpriteRenderer,_WebGLRenderer2.default.registerPlugin("sprite",SpriteRenderer)},{"../../renderers/webgl/WebGLRenderer":188,"../../renderers/webgl/utils/ObjectRenderer":198,"../../renderers/webgl/utils/checkMaxIfStatmentsInShader":201,"../../settings":205,"../../utils":229,"../../utils/createIndicesForQuads":227,"./BatchBuffer":209,"./generateMultiTextureShader":211,"bit-twiddle":114,"pixi-gl-core":133}],211:[function(require,module,exports){"use strict";function generateMultiTextureShader(gl,maxTextures){var fragmentSrc=fragTemplate;fragmentSrc=fragmentSrc.replace(/%count%/gi,maxTextures),fragmentSrc=fragmentSrc.replace(/%forloop%/gi,generateSampleSrc(maxTextures));for(var shader=new _Shader2.default(gl,"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor;\n}\n",fragmentSrc),sampleValues=[],i=0;i<maxTextures;i++)sampleValues[i]=i;return shader.bind(),shader.uniforms.uSamplers=sampleValues,shader}function generateSampleSrc(maxTextures){var src="";src+="\n",src+="\n";for(var i=0;i<maxTextures;i++)i>0&&(src+="\nelse "),i<maxTextures-1&&(src+="if(textureId == "+i+".0)"),src+="\n{",src+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",src+="\n}";return src+="\n",src+="\n"}exports.__esModule=!0,exports.default=generateMultiTextureShader;var _Shader=require("../../Shader"),_Shader2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Shader),fragTemplate=(require("path"),["varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureId;","uniform sampler2D uSamplers[%count%];","void main(void){","vec4 color;","float textureId = floor(vTextureId+0.5);","%forloop%","gl_FragColor = color * vColor;","}"].join("\n"))},{"../../Shader":148,path:126}],212:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),
superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Sprite2=require("../sprites/Sprite"),_Sprite3=_interopRequireDefault(_Sprite2),_Texture=require("../textures/Texture"),_Texture2=_interopRequireDefault(_Texture),_math=require("../math"),_utils=require("../utils"),_const=require("../const"),_settings=require("../settings"),_settings2=_interopRequireDefault(_settings),_TextStyle=require("./TextStyle"),_TextStyle2=_interopRequireDefault(_TextStyle),_TextMetrics=require("./TextMetrics"),_TextMetrics2=_interopRequireDefault(_TextMetrics),_trimCanvas=require("../utils/trimCanvas"),_trimCanvas2=_interopRequireDefault(_trimCanvas),defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},Text=function(_Sprite){function Text(text,style,canvas){_classCallCheck(this,Text),canvas=canvas||document.createElement("canvas"),canvas.width=3,canvas.height=3;var texture=_Texture2.default.fromCanvas(canvas,_settings2.default.SCALE_MODE,"text");texture.orig=new _math.Rectangle,texture.trim=new _math.Rectangle;var _this=_possibleConstructorReturn(this,_Sprite.call(this,texture));return _Texture2.default.addToCache(_this._texture,_this._texture.baseTexture.textureCacheIds[0]),_this.canvas=canvas,_this.context=_this.canvas.getContext("2d"),_this.resolution=_settings2.default.RESOLUTION,_this._text=null,_this._style=null,_this._styleListener=null,_this._font="",_this.text=text,_this.style=style,_this.localStyleID=-1,_this}return _inherits(Text,_Sprite),Text.prototype.updateText=function(respectDirty){var style=this._style;if(this.localStyleID!==style.styleID&&(this.dirty=!0,this.localStyleID=style.styleID),this.dirty||!respectDirty){this._font=this._style.toFontString();var context=this.context,measured=_TextMetrics2.default.measureText(this._text,this._style,this._style.wordWrap,this.canvas),width=measured.width,height=measured.height,lines=measured.lines,lineHeight=measured.lineHeight,lineWidths=measured.lineWidths,maxLineWidth=measured.maxLineWidth,fontProperties=measured.fontProperties;this.canvas.width=Math.ceil((Math.max(1,width)+2*style.padding)*this.resolution),this.canvas.height=Math.ceil((Math.max(1,height)+2*style.padding)*this.resolution),context.scale(this.resolution,this.resolution),context.clearRect(0,0,this.canvas.width,this.canvas.height),context.font=this._font,context.strokeStyle=style.stroke,context.lineWidth=style.strokeThickness,context.textBaseline=style.textBaseline,context.lineJoin=style.lineJoin,context.miterLimit=style.miterLimit;var linePositionX=void 0,linePositionY=void 0;if(style.dropShadow){context.fillStyle=style.dropShadowColor,context.globalAlpha=style.dropShadowAlpha,context.shadowBlur=style.dropShadowBlur,style.dropShadowBlur>0&&(context.shadowColor=style.dropShadowColor);for(var xShadowOffset=Math.cos(style.dropShadowAngle)*style.dropShadowDistance,yShadowOffset=Math.sin(style.dropShadowAngle)*style.dropShadowDistance,i=0;i<lines.length;i++)linePositionX=style.strokeThickness/2,linePositionY=style.strokeThickness/2+i*lineHeight+fontProperties.ascent,"right"===style.align?linePositionX+=maxLineWidth-lineWidths[i]:"center"===style.align&&(linePositionX+=(maxLineWidth-lineWidths[i])/2),style.fill&&(this.drawLetterSpacing(lines[i],linePositionX+xShadowOffset+style.padding,linePositionY+yShadowOffset+style.padding),style.stroke&&style.strokeThickness&&(context.strokeStyle=style.dropShadowColor,this.drawLetterSpacing(lines[i],linePositionX+xShadowOffset+style.padding,linePositionY+yShadowOffset+style.padding,!0),context.strokeStyle=style.stroke))}context.shadowBlur=0,context.globalAlpha=1,context.fillStyle=this._generateFillStyle(style,lines);for(var _i=0;_i<lines.length;_i++)linePositionX=style.strokeThickness/2,linePositionY=style.strokeThickness/2+_i*lineHeight+fontProperties.ascent,"right"===style.align?linePositionX+=maxLineWidth-lineWidths[_i]:"center"===style.align&&(linePositionX+=(maxLineWidth-lineWidths[_i])/2),style.stroke&&style.strokeThickness&&this.drawLetterSpacing(lines[_i],linePositionX+style.padding,linePositionY+style.padding,!0),style.fill&&this.drawLetterSpacing(lines[_i],linePositionX+style.padding,linePositionY+style.padding);this.updateTexture()}},Text.prototype.drawLetterSpacing=function(text,x,y){var isStroke=arguments.length>3&&void 0!==arguments[3]&&arguments[3],style=this._style,letterSpacing=style.letterSpacing;if(0===letterSpacing)return void(isStroke?this.context.strokeText(text,x,y):this.context.fillText(text,x,y));for(var characters=String.prototype.split.call(text,""),currentPosition=x,index=0,current="";index<text.length;)current=characters[index++],isStroke?this.context.strokeText(current,currentPosition,y):this.context.fillText(current,currentPosition,y),currentPosition+=this.context.measureText(current).width+letterSpacing},Text.prototype.updateTexture=function(){var canvas=this.canvas;if(this._style.trim){var trimmed=(0,_trimCanvas2.default)(canvas);trimmed.data&&(canvas.width=trimmed.width,canvas.height=trimmed.height,this.context.putImageData(trimmed.data,0,0))}var texture=this._texture,style=this._style,padding=style.trim?0:style.padding,baseTexture=texture.baseTexture;baseTexture.hasLoaded=!0,baseTexture.resolution=this.resolution,baseTexture.realWidth=canvas.width,baseTexture.realHeight=canvas.height,baseTexture.width=canvas.width/this.resolution,baseTexture.height=canvas.height/this.resolution,texture.trim.width=texture._frame.width=canvas.width/this.resolution,texture.trim.height=texture._frame.height=canvas.height/this.resolution,texture.trim.x=-padding,texture.trim.y=-padding,texture.orig.width=texture._frame.width-2*padding,texture.orig.height=texture._frame.height-2*padding,this._onTextureUpdate(),baseTexture.emit("update",baseTexture),this.dirty=!1},Text.prototype.renderWebGL=function(renderer){this.resolution!==renderer.resolution&&(this.resolution=renderer.resolution,this.dirty=!0),this.updateText(!0),_Sprite.prototype.renderWebGL.call(this,renderer)},Text.prototype._renderCanvas=function(renderer){this.resolution!==renderer.resolution&&(this.resolution=renderer.resolution,this.dirty=!0),this.updateText(!0),_Sprite.prototype._renderCanvas.call(this,renderer)},Text.prototype.getLocalBounds=function(rect){return this.updateText(!0),_Sprite.prototype.getLocalBounds.call(this,rect)},Text.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},Text.prototype._onStyleChange=function(){this.dirty=!0},Text.prototype._generateFillStyle=function(style,lines){if(!Array.isArray(style.fill))return style.fill;if(navigator.isCocoonJS)return style.fill[0];var gradient=void 0,totalIterations=void 0,currentIteration=void 0,stop=void 0,width=this.canvas.width/this.resolution,height=this.canvas.height/this.resolution,fill=style.fill.slice(),fillGradientStops=style.fillGradientStops.slice();if(!fillGradientStops.length)for(var lengthPlus1=fill.length+1,i=1;i<lengthPlus1;++i)fillGradientStops.push(i/lengthPlus1);if(fill.unshift(style.fill[0]),fillGradientStops.unshift(0),fill.push(style.fill[style.fill.length-1]),fillGradientStops.push(1),style.fillGradientType===_const.TEXT_GRADIENT.LINEAR_VERTICAL){gradient=this.context.createLinearGradient(width/2,0,width/2,height),totalIterations=(fill.length+1)*lines.length,currentIteration=0;for(var _i2=0;_i2<lines.length;_i2++){currentIteration+=1;for(var j=0;j<fill.length;j++)stop="number"==typeof fillGradientStops[j]?fillGradientStops[j]/lines.length+_i2/lines.length:currentIteration/totalIterations,gradient.addColorStop(stop,fill[j]),currentIteration++}}else{gradient=this.context.createLinearGradient(0,height/2,width,height/2),totalIterations=fill.length+1,currentIteration=1;for(var _i3=0;_i3<fill.length;_i3++)stop="number"==typeof fillGradientStops[_i3]?fillGradientStops[_i3]:currentIteration/totalIterations,gradient.addColorStop(stop,fill[_i3]),currentIteration++}return gradient},Text.prototype.destroy=function(options){"boolean"==typeof options&&(options={children:options}),options=Object.assign({},defaultDestroyOptions,options),_Sprite.prototype.destroy.call(this,options),this.context=null,this.canvas=null,this._style=null},_createClass(Text,[{key:"width",get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(value){this.updateText(!0);var s=(0,_utils.sign)(this.scale.x)||1;this.scale.x=s*value/this._texture.orig.width,this._width=value}},{key:"height",get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(value){this.updateText(!0);var s=(0,_utils.sign)(this.scale.y)||1;this.scale.y=s*value/this._texture.orig.height,this._height=value}},{key:"style",get:function(){return this._style},set:function(style){style=style||{},style instanceof _TextStyle2.default?this._style=style:this._style=new _TextStyle2.default(style),this.localStyleID=-1,this.dirty=!0}},{key:"text",get:function(){return this._text},set:function(text){text=String(""===text||null===text||void 0===text?" ":text),this._text!==text&&(this._text=text,this.dirty=!0)}}]),Text}(_Sprite3.default);exports.default=Text},{"../const":150,"../math":174,"../settings":205,"../sprites/Sprite":206,"../textures/Texture":219,"../utils":229,"../utils/trimCanvas":234,"./TextMetrics":213,"./TextStyle":214}],213:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var TextMetrics=function(){function TextMetrics(text,style,width,height,lines,lineWidths,lineHeight,maxLineWidth,fontProperties){_classCallCheck(this,TextMetrics),this.text=text,this.style=style,this.width=width,this.height=height,this.lines=lines,this.lineWidths=lineWidths,this.lineHeight=lineHeight,this.maxLineWidth=maxLineWidth,this.fontProperties=fontProperties}return TextMetrics.measureText=function(text,style,wordWrap){var canvas=arguments.length>3&&void 0!==arguments[3]?arguments[3]:TextMetrics._canvas;wordWrap=void 0===wordWrap||null===wordWrap?style.wordWrap:wordWrap;var font=style.toFontString(),fontProperties=TextMetrics.measureFont(font),context=canvas.getContext("2d");context.font=font;for(var outputText=wordWrap?TextMetrics.wordWrap(text,style,canvas):text,lines=outputText.split(/(?:\r\n|\r|\n)/),lineWidths=new Array(lines.length),maxLineWidth=0,i=0;i<lines.length;i++){var lineWidth=context.measureText(lines[i]).width+(lines[i].length-1)*style.letterSpacing;lineWidths[i]=lineWidth,maxLineWidth=Math.max(maxLineWidth,lineWidth)}var width=maxLineWidth+style.strokeThickness;style.dropShadow&&(width+=style.dropShadowDistance);var lineHeight=style.lineHeight||fontProperties.fontSize+style.strokeThickness,height=Math.max(lineHeight,fontProperties.fontSize+style.strokeThickness)+(lines.length-1)*(lineHeight+style.leading);return style.dropShadow&&(height+=style.dropShadowDistance),new TextMetrics(text,style,width,height,lines,lineWidths,lineHeight+style.leading,maxLineWidth,fontProperties)},TextMetrics.wordWrap=function(text,style){for(var canvas=arguments.length>2&&void 0!==arguments[2]?arguments[2]:TextMetrics._canvas,context=canvas.getContext("2d"),width=0,line="",lines="",cache={},letterSpacing=style.letterSpacing,whiteSpace=style.whiteSpace,collapseSpaces=TextMetrics.collapseSpaces(whiteSpace),collapseNewlines=TextMetrics.collapseNewlines(whiteSpace),canPrependSpaces=!collapseSpaces,wordWrapWidth=style.wordWrapWidth+letterSpacing,tokens=TextMetrics.tokenize(text),i=0;i<tokens.length;i++){var token=tokens[i];if(TextMetrics.isNewline(token)){if(!collapseNewlines){lines+=TextMetrics.addLine(line),canPrependSpaces=!collapseSpaces,line="",width=0;continue}token=" "}if(collapseSpaces){var currIsBreakingSpace=TextMetrics.isBreakingSpace(token),lastIsBreakingSpace=TextMetrics.isBreakingSpace(line[line.length-1]);if(currIsBreakingSpace&&lastIsBreakingSpace)continue}var tokenWidth=TextMetrics.getFromCache(token,letterSpacing,cache,context);if(tokenWidth>wordWrapWidth)if(""!==line&&(lines+=TextMetrics.addLine(line),line="",width=0),TextMetrics.canBreakWords(token,style.breakWords))for(var characters=token.split(""),j=0;j<characters.length;j++){for(var char=characters[j],k=1;characters[j+k];){var nextChar=characters[j+k],lastChar=char[char.length-1];if(TextMetrics.canBreakChars(lastChar,nextChar,token,j,style.breakWords))break;char+=nextChar,k++}j+=char.length-1;var characterWidth=TextMetrics.getFromCache(char,letterSpacing,cache,context);characterWidth+width>wordWrapWidth&&(lines+=TextMetrics.addLine(line),canPrependSpaces=!1,line="",width=0),line+=char,width+=characterWidth}else{line.length>0&&(lines+=TextMetrics.addLine(line),line="",width=0);var isLastToken=i===tokens.length-1;lines+=TextMetrics.addLine(token,!isLastToken),canPrependSpaces=!1,line="",width=0}else tokenWidth+width>wordWrapWidth&&(canPrependSpaces=!1,lines+=TextMetrics.addLine(line),line="",width=0),(line.length>0||!TextMetrics.isBreakingSpace(token)||canPrependSpaces)&&(line+=token,width+=tokenWidth)}return lines+=TextMetrics.addLine(line,!1)},TextMetrics.addLine=function(line){var newLine=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return line=TextMetrics.trimRight(line),line=newLine?line+"\n":line},TextMetrics.getFromCache=function(key,letterSpacing,cache,context){var width=cache[key];if(void 0===width){var spacing=key.length*letterSpacing;width=context.measureText(key).width+spacing,cache[key]=width}return width},TextMetrics.collapseSpaces=function(whiteSpace){return"normal"===whiteSpace||"pre-line"===whiteSpace},TextMetrics.collapseNewlines=function(whiteSpace){return"normal"===whiteSpace},TextMetrics.trimRight=function(text){if("string"!=typeof text)return"";for(var i=text.length-1;i>=0;i--){var char=text[i];if(!TextMetrics.isBreakingSpace(char))break;text=text.slice(0,-1)}return text},TextMetrics.isNewline=function(char){return"string"==typeof char&&TextMetrics._newlines.indexOf(char.charCodeAt(0))>=0},TextMetrics.isBreakingSpace=function(char){return"string"==typeof char&&TextMetrics._breakingSpaces.indexOf(char.charCodeAt(0))>=0},TextMetrics.tokenize=function(text){var tokens=[],token="";if("string"!=typeof text)return tokens;for(var i=0;i<text.length;i++){var char=text[i];TextMetrics.isBreakingSpace(char)||TextMetrics.isNewline(char)?(""!==token&&(tokens.push(token),token=""),tokens.push(char)):token+=char}return""!==token&&tokens.push(token),tokens},TextMetrics.canBreakWords=function(token,breakWords){return breakWords},TextMetrics.canBreakChars=function(char,nextChar,token,index,breakWords){return!0},TextMetrics.measureFont=function(font){if(TextMetrics._fonts[font])return TextMetrics._fonts[font];var properties={},canvas=TextMetrics._canvas,context=TextMetrics._context;context.font=font;var metricsString=TextMetrics.METRICS_STRING+TextMetrics.BASELINE_SYMBOL,width=Math.ceil(context.measureText(metricsString).width),baseline=Math.ceil(context.measureText(TextMetrics.BASELINE_SYMBOL).width),height=2*baseline;baseline=baseline*TextMetrics.BASELINE_MULTIPLIER|0,canvas.width=width,canvas.height=height,context.fillStyle="#f00",context.fillRect(0,0,width,height),context.font=font,context.textBaseline="alphabetic",context.fillStyle="#000",context.fillText(metricsString,0,baseline);var imagedata=context.getImageData(0,0,width,height).data,pixels=imagedata.length,line=4*width,i=0,idx=0,stop=!1;for(i=0;i<baseline;++i){for(var j=0;j<line;j+=4)if(255!==imagedata[idx+j]){stop=!0;break}if(stop)break;idx+=line}for(properties.ascent=baseline-i,idx=pixels-line,stop=!1,i=height;i>baseline;--i){for(var _j=0;_j<line;_j+=4)if(255!==imagedata[idx+_j]){stop=!0;break}if(stop)break;idx-=line}return properties.descent=i-baseline,properties.fontSize=properties.ascent+properties.descent,TextMetrics._fonts[font]=properties,properties},TextMetrics.clearMetrics=function(){var font=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";font?delete TextMetrics._fonts[font]:TextMetrics._fonts={}},TextMetrics}();exports.default=TextMetrics;var canvas=document.createElement("canvas");canvas.width=canvas.height=10,TextMetrics._canvas=canvas,TextMetrics._context=canvas.getContext("2d"),TextMetrics._fonts={},TextMetrics.METRICS_STRING="|Éq",TextMetrics.BASELINE_SYMBOL="M",TextMetrics.BASELINE_MULTIPLIER=1.4,TextMetrics._newlines=[10,13],TextMetrics._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},{}],214:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function getSingleColor(color){return"number"==typeof color?(0,_utils.hex2string)(color):("string"==typeof color&&0===color.indexOf("0x")&&(color=color.replace("0x","#")),color)}function getColor(color){if(Array.isArray(color)){for(var i=0;i<color.length;++i)color[i]=getSingleColor(color[i]);return color}return getSingleColor(color)}function areArraysEqual(array1,array2){if(!Array.isArray(array1)||!Array.isArray(array2))return!1;if(array1.length!==array2.length)return!1;for(var i=0;i<array1.length;++i)if(array1[i]!==array2[i])return!1;return!0}function deepCopyProperties(target,source,propertyObj){for(var prop in propertyObj)Array.isArray(source[prop])?target[prop]=source[prop].slice():target[prop]=source[prop]}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_const=require("../const"),_utils=require("../utils"),defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:_const.TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},genericFontFamilies=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],TextStyle=function(){function TextStyle(style){_classCallCheck(this,TextStyle),this.styleID=0,this.reset(),deepCopyProperties(this,style,style)}return TextStyle.prototype.clone=function(){var clonedProperties={};return deepCopyProperties(clonedProperties,this,defaultStyle),new TextStyle(clonedProperties)},TextStyle.prototype.reset=function(){deepCopyProperties(this,defaultStyle,defaultStyle)},TextStyle.prototype.toFontString=function(){var fontSizeString="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,fontFamilies=this.fontFamily;Array.isArray(this.fontFamily)||(fontFamilies=this.fontFamily.split(","));for(var i=fontFamilies.length-1;i>=0;i--){var fontFamily=fontFamilies[i].trim();!/([\"\'])[^\'\"]+\1/.test(fontFamily)&&genericFontFamilies.indexOf(fontFamily)<0&&(fontFamily='"'+fontFamily+'"'),fontFamilies[i]=fontFamily}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+fontSizeString+" "+fontFamilies.join(",")},_createClass(TextStyle,[{key:"align",get:function(){return this._align},set:function(align){this._align!==align&&(this._align=align,this.styleID++)}},{key:"breakWords",get:function(){return this._breakWords},set:function(breakWords){this._breakWords!==breakWords&&(this._breakWords=breakWords,this.styleID++)}},{key:"dropShadow",get:function(){return this._dropShadow},set:function(dropShadow){this._dropShadow!==dropShadow&&(this._dropShadow=dropShadow,this.styleID++)}},{key:"dropShadowAlpha",get:function(){return this._dropShadowAlpha},set:function(dropShadowAlpha){this._dropShadowAlpha!==dropShadowAlpha&&(this._dropShadowAlpha=dropShadowAlpha,this.styleID++)}},{key:"dropShadowAngle",get:function(){return this._dropShadowAngle},set:function(dropShadowAngle){this._dropShadowAngle!==dropShadowAngle&&(this._dropShadowAngle=dropShadowAngle,this.styleID++)}},{key:"dropShadowBlur",get:function(){return this._dropShadowBlur},set:function(dropShadowBlur){this._dropShadowBlur!==dropShadowBlur&&(this._dropShadowBlur=dropShadowBlur,this.styleID++)}},{key:"dropShadowColor",get:function(){return this._dropShadowColor},set:function(dropShadowColor){var outputColor=getColor(dropShadowColor);this._dropShadowColor!==outputColor&&(this._dropShadowColor=outputColor,this.styleID++)}},{key:"dropShadowDistance",get:function(){return this._dropShadowDistance},set:function(dropShadowDistance){this._dropShadowDistance!==dropShadowDistance&&(this._dropShadowDistance=dropShadowDistance,this.styleID++)}},{key:"fill",get:function(){return this._fill},set:function(fill){var outputColor=getColor(fill);this._fill!==outputColor&&(this._fill=outputColor,this.styleID++)}},{key:"fillGradientType",get:function(){return this._fillGradientType},set:function(fillGradientType){this._fillGradientType!==fillGradientType&&(this._fillGradientType=fillGradientType,this.styleID++)}},{key:"fillGradientStops",get:function(){return this._fillGradientStops},set:function(fillGradientStops){areArraysEqual(this._fillGradientStops,fillGradientStops)||(this._fillGradientStops=fillGradientStops,this.styleID++)}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(fontFamily){this.fontFamily!==fontFamily&&(this._fontFamily=fontFamily,this.styleID++)}},{key:"fontSize",get:function(){return this._fontSize},set:function(fontSize){this._fontSize!==fontSize&&(this._fontSize=fontSize,this.styleID++)}},{key:"fontStyle",get:function(){return this._fontStyle},set:function(fontStyle){this._fontStyle!==fontStyle&&(this._fontStyle=fontStyle,this.styleID++)}},{key:"fontVariant",get:function(){return this._fontVariant},set:function(fontVariant){this._fontVariant!==fontVariant&&(this._fontVariant=fontVariant,this.styleID++)}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(fontWeight){this._fontWeight!==fontWeight&&(this._fontWeight=fontWeight,this.styleID++)}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(letterSpacing){this._letterSpacing!==letterSpacing&&(this._letterSpacing=letterSpacing,this.styleID++)}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(lineHeight){this._lineHeight!==lineHeight&&(this._lineHeight=lineHeight,this.styleID++)}},{key:"leading",get:function(){return this._leading},set:function(leading){this._leading!==leading&&(this._leading=leading,this.styleID++)}},{key:"lineJoin",get:function(){return this._lineJoin},set:function(lineJoin){this._lineJoin!==lineJoin&&(this._lineJoin=lineJoin,this.styleID++)}},{key:"miterLimit",get:function(){return this._miterLimit},set:function(miterLimit){this._miterLimit!==miterLimit&&(this._miterLimit=miterLimit,this.styleID++)}},{key:"padding",get:function(){return this._padding},set:function(padding){this._padding!==padding&&(this._padding=padding,this.styleID++)}},{key:"stroke",get:function(){return this._stroke},set:function(stroke){var outputColor=getColor(stroke);this._stroke!==outputColor&&(this._stroke=outputColor,this.styleID++)}},{key:"strokeThickness",get:function(){return this._strokeThickness},set:function(strokeThickness){this._strokeThickness!==strokeThickness&&(this._strokeThickness=strokeThickness,this.styleID++)}},{key:"textBaseline",get:function(){return this._textBaseline},set:function(textBaseline){this._textBaseline!==textBaseline&&(this._textBaseline=textBaseline,this.styleID++)}},{key:"trim",get:function(){return this._trim},set:function(trim){this._trim!==trim&&(this._trim=trim,this.styleID++)}},{key:"whiteSpace",get:function(){return this._whiteSpace},set:function(whiteSpace){this._whiteSpace!==whiteSpace&&(this._whiteSpace=whiteSpace,this.styleID++)}},{key:"wordWrap",get:function(){return this._wordWrap},set:function(wordWrap){this._wordWrap!==wordWrap&&(this._wordWrap=wordWrap,this.styleID++)}},{key:"wordWrapWidth",get:function(){return this._wordWrapWidth},set:function(wordWrapWidth){this._wordWrapWidth!==wordWrapWidth&&(this._wordWrapWidth=wordWrapWidth,this.styleID++)}}]),TextStyle}();exports.default=TextStyle},{"../const":150,"../utils":229}],215:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _BaseTexture2=require("./BaseTexture"),_BaseTexture3=_interopRequireDefault(_BaseTexture2),_settings=require("../settings"),_settings2=_interopRequireDefault(_settings),BaseRenderTexture=function(_BaseTexture){function BaseRenderTexture(){var width=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,height=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,scaleMode=arguments[2],resolution=arguments[3];_classCallCheck(this,BaseRenderTexture);var _this=_possibleConstructorReturn(this,_BaseTexture.call(this,null,scaleMode));return _this.resolution=resolution||_settings2.default.RESOLUTION,_this.width=Math.ceil(width),_this.height=Math.ceil(height),_this.realWidth=_this.width*_this.resolution,_this.realHeight=_this.height*_this.resolution,_this.scaleMode=void 0!==scaleMode?scaleMode:_settings2.default.SCALE_MODE,_this.hasLoaded=!0,_this._glRenderTargets={},_this._canvasRenderTarget=null,_this.valid=!1,_this}return _inherits(BaseRenderTexture,_BaseTexture),BaseRenderTexture.prototype.resize=function(width,height){width=Math.ceil(width),height=Math.ceil(height),width===this.width&&height===this.height||(this.valid=width>0&&height>0,this.width=width,this.height=height,this.realWidth=this.width*this.resolution,this.realHeight=this.height*this.resolution,this.valid&&this.emit("update",this))},BaseRenderTexture.prototype.destroy=function(){_BaseTexture.prototype.destroy.call(this,!0),this.renderer=null},BaseRenderTexture}(_BaseTexture3.default);exports.default=BaseRenderTexture},{"../settings":205,"./BaseTexture":216}],216:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _utils=require("../utils"),_settings=require("../settings"),_settings2=_interopRequireDefault(_settings),_eventemitter=require("eventemitter3"),_eventemitter2=_interopRequireDefault(_eventemitter),_determineCrossOrigin=require("../utils/determineCrossOrigin"),_determineCrossOrigin2=_interopRequireDefault(_determineCrossOrigin),_bitTwiddle=require("bit-twiddle"),_bitTwiddle2=_interopRequireDefault(_bitTwiddle),BaseTexture=function(_EventEmitter){function BaseTexture(source,scaleMode,resolution){_classCallCheck(this,BaseTexture);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));return _this.uid=(0,_utils.uid)(),_this.touched=0,_this.resolution=resolution||_settings2.default.RESOLUTION,_this.width=100,_this.height=100,_this.realWidth=100,_this.realHeight=100,_this.scaleMode=void 0!==scaleMode?scaleMode:_settings2.default.SCALE_MODE,_this.hasLoaded=!1,_this.isLoading=!1,_this.source=null,_this.origSource=null,_this.imageType=null,_this.sourceScale=1,_this.premultipliedAlpha=!0,_this.imageUrl=null,_this.isPowerOfTwo=!1,_this.mipmap=_settings2.default.MIPMAP_TEXTURES,_this.wrapMode=_settings2.default.WRAP_MODE,_this._glTextures={},_this._enabled=0,_this._virtalBoundId=-1,_this._destroyed=!1,_this.textureCacheIds=[],source&&_this.loadSource(source),_this}return _inherits(BaseTexture,_EventEmitter),BaseTexture.prototype.update=function(){"svg"!==this.imageType&&(this.realWidth=this.source.naturalWidth||this.source.videoWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.videoHeight||this.source.height,this._updateDimensions()),this.emit("update",this)},BaseTexture.prototype._updateDimensions=function(){this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=_bitTwiddle2.default.isPow2(this.realWidth)&&_bitTwiddle2.default.isPow2(this.realHeight)},BaseTexture.prototype.loadSource=function(source){var wasLoading=this.isLoading;this.hasLoaded=!1,this.isLoading=!1,wasLoading&&this.source&&(this.source.onload=null,this.source.onerror=null);var firstSourceLoaded=!this.source;if(this.source=source,(source.src&&source.complete||source.getContext)&&source.width&&source.height)this._updateImageType(),"svg"===this.imageType?this._loadSvgSource():this._sourceLoaded(),firstSourceLoaded&&this.emit("loaded",this);else if(!source.getContext){this.isLoading=!0;var scope=this;if(source.onload=function(){if(scope._updateImageType(),source.onload=null,source.onerror=null,scope.isLoading){if(scope.isLoading=!1,scope._sourceLoaded(),"svg"===scope.imageType)return void scope._loadSvgSource();scope.emit("loaded",scope)}},source.onerror=function(){source.onload=null,source.onerror=null,scope.isLoading&&(scope.isLoading=!1,scope.emit("error",scope))},source.complete&&source.src){if(source.onload=null,source.onerror=null,"svg"===scope.imageType)return void scope._loadSvgSource();this.isLoading=!1,source.width&&source.height?(this._sourceLoaded(),wasLoading&&this.emit("loaded",this)):wasLoading&&this.emit("error",this)}}},BaseTexture.prototype._updateImageType=function(){if(this.imageUrl){var dataUri=(0,_utils.decomposeDataUri)(this.imageUrl),imageType=void 0;if(dataUri&&"image"===dataUri.mediaType){var firstSubType=dataUri.subType.split("+")[0];if(!(imageType=(0,_utils.getUrlFileExtension)("."+firstSubType)))throw new Error("Invalid image type in data URI.")}else(imageType=(0,
_utils.getUrlFileExtension)(this.imageUrl))||(imageType="png");this.imageType=imageType}},BaseTexture.prototype._loadSvgSource=function(){if("svg"===this.imageType){var dataUri=(0,_utils.decomposeDataUri)(this.imageUrl);dataUri?this._loadSvgSourceUsingDataUri(dataUri):this._loadSvgSourceUsingXhr()}},BaseTexture.prototype._loadSvgSourceUsingDataUri=function(dataUri){var svgString=void 0;if("base64"===dataUri.encoding){if(!atob)throw new Error("Your browser doesn't support base64 conversions.");svgString=atob(dataUri.data)}else svgString=dataUri.data;this._loadSvgSourceUsingString(svgString)},BaseTexture.prototype._loadSvgSourceUsingXhr=function(){var _this2=this,svgXhr=new XMLHttpRequest;svgXhr.onload=function(){if(svgXhr.readyState!==svgXhr.DONE||200!==svgXhr.status)throw new Error("Failed to load SVG using XHR.");_this2._loadSvgSourceUsingString(svgXhr.response)},svgXhr.onerror=function(){return _this2.emit("error",_this2)},svgXhr.open("GET",this.imageUrl,!0),svgXhr.send()},BaseTexture.prototype._loadSvgSourceUsingString=function(svgString){var svgSize=(0,_utils.getSvgSize)(svgString),svgWidth=svgSize.width,svgHeight=svgSize.height;if(!svgWidth||!svgHeight)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");this.realWidth=Math.round(svgWidth*this.sourceScale),this.realHeight=Math.round(svgHeight*this.sourceScale),this._updateDimensions();var canvas=document.createElement("canvas");canvas.width=this.realWidth,canvas.height=this.realHeight,canvas._pixiId="canvas_"+(0,_utils.uid)(),canvas.getContext("2d").drawImage(this.source,0,0,svgWidth,svgHeight,0,0,this.realWidth,this.realHeight),this.origSource=this.source,this.source=canvas,BaseTexture.addToCache(this,canvas._pixiId),this.isLoading=!1,this._sourceLoaded(),this.emit("loaded",this)},BaseTexture.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},BaseTexture.prototype.destroy=function(){this.imageUrl&&(delete _utils.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")),this.source=null,this.dispose(),BaseTexture.removeFromCache(this),this.textureCacheIds=null,this._destroyed=!0},BaseTexture.prototype.dispose=function(){this.emit("dispose",this)},BaseTexture.prototype.updateSourceImage=function(newSrc){this.source.src=newSrc,this.loadSource(this.source)},BaseTexture.fromImage=function(imageUrl,crossorigin,scaleMode,sourceScale){var baseTexture=_utils.BaseTextureCache[imageUrl];if(!baseTexture){var image=new Image;void 0===crossorigin&&0!==imageUrl.indexOf("data:")?image.crossOrigin=(0,_determineCrossOrigin2.default)(imageUrl):crossorigin&&(image.crossOrigin="string"==typeof crossorigin?crossorigin:"anonymous"),baseTexture=new BaseTexture(image,scaleMode),baseTexture.imageUrl=imageUrl,sourceScale&&(baseTexture.sourceScale=sourceScale),baseTexture.resolution=(0,_utils.getResolutionOfUrl)(imageUrl),image.src=imageUrl,BaseTexture.addToCache(baseTexture,imageUrl)}return baseTexture},BaseTexture.fromCanvas=function(canvas,scaleMode){var origin=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"canvas";canvas._pixiId||(canvas._pixiId=origin+"_"+(0,_utils.uid)());var baseTexture=_utils.BaseTextureCache[canvas._pixiId];return baseTexture||(baseTexture=new BaseTexture(canvas,scaleMode),BaseTexture.addToCache(baseTexture,canvas._pixiId)),baseTexture},BaseTexture.from=function(source,scaleMode,sourceScale){if("string"==typeof source)return BaseTexture.fromImage(source,void 0,scaleMode,sourceScale);if(source instanceof HTMLImageElement){var imageUrl=source.src,baseTexture=_utils.BaseTextureCache[imageUrl];return baseTexture||(baseTexture=new BaseTexture(source,scaleMode),baseTexture.imageUrl=imageUrl,sourceScale&&(baseTexture.sourceScale=sourceScale),baseTexture.resolution=(0,_utils.getResolutionOfUrl)(imageUrl),BaseTexture.addToCache(baseTexture,imageUrl)),baseTexture}return source instanceof HTMLCanvasElement?BaseTexture.fromCanvas(source,scaleMode):source},BaseTexture.addToCache=function(baseTexture,id){id&&(-1===baseTexture.textureCacheIds.indexOf(id)&&baseTexture.textureCacheIds.push(id),_utils.BaseTextureCache[id]&&console.warn("BaseTexture added to the cache with an id ["+id+"] that already had an entry"),_utils.BaseTextureCache[id]=baseTexture)},BaseTexture.removeFromCache=function(baseTexture){if("string"==typeof baseTexture){var baseTextureFromCache=_utils.BaseTextureCache[baseTexture];if(baseTextureFromCache){var index=baseTextureFromCache.textureCacheIds.indexOf(baseTexture);return index>-1&&baseTextureFromCache.textureCacheIds.splice(index,1),delete _utils.BaseTextureCache[baseTexture],baseTextureFromCache}}else if(baseTexture&&baseTexture.textureCacheIds){for(var i=0;i<baseTexture.textureCacheIds.length;++i)delete _utils.BaseTextureCache[baseTexture.textureCacheIds[i]];return baseTexture.textureCacheIds.length=0,baseTexture}return null},BaseTexture}(_eventemitter2.default);exports.default=BaseTexture},{"../settings":205,"../utils":229,"../utils/determineCrossOrigin":228,"bit-twiddle":114,eventemitter3:118}],217:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _BaseRenderTexture=require("./BaseRenderTexture"),_BaseRenderTexture2=_interopRequireDefault(_BaseRenderTexture),_Texture2=require("./Texture"),_Texture3=_interopRequireDefault(_Texture2),RenderTexture=function(_Texture){function RenderTexture(baseRenderTexture,frame){_classCallCheck(this,RenderTexture);var _legacyRenderer=null;if(!(baseRenderTexture instanceof _BaseRenderTexture2.default)){var width=arguments[1],height=arguments[2],scaleMode=arguments[3],resolution=arguments[4];console.warn("Please use RenderTexture.create("+width+", "+height+") instead of the ctor directly."),_legacyRenderer=arguments[0],frame=null,baseRenderTexture=new _BaseRenderTexture2.default(width,height,scaleMode,resolution)}var _this=_possibleConstructorReturn(this,_Texture.call(this,baseRenderTexture,frame));return _this.legacyRenderer=_legacyRenderer,_this.valid=!0,_this._updateUvs(),_this}return _inherits(RenderTexture,_Texture),RenderTexture.prototype.resize=function(width,height,doNotResizeBaseTexture){width=Math.ceil(width),height=Math.ceil(height),this.valid=width>0&&height>0,this._frame.width=this.orig.width=width,this._frame.height=this.orig.height=height,doNotResizeBaseTexture||this.baseTexture.resize(width,height),this._updateUvs()},RenderTexture.create=function(width,height,scaleMode,resolution){return new RenderTexture(new _BaseRenderTexture2.default(width,height,scaleMode,resolution))},RenderTexture}(_Texture3.default);exports.default=RenderTexture},{"./BaseRenderTexture":215,"./Texture":219}],218:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_=require("../"),_utils=require("../utils"),Spritesheet=function(){function Spritesheet(baseTexture,data){var resolutionFilename=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;_classCallCheck(this,Spritesheet),this.baseTexture=baseTexture,this.textures={},this.animations={},this.data=data,this.resolution=this._updateResolution(resolutionFilename||this.baseTexture.imageUrl),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return _createClass(Spritesheet,null,[{key:"BATCH_SIZE",get:function(){return 1e3}}]),Spritesheet.prototype._updateResolution=function(resolutionFilename){var scale=this.data.meta.scale,resolution=(0,_utils.getResolutionOfUrl)(resolutionFilename,null);return null===resolution&&(resolution=void 0!==scale?parseFloat(scale):1),1!==resolution&&(this.baseTexture.resolution=resolution,this.baseTexture.update()),resolution},Spritesheet.prototype.parse=function(callback){this._batchIndex=0,this._callback=callback,this._frameKeys.length<=Spritesheet.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},Spritesheet.prototype._processFrames=function(initialFrameIndex){for(var frameIndex=initialFrameIndex,maxFrames=Spritesheet.BATCH_SIZE,sourceScale=this.baseTexture.sourceScale;frameIndex-initialFrameIndex<maxFrames&&frameIndex<this._frameKeys.length;){var i=this._frameKeys[frameIndex],data=this._frames[i],rect=data.frame;if(rect){var frame=null,trim=null,sourceSize=!1!==data.trimmed&&data.sourceSize?data.sourceSize:data.frame,orig=new _.Rectangle(0,0,Math.floor(sourceSize.w*sourceScale)/this.resolution,Math.floor(sourceSize.h*sourceScale)/this.resolution);frame=data.rotated?new _.Rectangle(Math.floor(rect.x*sourceScale)/this.resolution,Math.floor(rect.y*sourceScale)/this.resolution,Math.floor(rect.h*sourceScale)/this.resolution,Math.floor(rect.w*sourceScale)/this.resolution):new _.Rectangle(Math.floor(rect.x*sourceScale)/this.resolution,Math.floor(rect.y*sourceScale)/this.resolution,Math.floor(rect.w*sourceScale)/this.resolution,Math.floor(rect.h*sourceScale)/this.resolution),!1!==data.trimmed&&data.spriteSourceSize&&(trim=new _.Rectangle(Math.floor(data.spriteSourceSize.x*sourceScale)/this.resolution,Math.floor(data.spriteSourceSize.y*sourceScale)/this.resolution,Math.floor(rect.w*sourceScale)/this.resolution,Math.floor(rect.h*sourceScale)/this.resolution)),this.textures[i]=new _.Texture(this.baseTexture,frame,orig,trim,data.rotated?2:0,data.anchor),_.Texture.addToCache(this.textures[i],i)}frameIndex++}},Spritesheet.prototype._processAnimations=function(){var animations=this.data.animations||{};for(var animName in animations){this.animations[animName]=[];for(var _iterator=animations[animName],_isArray=Array.isArray(_iterator),_i=0,_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++]}else{if(_i=_iterator.next(),_i.done)break;_ref=_i.value}var frameName=_ref;this.animations[animName].push(this.textures[frameName])}}},Spritesheet.prototype._parseComplete=function(){var callback=this._callback;this._callback=null,this._batchIndex=0,callback.call(this,this.textures)},Spritesheet.prototype._nextBatch=function(){var _this=this;this._processFrames(this._batchIndex*Spritesheet.BATCH_SIZE),this._batchIndex++,setTimeout(function(){_this._batchIndex*Spritesheet.BATCH_SIZE<_this._frameKeys.length?_this._nextBatch():(_this._processAnimations(),_this._parseComplete())},0)},Spritesheet.prototype.destroy=function(){var destroyBase=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(var i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,destroyBase&&this.baseTexture.destroy(),this.baseTexture=null},Spritesheet}();exports.default=Spritesheet},{"../":169,"../utils":229}],219:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function removeAllHandlers(tex){tex.destroy=function(){},tex.on=function(){},tex.once=function(){},tex.emit=function(){}}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_BaseTexture=require("./BaseTexture"),_BaseTexture2=_interopRequireDefault(_BaseTexture),_VideoBaseTexture=require("./VideoBaseTexture"),_VideoBaseTexture2=_interopRequireDefault(_VideoBaseTexture),_TextureUvs=require("./TextureUvs"),_TextureUvs2=_interopRequireDefault(_TextureUvs),_eventemitter=require("eventemitter3"),_eventemitter2=_interopRequireDefault(_eventemitter),_math=require("../math"),_utils=require("../utils"),_settings=require("../settings"),_settings2=_interopRequireDefault(_settings),Texture=function(_EventEmitter){function Texture(baseTexture,frame,orig,trim,rotate,anchor){_classCallCheck(this,Texture);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));if(_this.noFrame=!1,frame||(_this.noFrame=!0,frame=new _math.Rectangle(0,0,1,1)),baseTexture instanceof Texture&&(baseTexture=baseTexture.baseTexture),_this.baseTexture=baseTexture,_this._frame=frame,_this.trim=trim,_this.valid=!1,_this.requiresUpdate=!1,_this._uvs=null,_this.orig=orig||frame,_this._rotate=Number(rotate||0),!0===rotate)_this._rotate=2;else if(_this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return baseTexture.hasLoaded?(_this.noFrame&&(frame=new _math.Rectangle(0,0,baseTexture.width,baseTexture.height),baseTexture.on("update",_this.onBaseTextureUpdated,_this)),_this.frame=frame):baseTexture.once("loaded",_this.onBaseTextureLoaded,_this),_this.defaultAnchor=anchor?new _math.Point(anchor.x,anchor.y):new _math.Point(0,0),_this._updateID=0,_this.transform=null,_this.textureCacheIds=[],_this}return _inherits(Texture,_EventEmitter),Texture.prototype.update=function(){this.baseTexture.update()},Texture.prototype.onBaseTextureLoaded=function(baseTexture){this._updateID++,this.noFrame?this.frame=new _math.Rectangle(0,0,baseTexture.width,baseTexture.height):this.frame=this._frame,this.baseTexture.on("update",this.onBaseTextureUpdated,this),this.emit("update",this)},Texture.prototype.onBaseTextureUpdated=function(baseTexture){this._updateID++,this._frame.width=baseTexture.width,this._frame.height=baseTexture.height,this.emit("update",this)},Texture.prototype.destroy=function(destroyBase){this.baseTexture&&(destroyBase&&(_utils.TextureCache[this.baseTexture.imageUrl]&&Texture.removeFromCache(this.baseTexture.imageUrl),this.baseTexture.destroy()),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Texture.removeFromCache(this),this.textureCacheIds=null},Texture.prototype.clone=function(){return new Texture(this.baseTexture,this.frame,this.orig,this.trim,this.rotate)},Texture.prototype._updateUvs=function(){this._uvs||(this._uvs=new _TextureUvs2.default),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},Texture.fromImage=function(imageUrl,crossorigin,scaleMode,sourceScale){var texture=_utils.TextureCache[imageUrl];return texture||(texture=new Texture(_BaseTexture2.default.fromImage(imageUrl,crossorigin,scaleMode,sourceScale)),Texture.addToCache(texture,imageUrl)),texture},Texture.fromFrame=function(frameId){var texture=_utils.TextureCache[frameId];if(!texture)throw new Error('The frameId "'+frameId+'" does not exist in the texture cache');return texture},Texture.fromCanvas=function(canvas,scaleMode){var origin=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"canvas";return new Texture(_BaseTexture2.default.fromCanvas(canvas,scaleMode,origin))},Texture.fromVideo=function(video,scaleMode){return"string"==typeof video?Texture.fromVideoUrl(video,scaleMode):new Texture(_VideoBaseTexture2.default.fromVideo(video,scaleMode))},Texture.fromVideoUrl=function(videoUrl,scaleMode){return new Texture(_VideoBaseTexture2.default.fromUrl(videoUrl,scaleMode))},Texture.from=function(source){if("string"==typeof source){var texture=_utils.TextureCache[source];if(!texture){return null!==source.match(/\.(mp4|webm|ogg|h264|avi|mov)$/)?Texture.fromVideoUrl(source):Texture.fromImage(source)}return texture}return source instanceof HTMLImageElement?new Texture(_BaseTexture2.default.from(source)):source instanceof HTMLCanvasElement?Texture.fromCanvas(source,_settings2.default.SCALE_MODE,"HTMLCanvasElement"):source instanceof HTMLVideoElement?Texture.fromVideo(source):source instanceof _BaseTexture2.default?new Texture(source):source},Texture.fromLoader=function(source,imageUrl,name){var baseTexture=new _BaseTexture2.default(source,void 0,(0,_utils.getResolutionOfUrl)(imageUrl)),texture=new Texture(baseTexture);return baseTexture.imageUrl=imageUrl,name||(name=imageUrl),_BaseTexture2.default.addToCache(texture.baseTexture,name),Texture.addToCache(texture,name),name!==imageUrl&&(_BaseTexture2.default.addToCache(texture.baseTexture,imageUrl),Texture.addToCache(texture,imageUrl)),texture},Texture.addToCache=function(texture,id){id&&(-1===texture.textureCacheIds.indexOf(id)&&texture.textureCacheIds.push(id),_utils.TextureCache[id]&&console.warn("Texture added to the cache with an id ["+id+"] that already had an entry"),_utils.TextureCache[id]=texture)},Texture.removeFromCache=function(texture){if("string"==typeof texture){var textureFromCache=_utils.TextureCache[texture];if(textureFromCache){var index=textureFromCache.textureCacheIds.indexOf(texture);return index>-1&&textureFromCache.textureCacheIds.splice(index,1),delete _utils.TextureCache[texture],textureFromCache}}else if(texture&&texture.textureCacheIds){for(var i=0;i<texture.textureCacheIds.length;++i)_utils.TextureCache[texture.textureCacheIds[i]]===texture&&delete _utils.TextureCache[texture.textureCacheIds[i]];return texture.textureCacheIds.length=0,texture}return null},_createClass(Texture,[{key:"frame",get:function(){return this._frame},set:function(frame){this._frame=frame,this.noFrame=!1;var x=frame.x,y=frame.y,width=frame.width,height=frame.height,xNotFit=x+width>this.baseTexture.width,yNotFit=y+height>this.baseTexture.height;if(xNotFit||yNotFit){var relationship=xNotFit&&yNotFit?"and":"or",errorX="X: "+x+" + "+width+" = "+(x+width)+" > "+this.baseTexture.width,errorY="Y: "+y+" + "+height+" = "+(y+height)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+errorX+" "+relationship+" "+errorY)}this.valid=width&&height&&this.baseTexture.hasLoaded,this.trim||this.rotate||(this.orig=frame),this.valid&&this._updateUvs()}},{key:"rotate",get:function(){return this._rotate},set:function(rotate){this._rotate=rotate,this.valid&&this._updateUvs()}},{key:"width",get:function(){return this.orig.width}},{key:"height",get:function(){return this.orig.height}}]),Texture}(_eventemitter2.default);exports.default=Texture,Texture.EMPTY=new Texture(new _BaseTexture2.default),removeAllHandlers(Texture.EMPTY),removeAllHandlers(Texture.EMPTY.baseTexture),Texture.WHITE=function(){var canvas=document.createElement("canvas");canvas.width=10,canvas.height=10;var context=canvas.getContext("2d");return context.fillStyle="white",context.fillRect(0,0,10,10),new Texture(new _BaseTexture2.default(canvas))}(),removeAllHandlers(Texture.WHITE),removeAllHandlers(Texture.WHITE.baseTexture)},{"../math":174,"../settings":205,"../utils":229,"./BaseTexture":216,"./TextureUvs":221,"./VideoBaseTexture":222,eventemitter3:118}],220:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Matrix=require("../math/Matrix"),_Matrix2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Matrix),tempMat=new _Matrix2.default,TextureMatrix=function(){function TextureMatrix(texture,clampMargin){_classCallCheck(this,TextureMatrix),this._texture=texture,this.mapCoord=new _Matrix2.default,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._lastTextureID=-1,this.clampOffset=0,this.clampMargin=void 0===clampMargin?.5:clampMargin}return TextureMatrix.prototype.multiplyUvs=function(uvs,out){void 0===out&&(out=uvs);for(var mat=this.mapCoord,i=0;i<uvs.length;i+=2){var x=uvs[i],y=uvs[i+1];out[i]=x*mat.a+y*mat.c+mat.tx,out[i+1]=x*mat.b+y*mat.d+mat.ty}return out},TextureMatrix.prototype.update=function(forceUpdate){var tex=this._texture;if(!tex||!tex.valid)return!1;if(!forceUpdate&&this._lastTextureID===tex._updateID)return!1;this._lastTextureID=tex._updateID;var uvs=tex._uvs;this.mapCoord.set(uvs.x1-uvs.x0,uvs.y1-uvs.y0,uvs.x3-uvs.x0,uvs.y3-uvs.y0,uvs.x0,uvs.y0);var orig=tex.orig,trim=tex.trim;trim&&(tempMat.set(orig.width/trim.width,0,0,orig.height/trim.height,-trim.x/trim.width,-trim.y/trim.height),this.mapCoord.append(tempMat));var texBase=tex.baseTexture,frame=this.uClampFrame,margin=this.clampMargin/texBase.resolution,offset=this.clampOffset;return frame[0]=(tex._frame.x+margin+offset)/texBase.width,frame[1]=(tex._frame.y+margin+offset)/texBase.height,frame[2]=(tex._frame.x+tex._frame.width-margin+offset)/texBase.width,frame[3]=(tex._frame.y+tex._frame.height-margin+offset)/texBase.height,this.uClampOffset[0]=offset/texBase.realWidth,this.uClampOffset[1]=offset/texBase.realHeight,!0},_createClass(TextureMatrix,[{key:"texture",get:function(){return this._texture},set:function(value){this._texture=value,this._lastTextureID=-1}}]),TextureMatrix}();exports.default=TextureMatrix},{"../math/Matrix":171}],221:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _GroupD=require("../math/GroupD8"),_GroupD2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_GroupD),TextureUvs=function(){function TextureUvs(){_classCallCheck(this,TextureUvs),this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsUint32=new Uint32Array(4)}return TextureUvs.prototype.set=function(frame,baseFrame,rotate){var tw=baseFrame.width,th=baseFrame.height;if(rotate){var w2=frame.width/2/tw,h2=frame.height/2/th,cX=frame.x/tw+w2,cY=frame.y/th+h2;rotate=_GroupD2.default.add(rotate,_GroupD2.default.NW),this.x0=cX+w2*_GroupD2.default.uX(rotate),this.y0=cY+h2*_GroupD2.default.uY(rotate),rotate=_GroupD2.default.add(rotate,2),this.x1=cX+w2*_GroupD2.default.uX(rotate),this.y1=cY+h2*_GroupD2.default.uY(rotate),rotate=_GroupD2.default.add(rotate,2),this.x2=cX+w2*_GroupD2.default.uX(rotate),this.y2=cY+h2*_GroupD2.default.uY(rotate),rotate=_GroupD2.default.add(rotate,2),this.x3=cX+w2*_GroupD2.default.uX(rotate),this.y3=cY+h2*_GroupD2.default.uY(rotate)}else this.x0=frame.x/tw,this.y0=frame.y/th,this.x1=(frame.x+frame.width)/tw,this.y1=frame.y/th,this.x2=(frame.x+frame.width)/tw,this.y2=(frame.y+frame.height)/th,this.x3=frame.x/tw,this.y3=(frame.y+frame.height)/th;this.uvsUint32[0]=(65535*this.y0&65535)<<16|65535*this.x0&65535,this.uvsUint32[1]=(65535*this.y1&65535)<<16|65535*this.x1&65535,this.uvsUint32[2]=(65535*this.y2&65535)<<16|65535*this.x2&65535,this.uvsUint32[3]=(65535*this.y3&65535)<<16|65535*this.x3&65535},TextureUvs}();exports.default=TextureUvs},{"../math/GroupD8":170}],222:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function createSource(path,type){type||(path=path.split("?").shift().toLowerCase(),type="video/"+path.substr(path.lastIndexOf(".")+1));var source=document.createElement("source");return source.src=path,source.type=type,source}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_BaseTexture2=require("./BaseTexture"),_BaseTexture3=_interopRequireDefault(_BaseTexture2),_utils=require("../utils"),_ticker=require("../ticker"),_const=require("../const"),_determineCrossOrigin=require("../utils/determineCrossOrigin"),_determineCrossOrigin2=_interopRequireDefault(_determineCrossOrigin),VideoBaseTexture=function(_BaseTexture){function VideoBaseTexture(source,scaleMode){if(_classCallCheck(this,VideoBaseTexture),!source)throw new Error("No video source element specified.");(source.readyState===source.HAVE_ENOUGH_DATA||source.readyState===source.HAVE_FUTURE_DATA)&&source.width&&source.height&&(source.complete=!0);var _this=_possibleConstructorReturn(this,_BaseTexture.call(this,source,scaleMode));return _this.width=source.videoWidth,_this.height=source.videoHeight,_this._autoUpdate=!0,_this._isAutoUpdating=!1,_this.autoPlay=!0,_this.update=_this.update.bind(_this),_this._onCanPlay=_this._onCanPlay.bind(_this),source.addEventListener("play",_this._onPlayStart.bind(_this)),source.addEventListener("pause",_this._onPlayStop.bind(_this)),_this.hasLoaded=!1,_this.__loaded=!1,_this._isSourceReady()?_this._onCanPlay():(source.addEventListener("canplay",_this._onCanPlay),source.addEventListener("canplaythrough",_this._onCanPlay)),_this}return _inherits(VideoBaseTexture,_BaseTexture),VideoBaseTexture.prototype._isSourcePlaying=function(){var source=this.source;return source.currentTime>0&&!1===source.paused&&!1===source.ended&&source.readyState>2},VideoBaseTexture.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},VideoBaseTexture.prototype._onPlayStart=function(){this.hasLoaded||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(_ticker.shared.add(this.update,this,_const.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0)},VideoBaseTexture.prototype._onPlayStop=function(){this._isAutoUpdating&&(_ticker.shared.remove(this.update,this),this._isAutoUpdating=!1)},VideoBaseTexture.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.__loaded||(this.__loaded=!0,this.emit("loaded",this)),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.source.play())},VideoBaseTexture.prototype.destroy=function(){this._isAutoUpdating&&_ticker.shared.remove(this.update,this),this.source&&this.source._pixiId&&(_BaseTexture3.default.removeFromCache(this.source._pixiId),delete this.source._pixiId,this.source.pause(),this.source.src="",this.source.load()),_BaseTexture.prototype.destroy.call(this)},VideoBaseTexture.fromVideo=function(video,scaleMode){video._pixiId||(video._pixiId="video_"+(0,_utils.uid)());var baseTexture=_utils.BaseTextureCache[video._pixiId];return baseTexture||(baseTexture=new VideoBaseTexture(video,scaleMode),_BaseTexture3.default.addToCache(baseTexture,video._pixiId)),baseTexture},VideoBaseTexture.fromUrl=function(videoSrc,scaleMode,crossorigin){var video=document.createElement("video");video.setAttribute("webkit-playsinline",""),video.setAttribute("playsinline","");var url=Array.isArray(videoSrc)?videoSrc[0].src||videoSrc[0]:videoSrc.src||videoSrc;if(void 0===crossorigin&&0!==url.indexOf("data:")?video.crossOrigin=(0,_determineCrossOrigin2.default)(url):crossorigin&&(video.crossOrigin="string"==typeof crossorigin?crossorigin:"anonymous"),Array.isArray(videoSrc))for(var i=0;i<videoSrc.length;++i)video.appendChild(createSource(videoSrc[i].src||videoSrc[i],videoSrc[i].mime));else video.appendChild(createSource(url,videoSrc.mime));return video.load(),VideoBaseTexture.fromVideo(video,scaleMode)},_createClass(VideoBaseTexture,[{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(value){value!==this._autoUpdate&&(this._autoUpdate=value,!this._autoUpdate&&this._isAutoUpdating?(_ticker.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(_ticker.shared.add(this.update,this,_const.UPDATE_PRIORITY.HIGH),this._isAutoUpdating=!0))}}]),VideoBaseTexture}(_BaseTexture3.default);exports.default=VideoBaseTexture,VideoBaseTexture.fromUrls=VideoBaseTexture.fromUrl},{"../const":150,"../ticker":225,"../utils":229,"../utils/determineCrossOrigin":228,"./BaseTexture":216}],223:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),
Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_settings=require("../settings"),_settings2=_interopRequireDefault(_settings),_const=require("../const"),_TickerListener=require("./TickerListener"),_TickerListener2=_interopRequireDefault(_TickerListener),Ticker=function(){function Ticker(){var _this=this;_classCallCheck(this,Ticker),this._head=new _TickerListener2.default(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/_settings2.default.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._tick=function(time){_this._requestId=null,_this.started&&(_this.update(time),_this.started&&null===_this._requestId&&_this._head.next&&(_this._requestId=requestAnimationFrame(_this._tick)))}}return Ticker.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},Ticker.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},Ticker.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},Ticker.prototype.add=function(fn,context){var priority=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_const.UPDATE_PRIORITY.NORMAL;return this._addListener(new _TickerListener2.default(fn,context,priority))},Ticker.prototype.addOnce=function(fn,context){var priority=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_const.UPDATE_PRIORITY.NORMAL;return this._addListener(new _TickerListener2.default(fn,context,priority,!0))},Ticker.prototype._addListener=function(listener){var current=this._head.next,previous=this._head;if(current){for(;current;){if(listener.priority>current.priority){listener.connect(previous);break}previous=current,current=current.next}listener.previous||listener.connect(previous)}else listener.connect(previous);return this._startIfPossible(),this},Ticker.prototype.remove=function(fn,context){for(var listener=this._head.next;listener;)listener=listener.match(fn,context)?listener.destroy():listener.next;return this._head.next||this._cancelIfNeeded(),this},Ticker.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},Ticker.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},Ticker.prototype.destroy=function(){this.stop();for(var listener=this._head.next;listener;)listener=listener.destroy(!0);this._head.destroy(),this._head=null},Ticker.prototype.update=function(){var currentTime=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now(),elapsedMS=void 0;if(currentTime>this.lastTime){elapsedMS=this.elapsedMS=currentTime-this.lastTime,elapsedMS>this._maxElapsedMS&&(elapsedMS=this._maxElapsedMS),this.deltaTime=elapsedMS*_settings2.default.TARGET_FPMS*this.speed;for(var head=this._head,listener=head.next;listener;)listener=listener.emit(this.deltaTime);head.next||this._cancelIfNeeded()}else this.deltaTime=this.elapsedMS=0;this.lastTime=currentTime},_createClass(Ticker,[{key:"FPS",get:function(){return 1e3/this.elapsedMS}},{key:"minFPS",get:function(){return 1e3/this._maxElapsedMS},set:function(fps){var minFPMS=Math.min(Math.max(0,fps)/1e3,_settings2.default.TARGET_FPMS);this._maxElapsedMS=1/minFPMS}}]),Ticker}();exports.default=Ticker},{"../const":150,"../settings":205,"./TickerListener":224}],224:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var TickerListener=function(){function TickerListener(fn){var context=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,priority=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,once=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,TickerListener),this.fn=fn,this.context=context,this.priority=priority,this.once=once,this.next=null,this.previous=null,this._destroyed=!1}return TickerListener.prototype.match=function(fn,context){return context=context||null,this.fn===fn&&this.context===context},TickerListener.prototype.emit=function(deltaTime){this.fn&&(this.context?this.fn.call(this.context,deltaTime):this.fn(deltaTime));var redirect=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),redirect},TickerListener.prototype.connect=function(previous){this.previous=previous,previous.next&&(previous.next.previous=this),this.next=previous.next,previous.next=this},TickerListener.prototype.destroy=function(){var hard=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var redirect=this.next;return this.next=hard?null:redirect,this.previous=null,redirect},TickerListener}();exports.default=TickerListener},{}],225:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.Ticker=exports.shared=void 0;var _Ticker=require("./Ticker"),_Ticker2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Ticker),shared=new _Ticker2.default;shared.autoStart=!0,shared.destroy=function(){},exports.shared=shared,exports.Ticker=_Ticker2.default},{"./Ticker":223}],226:[function(require,module,exports){"use strict";function canUploadSameBuffer(){return!(!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform))}exports.__esModule=!0,exports.default=canUploadSameBuffer},{}],227:[function(require,module,exports){"use strict";function createIndicesForQuads(size){for(var totalIndices=6*size,indices=new Uint16Array(totalIndices),i=0,j=0;i<totalIndices;i+=6,j+=4)indices[i+0]=j+0,indices[i+1]=j+1,indices[i+2]=j+2,indices[i+3]=j+0,indices[i+4]=j+2,indices[i+5]=j+3;return indices}exports.__esModule=!0,exports.default=createIndicesForQuads},{}],228:[function(require,module,exports){"use strict";function determineCrossOrigin(url){var loc=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location;if(0===url.indexOf("data:"))return"";loc=loc||window.location,tempAnchor||(tempAnchor=document.createElement("a")),tempAnchor.href=url,url=_url3.default.parse(tempAnchor.href);var samePort=!url.port&&""===loc.port||url.port===loc.port;return url.hostname===loc.hostname&&samePort&&url.protocol===loc.protocol?"":"anonymous"}exports.__esModule=!0,exports.default=determineCrossOrigin;var _url2=require("url"),_url3=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_url2),tempAnchor=void 0},{url:308}],229:[function(require,module,exports){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function uid(){return++nextUid}function hex2rgb(hex,out){return out=out||[],out[0]=(hex>>16&255)/255,out[1]=(hex>>8&255)/255,out[2]=(255&hex)/255,out}function hex2string(hex){return hex=hex.toString(16),"#"+(hex="000000".substr(0,6-hex.length)+hex)}function rgb2hex(rgb){return(255*rgb[0]<<16)+(255*rgb[1]<<8)+(255*rgb[2]|0)}function getResolutionOfUrl(url,defaultValue){var resolution=_settings2.default.RETINA_PREFIX.exec(url);return resolution?parseFloat(resolution[1]):void 0!==defaultValue?defaultValue:1}function decomposeDataUri(dataUri){var dataUriMatch=_const.DATA_URI.exec(dataUri);if(dataUriMatch)return{mediaType:dataUriMatch[1]?dataUriMatch[1].toLowerCase():void 0,subType:dataUriMatch[2]?dataUriMatch[2].toLowerCase():void 0,charset:dataUriMatch[3]?dataUriMatch[3].toLowerCase():void 0,encoding:dataUriMatch[4]?dataUriMatch[4].toLowerCase():void 0,data:dataUriMatch[5]}}function getUrlFileExtension(url){var extension=_const.URL_FILE_EXTENSION.exec(url);if(extension)return extension[1].toLowerCase()}function getSvgSize(svgString){var sizeMatch=_const.SVG_SIZE.exec(svgString),size={};return sizeMatch&&(size[sizeMatch[1]]=Math.round(parseFloat(sizeMatch[3])),size[sizeMatch[5]]=Math.round(parseFloat(sizeMatch[7]))),size}function skipHello(){saidHello=!0}function sayHello(type){if(!saidHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var args=["\n %c %c %c PixiJS "+_const.VERSION+" - ✰ "+type+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,args)}else window.console&&window.console.log("PixiJS "+_const.VERSION+" - "+type+" - http://www.pixijs.com/");saidHello=!0}}function isWebGLSupported(){var contextOptions={stencil:!0,failIfMajorPerformanceCaveat:!0};try{if(!window.WebGLRenderingContext)return!1;var canvas=document.createElement("canvas"),gl=canvas.getContext("webgl",contextOptions)||canvas.getContext("experimental-webgl",contextOptions),success=!(!gl||!gl.getContextAttributes().stencil);if(gl){var loseContext=gl.getExtension("WEBGL_lose_context");loseContext&&loseContext.loseContext()}return gl=null,success}catch(e){return!1}}function sign(n){return 0===n?0:n<0?-1:1}function destroyTextureCache(){var key=void 0;for(key in TextureCache)TextureCache[key].destroy();for(key in BaseTextureCache)BaseTextureCache[key].destroy()}function clearTextureCache(){var key=void 0;for(key in TextureCache)delete TextureCache[key];for(key in BaseTextureCache)delete BaseTextureCache[key]}function correctBlendMode(blendMode,premultiplied){return premultiplyBlendMode[premultiplied?1:0][blendMode]}function premultiplyTint(tint,alpha){if(1===alpha)return(255*alpha<<24)+tint;if(0===alpha)return 0;var R=tint>>16&255,G=tint>>8&255,B=255&tint;return R=R*alpha+.5|0,G=G*alpha+.5|0,B=B*alpha+.5|0,(255*alpha<<24)+(R<<16)+(G<<8)+B}function premultiplyRgba(rgb,alpha,out,premultiply){return out=out||new Float32Array(4),premultiply||void 0===premultiply?(out[0]=rgb[0]*alpha,out[1]=rgb[1]*alpha,out[2]=rgb[2]*alpha):(out[0]=rgb[0],out[1]=rgb[1],out[2]=rgb[2]),out[3]=alpha,out}function premultiplyTintToRgba(tint,alpha,out,premultiply){return out=out||new Float32Array(4),out[0]=(tint>>16&255)/255,out[1]=(tint>>8&255)/255,out[2]=(255&tint)/255,(premultiply||void 0===premultiply)&&(out[0]*=alpha,out[1]*=alpha,out[2]*=alpha),out[3]=alpha,out}exports.__esModule=!0,exports.premultiplyBlendMode=exports.BaseTextureCache=exports.TextureCache=exports.earcut=exports.mixins=exports.pluginTarget=exports.EventEmitter=exports.removeItems=exports.isMobile=void 0,exports.uid=uid,exports.hex2rgb=hex2rgb,exports.hex2string=hex2string,exports.rgb2hex=rgb2hex,exports.getResolutionOfUrl=getResolutionOfUrl,exports.decomposeDataUri=decomposeDataUri,exports.getUrlFileExtension=getUrlFileExtension,exports.getSvgSize=getSvgSize,exports.skipHello=skipHello,exports.sayHello=sayHello,exports.isWebGLSupported=isWebGLSupported,exports.sign=sign,exports.destroyTextureCache=destroyTextureCache,exports.clearTextureCache=clearTextureCache,exports.correctBlendMode=correctBlendMode,exports.premultiplyTint=premultiplyTint,exports.premultiplyRgba=premultiplyRgba,exports.premultiplyTintToRgba=premultiplyTintToRgba;var _const=require("../const"),_settings=require("../settings"),_settings2=_interopRequireDefault(_settings),_eventemitter=require("eventemitter3"),_eventemitter2=_interopRequireDefault(_eventemitter),_pluginTarget=require("./pluginTarget"),_pluginTarget2=_interopRequireDefault(_pluginTarget),_mixin=require("./mixin"),mixins=_interopRequireWildcard(_mixin),_ismobilejs=require("ismobilejs"),isMobile=_interopRequireWildcard(_ismobilejs),_removeArrayItems=require("remove-array-items"),_removeArrayItems2=_interopRequireDefault(_removeArrayItems),_mapPremultipliedBlendModes=require("./mapPremultipliedBlendModes"),_mapPremultipliedBlendModes2=_interopRequireDefault(_mapPremultipliedBlendModes),_earcut=require("earcut"),_earcut2=_interopRequireDefault(_earcut),nextUid=0,saidHello=!1;exports.isMobile=isMobile,exports.removeItems=_removeArrayItems2.default,exports.EventEmitter=_eventemitter2.default,exports.pluginTarget=_pluginTarget2.default,exports.mixins=mixins,exports.earcut=_earcut2.default;var TextureCache=exports.TextureCache=Object.create(null),BaseTextureCache=exports.BaseTextureCache=Object.create(null),premultiplyBlendMode=exports.premultiplyBlendMode=(0,_mapPremultipliedBlendModes2.default)()},{"../const":150,"../settings":205,"./mapPremultipliedBlendModes":230,"./mixin":232,"./pluginTarget":233,earcut:116,eventemitter3:118,ismobilejs:119,"remove-array-items":299}],230:[function(require,module,exports){"use strict";function mapPremultipliedBlendModes(){for(var pm=[],npm=[],i=0;i<32;i++)pm[i]=i,npm[i]=i;pm[_const.BLEND_MODES.NORMAL_NPM]=_const.BLEND_MODES.NORMAL,pm[_const.BLEND_MODES.ADD_NPM]=_const.BLEND_MODES.ADD,pm[_const.BLEND_MODES.SCREEN_NPM]=_const.BLEND_MODES.SCREEN,npm[_const.BLEND_MODES.NORMAL]=_const.BLEND_MODES.NORMAL_NPM,npm[_const.BLEND_MODES.ADD]=_const.BLEND_MODES.ADD_NPM,npm[_const.BLEND_MODES.SCREEN]=_const.BLEND_MODES.SCREEN_NPM;var array=[];return array.push(npm),array.push(pm),array}exports.__esModule=!0,exports.default=mapPremultipliedBlendModes;var _const=require("../const")},{"../const":150}],231:[function(require,module,exports){"use strict";function maxRecommendedTextures(max){return _ismobilejs2.default.tablet||_ismobilejs2.default.phone?4:max}exports.__esModule=!0,exports.default=maxRecommendedTextures;var _ismobilejs=require("ismobilejs"),_ismobilejs2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_ismobilejs)},{ismobilejs:119}],232:[function(require,module,exports){"use strict";function mixin(target,source){if(target&&source)for(var keys=Object.keys(source),i=0;i<keys.length;++i){var propertyName=keys[i];Object.defineProperty(target,propertyName,Object.getOwnPropertyDescriptor(source,propertyName))}}function delayMixin(target,source){mixins.push(target,source)}function performMixins(){for(var i=0;i<mixins.length;i+=2)mixin(mixins[i],mixins[i+1]);mixins.length=0}exports.__esModule=!0,exports.mixin=mixin,exports.delayMixin=delayMixin,exports.performMixins=performMixins;var mixins=[]},{}],233:[function(require,module,exports){"use strict";function pluginTarget(obj){obj.__plugins={},obj.registerPlugin=function(pluginName,ctor){obj.__plugins[pluginName]=ctor},obj.prototype.initPlugins=function(){this.plugins=this.plugins||{};for(var o in obj.__plugins)this.plugins[o]=new obj.__plugins[o](this)},obj.prototype.destroyPlugins=function(){for(var o in this.plugins)this.plugins[o].destroy(),this.plugins[o]=null;this.plugins=null}}exports.__esModule=!0,exports.default={mixin:function(obj){pluginTarget(obj)}}},{}],234:[function(require,module,exports){"use strict";function trimCanvas(canvas){var width=canvas.width,height=canvas.height,context=canvas.getContext("2d"),imageData=context.getImageData(0,0,width,height),pixels=imageData.data,len=pixels.length,bound={top:null,left:null,right:null,bottom:null},data=null,i=void 0,x=void 0,y=void 0;for(i=0;i<len;i+=4)0!==pixels[i+3]&&(x=i/4%width,y=~~(i/4/width),null===bound.top&&(bound.top=y),null===bound.left?bound.left=x:x<bound.left&&(bound.left=x),null===bound.right?bound.right=x+1:bound.right<x&&(bound.right=x+1),null===bound.bottom?bound.bottom=y:bound.bottom<y&&(bound.bottom=y));return null!==bound.top&&(width=bound.right-bound.left,height=bound.bottom-bound.top+1,data=context.getImageData(bound.left,bound.top,width,height)),{height:height,width:width,data:data}}exports.__esModule=!0,exports.default=trimCanvas},{}],235:[function(require,module,exports){"use strict";function warn(msg){if(!warnings[msg]){var stack=(new Error).stack;void 0===stack?console.warn("Deprecation Warning: ",msg):(stack=stack.split("\n").splice(3).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cDeprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",msg),console.warn(stack),console.groupEnd()):(console.warn("Deprecation Warning: ",msg),console.warn(stack))),warnings[msg]=!0}}function deprecation(core){var mesh=core.mesh,particles=core.particles,extras=core.extras,filters=core.filters,prepare=core.prepare,loaders=core.loaders,interaction=core.interaction;Object.defineProperties(core,{SpriteBatch:{get:function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")}},AssetLoader:{get:function(){throw new ReferenceError("The loader system was overhauled in PixiJS v3, please see the new PIXI.loaders.Loader class.")}},Stage:{get:function(){return warn("You do not need to use a PIXI Stage any more, you can simply render any container."),core.Container}},DisplayObjectContainer:{get:function(){return warn("DisplayObjectContainer has been shortened to Container, please use Container from now on."),core.Container}},Strip:{get:function(){return warn("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on."),mesh.Mesh}},Rope:{get:function(){return warn("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on."),mesh.Rope}},ParticleContainer:{get:function(){return warn("The ParticleContainer class has been moved to particles.ParticleContainer, please use particles.ParticleContainer from now on."),particles.ParticleContainer}},MovieClip:{get:function(){return warn("The MovieClip class has been moved to extras.AnimatedSprite, please use extras.AnimatedSprite."),extras.AnimatedSprite}},TilingSprite:{get:function(){return warn("The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on."),extras.TilingSprite}},BitmapText:{get:function(){return warn("The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on."),extras.BitmapText}},blendModes:{get:function(){return warn("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on."),core.BLEND_MODES}},scaleModes:{get:function(){return warn("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on."),core.SCALE_MODES}},BaseTextureCache:{get:function(){return warn("The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on."),core.utils.BaseTextureCache}},TextureCache:{get:function(){return warn("The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on."),core.utils.TextureCache}},math:{get:function(){return warn("The math namespace is deprecated, please access members already accessible on PIXI."),core}},AbstractFilter:{get:function(){return warn("AstractFilter has been renamed to Filter, please use PIXI.Filter"),core.Filter}},TransformManual:{get:function(){return warn("TransformManual has been renamed to TransformBase, please update your pixi-spine"),core.TransformBase}},TARGET_FPMS:{get:function(){return warn("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),core.settings.TARGET_FPMS},set:function(value){warn("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),core.settings.TARGET_FPMS=value}},FILTER_RESOLUTION:{get:function(){return warn("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),core.settings.FILTER_RESOLUTION},set:function(value){warn("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),core.settings.FILTER_RESOLUTION=value}},RESOLUTION:{get:function(){return warn("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),core.settings.RESOLUTION},set:function(value){warn("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),core.settings.RESOLUTION=value}},MIPMAP_TEXTURES:{get:function(){return warn("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),core.settings.MIPMAP_TEXTURES},set:function(value){warn("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),core.settings.MIPMAP_TEXTURES=value}},SPRITE_BATCH_SIZE:{get:function(){return warn("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),core.settings.SPRITE_BATCH_SIZE},set:function(value){warn("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),core.settings.SPRITE_BATCH_SIZE=value}},SPRITE_MAX_TEXTURES:{get:function(){return warn("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),core.settings.SPRITE_MAX_TEXTURES},set:function(value){warn("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),core.settings.SPRITE_MAX_TEXTURES=value}},RETINA_PREFIX:{get:function(){return warn("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),core.settings.RETINA_PREFIX},set:function(value){warn("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),core.settings.RETINA_PREFIX=value}},DEFAULT_RENDER_OPTIONS:{get:function(){return warn("PIXI.DEFAULT_RENDER_OPTIONS has been deprecated, please use PIXI.settings.DEFAULT_RENDER_OPTIONS"),core.settings.RENDER_OPTIONS}}});for(var defaults=[{parent:"TRANSFORM_MODE",target:"TRANSFORM_MODE"},{parent:"GC_MODES",target:"GC_MODE"},{parent:"WRAP_MODES",target:"WRAP_MODE"},{parent:"SCALE_MODES",target:"SCALE_MODE"},{parent:"PRECISION",target:"PRECISION_FRAGMENT"}],i=0;i<defaults.length;i++)!function(i){var deprecation=defaults[i];Object.defineProperty(core[deprecation.parent],"DEFAULT",{get:function(){return warn("PIXI."+deprecation.parent+".DEFAULT has been deprecated, please use PIXI.settings."+deprecation.target),core.settings[deprecation.target]},set:function(value){warn("PIXI."+deprecation.parent+".DEFAULT has been deprecated, please use PIXI.settings."+deprecation.target),core.settings[deprecation.target]=value}})}(i);Object.defineProperties(core.settings,{PRECISION:{get:function(){return warn("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),core.settings.PRECISION_FRAGMENT},set:function(value){warn("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),core.settings.PRECISION_FRAGMENT=value}}}),extras.AnimatedSprite&&Object.defineProperties(extras,{MovieClip:{get:function(){return warn("The MovieClip class has been renamed to AnimatedSprite, please use AnimatedSprite from now on."),extras.AnimatedSprite}}}),extras&&Object.defineProperties(extras,{TextureTransform:{get:function(){return warn("The TextureTransform class has been renamed to TextureMatrix, please use PIXI.TextureMatrix from now on."),core.TextureMatrix}}}),core.DisplayObject.prototype.generateTexture=function(renderer,scaleMode,resolution){return warn("generateTexture has moved to the renderer, please use renderer.generateTexture(displayObject)"),renderer.generateTexture(this,scaleMode,resolution)},core.Graphics.prototype.generateTexture=function(scaleMode,resolution){return warn("graphics generate texture has moved to the renderer. Or to render a graphics to a texture using canvas please use generateCanvasTexture"),this.generateCanvasTexture(scaleMode,resolution)},core.GroupD8.isSwapWidthHeight=function(rotation){return warn("GroupD8.isSwapWidthHeight was renamed to GroupD8.isVertical"),core.GroupD8.isVertical(rotation)},core.RenderTexture.prototype.render=function(displayObject,matrix,clear,updateTransform){this.legacyRenderer.render(displayObject,this,clear,matrix,!updateTransform),warn("RenderTexture.render is now deprecated, please use renderer.render(displayObject, renderTexture)")},core.RenderTexture.prototype.getImage=function(target){return warn("RenderTexture.getImage is now deprecated, please use renderer.extract.image(target)"),this.legacyRenderer.extract.image(target)},core.RenderTexture.prototype.getBase64=function(target){return warn("RenderTexture.getBase64 is now deprecated, please use renderer.extract.base64(target)"),this.legacyRenderer.extract.base64(target)},core.RenderTexture.prototype.getCanvas=function(target){return warn("RenderTexture.getCanvas is now deprecated, please use renderer.extract.canvas(target)"),this.legacyRenderer.extract.canvas(target)},core.RenderTexture.prototype.getPixels=function(target){return warn("RenderTexture.getPixels is now deprecated, please use renderer.extract.pixels(target)"),this.legacyRenderer.pixels(target)},core.Sprite.prototype.setTexture=function(texture){this.texture=texture,warn("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")},extras.BitmapText&&(extras.BitmapText.prototype.setText=function(text){this.text=text,warn("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")}),core.Text.prototype.setText=function(text){this.text=text,warn("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")},core.Text.calculateFontProperties=function(font){return warn("Text.calculateFontProperties is now deprecated, please use the TextMetrics.measureFont"),core.TextMetrics.measureFont(font)},Object.defineProperties(core.Text,{fontPropertiesCache:{get:function(){return warn("Text.fontPropertiesCache is deprecated"),core.TextMetrics._fonts}},fontPropertiesCanvas:{get:function(){return warn("Text.fontPropertiesCanvas is deprecated"),core.TextMetrics._canvas}},fontPropertiesContext:{get:function(){return warn("Text.fontPropertiesContext is deprecated"),core.TextMetrics._context}}}),core.Text.prototype.setStyle=function(style){this.style=style,warn("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")},core.Text.prototype.determineFontProperties=function(fontStyle){return warn("determineFontProperties is now deprecated, please use TextMetrics.measureFont method"),core.TextMetrics.measureFont(fontStyle)},core.Text.getFontStyle=function(style){return warn("getFontStyle is now deprecated, please use TextStyle.toFontString() instead"),style=style||{},style instanceof core.TextStyle||(style=new core.TextStyle(style)),style.toFontString()},Object.defineProperties(core.TextStyle.prototype,{font:{get:function(){warn("text style property 'font' is now deprecated, please use the 'fontFamily', 'fontSize', 'fontStyle', 'fontVariant' and 'fontWeight' properties from now on");var fontSizeString="number"==typeof this._fontSize?this._fontSize+"px":this._fontSize;return this._fontStyle+" "+this._fontVariant+" "+this._fontWeight+" "+fontSizeString+" "+this._fontFamily},set:function(font){warn("text style property 'font' is now deprecated, please use the 'fontFamily','fontSize',fontStyle','fontVariant' and 'fontWeight' properties from now on"),font.indexOf("italic")>1?this._fontStyle="italic":font.indexOf("oblique")>-1?this._fontStyle="oblique":this._fontStyle="normal",font.indexOf("small-caps")>-1?this._fontVariant="small-caps":this._fontVariant="normal";var splits=font.split(" "),fontSizeIndex=-1;this._fontSize=26;for(var i=0;i<splits.length;++i)if(splits[i].match(/(px|pt|em|%)/)){fontSizeIndex=i,this._fontSize=splits[i];break}this._fontWeight="normal";for(var _i=0;_i<fontSizeIndex;++_i)if(splits[_i].match(/(bold|bolder|lighter|100|200|300|400|500|600|700|800|900)/)){this._fontWeight=splits[_i];break}if(fontSizeIndex>-1&&fontSizeIndex<splits.length-1){this._fontFamily="";for(var _i2=fontSizeIndex+1;_i2<splits.length;++_i2)this._fontFamily+=splits[_i2]+" ";this._fontFamily=this._fontFamily.slice(0,-1)}else this._fontFamily="Arial";this.styleID++}}}),core.Texture.prototype.setFrame=function(frame){this.frame=frame,warn("setFrame is now deprecated, please use the frame property, e.g: myTexture.frame = frame;")},core.Texture.addTextureToCache=function(texture,id){core.Texture.addToCache(texture,id),warn("Texture.addTextureToCache is deprecated, please use Texture.addToCache from now on.")},core.Texture.removeTextureFromCache=function(id){return warn("Texture.removeTextureFromCache is deprecated, please use Texture.removeFromCache from now on. Be aware that Texture.removeFromCache does not automatically its BaseTexture from the BaseTextureCache. For that, use BaseTexture.removeFromCache"),core.BaseTexture.removeFromCache(id),core.Texture.removeFromCache(id)},Object.defineProperties(filters,{AbstractFilter:{get:function(){return warn("AstractFilter has been renamed to Filter, please use PIXI.Filter"),core.AbstractFilter}},SpriteMaskFilter:{get:function(){return warn("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on."),core.SpriteMaskFilter}},VoidFilter:{get:function(){return warn("VoidFilter has been renamed to AlphaFilter, please use PIXI.filters.AlphaFilter"),filters.AlphaFilter}}}),core.utils.uuid=function(){return warn("utils.uuid() is deprecated, please use utils.uid() from now on."),core.utils.uid()},core.utils.canUseNewCanvasBlendModes=function(){return warn("utils.canUseNewCanvasBlendModes() is deprecated, please use CanvasTinter.canUseMultiply from now on"),core.CanvasTinter.canUseMultiply};var saidHello=!0;if(Object.defineProperty(core.utils,"_saidHello",{set:function(bool){bool&&(warn("PIXI.utils._saidHello is deprecated, please use PIXI.utils.skipHello()"),this.skipHello()),saidHello=bool},get:function(){return saidHello}}),prepare.BasePrepare&&(prepare.BasePrepare.prototype.register=function(addHook,uploadHook){return warn("renderer.plugins.prepare.register is now deprecated, please use renderer.plugins.prepare.registerFindHook & renderer.plugins.prepare.registerUploadHook"),addHook&&this.registerFindHook(addHook),uploadHook&&this.registerUploadHook(uploadHook),this}),prepare.canvas&&Object.defineProperty(prepare.canvas,"UPLOADS_PER_FRAME",{set:function(){warn("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return warn("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}}),prepare.webgl&&Object.defineProperty(prepare.webgl,"UPLOADS_PER_FRAME",{set:function(){warn("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return warn("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}}),loaders.Loader){var Resource=loaders.Resource,Loader=loaders.Loader;Object.defineProperties(Resource.prototype,{isJson:{get:function(){return warn("The isJson property is deprecated, please use `resource.type === Resource.TYPE.JSON`."),this.type===Resource.TYPE.JSON}},isXml:{get:function(){return warn("The isXml property is deprecated, please use `resource.type === Resource.TYPE.XML`."),this.type===Resource.TYPE.XML}},isImage:{get:function(){return warn("The isImage property is deprecated, please use `resource.type === Resource.TYPE.IMAGE`."),this.type===Resource.TYPE.IMAGE}},isAudio:{get:function(){return warn("The isAudio property is deprecated, please use `resource.type === Resource.TYPE.AUDIO`."),this.type===Resource.TYPE.AUDIO}},isVideo:{get:function(){return warn("The isVideo property is deprecated, please use `resource.type === Resource.TYPE.VIDEO`."),this.type===Resource.TYPE.VIDEO}}}),Object.defineProperties(Loader.prototype,{before:{get:function(){
return warn("The before() method is deprecated, please use pre()."),this.pre}},after:{get:function(){return warn("The after() method is deprecated, please use use()."),this.use}}})}interaction.interactiveTarget&&Object.defineProperty(interaction.interactiveTarget,"defaultCursor",{set:function(value){warn("Property defaultCursor has been replaced with 'cursor'. "),this.cursor=value},get:function(){return warn("Property defaultCursor has been replaced with 'cursor'. "),this.cursor}}),interaction.InteractionManager&&(Object.defineProperty(interaction.InteractionManager,"defaultCursorStyle",{set:function(value){warn("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default=value},get:function(){return warn("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default}}),Object.defineProperty(interaction.InteractionManager,"currentCursorStyle",{set:function(value){warn("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode=value},get:function(){return warn("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode}}))}exports.__esModule=!0,exports.default=deprecation;var warnings={}},{}],236:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _core=require("../../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),TEMP_RECT=new core.Rectangle,CanvasExtract=function(){function CanvasExtract(renderer){_classCallCheck(this,CanvasExtract),this.renderer=renderer,renderer.extract=this}return CanvasExtract.prototype.image=function(target){var image=new Image;return image.src=this.base64(target),image},CanvasExtract.prototype.base64=function(target){return this.canvas(target).toDataURL()},CanvasExtract.prototype.canvas=function(target){var renderer=this.renderer,context=void 0,resolution=void 0,frame=void 0,renderTexture=void 0;target&&(renderTexture=target instanceof core.RenderTexture?target:renderer.generateTexture(target)),renderTexture?(context=renderTexture.baseTexture._canvasRenderTarget.context,resolution=renderTexture.baseTexture._canvasRenderTarget.resolution,frame=renderTexture.frame):(context=renderer.rootContext,frame=TEMP_RECT,frame.width=this.renderer.width,frame.height=this.renderer.height);var width=frame.width*resolution,height=frame.height*resolution,canvasBuffer=new core.CanvasRenderTarget(width,height,1),canvasData=context.getImageData(frame.x*resolution,frame.y*resolution,width,height);return canvasBuffer.context.putImageData(canvasData,0,0),canvasBuffer.canvas},CanvasExtract.prototype.pixels=function(target){var renderer=this.renderer,context=void 0,resolution=void 0,frame=void 0,renderTexture=void 0;return target&&(renderTexture=target instanceof core.RenderTexture?target:renderer.generateTexture(target)),renderTexture?(context=renderTexture.baseTexture._canvasRenderTarget.context,resolution=renderTexture.baseTexture._canvasRenderTarget.resolution,frame=renderTexture.frame):(context=renderer.rootContext,frame=TEMP_RECT,frame.width=renderer.width,frame.height=renderer.height),context.getImageData(0,0,frame.width*resolution,frame.height*resolution).data},CanvasExtract.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},CanvasExtract}();exports.default=CanvasExtract,core.CanvasRenderer.registerPlugin("extract",CanvasExtract)},{"../../core":169}],237:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.__esModule=!0;var _WebGLExtract=require("./webgl/WebGLExtract");Object.defineProperty(exports,"webgl",{enumerable:!0,get:function(){return _interopRequireDefault(_WebGLExtract).default}});var _CanvasExtract=require("./canvas/CanvasExtract");Object.defineProperty(exports,"canvas",{enumerable:!0,get:function(){return _interopRequireDefault(_CanvasExtract).default}})},{"./canvas/CanvasExtract":236,"./webgl/WebGLExtract":238}],238:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _core=require("../../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),TEMP_RECT=new core.Rectangle,WebGLExtract=function(){function WebGLExtract(renderer){_classCallCheck(this,WebGLExtract),this.renderer=renderer,renderer.extract=this}return WebGLExtract.prototype.image=function(target){var image=new Image;return image.src=this.base64(target),image},WebGLExtract.prototype.base64=function(target){return this.canvas(target).toDataURL()},WebGLExtract.prototype.canvas=function(target){var renderer=this.renderer,textureBuffer=void 0,resolution=void 0,frame=void 0,flipY=!1,renderTexture=void 0,generated=!1;target&&(target instanceof core.RenderTexture?renderTexture=target:(renderTexture=this.renderer.generateTexture(target),generated=!0)),renderTexture?(textureBuffer=renderTexture.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],resolution=textureBuffer.resolution,frame=renderTexture.frame,flipY=!1):(textureBuffer=this.renderer.rootRenderTarget,resolution=textureBuffer.resolution,flipY=!0,frame=TEMP_RECT,frame.width=textureBuffer.size.width,frame.height=textureBuffer.size.height);var width=frame.width*resolution,height=frame.height*resolution,canvasBuffer=new core.CanvasRenderTarget(width,height,1);if(textureBuffer){renderer.bindRenderTarget(textureBuffer);var webglPixels=new Uint8Array(4*width*height),gl=renderer.gl;gl.readPixels(frame.x*resolution,frame.y*resolution,width,height,gl.RGBA,gl.UNSIGNED_BYTE,webglPixels);var canvasData=canvasBuffer.context.getImageData(0,0,width,height);canvasData.data.set(webglPixels),canvasBuffer.context.putImageData(canvasData,0,0),flipY&&(canvasBuffer.context.scale(1,-1),canvasBuffer.context.drawImage(canvasBuffer.canvas,0,-height))}return generated&&renderTexture.destroy(!0),canvasBuffer.canvas},WebGLExtract.prototype.pixels=function(target){var renderer=this.renderer,textureBuffer=void 0,resolution=void 0,frame=void 0,renderTexture=void 0,generated=!1;target&&(target instanceof core.RenderTexture?renderTexture=target:(renderTexture=this.renderer.generateTexture(target),generated=!0)),renderTexture?(textureBuffer=renderTexture.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],resolution=textureBuffer.resolution,frame=renderTexture.frame):(textureBuffer=this.renderer.rootRenderTarget,resolution=textureBuffer.resolution,frame=TEMP_RECT,frame.width=textureBuffer.size.width,frame.height=textureBuffer.size.height);var width=frame.width*resolution,height=frame.height*resolution,webglPixels=new Uint8Array(4*width*height);if(textureBuffer){renderer.bindRenderTarget(textureBuffer);var gl=renderer.gl;gl.readPixels(frame.x*resolution,frame.y*resolution,width,height,gl.RGBA,gl.UNSIGNED_BYTE,webglPixels)}return generated&&renderTexture.destroy(!0),webglPixels},WebGLExtract.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},WebGLExtract}();exports.default=WebGLExtract,core.WebGLRenderer.registerPlugin("extract",WebGLExtract)},{"../../core":169}],239:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_core=require("../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),AnimatedSprite=function(_core$Sprite){function AnimatedSprite(textures,autoUpdate){_classCallCheck(this,AnimatedSprite);var _this=_possibleConstructorReturn(this,_core$Sprite.call(this,textures[0]instanceof core.Texture?textures[0]:textures[0].texture));return _this._textures=null,_this._durations=null,_this.textures=textures,_this._autoUpdate=!1!==autoUpdate,_this.animationSpeed=1,_this.loop=!0,_this.onComplete=null,_this.onFrameChange=null,_this.onLoop=null,_this._currentTime=0,_this.playing=!1,_this}return _inherits(AnimatedSprite,_core$Sprite),AnimatedSprite.prototype.stop=function(){this.playing&&(this.playing=!1,this._autoUpdate&&core.ticker.shared.remove(this.update,this))},AnimatedSprite.prototype.play=function(){this.playing||(this.playing=!0,this._autoUpdate&&core.ticker.shared.add(this.update,this,core.UPDATE_PRIORITY.HIGH))},AnimatedSprite.prototype.gotoAndStop=function(frameNumber){this.stop();var previousFrame=this.currentFrame;this._currentTime=frameNumber,previousFrame!==this.currentFrame&&this.updateTexture()},AnimatedSprite.prototype.gotoAndPlay=function(frameNumber){var previousFrame=this.currentFrame;this._currentTime=frameNumber,previousFrame!==this.currentFrame&&this.updateTexture(),this.play()},AnimatedSprite.prototype.update=function(deltaTime){var elapsed=this.animationSpeed*deltaTime,previousFrame=this.currentFrame;if(null!==this._durations){var lag=this._currentTime%1*this._durations[this.currentFrame];for(lag+=elapsed/60*1e3;lag<0;)this._currentTime--,lag+=this._durations[this.currentFrame];var sign=Math.sign(this.animationSpeed*deltaTime);for(this._currentTime=Math.floor(this._currentTime);lag>=this._durations[this.currentFrame];)lag-=this._durations[this.currentFrame]*sign,this._currentTime+=sign;this._currentTime+=lag/this._durations[this.currentFrame]}else this._currentTime+=elapsed;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):previousFrame!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<previousFrame?this.onLoop():this.animationSpeed<0&&this.currentFrame>previousFrame&&this.onLoop()),this.updateTexture())},AnimatedSprite.prototype.updateTexture=function(){this._texture=this._textures[this.currentFrame],this._textureID=-1,this.cachedTint=16777215,this.onFrameChange&&this.onFrameChange(this.currentFrame)},AnimatedSprite.prototype.destroy=function(options){this.stop(),_core$Sprite.prototype.destroy.call(this,options)},AnimatedSprite.fromFrames=function(frames){for(var textures=[],i=0;i<frames.length;++i)textures.push(core.Texture.fromFrame(frames[i]));return new AnimatedSprite(textures)},AnimatedSprite.fromImages=function(images){for(var textures=[],i=0;i<images.length;++i)textures.push(core.Texture.fromImage(images[i]));return new AnimatedSprite(textures)},_createClass(AnimatedSprite,[{key:"totalFrames",get:function(){return this._textures.length}},{key:"textures",get:function(){return this._textures},set:function(value){if(value[0]instanceof core.Texture)this._textures=value,this._durations=null;else{this._textures=[],this._durations=[];for(var i=0;i<value.length;i++)this._textures.push(value[i].texture),this._durations.push(value[i].time)}this.gotoAndStop(0),this.updateTexture()}},{key:"currentFrame",get:function(){var currentFrame=Math.floor(this._currentTime)%this._textures.length;return currentFrame<0&&(currentFrame+=this._textures.length),currentFrame}}]),AnimatedSprite}(core.Sprite);exports.default=AnimatedSprite},{"../core":169}],240:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_core=require("../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),_ObservablePoint=require("../core/math/ObservablePoint"),_ObservablePoint2=_interopRequireDefault(_ObservablePoint),_utils=require("../core/utils"),_settings=require("../core/settings"),_settings2=_interopRequireDefault(_settings),BitmapText=function(_core$Container){function BitmapText(text){var style=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,BitmapText);var _this=_possibleConstructorReturn(this,_core$Container.call(this));return _this._textWidth=0,_this._textHeight=0,_this._glyphs=[],_this._font={tint:void 0!==style.tint?style.tint:16777215,align:style.align||"left",name:null,size:0},_this.font=style.font,_this._text=text,_this._maxWidth=0,_this._maxLineHeight=0,_this._letterSpacing=0,_this._anchor=new _ObservablePoint2.default(function(){_this.dirty=!0},_this,0,0),_this.dirty=!1,_this.updateText(),_this}return _inherits(BitmapText,_core$Container),BitmapText.prototype.updateText=function(){for(var data=BitmapText.fonts[this._font.name],scale=this._font.size/data.size,pos=new core.Point,chars=[],lineWidths=[],text=this.text.replace(/(?:\r\n|\r)/g,"\n"),textLength=text.length,maxWidth=this._maxWidth*data.size/this._font.size,prevCharCode=null,lastLineWidth=0,maxLineWidth=0,line=0,lastBreakPos=-1,lastBreakWidth=0,spacesRemoved=0,maxLineHeight=0,i=0;i<textLength;i++){var charCode=text.charCodeAt(i),char=text.charAt(i);if(/(?:\s)/.test(char)&&(lastBreakPos=i,lastBreakWidth=lastLineWidth),"\r"!==char&&"\n"!==char){var charData=data.chars[charCode];charData&&(prevCharCode&&charData.kerning[prevCharCode]&&(pos.x+=charData.kerning[prevCharCode]),chars.push({texture:charData.texture,line:line,charCode:charCode,position:new core.Point(pos.x+charData.xOffset+this._letterSpacing/2,pos.y+charData.yOffset)}),pos.x+=charData.xAdvance+this._letterSpacing,lastLineWidth=pos.x,maxLineHeight=Math.max(maxLineHeight,charData.yOffset+charData.texture.height),prevCharCode=charCode,-1!==lastBreakPos&&maxWidth>0&&pos.x>maxWidth&&(++spacesRemoved,core.utils.removeItems(chars,1+lastBreakPos-spacesRemoved,1+i-lastBreakPos),i=lastBreakPos,lastBreakPos=-1,lineWidths.push(lastBreakWidth),maxLineWidth=Math.max(maxLineWidth,lastBreakWidth),line++,pos.x=0,pos.y+=data.lineHeight,prevCharCode=null))}else lineWidths.push(lastLineWidth),maxLineWidth=Math.max(maxLineWidth,lastLineWidth),++line,++spacesRemoved,pos.x=0,pos.y+=data.lineHeight,prevCharCode=null}var lastChar=text.charAt(text.length-1);"\r"!==lastChar&&"\n"!==lastChar&&(/(?:\s)/.test(lastChar)&&(lastLineWidth=lastBreakWidth),lineWidths.push(lastLineWidth),maxLineWidth=Math.max(maxLineWidth,lastLineWidth));for(var lineAlignOffsets=[],_i=0;_i<=line;_i++){var alignOffset=0;"right"===this._font.align?alignOffset=maxLineWidth-lineWidths[_i]:"center"===this._font.align&&(alignOffset=(maxLineWidth-lineWidths[_i])/2),lineAlignOffsets.push(alignOffset)}for(var lenChars=chars.length,tint=this.tint,_i2=0;_i2<lenChars;_i2++){var c=this._glyphs[_i2];c?c.texture=chars[_i2].texture:(c=new core.Sprite(chars[_i2].texture),this._glyphs.push(c)),c.position.x=(chars[_i2].position.x+lineAlignOffsets[chars[_i2].line])*scale,c.position.y=chars[_i2].position.y*scale,c.scale.x=c.scale.y=scale,c.tint=tint,c.parent||this.addChild(c)}for(var _i3=lenChars;_i3<this._glyphs.length;++_i3)this.removeChild(this._glyphs[_i3]);if(this._textWidth=maxLineWidth*scale,this._textHeight=(pos.y+data.lineHeight)*scale,0!==this.anchor.x||0!==this.anchor.y)for(var _i4=0;_i4<lenChars;_i4++)this._glyphs[_i4].x-=this._textWidth*this.anchor.x,this._glyphs[_i4].y-=this._textHeight*this.anchor.y;this._maxLineHeight=maxLineHeight*scale},BitmapText.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},BitmapText.prototype.getLocalBounds=function(){return this.validate(),_core$Container.prototype.getLocalBounds.call(this)},BitmapText.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},BitmapText.registerFont=function(xml,textures){var data={},info=xml.getElementsByTagName("info")[0],common=xml.getElementsByTagName("common")[0],pages=xml.getElementsByTagName("page"),res=(0,_utils.getResolutionOfUrl)(pages[0].getAttribute("file"),_settings2.default.RESOLUTION),pagesTextures={};data.font=info.getAttribute("face"),data.size=parseInt(info.getAttribute("size"),10),data.lineHeight=parseInt(common.getAttribute("lineHeight"),10)/res,data.chars={},textures instanceof core.Texture&&(textures=[textures]);for(var i=0;i<pages.length;i++){var id=pages[i].getAttribute("id"),file=pages[i].getAttribute("file");pagesTextures[id]=textures instanceof Array?textures[i]:textures[file]}for(var letters=xml.getElementsByTagName("char"),_i5=0;_i5<letters.length;_i5++){var letter=letters[_i5],charCode=parseInt(letter.getAttribute("id"),10),page=letter.getAttribute("page")||0,textureRect=new core.Rectangle(parseInt(letter.getAttribute("x"),10)/res+pagesTextures[page].frame.x/res,parseInt(letter.getAttribute("y"),10)/res+pagesTextures[page].frame.y/res,parseInt(letter.getAttribute("width"),10)/res,parseInt(letter.getAttribute("height"),10)/res);data.chars[charCode]={xOffset:parseInt(letter.getAttribute("xoffset"),10)/res,yOffset:parseInt(letter.getAttribute("yoffset"),10)/res,xAdvance:parseInt(letter.getAttribute("xadvance"),10)/res,kerning:{},texture:new core.Texture(pagesTextures[page].baseTexture,textureRect),page:page}}for(var kernings=xml.getElementsByTagName("kerning"),_i6=0;_i6<kernings.length;_i6++){var kerning=kernings[_i6],first=parseInt(kerning.getAttribute("first"),10)/res,second=parseInt(kerning.getAttribute("second"),10)/res,amount=parseInt(kerning.getAttribute("amount"),10)/res;data.chars[second]&&(data.chars[second].kerning[first]=amount)}return BitmapText.fonts[data.font]=data,data},_createClass(BitmapText,[{key:"tint",get:function(){return this._font.tint},set:function(value){this._font.tint="number"==typeof value&&value>=0?value:16777215,this.dirty=!0}},{key:"align",get:function(){return this._font.align},set:function(value){this._font.align=value||"left",this.dirty=!0}},{key:"anchor",get:function(){return this._anchor},set:function(value){"number"==typeof value?this._anchor.set(value):this._anchor.copy(value)}},{key:"font",get:function(){return this._font},set:function(value){value&&("string"==typeof value?(value=value.split(" "),this._font.name=1===value.length?value[0]:value.slice(1).join(" "),this._font.size=value.length>=2?parseInt(value[0],10):BitmapText.fonts[this._font.name].size):(this._font.name=value.name,this._font.size="number"==typeof value.size?value.size:parseInt(value.size,10)),this.dirty=!0)}},{key:"text",get:function(){return this._text},set:function(value){value=value.toString()||" ",this._text!==value&&(this._text=value,this.dirty=!0)}},{key:"maxWidth",get:function(){return this._maxWidth},set:function(value){this._maxWidth!==value&&(this._maxWidth=value,this.dirty=!0)}},{key:"maxLineHeight",get:function(){return this.validate(),this._maxLineHeight}},{key:"textWidth",get:function(){return this.validate(),this._textWidth}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(value){this._letterSpacing!==value&&(this._letterSpacing=value,this.dirty=!0)}},{key:"textHeight",get:function(){return this.validate(),this._textHeight}}]),BitmapText}(core.Container);exports.default=BitmapText,BitmapText.fonts={}},{"../core":169,"../core/math/ObservablePoint":172,"../core/settings":205,"../core/utils":229}],241:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_core=require("../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),_CanvasTinter=require("../core/sprites/canvas/CanvasTinter"),_CanvasTinter2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_CanvasTinter),tempPoint=new core.Point,TilingSprite=function(_core$Sprite){function TilingSprite(texture){var width=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,height=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;_classCallCheck(this,TilingSprite);var _this=_possibleConstructorReturn(this,_core$Sprite.call(this,texture));return _this.tileTransform=new core.TransformStatic,_this._width=width,_this._height=height,_this._canvasPattern=null,_this.uvTransform=texture.transform||new core.TextureMatrix(texture),_this.pluginName="tilingSprite",_this.uvRespectAnchor=!1,_this}return _inherits(TilingSprite,_core$Sprite),TilingSprite.prototype._onTextureUpdate=function(){this.uvTransform&&(this.uvTransform.texture=this._texture),this.cachedTint=16777215},TilingSprite.prototype._renderWebGL=function(renderer){var texture=this._texture;texture&&texture.valid&&(this.tileTransform.updateLocalTransform(),this.uvTransform.update(),renderer.setObjectRenderer(renderer.plugins[this.pluginName]),renderer.plugins[this.pluginName].render(this))},TilingSprite.prototype._renderCanvas=function(renderer){var texture=this._texture;if(texture.baseTexture.hasLoaded){var context=renderer.context,transform=this.worldTransform,resolution=renderer.resolution,baseTexture=texture.baseTexture,baseTextureResolution=baseTexture.resolution,modX=this.tilePosition.x/this.tileScale.x%texture._frame.width*baseTextureResolution,modY=this.tilePosition.y/this.tileScale.y%texture._frame.height*baseTextureResolution;if(this._textureID!==this._texture._updateID||this.cachedTint!==this.tint){this._textureID=this._texture._updateID;var tempCanvas=new core.CanvasRenderTarget(texture._frame.width,texture._frame.height,baseTextureResolution);16777215!==this.tint?(this.tintedTexture=_CanvasTinter2.default.getTintedTexture(this,this.tint),tempCanvas.context.drawImage(this.tintedTexture,0,0)):tempCanvas.context.drawImage(baseTexture.source,-texture._frame.x*baseTextureResolution,-texture._frame.y*baseTextureResolution),this.cachedTint=this.tint,this._canvasPattern=tempCanvas.context.createPattern(tempCanvas.canvas,"repeat")}context.globalAlpha=this.worldAlpha,context.setTransform(transform.a*resolution,transform.b*resolution,transform.c*resolution,transform.d*resolution,transform.tx*resolution,transform.ty*resolution),renderer.setBlendMode(this.blendMode),context.fillStyle=this._canvasPattern,context.scale(this.tileScale.x/baseTextureResolution,this.tileScale.y/baseTextureResolution);var anchorX=this.anchor.x*-this._width,anchorY=this.anchor.y*-this._height;this.uvRespectAnchor?(context.translate(modX,modY),context.fillRect(-modX+anchorX,-modY+anchorY,this._width/this.tileScale.x*baseTextureResolution,this._height/this.tileScale.y*baseTextureResolution)):(context.translate(modX+anchorX,modY+anchorY),context.fillRect(-modX,-modY,this._width/this.tileScale.x*baseTextureResolution,this._height/this.tileScale.y*baseTextureResolution))}},TilingSprite.prototype._calculateBounds=function(){var minX=this._width*-this._anchor._x,minY=this._height*-this._anchor._y,maxX=this._width*(1-this._anchor._x),maxY=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,minX,minY,maxX,maxY)},TilingSprite.prototype.getLocalBounds=function(rect){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),rect||(this._localBoundsRect||(this._localBoundsRect=new core.Rectangle),rect=this._localBoundsRect),this._bounds.getRectangle(rect)):_core$Sprite.prototype.getLocalBounds.call(this,rect)},TilingSprite.prototype.containsPoint=function(point){this.worldTransform.applyInverse(point,tempPoint);var width=this._width,height=this._height,x1=-width*this.anchor._x;if(tempPoint.x>=x1&&tempPoint.x<x1+width){var y1=-height*this.anchor._y;if(tempPoint.y>=y1&&tempPoint.y<y1+height)return!0}return!1},TilingSprite.prototype.destroy=function(options){_core$Sprite.prototype.destroy.call(this,options),this.tileTransform=null,this.uvTransform=null},TilingSprite.from=function(source,width,height){return new TilingSprite(core.Texture.from(source),width,height)},TilingSprite.fromFrame=function(frameId,width,height){var texture=core.utils.TextureCache[frameId];if(!texture)throw new Error('The frameId "'+frameId+'" does not exist in the texture cache '+this);return new TilingSprite(texture,width,height)},TilingSprite.fromImage=function(imageId,width,height,crossorigin,scaleMode){return new TilingSprite(core.Texture.fromImage(imageId,crossorigin,scaleMode),width,height)},_createClass(TilingSprite,[{key:"clampMargin",get:function(){return this.uvTransform.clampMargin},set:function(value){this.uvTransform.clampMargin=value,this.uvTransform.update(!0)}},{key:"tileScale",get:function(){return this.tileTransform.scale},set:function(value){this.tileTransform.scale.copy(value)}},{key:"tilePosition",get:function(){return this.tileTransform.position},set:function(value){this.tileTransform.position.copy(value)}},{key:"width",get:function(){return this._width},set:function(value){this._width=value}},{key:"height",get:function(){return this._height},set:function(value){this._height=value}}]),TilingSprite}(core.Sprite);exports.default=TilingSprite},{"../core":169,"../core/sprites/canvas/CanvasTinter":208}],242:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _core=require("../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),_Texture=require("../core/textures/Texture"),_Texture2=_interopRequireDefault(_Texture),_BaseTexture=require("../core/textures/BaseTexture"),_BaseTexture2=_interopRequireDefault(_BaseTexture),_utils=require("../core/utils"),DisplayObject=core.DisplayObject,_tempMatrix=new core.Matrix;DisplayObject.prototype._cacheAsBitmap=!1,DisplayObject.prototype._cacheData=!1;var CacheData=function CacheData(){_classCallCheck(this,CacheData),this.textureCacheId=null,this.originalRenderWebGL=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null};Object.defineProperties(DisplayObject.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(value){if(this._cacheAsBitmap!==value){this._cacheAsBitmap=value;var data=void 0;value?(this._cacheData||(this._cacheData=new CacheData),data=this._cacheData,data.originalRenderWebGL=this.renderWebGL,data.originalRenderCanvas=this.renderCanvas,data.originalUpdateTransform=this.updateTransform,data.originalCalculateBounds=this._calculateBounds,data.originalGetLocalBounds=this.getLocalBounds,data.originalDestroy=this.destroy,data.originalContainsPoint=this.containsPoint,data.originalMask=this._mask,data.originalFilterArea=this.filterArea,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(data=this._cacheData,data.sprite&&this._destroyCachedDisplayObject(),this.renderWebGL=data.originalRenderWebGL,this.renderCanvas=data.originalRenderCanvas,this._calculateBounds=data.originalCalculateBounds,this.getLocalBounds=data.originalGetLocalBounds,this.destroy=data.originalDestroy,this.updateTransform=data.originalUpdateTransform,this.containsPoint=data.originalContainsPoint,this._mask=data.originalMask,this.filterArea=data.originalFilterArea)}}}}),DisplayObject.prototype._renderCachedWebGL=function(renderer){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(renderer),this._cacheData.sprite._transformID=-1,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderWebGL(renderer))},
DisplayObject.prototype._initCachedDisplayObject=function(renderer){if(!this._cacheData||!this._cacheData.sprite){var cacheAlpha=this.alpha;this.alpha=1,renderer.currentRenderer.flush();var bounds=this.getLocalBounds().clone();if(this._filters){var padding=this._filters[0].padding;bounds.pad(padding)}var cachedRenderTarget=renderer._activeRenderTarget,stack=renderer.filterManager.filterStack,renderTexture=core.RenderTexture.create(0|bounds.width,0|bounds.height),textureCacheId="cacheAsBitmap_"+(0,_utils.uid)();this._cacheData.textureCacheId=textureCacheId,_BaseTexture2.default.addToCache(renderTexture.baseTexture,textureCacheId),_Texture2.default.addToCache(renderTexture,textureCacheId);var m=_tempMatrix;m.tx=-bounds.x,m.ty=-bounds.y,this.transform.worldTransform.identity(),this.renderWebGL=this._cacheData.originalRenderWebGL,renderer.render(this,renderTexture,!0,m,!0),renderer.bindRenderTarget(cachedRenderTarget),renderer.filterManager.filterStack=stack,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this._mask=null,this.filterArea=null;var cachedSprite=new core.Sprite(renderTexture);cachedSprite.transform.worldTransform=this.transform.worldTransform,cachedSprite.anchor.x=-bounds.x/bounds.width,cachedSprite.anchor.y=-bounds.y/bounds.height,cachedSprite.alpha=cacheAlpha,cachedSprite._bounds=this._bounds,this._calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._cacheData.sprite=cachedSprite,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=renderer._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=cachedSprite.containsPoint.bind(cachedSprite)}},DisplayObject.prototype._renderCachedCanvas=function(renderer){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(renderer),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite.renderCanvas(renderer))},DisplayObject.prototype._initCachedDisplayObjectCanvas=function(renderer){if(!this._cacheData||!this._cacheData.sprite){var bounds=this.getLocalBounds(),cacheAlpha=this.alpha;this.alpha=1;var cachedRenderTarget=renderer.context,renderTexture=core.RenderTexture.create(0|bounds.width,0|bounds.height),textureCacheId="cacheAsBitmap_"+(0,_utils.uid)();this._cacheData.textureCacheId=textureCacheId,_BaseTexture2.default.addToCache(renderTexture.baseTexture,textureCacheId),_Texture2.default.addToCache(renderTexture,textureCacheId);var m=_tempMatrix;this.transform.localTransform.copy(m),m.invert(),m.tx-=bounds.x,m.ty-=bounds.y,this.renderCanvas=this._cacheData.originalRenderCanvas,renderer.render(this,renderTexture,!0,m,!1),renderer.context=cachedRenderTarget,this.renderCanvas=this._renderCachedCanvas,this._calculateBounds=this._calculateCachedBounds,this._mask=null,this.filterArea=null;var cachedSprite=new core.Sprite(renderTexture);cachedSprite.transform.worldTransform=this.transform.worldTransform,cachedSprite.anchor.x=-bounds.x/bounds.width,cachedSprite.anchor.y=-bounds.y/bounds.height,cachedSprite._bounds=this._bounds,cachedSprite.alpha=cacheAlpha,this.parent?this.updateTransform():(this.parent=renderer._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.updateTransform=this.displayObjectUpdateTransform,this._cacheData.sprite=cachedSprite,this.containsPoint=cachedSprite.containsPoint.bind(cachedSprite)}},DisplayObject.prototype._calculateCachedBounds=function(){this._cacheData.sprite._calculateBounds()},DisplayObject.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()},DisplayObject.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,_BaseTexture2.default.removeFromCache(this._cacheData.textureCacheId),_Texture2.default.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},DisplayObject.prototype._cacheAsBitmapDestroy=function(options){this.cacheAsBitmap=!1,this.destroy(options)}},{"../core":169,"../core/textures/BaseTexture":216,"../core/textures/Texture":219,"../core/utils":229}],243:[function(require,module,exports){"use strict";var _core=require("../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core);core.DisplayObject.prototype.name=null,core.Container.prototype.getChildByName=function(name){for(var i=0;i<this.children.length;i++)if(this.children[i].name===name)return this.children[i];return null}},{"../core":169}],244:[function(require,module,exports){"use strict";var _core=require("../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core);core.DisplayObject.prototype.getGlobalPosition=function(){var point=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new core.Point,skipUpdate=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.parent?this.parent.toGlobal(this.position,point,skipUpdate):(point.x=this.position.x,point.y=this.position.y),point}},{"../core":169}],245:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.__esModule=!0,exports.BitmapText=exports.TilingSpriteRenderer=exports.TilingSprite=exports.AnimatedSprite=void 0;var _AnimatedSprite=require("./AnimatedSprite");Object.defineProperty(exports,"AnimatedSprite",{enumerable:!0,get:function(){return _interopRequireDefault(_AnimatedSprite).default}});var _TilingSprite=require("./TilingSprite");Object.defineProperty(exports,"TilingSprite",{enumerable:!0,get:function(){return _interopRequireDefault(_TilingSprite).default}});var _TilingSpriteRenderer=require("./webgl/TilingSpriteRenderer");Object.defineProperty(exports,"TilingSpriteRenderer",{enumerable:!0,get:function(){return _interopRequireDefault(_TilingSpriteRenderer).default}});var _BitmapText=require("./BitmapText");Object.defineProperty(exports,"BitmapText",{enumerable:!0,get:function(){return _interopRequireDefault(_BitmapText).default}}),require("./cacheAsBitmap"),require("./getChildByName"),require("./getGlobalPosition")},{"./AnimatedSprite":239,"./BitmapText":240,"./TilingSprite":241,"./cacheAsBitmap":242,"./getChildByName":243,"./getGlobalPosition":244,"./webgl/TilingSpriteRenderer":246}],246:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _core=require("../../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),_const=require("../../core/const"),tempMat=(require("path"),new core.Matrix),TilingSpriteRenderer=function(_core$ObjectRenderer){function TilingSpriteRenderer(renderer){_classCallCheck(this,TilingSpriteRenderer);var _this=_possibleConstructorReturn(this,_core$ObjectRenderer.call(this,renderer));return _this.shader=null,_this.simpleShader=null,_this.quad=null,_this}return _inherits(TilingSpriteRenderer,_core$ObjectRenderer),TilingSpriteRenderer.prototype.onContextChange=function(){var gl=this.renderer.gl;this.shader=new core.Shader(gl,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    gl_FragColor = sample * uColor;\n}\n"),this.simpleShader=new core.Shader(gl,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n"),this.renderer.bindVao(null),this.quad=new core.Quad(gl,this.renderer.state.attribState),this.quad.initVao(this.shader)},TilingSpriteRenderer.prototype.render=function(ts){var renderer=this.renderer,quad=this.quad;renderer.bindVao(quad.vao);var vertices=quad.vertices;vertices[0]=vertices[6]=ts._width*-ts.anchor.x,vertices[1]=vertices[3]=ts._height*-ts.anchor.y,vertices[2]=vertices[4]=ts._width*(1-ts.anchor.x),vertices[5]=vertices[7]=ts._height*(1-ts.anchor.y),ts.uvRespectAnchor&&(vertices=quad.uvs,vertices[0]=vertices[6]=-ts.anchor.x,vertices[1]=vertices[3]=-ts.anchor.y,vertices[2]=vertices[4]=1-ts.anchor.x,vertices[5]=vertices[7]=1-ts.anchor.y),quad.upload();var tex=ts._texture,baseTex=tex.baseTexture,lt=ts.tileTransform.localTransform,uv=ts.uvTransform,isSimple=baseTex.isPowerOfTwo&&tex.frame.width===baseTex.width&&tex.frame.height===baseTex.height;isSimple&&(baseTex._glTextures[renderer.CONTEXT_UID]?isSimple=baseTex.wrapMode!==_const.WRAP_MODES.CLAMP:baseTex.wrapMode===_const.WRAP_MODES.CLAMP&&(baseTex.wrapMode=_const.WRAP_MODES.REPEAT));var shader=isSimple?this.simpleShader:this.shader;renderer.bindShader(shader);var w=tex.width,h=tex.height,W=ts._width,H=ts._height;tempMat.set(lt.a*w/W,lt.b*w/H,lt.c*h/W,lt.d*h/H,lt.tx/W,lt.ty/H),tempMat.invert(),isSimple?tempMat.prepend(uv.mapCoord):(shader.uniforms.uMapCoord=uv.mapCoord.toArray(!0),shader.uniforms.uClampFrame=uv.uClampFrame,shader.uniforms.uClampOffset=uv.uClampOffset),shader.uniforms.uTransform=tempMat.toArray(!0),shader.uniforms.uColor=core.utils.premultiplyTintToRgba(ts.tint,ts.worldAlpha,shader.uniforms.uColor,baseTex.premultipliedAlpha),shader.uniforms.translationMatrix=ts.transform.worldTransform.toArray(!0),shader.uniforms.uSampler=renderer.bindTexture(tex),renderer.setBlendMode(core.utils.correctBlendMode(ts.blendMode,baseTex.premultipliedAlpha)),quad.vao.draw(this.renderer.gl.TRIANGLES,6,0)},TilingSpriteRenderer}(core.ObjectRenderer);exports.default=TilingSpriteRenderer,core.WebGLRenderer.registerPlugin("tilingSprite",TilingSpriteRenderer)},{"../../core":169,"../../core/const":150,path:126}],247:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_core=require("../../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),AlphaFilter=(require("path"),function(_core$Filter){function AlphaFilter(){var alpha=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;_classCallCheck(this,AlphaFilter);var _this=_possibleConstructorReturn(this,_core$Filter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n"));return _this.alpha=alpha,_this.glShaderKey="alpha",_this}return _inherits(AlphaFilter,_core$Filter),_createClass(AlphaFilter,[{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(value){this.uniforms.uAlpha=value}}]),AlphaFilter}(core.Filter));exports.default=AlphaFilter},{"../../core":169,path:126}],248:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_core=require("../../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),_BlurXFilter=require("./BlurXFilter"),_BlurXFilter2=_interopRequireDefault(_BlurXFilter),_BlurYFilter=require("./BlurYFilter"),_BlurYFilter2=_interopRequireDefault(_BlurYFilter),BlurFilter=function(_core$Filter){function BlurFilter(strength,quality,resolution,kernelSize){_classCallCheck(this,BlurFilter);var _this=_possibleConstructorReturn(this,_core$Filter.call(this));return _this.blurXFilter=new _BlurXFilter2.default(strength,quality,resolution,kernelSize),_this.blurYFilter=new _BlurYFilter2.default(strength,quality,resolution,kernelSize),_this.padding=0,_this.resolution=resolution||core.settings.RESOLUTION,_this.quality=quality||4,_this.blur=strength||8,_this}return _inherits(BlurFilter,_core$Filter),BlurFilter.prototype.apply=function(filterManager,input,output){var renderTarget=filterManager.getRenderTarget(!0);this.blurXFilter.apply(filterManager,input,renderTarget,!0),this.blurYFilter.apply(filterManager,renderTarget,output,!1),filterManager.returnRenderTarget(renderTarget)},_createClass(BlurFilter,[{key:"blur",get:function(){return this.blurXFilter.blur},set:function(value){this.blurXFilter.blur=this.blurYFilter.blur=value,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"quality",get:function(){return this.blurXFilter.quality},set:function(value){this.blurXFilter.quality=this.blurYFilter.quality=value}},{key:"blurX",get:function(){return this.blurXFilter.blur},set:function(value){this.blurXFilter.blur=value,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blurY",get:function(){return this.blurYFilter.blur},set:function(value){this.blurYFilter.blur=value,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blendMode",get:function(){return this.blurYFilter._blendMode},set:function(value){this.blurYFilter._blendMode=value}}]),BlurFilter}(core.Filter);exports.default=BlurFilter},{"../../core":169,"./BlurXFilter":249,"./BlurYFilter":250}],249:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_core=require("../../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),_generateBlurVertSource=require("./generateBlurVertSource"),_generateBlurVertSource2=_interopRequireDefault(_generateBlurVertSource),_generateBlurFragSource=require("./generateBlurFragSource"),_generateBlurFragSource2=_interopRequireDefault(_generateBlurFragSource),_getMaxBlurKernelSize=require("./getMaxBlurKernelSize"),_getMaxBlurKernelSize2=_interopRequireDefault(_getMaxBlurKernelSize),BlurXFilter=function(_core$Filter){function BlurXFilter(strength,quality,resolution,kernelSize){_classCallCheck(this,BlurXFilter),kernelSize=kernelSize||5;var vertSrc=(0,_generateBlurVertSource2.default)(kernelSize,!0),fragSrc=(0,_generateBlurFragSource2.default)(kernelSize),_this=_possibleConstructorReturn(this,_core$Filter.call(this,vertSrc,fragSrc));return _this.resolution=resolution||core.settings.RESOLUTION,_this._quality=0,_this.quality=quality||4,_this.strength=strength||8,_this.firstRun=!0,_this}return _inherits(BlurXFilter,_core$Filter),BlurXFilter.prototype.apply=function(filterManager,input,output,clear){if(this.firstRun){var gl=filterManager.renderer.gl,kernelSize=(0,_getMaxBlurKernelSize2.default)(gl);this.vertexSrc=(0,_generateBlurVertSource2.default)(kernelSize,!0),this.fragmentSrc=(0,_generateBlurFragSource2.default)(kernelSize),this.firstRun=!1}if(this.uniforms.strength=1/output.size.width*(output.size.width/input.size.width),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)filterManager.applyFilter(this,input,output,clear);else{for(var renderTarget=filterManager.getRenderTarget(!0),flip=input,flop=renderTarget,i=0;i<this.passes-1;i++){filterManager.applyFilter(this,flip,flop,!0);var temp=flop;flop=flip,flip=temp}filterManager.applyFilter(this,flip,output,clear),filterManager.returnRenderTarget(renderTarget)}},_createClass(BlurXFilter,[{key:"blur",get:function(){return this.strength},set:function(value){this.padding=2*Math.abs(value),this.strength=value}},{key:"quality",get:function(){return this._quality},set:function(value){this._quality=value,this.passes=value}}]),BlurXFilter}(core.Filter);exports.default=BlurXFilter},{"../../core":169,"./generateBlurFragSource":251,"./generateBlurVertSource":252,"./getMaxBlurKernelSize":253}],250:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_core=require("../../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),_generateBlurVertSource=require("./generateBlurVertSource"),_generateBlurVertSource2=_interopRequireDefault(_generateBlurVertSource),_generateBlurFragSource=require("./generateBlurFragSource"),_generateBlurFragSource2=_interopRequireDefault(_generateBlurFragSource),_getMaxBlurKernelSize=require("./getMaxBlurKernelSize"),_getMaxBlurKernelSize2=_interopRequireDefault(_getMaxBlurKernelSize),BlurYFilter=function(_core$Filter){function BlurYFilter(strength,quality,resolution,kernelSize){_classCallCheck(this,BlurYFilter),kernelSize=kernelSize||5;var vertSrc=(0,_generateBlurVertSource2.default)(kernelSize,!1),fragSrc=(0,_generateBlurFragSource2.default)(kernelSize),_this=_possibleConstructorReturn(this,_core$Filter.call(this,vertSrc,fragSrc));return _this.resolution=resolution||core.settings.RESOLUTION,_this._quality=0,_this.quality=quality||4,_this.strength=strength||8,_this.firstRun=!0,_this}return _inherits(BlurYFilter,_core$Filter),BlurYFilter.prototype.apply=function(filterManager,input,output,clear){if(this.firstRun){var gl=filterManager.renderer.gl,kernelSize=(0,_getMaxBlurKernelSize2.default)(gl);this.vertexSrc=(0,_generateBlurVertSource2.default)(kernelSize,!1),this.fragmentSrc=(0,_generateBlurFragSource2.default)(kernelSize),this.firstRun=!1}if(this.uniforms.strength=1/output.size.height*(output.size.height/input.size.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)filterManager.applyFilter(this,input,output,clear);else{for(var renderTarget=filterManager.getRenderTarget(!0),flip=input,flop=renderTarget,i=0;i<this.passes-1;i++){filterManager.applyFilter(this,flip,flop,!0);var temp=flop;flop=flip,flip=temp}filterManager.applyFilter(this,flip,output,clear),filterManager.returnRenderTarget(renderTarget)}},_createClass(BlurYFilter,[{key:"blur",get:function(){return this.strength},set:function(value){this.padding=2*Math.abs(value),this.strength=value}},{key:"quality",get:function(){return this._quality},set:function(value){this._quality=value,this.passes=value}}]),BlurYFilter}(core.Filter);exports.default=BlurYFilter},{"../../core":169,"./generateBlurFragSource":251,"./generateBlurVertSource":252,"./getMaxBlurKernelSize":253}],251:[function(require,module,exports){"use strict";function generateFragBlurSource(kernelSize){for(var kernel=GAUSSIAN_VALUES[kernelSize],halfLength=kernel.length,fragSource=fragTemplate,blurLoop="",template="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;",value=void 0,i=0;i<kernelSize;i++){var blur=template.replace("%index%",i);value=i,i>=halfLength&&(value=kernelSize-i-1),blur=blur.replace("%value%",kernel[value]),blurLoop+=blur,blurLoop+="\n"}return fragSource=fragSource.replace("%blur%",blurLoop),fragSource=fragSource.replace("%size%",kernelSize)}exports.__esModule=!0,exports.default=generateFragBlurSource;var GAUSSIAN_VALUES={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},fragTemplate=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n")},{}],252:[function(require,module,exports){"use strict";function generateVertBlurSource(kernelSize,x){var halfLength=Math.ceil(kernelSize/2),vertSource=vertTemplate,blurLoop="",template=void 0;template=x?"vBlurTexCoords[%index%] = aTextureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] = aTextureCoord + vec2(0.0, %sampleIndex% * strength);";for(var i=0;i<kernelSize;i++){var blur=template.replace("%index%",i);blur=blur.replace("%sampleIndex%",i-(halfLength-1)+".0"),blurLoop+=blur,blurLoop+="\n"}return vertSource=vertSource.replace("%blur%",blurLoop),vertSource=vertSource.replace("%size%",kernelSize)}exports.__esModule=!0,exports.default=generateVertBlurSource;var vertTemplate=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform float strength;","uniform mat3 projectionMatrix;","varying vec2 vBlurTexCoords[%size%];","void main(void)","{","gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);","%blur%","}"].join("\n")},{}],253:[function(require,module,exports){"use strict";function getMaxKernelSize(gl){for(var maxVaryings=gl.getParameter(gl.MAX_VARYING_VECTORS),kernelSize=15;kernelSize>maxVaryings;)kernelSize-=2;return kernelSize}exports.__esModule=!0,exports.default=getMaxKernelSize},{}],254:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_core=require("../../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),ColorMatrixFilter=(require("path"),function(_core$Filter){function ColorMatrixFilter(){_classCallCheck(this,ColorMatrixFilter);var _this=_possibleConstructorReturn(this,_core$Filter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n"));return _this.uniforms.m=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],_this.alpha=1,_this}return _inherits(ColorMatrixFilter,_core$Filter),ColorMatrixFilter.prototype._loadMatrix=function(matrix){var multiply=arguments.length>1&&void 0!==arguments[1]&&arguments[1],newMatrix=matrix;multiply&&(this._multiply(newMatrix,this.uniforms.m,matrix),newMatrix=this._colorMatrix(newMatrix)),this.uniforms.m=newMatrix
},ColorMatrixFilter.prototype._multiply=function(out,a,b){return out[0]=a[0]*b[0]+a[1]*b[5]+a[2]*b[10]+a[3]*b[15],out[1]=a[0]*b[1]+a[1]*b[6]+a[2]*b[11]+a[3]*b[16],out[2]=a[0]*b[2]+a[1]*b[7]+a[2]*b[12]+a[3]*b[17],out[3]=a[0]*b[3]+a[1]*b[8]+a[2]*b[13]+a[3]*b[18],out[4]=a[0]*b[4]+a[1]*b[9]+a[2]*b[14]+a[3]*b[19]+a[4],out[5]=a[5]*b[0]+a[6]*b[5]+a[7]*b[10]+a[8]*b[15],out[6]=a[5]*b[1]+a[6]*b[6]+a[7]*b[11]+a[8]*b[16],out[7]=a[5]*b[2]+a[6]*b[7]+a[7]*b[12]+a[8]*b[17],out[8]=a[5]*b[3]+a[6]*b[8]+a[7]*b[13]+a[8]*b[18],out[9]=a[5]*b[4]+a[6]*b[9]+a[7]*b[14]+a[8]*b[19]+a[9],out[10]=a[10]*b[0]+a[11]*b[5]+a[12]*b[10]+a[13]*b[15],out[11]=a[10]*b[1]+a[11]*b[6]+a[12]*b[11]+a[13]*b[16],out[12]=a[10]*b[2]+a[11]*b[7]+a[12]*b[12]+a[13]*b[17],out[13]=a[10]*b[3]+a[11]*b[8]+a[12]*b[13]+a[13]*b[18],out[14]=a[10]*b[4]+a[11]*b[9]+a[12]*b[14]+a[13]*b[19]+a[14],out[15]=a[15]*b[0]+a[16]*b[5]+a[17]*b[10]+a[18]*b[15],out[16]=a[15]*b[1]+a[16]*b[6]+a[17]*b[11]+a[18]*b[16],out[17]=a[15]*b[2]+a[16]*b[7]+a[17]*b[12]+a[18]*b[17],out[18]=a[15]*b[3]+a[16]*b[8]+a[17]*b[13]+a[18]*b[18],out[19]=a[15]*b[4]+a[16]*b[9]+a[17]*b[14]+a[18]*b[19]+a[19],out},ColorMatrixFilter.prototype._colorMatrix=function(matrix){var m=new Float32Array(matrix);return m[4]/=255,m[9]/=255,m[14]/=255,m[19]/=255,m},ColorMatrixFilter.prototype.brightness=function(b,multiply){var matrix=[b,0,0,0,0,0,b,0,0,0,0,0,b,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.greyscale=function(scale,multiply){var matrix=[scale,scale,scale,0,0,scale,scale,scale,0,0,scale,scale,scale,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.blackAndWhite=function(multiply){var matrix=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.hue=function(rotation,multiply){rotation=(rotation||0)/180*Math.PI;var cosR=Math.cos(rotation),sinR=Math.sin(rotation),sqrt=Math.sqrt,w=1/3,sqrW=sqrt(w),a00=cosR+(1-cosR)*w,a01=w*(1-cosR)-sqrW*sinR,a02=w*(1-cosR)+sqrW*sinR,a10=w*(1-cosR)+sqrW*sinR,a11=cosR+w*(1-cosR),a12=w*(1-cosR)-sqrW*sinR,a20=w*(1-cosR)-sqrW*sinR,a21=w*(1-cosR)+sqrW*sinR,a22=cosR+w*(1-cosR),matrix=[a00,a01,a02,0,0,a10,a11,a12,0,0,a20,a21,a22,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.contrast=function(amount,multiply){var v=(amount||0)+1,o=-.5*(v-1),matrix=[v,0,0,0,o,0,v,0,0,o,0,0,v,0,o,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.saturate=function(){var amount=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,multiply=arguments[1],x=2*amount/3+1,y=-.5*(x-1),matrix=[x,y,y,0,0,y,x,y,0,0,y,y,x,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.desaturate=function(){this.saturate(-1)},ColorMatrixFilter.prototype.negative=function(multiply){var matrix=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.sepia=function(multiply){var matrix=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.technicolor=function(multiply){var matrix=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.polaroid=function(multiply){var matrix=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.toBGR=function(multiply){var matrix=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.kodachrome=function(multiply){var matrix=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.browni=function(multiply){var matrix=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.vintage=function(multiply){var matrix=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.colorTone=function(desaturation,toned,lightColor,darkColor,multiply){desaturation=desaturation||.2,toned=toned||.15,lightColor=lightColor||16770432,darkColor=darkColor||3375104;var lR=(lightColor>>16&255)/255,lG=(lightColor>>8&255)/255,lB=(255&lightColor)/255,dR=(darkColor>>16&255)/255,dG=(darkColor>>8&255)/255,dB=(255&darkColor)/255,matrix=[.3,.59,.11,0,0,lR,lG,lB,desaturation,0,dR,dG,dB,toned,0,lR-dR,lG-dG,lB-dB,0,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.night=function(intensity,multiply){intensity=intensity||.1;var matrix=[-2*intensity,-intensity,0,0,0,-intensity,0,intensity,0,0,0,intensity,2*intensity,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.predator=function(amount,multiply){var matrix=[11.224130630493164*amount,-4.794486999511719*amount,-2.8746118545532227*amount,0*amount,.40342438220977783*amount,-3.6330697536468506*amount,9.193157196044922*amount,-2.951810836791992*amount,0*amount,-1.316135048866272*amount,-3.2184197902679443*amount,-4.2375030517578125*amount,7.476448059082031*amount,0*amount,.8044459223747253*amount,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.lsd=function(multiply){var matrix=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.reset=function(){var matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(matrix,!1)},_createClass(ColorMatrixFilter,[{key:"matrix",get:function(){return this.uniforms.m},set:function(value){this.uniforms.m=value}},{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(value){this.uniforms.uAlpha=value}}]),ColorMatrixFilter}(core.Filter));exports.default=ColorMatrixFilter,ColorMatrixFilter.prototype.grayscale=ColorMatrixFilter.prototype.greyscale},{"../../core":169,path:126}],255:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_core=require("../../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),DisplacementFilter=(require("path"),function(_core$Filter){function DisplacementFilter(sprite,scale){_classCallCheck(this,DisplacementFilter);var maskMatrix=new core.Matrix;sprite.renderable=!1;var _this=_possibleConstructorReturn(this,_core$Filter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vTextureCoord = aTextureCoord;\n}","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform vec4 filterArea;\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy *= scale / filterArea.xy;\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), filterClamp.xy, filterClamp.zw));\n}\n"));return _this.maskSprite=sprite,_this.maskMatrix=maskMatrix,_this.uniforms.mapSampler=sprite._texture,_this.uniforms.filterMatrix=maskMatrix,_this.uniforms.scale={x:1,y:1},null!==scale&&void 0!==scale||(scale=20),_this.scale=new core.Point(scale,scale),_this}return _inherits(DisplacementFilter,_core$Filter),DisplacementFilter.prototype.apply=function(filterManager,input,output){this.uniforms.filterMatrix=filterManager.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y,filterManager.applyFilter(this,input,output)},_createClass(DisplacementFilter,[{key:"map",get:function(){return this.uniforms.mapSampler},set:function(value){this.uniforms.mapSampler=value}}]),DisplacementFilter}(core.Filter));exports.default=DisplacementFilter},{"../../core":169,path:126}],256:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _core=require("../../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),FXAAFilter=(require("path"),function(_core$Filter){function FXAAFilter(){return _classCallCheck(this,FXAAFilter),_possibleConstructorReturn(this,_core$Filter.call(this,"\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform vec4 filterArea;\n\nvarying vec2 vTextureCoord;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n   vTextureCoord = aTextureCoord;\n\n   vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n   texcoords(fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n \n --\n \n From:\n https://github.com/mitsuhiko/webgl-meincraft\n \n Copyright (c) 2011 by Armin Ronacher.\n \n Some rights reserved.\n \n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n \n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n \n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n \n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n \n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n    \n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n    \n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n      vec4 color;\n\n    color = fxaa(uSampler, fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n'))}return _inherits(FXAAFilter,_core$Filter),FXAAFilter}(core.Filter));exports.default=FXAAFilter},{"../../core":169,path:126}],257:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.__esModule=!0;var _FXAAFilter=require("./fxaa/FXAAFilter");Object.defineProperty(exports,"FXAAFilter",{enumerable:!0,get:function(){return _interopRequireDefault(_FXAAFilter).default}});var _NoiseFilter=require("./noise/NoiseFilter");Object.defineProperty(exports,"NoiseFilter",{enumerable:!0,get:function(){return _interopRequireDefault(_NoiseFilter).default}});var _DisplacementFilter=require("./displacement/DisplacementFilter");Object.defineProperty(exports,"DisplacementFilter",{enumerable:!0,get:function(){return _interopRequireDefault(_DisplacementFilter).default}});var _BlurFilter=require("./blur/BlurFilter");Object.defineProperty(exports,"BlurFilter",{enumerable:!0,get:function(){return _interopRequireDefault(_BlurFilter).default}});var _BlurXFilter=require("./blur/BlurXFilter");Object.defineProperty(exports,"BlurXFilter",{enumerable:!0,get:function(){return _interopRequireDefault(_BlurXFilter).default}});var _BlurYFilter=require("./blur/BlurYFilter");Object.defineProperty(exports,"BlurYFilter",{enumerable:!0,get:function(){return _interopRequireDefault(_BlurYFilter).default}});var _ColorMatrixFilter=require("./colormatrix/ColorMatrixFilter");Object.defineProperty(exports,"ColorMatrixFilter",{enumerable:!0,get:function(){return _interopRequireDefault(_ColorMatrixFilter).default}});var _AlphaFilter=require("./alpha/AlphaFilter");Object.defineProperty(exports,"AlphaFilter",{enumerable:!0,get:function(){return _interopRequireDefault(_AlphaFilter).default}})},{"./alpha/AlphaFilter":247,"./blur/BlurFilter":248,"./blur/BlurXFilter":249,"./blur/BlurYFilter":250,"./colormatrix/ColorMatrixFilter":254,"./displacement/DisplacementFilter":255,"./fxaa/FXAAFilter":256,"./noise/NoiseFilter":258}],258:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_core=require("../../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),NoiseFilter=(require("path"),function(_core$Filter){function NoiseFilter(){var noise=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,seed=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.random();_classCallCheck(this,NoiseFilter);var _this=_possibleConstructorReturn(this,_core$Filter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n"));return _this.noise=noise,_this.seed=seed,_this}return _inherits(NoiseFilter,_core$Filter),_createClass(NoiseFilter,[{key:"noise",get:function(){return this.uniforms.uNoise},set:function(value){this.uniforms.uNoise=value}},{key:"seed",get:function(){return this.uniforms.uSeed},set:function(value){this.uniforms.uSeed=value}}]),NoiseFilter}(core.Filter));exports.default=NoiseFilter},{"../../core":169,path:126}],259:[function(require,module,exports){(function(global){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}exports.__esModule=!0,exports.loader=exports.prepare=exports.particles=exports.mesh=exports.loaders=exports.interaction=exports.filters=exports.extras=exports.extract=exports.accessibility=void 0;var _polyfill=require("./polyfill");Object.keys(_polyfill).forEach(function(key){"default"!==key&&"__esModule"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _polyfill[key]}})});var _core=require("./core");Object.keys(_core).forEach(function(key){"default"!==key&&"__esModule"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _core[key]}})});var _deprecation=require("./deprecation"),_deprecation2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_deprecation),_accessibility=require("./accessibility"),accessibility=_interopRequireWildcard(_accessibility),_extract=require("./extract"),extract=_interopRequireWildcard(_extract),_extras=require("./extras"),extras=_interopRequireWildcard(_extras),_filters=require("./filters"),filters=_interopRequireWildcard(_filters),_interaction=require("./interaction"),interaction=_interopRequireWildcard(_interaction),_loaders=require("./loaders"),loaders=_interopRequireWildcard(_loaders),_mesh=require("./mesh"),mesh=_interopRequireWildcard(_mesh),_particles=require("./particles"),particles=_interopRequireWildcard(_particles),_prepare=require("./prepare"),prepare=_interopRequireWildcard(_prepare);_core.utils.mixins.performMixins();var loader=loaders.shared||null;exports.accessibility=accessibility,exports.extract=extract,exports.extras=extras,exports.filters=filters,exports.interaction=interaction,exports.loaders=loaders,exports.mesh=mesh,exports.particles=particles,exports.prepare=prepare,exports.loader=loader,"function"==typeof _deprecation2.default&&(0,_deprecation2.default)(exports),global.PIXI=exports}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./accessibility":146,"./core":169,"./deprecation":235,"./extract":237,"./extras":245,"./filters":257,"./interaction":264,"./loaders":267,"./mesh":276,"./particles":279,"./polyfill":286,"./prepare":290}],260:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_core=require("../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),InteractionData=function(){function InteractionData(){_classCallCheck(this,InteractionData),this.global=new core.Point,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return InteractionData.prototype.getLocalPosition=function(displayObject,point,globalPos){return displayObject.worldTransform.applyInverse(globalPos||this.global,point)},InteractionData.prototype.copyEvent=function(event){event.isPrimary&&(this.isPrimary=!0),this.button=event.button,this.buttons=Number.isInteger(event.buttons)?event.buttons:event.which,this.width=event.width,this.height=event.height,this.tiltX=event.tiltX,this.tiltY=event.tiltY,this.pointerType=event.pointerType,this.pressure=event.pressure,this.rotationAngle=event.rotationAngle,this.twist=event.twist||0,this.tangentialPressure=event.tangentialPressure||0},InteractionData.prototype.reset=function(){this.isPrimary=!1},_createClass(InteractionData,[{key:"pointerId",get:function(){return this.identifier}}]),InteractionData}();exports.default=InteractionData},{"../core":169}],261:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var InteractionEvent=function(){function InteractionEvent(){_classCallCheck(this,InteractionEvent),this.stopped=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return InteractionEvent.prototype.stopPropagation=function(){this.stopped=!0},InteractionEvent.prototype.reset=function(){this.stopped=!1,this.currentTarget=null,this.target=null},InteractionEvent}();exports.default=InteractionEvent},{}],262:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_core=require("../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),_InteractionData=require("./InteractionData"),_InteractionData2=_interopRequireDefault(_InteractionData),_InteractionEvent=require("./InteractionEvent"),_InteractionEvent2=_interopRequireDefault(_InteractionEvent),_InteractionTrackingData=require("./InteractionTrackingData"),_InteractionTrackingData2=_interopRequireDefault(_InteractionTrackingData),_eventemitter=require("eventemitter3"),_eventemitter2=_interopRequireDefault(_eventemitter),_interactiveTarget=require("./interactiveTarget"),_interactiveTarget2=_interopRequireDefault(_interactiveTarget);core.utils.mixins.delayMixin(core.DisplayObject.prototype,_interactiveTarget2.default);var MOUSE_POINTER_ID=1,hitTestEvent={target:null,data:{global:null}},InteractionManager=function(_EventEmitter){function InteractionManager(renderer,options){_classCallCheck(this,InteractionManager);var _this=_possibleConstructorReturn(this,_EventEmitter.call(this));return options=options||{},_this.renderer=renderer,_this.autoPreventDefault=void 0===options.autoPreventDefault||options.autoPreventDefault,_this.interactionFrequency=options.interactionFrequency||10,_this.mouse=new _InteractionData2.default,_this.mouse.identifier=MOUSE_POINTER_ID,_this.mouse.global.set(-999999),_this.activeInteractionData={},_this.activeInteractionData[MOUSE_POINTER_ID]=_this.mouse,_this.interactionDataPool=[],_this.eventData=new _InteractionEvent2.default,_this.interactionDOMElement=null,_this.moveWhenInside=!1,_this.eventsAdded=!1,_this.mouseOverRenderer=!1,_this.supportsTouchEvents="ontouchstart"in window,_this.supportsPointerEvents=!!window.PointerEvent,_this.onPointerUp=_this.onPointerUp.bind(_this),_this.processPointerUp=_this.processPointerUp.bind(_this),_this.onPointerCancel=_this.onPointerCancel.bind(_this),_this.processPointerCancel=_this.processPointerCancel.bind(_this),_this.onPointerDown=_this.onPointerDown.bind(_this),_this.processPointerDown=_this.processPointerDown.bind(_this),_this.onPointerMove=_this.onPointerMove.bind(_this),_this.processPointerMove=_this.processPointerMove.bind(_this),_this.onPointerOut=_this.onPointerOut.bind(_this),_this.processPointerOverOut=_this.processPointerOverOut.bind(_this),_this.onPointerOver=_this.onPointerOver.bind(_this),_this.cursorStyles={default:"inherit",pointer:"pointer"},_this.currentCursorMode=null,_this.cursor=null,_this._tempPoint=new core.Point,_this.resolution=1,_this.setTargetElement(_this.renderer.view,_this.renderer.resolution),_this}return _inherits(InteractionManager,_EventEmitter),InteractionManager.prototype.hitTest=function(globalPoint,root){return hitTestEvent.target=null,
hitTestEvent.data.global=globalPoint,root||(root=this.renderer._lastObjectRendered),this.processInteractive(hitTestEvent,root,null,!0),hitTestEvent.target},InteractionManager.prototype.setTargetElement=function(element){var resolution=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.removeEvents(),this.interactionDOMElement=element,this.resolution=resolution,this.addEvents()},InteractionManager.prototype.addEvents=function(){this.interactionDOMElement&&(core.ticker.shared.add(this.update,this,core.UPDATE_PRIORITY.INTERACTION),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0)},InteractionManager.prototype.removeEvents=function(){this.interactionDOMElement&&(core.ticker.shared.remove(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1)},InteractionManager.prototype.update=function(deltaTime){if(this._deltaTime+=deltaTime,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.interactionDOMElement)){if(this.didMove)return void(this.didMove=!1);this.cursor=null;for(var k in this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(k)){var interactionData=this.activeInteractionData[k];if(interactionData.originalEvent&&"touch"!==interactionData.pointerType){var interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,interactionData.originalEvent,interactionData);this.processInteractive(interactionEvent,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},InteractionManager.prototype.setCursorMode=function(mode){if(mode=mode||"default",this.currentCursorMode!==mode){this.currentCursorMode=mode;var style=this.cursorStyles[mode];if(style)switch(void 0===style?"undefined":_typeof(style)){case"string":this.interactionDOMElement.style.cursor=style;break;case"function":style(mode);break;case"object":Object.assign(this.interactionDOMElement.style,style)}else"string"!=typeof mode||Object.prototype.hasOwnProperty.call(this.cursorStyles,mode)||(this.interactionDOMElement.style.cursor=mode)}},InteractionManager.prototype.dispatchEvent=function(displayObject,eventString,eventData){eventData.stopped||(eventData.currentTarget=displayObject,eventData.type=eventString,displayObject.emit(eventString,eventData),displayObject[eventString]&&displayObject[eventString](eventData))},InteractionManager.prototype.mapPositionToPoint=function(point,x,y){var rect=void 0;rect=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var resolutionMultiplier=navigator.isCocoonJS?this.resolution:1/this.resolution;point.x=(x-rect.left)*(this.interactionDOMElement.width/rect.width)*resolutionMultiplier,point.y=(y-rect.top)*(this.interactionDOMElement.height/rect.height)*resolutionMultiplier},InteractionManager.prototype.processInteractive=function(interactionEvent,displayObject,func,hitTest,interactive){if(!displayObject||!displayObject.visible)return!1;var point=interactionEvent.data.global;interactive=displayObject.interactive||interactive;var hit=!1,interactiveParent=interactive,hitTestChildren=!0;if(displayObject.hitArea?(hitTest&&(displayObject.worldTransform.applyInverse(point,this._tempPoint),displayObject.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?hit=!0:(hitTest=!1,hitTestChildren=!1)),interactiveParent=!1):displayObject._mask&&hitTest&&(displayObject._mask.containsPoint(point)||(hitTest=!1,hitTestChildren=!1)),hitTestChildren&&displayObject.interactiveChildren&&displayObject.children)for(var children=displayObject.children,i=children.length-1;i>=0;i--){var child=children[i],childHit=this.processInteractive(interactionEvent,child,func,hitTest,interactiveParent);if(childHit){if(!child.parent)continue;interactiveParent=!1,childHit&&(interactionEvent.target&&(hitTest=!1),hit=!0)}}return interactive&&(hitTest&&!interactionEvent.target&&!displayObject.hitArea&&displayObject.containsPoint&&displayObject.containsPoint(point)&&(hit=!0),displayObject.interactive&&(hit&&!interactionEvent.target&&(interactionEvent.target=displayObject),func&&func(interactionEvent,displayObject,!!hit))),hit},InteractionManager.prototype.onPointerDown=function(originalEvent){if(!this.supportsTouchEvents||"touch"!==originalEvent.pointerType){var events=this.normalizeToPointerData(originalEvent);this.autoPreventDefault&&events[0].isNormalized&&originalEvent.preventDefault();for(var eventLen=events.length,i=0;i<eventLen;i++){var event=events[i],interactionData=this.getInteractionDataForPointerId(event),interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);if(interactionEvent.data.originalEvent=originalEvent,this.processInteractive(interactionEvent,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",interactionEvent),"touch"===event.pointerType)this.emit("touchstart",interactionEvent);else if("mouse"===event.pointerType||"pen"===event.pointerType){var isRightButton=2===event.button;this.emit(isRightButton?"rightdown":"mousedown",this.eventData)}}}},InteractionManager.prototype.processPointerDown=function(interactionEvent,displayObject,hit){var data=interactionEvent.data,id=interactionEvent.data.identifier;if(hit)if(displayObject.trackedPointers[id]||(displayObject.trackedPointers[id]=new _InteractionTrackingData2.default(id)),this.dispatchEvent(displayObject,"pointerdown",interactionEvent),"touch"===data.pointerType)this.dispatchEvent(displayObject,"touchstart",interactionEvent);else if("mouse"===data.pointerType||"pen"===data.pointerType){var isRightButton=2===data.button;isRightButton?displayObject.trackedPointers[id].rightDown=!0:displayObject.trackedPointers[id].leftDown=!0,this.dispatchEvent(displayObject,isRightButton?"rightdown":"mousedown",interactionEvent)}},InteractionManager.prototype.onPointerComplete=function(originalEvent,cancelled,func){for(var events=this.normalizeToPointerData(originalEvent),eventLen=events.length,eventAppend=originalEvent.target!==this.interactionDOMElement?"outside":"",i=0;i<eventLen;i++){var event=events[i],interactionData=this.getInteractionDataForPointerId(event),interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);if(interactionEvent.data.originalEvent=originalEvent,this.processInteractive(interactionEvent,this.renderer._lastObjectRendered,func,cancelled||!eventAppend),this.emit(cancelled?"pointercancel":"pointerup"+eventAppend,interactionEvent),"mouse"===event.pointerType||"pen"===event.pointerType){var isRightButton=2===event.button;this.emit(isRightButton?"rightup"+eventAppend:"mouseup"+eventAppend,interactionEvent)}else"touch"===event.pointerType&&(this.emit(cancelled?"touchcancel":"touchend"+eventAppend,interactionEvent),this.releaseInteractionDataForPointerId(event.pointerId,interactionData))}},InteractionManager.prototype.onPointerCancel=function(event){this.supportsTouchEvents&&"touch"===event.pointerType||this.onPointerComplete(event,!0,this.processPointerCancel)},InteractionManager.prototype.processPointerCancel=function(interactionEvent,displayObject){var data=interactionEvent.data,id=interactionEvent.data.identifier;void 0!==displayObject.trackedPointers[id]&&(delete displayObject.trackedPointers[id],this.dispatchEvent(displayObject,"pointercancel",interactionEvent),"touch"===data.pointerType&&this.dispatchEvent(displayObject,"touchcancel",interactionEvent))},InteractionManager.prototype.onPointerUp=function(event){this.supportsTouchEvents&&"touch"===event.pointerType||this.onPointerComplete(event,!1,this.processPointerUp)},InteractionManager.prototype.processPointerUp=function(interactionEvent,displayObject,hit){var data=interactionEvent.data,id=interactionEvent.data.identifier,trackingData=displayObject.trackedPointers[id],isTouch="touch"===data.pointerType,isMouse="mouse"===data.pointerType||"pen"===data.pointerType,isMouseTap=!1;if(isMouse){var isRightButton=2===data.button,flags=_InteractionTrackingData2.default.FLAGS,test=isRightButton?flags.RIGHT_DOWN:flags.LEFT_DOWN,isDown=void 0!==trackingData&&trackingData.flags&test;hit?(this.dispatchEvent(displayObject,isRightButton?"rightup":"mouseup",interactionEvent),isDown&&(this.dispatchEvent(displayObject,isRightButton?"rightclick":"click",interactionEvent),isMouseTap=!0)):isDown&&this.dispatchEvent(displayObject,isRightButton?"rightupoutside":"mouseupoutside",interactionEvent),trackingData&&(isRightButton?trackingData.rightDown=!1:trackingData.leftDown=!1)}hit?(this.dispatchEvent(displayObject,"pointerup",interactionEvent),isTouch&&this.dispatchEvent(displayObject,"touchend",interactionEvent),trackingData&&(isMouse&&!isMouseTap||this.dispatchEvent(displayObject,"pointertap",interactionEvent),isTouch&&(this.dispatchEvent(displayObject,"tap",interactionEvent),trackingData.over=!1))):trackingData&&(this.dispatchEvent(displayObject,"pointerupoutside",interactionEvent),isTouch&&this.dispatchEvent(displayObject,"touchendoutside",interactionEvent)),trackingData&&trackingData.none&&delete displayObject.trackedPointers[id]},InteractionManager.prototype.onPointerMove=function(originalEvent){if(!this.supportsTouchEvents||"touch"!==originalEvent.pointerType){var events=this.normalizeToPointerData(originalEvent);"mouse"!==events[0].pointerType&&"pen"!==events[0].pointerType||(this.didMove=!0,this.cursor=null);for(var eventLen=events.length,i=0;i<eventLen;i++){var event=events[i],interactionData=this.getInteractionDataForPointerId(event),interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);interactionEvent.data.originalEvent=originalEvent;var interactive="touch"!==event.pointerType||this.moveWhenInside;this.processInteractive(interactionEvent,this.renderer._lastObjectRendered,this.processPointerMove,interactive),this.emit("pointermove",interactionEvent),"touch"===event.pointerType&&this.emit("touchmove",interactionEvent),"mouse"!==event.pointerType&&"pen"!==event.pointerType||this.emit("mousemove",interactionEvent)}"mouse"===events[0].pointerType&&this.setCursorMode(this.cursor)}},InteractionManager.prototype.processPointerMove=function(interactionEvent,displayObject,hit){var data=interactionEvent.data,isTouch="touch"===data.pointerType,isMouse="mouse"===data.pointerType||"pen"===data.pointerType;isMouse&&this.processPointerOverOut(interactionEvent,displayObject,hit),this.moveWhenInside&&!hit||(this.dispatchEvent(displayObject,"pointermove",interactionEvent),isTouch&&this.dispatchEvent(displayObject,"touchmove",interactionEvent),isMouse&&this.dispatchEvent(displayObject,"mousemove",interactionEvent))},InteractionManager.prototype.onPointerOut=function(originalEvent){if(!this.supportsTouchEvents||"touch"!==originalEvent.pointerType){var events=this.normalizeToPointerData(originalEvent),event=events[0];"mouse"===event.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var interactionData=this.getInteractionDataForPointerId(event),interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);interactionEvent.data.originalEvent=event,this.processInteractive(interactionEvent,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",interactionEvent),"mouse"===event.pointerType||"pen"===event.pointerType?this.emit("mouseout",interactionEvent):this.releaseInteractionDataForPointerId(interactionData.identifier)}},InteractionManager.prototype.processPointerOverOut=function(interactionEvent,displayObject,hit){var data=interactionEvent.data,id=interactionEvent.data.identifier,isMouse="mouse"===data.pointerType||"pen"===data.pointerType,trackingData=displayObject.trackedPointers[id];hit&&!trackingData&&(trackingData=displayObject.trackedPointers[id]=new _InteractionTrackingData2.default(id)),void 0!==trackingData&&(hit&&this.mouseOverRenderer?(trackingData.over||(trackingData.over=!0,this.dispatchEvent(displayObject,"pointerover",interactionEvent),isMouse&&this.dispatchEvent(displayObject,"mouseover",interactionEvent)),isMouse&&null===this.cursor&&(this.cursor=displayObject.cursor)):trackingData.over&&(trackingData.over=!1,this.dispatchEvent(displayObject,"pointerout",this.eventData),isMouse&&this.dispatchEvent(displayObject,"mouseout",interactionEvent),trackingData.none&&delete displayObject.trackedPointers[id]))},InteractionManager.prototype.onPointerOver=function(originalEvent){var events=this.normalizeToPointerData(originalEvent),event=events[0],interactionData=this.getInteractionDataForPointerId(event),interactionEvent=this.configureInteractionEventForDOMEvent(this.eventData,event,interactionData);interactionEvent.data.originalEvent=event,"mouse"===event.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",interactionEvent),"mouse"!==event.pointerType&&"pen"!==event.pointerType||this.emit("mouseover",interactionEvent)},InteractionManager.prototype.getInteractionDataForPointerId=function(event){var pointerId=event.pointerId,interactionData=void 0;return pointerId===MOUSE_POINTER_ID||"mouse"===event.pointerType?interactionData=this.mouse:this.activeInteractionData[pointerId]?interactionData=this.activeInteractionData[pointerId]:(interactionData=this.interactionDataPool.pop()||new _InteractionData2.default,interactionData.identifier=pointerId,this.activeInteractionData[pointerId]=interactionData),interactionData.copyEvent(event),interactionData},InteractionManager.prototype.releaseInteractionDataForPointerId=function(pointerId){var interactionData=this.activeInteractionData[pointerId];interactionData&&(delete this.activeInteractionData[pointerId],interactionData.reset(),this.interactionDataPool.push(interactionData))},InteractionManager.prototype.configureInteractionEventForDOMEvent=function(interactionEvent,pointerEvent,interactionData){return interactionEvent.data=interactionData,this.mapPositionToPoint(interactionData.global,pointerEvent.clientX,pointerEvent.clientY),navigator.isCocoonJS&&"touch"===pointerEvent.pointerType&&(interactionData.global.x=interactionData.global.x/this.resolution,interactionData.global.y=interactionData.global.y/this.resolution),"touch"===pointerEvent.pointerType&&(pointerEvent.globalX=interactionData.global.x,pointerEvent.globalY=interactionData.global.y),interactionData.originalEvent=pointerEvent,interactionEvent.reset(),interactionEvent},InteractionManager.prototype.normalizeToPointerData=function(event){var normalizedEvents=[];if(this.supportsTouchEvents&&event instanceof TouchEvent)for(var i=0,li=event.changedTouches.length;i<li;i++){var touch=event.changedTouches[i];void 0===touch.button&&(touch.button=event.touches.length?1:0),void 0===touch.buttons&&(touch.buttons=event.touches.length?1:0),void 0===touch.isPrimary&&(touch.isPrimary=1===event.touches.length&&"touchstart"===event.type),void 0===touch.width&&(touch.width=touch.radiusX||1),void 0===touch.height&&(touch.height=touch.radiusY||1),void 0===touch.tiltX&&(touch.tiltX=0),void 0===touch.tiltY&&(touch.tiltY=0),void 0===touch.pointerType&&(touch.pointerType="touch"),void 0===touch.pointerId&&(touch.pointerId=touch.identifier||0),void 0===touch.pressure&&(touch.pressure=touch.force||.5),touch.twist=0,touch.tangentialPressure=0,void 0===touch.layerX&&(touch.layerX=touch.offsetX=touch.clientX),void 0===touch.layerY&&(touch.layerY=touch.offsetY=touch.clientY),touch.isNormalized=!0,normalizedEvents.push(touch)}else!(event instanceof MouseEvent)||this.supportsPointerEvents&&event instanceof window.PointerEvent?normalizedEvents.push(event):(void 0===event.isPrimary&&(event.isPrimary=!0),void 0===event.width&&(event.width=1),void 0===event.height&&(event.height=1),void 0===event.tiltX&&(event.tiltX=0),void 0===event.tiltY&&(event.tiltY=0),void 0===event.pointerType&&(event.pointerType="mouse"),void 0===event.pointerId&&(event.pointerId=MOUSE_POINTER_ID),void 0===event.pressure&&(event.pressure=.5),event.twist=0,event.tangentialPressure=0,event.isNormalized=!0,normalizedEvents.push(event));return normalizedEvents},InteractionManager.prototype.destroy=function(){this.removeEvents(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this._tempPoint=null},InteractionManager}(_eventemitter2.default);exports.default=InteractionManager,core.WebGLRenderer.registerPlugin("interaction",InteractionManager),core.CanvasRenderer.registerPlugin("interaction",InteractionManager)},{"../core":169,"./InteractionData":260,"./InteractionEvent":261,"./InteractionTrackingData":263,"./interactiveTarget":265,eventemitter3:118}],263:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),InteractionTrackingData=function(){function InteractionTrackingData(pointerId){_classCallCheck(this,InteractionTrackingData),this._pointerId=pointerId,this._flags=InteractionTrackingData.FLAGS.NONE}return InteractionTrackingData.prototype._doSet=function(flag,yn){this._flags=yn?this._flags|flag:this._flags&~flag},_createClass(InteractionTrackingData,[{key:"pointerId",get:function(){return this._pointerId}},{key:"flags",get:function(){return this._flags},set:function(flags){this._flags=flags}},{key:"none",get:function(){return this._flags===this.constructor.FLAGS.NONE}},{key:"over",get:function(){return 0!=(this._flags&this.constructor.FLAGS.OVER)},set:function(yn){this._doSet(this.constructor.FLAGS.OVER,yn)}},{key:"rightDown",get:function(){return 0!=(this._flags&this.constructor.FLAGS.RIGHT_DOWN)},set:function(yn){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,yn)}},{key:"leftDown",get:function(){return 0!=(this._flags&this.constructor.FLAGS.LEFT_DOWN)},set:function(yn){this._doSet(this.constructor.FLAGS.LEFT_DOWN,yn)}}]),InteractionTrackingData}();exports.default=InteractionTrackingData,InteractionTrackingData.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4})},{}],264:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.__esModule=!0;var _InteractionData=require("./InteractionData");Object.defineProperty(exports,"InteractionData",{enumerable:!0,get:function(){return _interopRequireDefault(_InteractionData).default}});var _InteractionManager=require("./InteractionManager");Object.defineProperty(exports,"InteractionManager",{enumerable:!0,get:function(){return _interopRequireDefault(_InteractionManager).default}});var _interactiveTarget=require("./interactiveTarget");Object.defineProperty(exports,"interactiveTarget",{enumerable:!0,get:function(){return _interopRequireDefault(_interactiveTarget).default}});var _InteractionTrackingData=require("./InteractionTrackingData");Object.defineProperty(exports,"InteractionTrackingData",{enumerable:!0,get:function(){return _interopRequireDefault(_InteractionTrackingData).default}});var _InteractionEvent=require("./InteractionEvent");Object.defineProperty(exports,"InteractionEvent",{enumerable:!0,get:function(){return _interopRequireDefault(_InteractionEvent).default}})},{"./InteractionData":260,"./InteractionEvent":261,"./InteractionManager":262,"./InteractionTrackingData":263,"./interactiveTarget":265}],265:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(value){value?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0}},{}],266:[function(require,module,exports){"use strict";function parse(resource,textures){resource.bitmapFont=_extras.BitmapText.registerFont(resource.data,textures)}exports.__esModule=!0,exports.parse=parse,exports.default=function(){return function(resource,next){if(!resource.data||resource.type!==_resourceLoader.Resource.TYPE.XML)return void next();if(0===resource.data.getElementsByTagName("page").length||0===resource.data.getElementsByTagName("info").length||null===resource.data.getElementsByTagName("info")[0].getAttribute("face"))return void next();var xmlUrl=resource.isDataUrl?"":path.dirname(resource.url);resource.isDataUrl&&("."===xmlUrl&&(xmlUrl=""),this.baseUrl&&xmlUrl&&"/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(xmlUrl+="/")),(xmlUrl=xmlUrl.replace(this.baseUrl,""))&&"/"!==xmlUrl.charAt(xmlUrl.length-1)&&(xmlUrl+="/");for(var pages=resource.data.getElementsByTagName("page"),textures={},completed=function(page){textures[page.metadata.pageFile]=page.texture,Object.keys(textures).length===pages.length&&(parse(resource,textures),next())},i=0;i<pages.length;++i){var pageFile=pages[i].getAttribute("file"),url=xmlUrl+pageFile,exists=!1;for(var name in this.resources){var bitmapResource=this.resources[name];if(bitmapResource.url===url){bitmapResource.metadata.pageFile=pageFile,bitmapResource.texture?completed(bitmapResource):bitmapResource.onAfterMiddleware.add(completed),exists=!0;break}}if(!exists){var options={crossOrigin:resource.crossOrigin,loadType:_resourceLoader.Resource.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:pageFile},resource.metadata.imageMetadata),parentResource:resource};this.add(url,options,completed)}}}};var _path=require("path"),path=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_path),_resourceLoader=require("resource-loader"),_extras=require("../extras")},{"../extras":245,path:126,"resource-loader":304}],267:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.__esModule=!0,exports.shared=exports.Resource=exports.textureParser=exports.getResourcePath=exports.spritesheetParser=exports.parseBitmapFontData=exports.bitmapFontParser=exports.Loader=void 0;var _bitmapFontParser=require("./bitmapFontParser");Object.defineProperty(exports,"bitmapFontParser",{enumerable:!0,get:function(){return _interopRequireDefault(_bitmapFontParser).default}}),Object.defineProperty(exports,"parseBitmapFontData",{enumerable:!0,get:function(){return _bitmapFontParser.parse}});var _spritesheetParser=require("./spritesheetParser");Object.defineProperty(exports,"spritesheetParser",{enumerable:!0,get:function(){return _interopRequireDefault(_spritesheetParser).default}}),Object.defineProperty(exports,"getResourcePath",{enumerable:!0,get:function(){return _spritesheetParser.getResourcePath}});var _textureParser=require("./textureParser");Object.defineProperty(exports,"textureParser",{enumerable:!0,get:function(){return _interopRequireDefault(_textureParser).default}});var _resourceLoader=require("resource-loader");Object.defineProperty(exports,"Resource",{enumerable:!0,get:function(){return _resourceLoader.Resource}});var _Application=require("../core/Application"),_Application2=_interopRequireDefault(_Application),_loader=require("./loader"),_loader2=_interopRequireDefault(_loader);exports.Loader=_loader2.default;var shared=new _loader2.default;shared.destroy=function(){},exports.shared=shared;var AppPrototype=_Application2.default.prototype;AppPrototype._loader=null,Object.defineProperty(AppPrototype,"loader",{get:function(){if(!this._loader){var sharedLoader=this._options.sharedLoader;this._loader=sharedLoader?shared:new _loader2.default}return this._loader}}),AppPrototype._parentDestroy=AppPrototype.destroy,AppPrototype.destroy=function(removeView,stageOptions){this._loader&&(this._loader.destroy(),this._loader=null),this._parentDestroy(removeView,stageOptions)}},{"../core/Application":147,"./bitmapFontParser":266,"./loader":268,"./spritesheetParser":269,"./textureParser":270,"resource-loader":304}],268:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _resourceLoader=require("resource-loader"),_resourceLoader2=_interopRequireDefault(_resourceLoader),_blob=require("resource-loader/lib/middlewares/parsing/blob"),_eventemitter=require("eventemitter3"),_eventemitter2=_interopRequireDefault(_eventemitter),_textureParser=require("./textureParser"),_textureParser2=_interopRequireDefault(_textureParser),_spritesheetParser=require("./spritesheetParser"),_spritesheetParser2=_interopRequireDefault(_spritesheetParser),_bitmapFontParser=require("./bitmapFontParser"),_bitmapFontParser2=_interopRequireDefault(_bitmapFontParser),Loader=function(_ResourceLoader){function Loader(baseUrl,concurrency){_classCallCheck(this,Loader);var _this=_possibleConstructorReturn(this,_ResourceLoader.call(this,baseUrl,concurrency));_eventemitter2.default.call(_this);for(var i=0;i<Loader._pixiMiddleware.length;++i)_this.use(Loader._pixiMiddleware[i]());return _this.onStart.add(function(l){return _this.emit("start",l)}),_this.onProgress.add(function(l,r){return _this.emit("progress",l,r)}),_this.onError.add(function(e,l,r){return _this.emit("error",e,l,r)}),_this.onLoad.add(function(l,r){return _this.emit("load",l,r)}),_this.onComplete.add(function(l,r){return _this.emit("complete",l,r)}),_this}return _inherits(Loader,_ResourceLoader),Loader.addPixiMiddleware=function(fn){Loader._pixiMiddleware.push(fn)},Loader.prototype.destroy=function(){this.removeAllListeners(),this.reset()},Loader}(_resourceLoader2.default);exports.default=Loader;for(var k in _eventemitter2.default.prototype)Loader.prototype[k]=_eventemitter2.default.prototype[k];Loader._pixiMiddleware=[_blob.blobMiddlewareFactory,_textureParser2.default,_spritesheetParser2.default,_bitmapFontParser2.default];var Resource=_resourceLoader2.default.Resource;Resource.setExtensionXhrType("fnt",Resource.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":266,"./spritesheetParser":269,"./textureParser":270,eventemitter3:118,"resource-loader":304,"resource-loader/lib/middlewares/parsing/blob":305}],269:[function(require,module,exports){"use strict";function getResourcePath(resource,baseUrl){return resource.isDataUrl?resource.data.meta.image:_url2.default.resolve(resource.url.replace(baseUrl,""),resource.data.meta.image)}exports.__esModule=!0,exports.default=function(){return function(resource,next){var imageResourceName=resource.name+"_image";if(!resource.data||resource.type!==_resourceLoader.Resource.TYPE.JSON||!resource.data.frames||this.resources[imageResourceName])return void next();var loadOptions={crossOrigin:resource.crossOrigin,metadata:resource.metadata.imageMetadata,parentResource:resource},resourcePath=getResourcePath(resource,this.baseUrl);this.add(imageResourceName,resourcePath,loadOptions,function(res){if(res.error)return void next(res.error);var spritesheet=new _core.Spritesheet(res.texture.baseTexture,resource.data,resource.url);spritesheet.parse(function(){resource.spritesheet=spritesheet,resource.textures=spritesheet.textures,next()})})}},exports.getResourcePath=getResourcePath;var _resourceLoader=require("resource-loader"),_url=require("url"),_url2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_url),_core=require("../core")},{"../core":169,"resource-loader":304,url:308}],270:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=function(){return function(resource,next){resource.data&&resource.type===_resourceLoader.Resource.TYPE.IMAGE&&(resource.texture=_Texture2.default.fromLoader(resource.data,resource.url,resource.name)),next()}}
;var _resourceLoader=require("resource-loader"),_Texture=require("../core/textures/Texture"),_Texture2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Texture)},{"../core/textures/Texture":219,"resource-loader":304}],271:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_core=require("../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),_Texture=require("../core/textures/Texture"),_Texture2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Texture),tempPoint=new core.Point,tempPolygon=new core.Polygon,Mesh=function(_core$Container){function Mesh(texture,vertices,uvs,indices,drawMode){_classCallCheck(this,Mesh);var _this=_possibleConstructorReturn(this,_core$Container.call(this));return _this._texture=texture||_Texture2.default.EMPTY,_this.uvs=uvs||new Float32Array([0,0,1,0,1,1,0,1]),_this.vertices=vertices||new Float32Array([0,0,100,0,100,100,0,100]),_this.indices=indices||new Uint16Array([0,1,3,2]),_this.dirty=0,_this.indexDirty=0,_this.vertexDirty=0,_this.autoUpdate=!0,_this.blendMode=core.BLEND_MODES.NORMAL,_this.canvasPadding=core.settings.MESH_CANVAS_PADDING,_this.drawMode=drawMode||Mesh.DRAW_MODES.TRIANGLE_MESH,_this.shader=null,_this.tintRgb=new Float32Array([1,1,1]),_this._glDatas={},_this._uvTransform=new core.TextureMatrix(_this._texture),_this.uploadUvTransform=!1,_this.pluginName="mesh",_this}return _inherits(Mesh,_core$Container),Mesh.prototype._renderWebGL=function(renderer){this.refresh(),renderer.setObjectRenderer(renderer.plugins[this.pluginName]),renderer.plugins[this.pluginName].render(this)},Mesh.prototype._renderCanvas=function(renderer){this.refresh(),renderer.plugins[this.pluginName].render(this)},Mesh.prototype._onTextureUpdate=function(){this._uvTransform.texture=this._texture,this.refresh()},Mesh.prototype.multiplyUvs=function(){this.uploadUvTransform||this._uvTransform.multiplyUvs(this.uvs)},Mesh.prototype.refresh=function(forceUpdate){this.autoUpdate&&this.vertexDirty++,this._uvTransform.update(forceUpdate)&&this._refresh()},Mesh.prototype._refresh=function(){},Mesh.prototype._calculateBounds=function(){this._bounds.addVertices(this.transform,this.vertices,0,this.vertices.length)},Mesh.prototype.containsPoint=function(point){if(!this.getBounds().contains(point.x,point.y))return!1;this.worldTransform.applyInverse(point,tempPoint);for(var vertices=this.vertices,points=tempPolygon.points,indices=this.indices,len=this.indices.length,step=this.drawMode===Mesh.DRAW_MODES.TRIANGLES?3:1,i=0;i+2<len;i+=step){var ind0=2*indices[i],ind1=2*indices[i+1],ind2=2*indices[i+2];if(points[0]=vertices[ind0],points[1]=vertices[ind0+1],points[2]=vertices[ind1],points[3]=vertices[ind1+1],points[4]=vertices[ind2],points[5]=vertices[ind2+1],tempPolygon.contains(tempPoint.x,tempPoint.y))return!0}return!1},Mesh.prototype.destroy=function(options){for(var id in this._glDatas){var data=this._glDatas[id];data.destroy?data.destroy():(data.vertexBuffer&&(data.vertexBuffer.destroy(),data.vertexBuffer=null),data.indexBuffer&&(data.indexBuffer.destroy(),data.indexBuffer=null),data.uvBuffer&&(data.uvBuffer.destroy(),data.uvBuffer=null),data.vao&&(data.vao.destroy(),data.vao=null))}this._glDatas=null,_core$Container.prototype.destroy.call(this,options)},_createClass(Mesh,[{key:"texture",get:function(){return this._texture},set:function(value){this._texture!==value&&(this._texture=value,value&&(value.baseTexture.hasLoaded?this._onTextureUpdate():value.once("update",this._onTextureUpdate,this)))}},{key:"tint",get:function(){return core.utils.rgb2hex(this.tintRgb)},set:function(value){this.tintRgb=core.utils.hex2rgb(value,this.tintRgb)}}]),Mesh}(core.Container);exports.default=Mesh,Mesh.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":169,"../core/textures/Texture":219}],272:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Plane2=require("./Plane"),_Plane3=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Plane2),DEFAULT_BORDER_SIZE=10,NineSlicePlane=function(_Plane){function NineSlicePlane(texture,leftWidth,topHeight,rightWidth,bottomHeight){_classCallCheck(this,NineSlicePlane);var _this=_possibleConstructorReturn(this,_Plane.call(this,texture,4,4));return _this._origWidth=texture.orig.width,_this._origHeight=texture.orig.height,_this._width=_this._origWidth,_this._height=_this._origHeight,_this._leftWidth=void 0!==leftWidth?leftWidth:DEFAULT_BORDER_SIZE,_this._rightWidth=void 0!==rightWidth?rightWidth:DEFAULT_BORDER_SIZE,_this._topHeight=void 0!==topHeight?topHeight:DEFAULT_BORDER_SIZE,_this._bottomHeight=void 0!==bottomHeight?bottomHeight:DEFAULT_BORDER_SIZE,_this.refresh(!0),_this}return _inherits(NineSlicePlane,_Plane),NineSlicePlane.prototype.updateHorizontalVertices=function(){var vertices=this.vertices,h=this._topHeight+this._bottomHeight,scale=this._height>h?1:this._height/h;vertices[9]=vertices[11]=vertices[13]=vertices[15]=this._topHeight*scale,vertices[17]=vertices[19]=vertices[21]=vertices[23]=this._height-this._bottomHeight*scale,vertices[25]=vertices[27]=vertices[29]=vertices[31]=this._height},NineSlicePlane.prototype.updateVerticalVertices=function(){var vertices=this.vertices,w=this._leftWidth+this._rightWidth,scale=this._width>w?1:this._width/w;vertices[2]=vertices[10]=vertices[18]=vertices[26]=this._leftWidth*scale,vertices[4]=vertices[12]=vertices[20]=vertices[28]=this._width-this._rightWidth*scale,vertices[6]=vertices[14]=vertices[22]=vertices[30]=this._width},NineSlicePlane.prototype._renderCanvas=function(renderer){var context=renderer.context;context.globalAlpha=this.worldAlpha,renderer.setBlendMode(this.blendMode);var transform=this.worldTransform,res=renderer.resolution;renderer.roundPixels?context.setTransform(transform.a*res,transform.b*res,transform.c*res,transform.d*res,transform.tx*res|0,transform.ty*res|0):context.setTransform(transform.a*res,transform.b*res,transform.c*res,transform.d*res,transform.tx*res,transform.ty*res);var base=this._texture.baseTexture,textureSource=base.source,w=base.width*base.resolution,h=base.height*base.resolution;this.drawSegment(context,textureSource,w,h,0,1,10,11),this.drawSegment(context,textureSource,w,h,2,3,12,13),this.drawSegment(context,textureSource,w,h,4,5,14,15),this.drawSegment(context,textureSource,w,h,8,9,18,19),this.drawSegment(context,textureSource,w,h,10,11,20,21),this.drawSegment(context,textureSource,w,h,12,13,22,23),this.drawSegment(context,textureSource,w,h,16,17,26,27),this.drawSegment(context,textureSource,w,h,18,19,28,29),this.drawSegment(context,textureSource,w,h,20,21,30,31)},NineSlicePlane.prototype.drawSegment=function(context,textureSource,w,h,x1,y1,x2,y2){var uvs=this.uvs,vertices=this.vertices,sw=(uvs[x2]-uvs[x1])*w,sh=(uvs[y2]-uvs[y1])*h,dw=vertices[x2]-vertices[x1],dh=vertices[y2]-vertices[y1];sw<1&&(sw=1),sh<1&&(sh=1),dw<1&&(dw=1),dh<1&&(dh=1),context.drawImage(textureSource,uvs[x1]*w,uvs[y1]*h,sw,sh,vertices[x1],vertices[y1],dw,dh)},NineSlicePlane.prototype._refresh=function(){_Plane.prototype._refresh.call(this);var uvs=this.uvs,texture=this._texture;this._origWidth=texture.orig.width,this._origHeight=texture.orig.height;var _uvw=1/this._origWidth,_uvh=1/this._origHeight;uvs[0]=uvs[8]=uvs[16]=uvs[24]=0,uvs[1]=uvs[3]=uvs[5]=uvs[7]=0,uvs[6]=uvs[14]=uvs[22]=uvs[30]=1,uvs[25]=uvs[27]=uvs[29]=uvs[31]=1,uvs[2]=uvs[10]=uvs[18]=uvs[26]=_uvw*this._leftWidth,uvs[4]=uvs[12]=uvs[20]=uvs[28]=1-_uvw*this._rightWidth,uvs[9]=uvs[11]=uvs[13]=uvs[15]=_uvh*this._topHeight,uvs[17]=uvs[19]=uvs[21]=uvs[23]=1-_uvh*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.dirty++,this.multiplyUvs()},_createClass(NineSlicePlane,[{key:"width",get:function(){return this._width},set:function(value){this._width=value,this._refresh()}},{key:"height",get:function(){return this._height},set:function(value){this._height=value,this._refresh()}},{key:"leftWidth",get:function(){return this._leftWidth},set:function(value){this._leftWidth=value,this._refresh()}},{key:"rightWidth",get:function(){return this._rightWidth},set:function(value){this._rightWidth=value,this._refresh()}},{key:"topHeight",get:function(){return this._topHeight},set:function(value){this._topHeight=value,this._refresh()}},{key:"bottomHeight",get:function(){return this._bottomHeight},set:function(value){this._bottomHeight=value,this._refresh()}}]),NineSlicePlane}(_Plane3.default);exports.default=NineSlicePlane},{"./Plane":273}],273:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _Mesh2=require("./Mesh"),_Mesh3=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Mesh2),Plane=function(_Mesh){function Plane(texture,verticesX,verticesY){_classCallCheck(this,Plane);var _this=_possibleConstructorReturn(this,_Mesh.call(this,texture));return _this._ready=!0,_this.verticesX=verticesX||10,_this.verticesY=verticesY||10,_this.drawMode=_Mesh3.default.DRAW_MODES.TRIANGLES,_this.refresh(),_this}return _inherits(Plane,_Mesh),Plane.prototype._refresh=function(){for(var texture=this._texture,total=this.verticesX*this.verticesY,verts=[],colors=[],uvs=[],indices=[],segmentsX=this.verticesX-1,segmentsY=this.verticesY-1,sizeX=texture.width/segmentsX,sizeY=texture.height/segmentsY,i=0;i<total;i++){var x=i%this.verticesX,y=i/this.verticesX|0;verts.push(x*sizeX,y*sizeY),uvs.push(x/segmentsX,y/segmentsY)}for(var totalSub=segmentsX*segmentsY,_i=0;_i<totalSub;_i++){var xpos=_i%segmentsX,ypos=_i/segmentsX|0,value=ypos*this.verticesX+xpos,value2=ypos*this.verticesX+xpos+1,value3=(ypos+1)*this.verticesX+xpos,value4=(ypos+1)*this.verticesX+xpos+1;indices.push(value,value2,value3),indices.push(value2,value4,value3)}this.vertices=new Float32Array(verts),this.uvs=new Float32Array(uvs),this.colors=new Float32Array(colors),this.indices=new Uint16Array(indices),this.dirty++,this.indexDirty++,this.multiplyUvs()},Plane.prototype._onTextureUpdate=function(){_Mesh3.default.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},Plane}(_Mesh3.default);exports.default=Plane},{"./Mesh":271}],274:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _Mesh2=require("./Mesh"),_Mesh3=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Mesh2),Rope=function(_Mesh){function Rope(texture,points){_classCallCheck(this,Rope);var _this=_possibleConstructorReturn(this,_Mesh.call(this,texture));return _this.points=points,_this.vertices=new Float32Array(4*points.length),_this.uvs=new Float32Array(4*points.length),_this.colors=new Float32Array(2*points.length),_this.indices=new Uint16Array(2*points.length),_this.autoUpdate=!0,_this.refresh(),_this}return _inherits(Rope,_Mesh),Rope.prototype._refresh=function(){var points=this.points;if(!(points.length<1)&&this._texture._uvs){this.vertices.length/4!==points.length&&(this.vertices=new Float32Array(4*points.length),this.uvs=new Float32Array(4*points.length),this.colors=new Float32Array(2*points.length),this.indices=new Uint16Array(2*points.length));var uvs=this.uvs,indices=this.indices,colors=this.colors;uvs[0]=0,uvs[1]=0,uvs[2]=0,uvs[3]=1,colors[0]=1,colors[1]=1,indices[0]=0,indices[1]=1;for(var total=points.length,i=1;i<total;i++){var index=4*i,amount=i/(total-1);uvs[index]=amount,uvs[index+1]=0,uvs[index+2]=amount,uvs[index+3]=1,index=2*i,colors[index]=1,colors[index+1]=1,index=2*i,indices[index]=index,indices[index+1]=index+1}this.dirty++,this.indexDirty++,this.multiplyUvs(),this.refreshVertices()}},Rope.prototype.refreshVertices=function(){var points=this.points;if(!(points.length<1))for(var lastPoint=points[0],nextPoint=void 0,perpX=0,perpY=0,vertices=this.vertices,total=points.length,i=0;i<total;i++){var point=points[i],index=4*i;nextPoint=i<points.length-1?points[i+1]:point,perpY=-(nextPoint.x-lastPoint.x),perpX=nextPoint.y-lastPoint.y;var ratio=10*(1-i/(total-1));ratio>1&&(ratio=1);var perpLength=Math.sqrt(perpX*perpX+perpY*perpY),num=this._texture.height/2;perpX/=perpLength,perpY/=perpLength,perpX*=num,perpY*=num,vertices[index]=point.x+perpX,vertices[index+1]=point.y+perpY,vertices[index+2]=point.x-perpX,vertices[index+3]=point.y-perpY,lastPoint=point}},Rope.prototype.updateTransform=function(){this.autoUpdate&&this.refreshVertices(),this.containerUpdateTransform()},Rope}(_Mesh3.default);exports.default=Rope},{"./Mesh":271}],275:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _core=require("../../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),_Mesh=require("../Mesh"),_Mesh2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Mesh),MeshSpriteRenderer=function(){function MeshSpriteRenderer(renderer){_classCallCheck(this,MeshSpriteRenderer),this.renderer=renderer}return MeshSpriteRenderer.prototype.render=function(mesh){var renderer=this.renderer,context=renderer.context,transform=mesh.worldTransform,res=renderer.resolution;renderer.roundPixels?context.setTransform(transform.a*res,transform.b*res,transform.c*res,transform.d*res,transform.tx*res|0,transform.ty*res|0):context.setTransform(transform.a*res,transform.b*res,transform.c*res,transform.d*res,transform.tx*res,transform.ty*res),renderer.context.globalAlpha=mesh.worldAlpha,renderer.setBlendMode(mesh.blendMode),mesh.drawMode===_Mesh2.default.DRAW_MODES.TRIANGLE_MESH?this._renderTriangleMesh(mesh):this._renderTriangles(mesh)},MeshSpriteRenderer.prototype._renderTriangleMesh=function(mesh){for(var length=mesh.vertices.length/2,i=0;i<length-2;i++){var index=2*i;this._renderDrawTriangle(mesh,index,index+2,index+4)}},MeshSpriteRenderer.prototype._renderTriangles=function(mesh){for(var indices=mesh.indices,length=indices.length,i=0;i<length;i+=3){var index0=2*indices[i],index1=2*indices[i+1],index2=2*indices[i+2];this._renderDrawTriangle(mesh,index0,index1,index2)}},MeshSpriteRenderer.prototype._renderDrawTriangle=function(mesh,index0,index1,index2){var context=this.renderer.context,uvs=mesh.uvs,vertices=mesh.vertices,texture=mesh._texture;if(texture.valid){var base=texture.baseTexture,textureSource=base.source,textureWidth=base.width,textureHeight=base.height,u0=void 0,u1=void 0,u2=void 0,v0=void 0,v1=void 0,v2=void 0;if(mesh.uploadUvTransform){var ut=mesh._uvTransform.mapCoord;u0=(uvs[index0]*ut.a+uvs[index0+1]*ut.c+ut.tx)*base.width,u1=(uvs[index1]*ut.a+uvs[index1+1]*ut.c+ut.tx)*base.width,u2=(uvs[index2]*ut.a+uvs[index2+1]*ut.c+ut.tx)*base.width,v0=(uvs[index0]*ut.b+uvs[index0+1]*ut.d+ut.ty)*base.height,v1=(uvs[index1]*ut.b+uvs[index1+1]*ut.d+ut.ty)*base.height,v2=(uvs[index2]*ut.b+uvs[index2+1]*ut.d+ut.ty)*base.height}else u0=uvs[index0]*base.width,u1=uvs[index1]*base.width,u2=uvs[index2]*base.width,v0=uvs[index0+1]*base.height,v1=uvs[index1+1]*base.height,v2=uvs[index2+1]*base.height;var x0=vertices[index0],x1=vertices[index1],x2=vertices[index2],y0=vertices[index0+1],y1=vertices[index1+1],y2=vertices[index2+1],canvasPadding=mesh.canvasPadding/this.renderer.resolution;if(canvasPadding>0){var paddingX=canvasPadding/Math.abs(mesh.worldTransform.a),paddingY=canvasPadding/Math.abs(mesh.worldTransform.d),centerX=(x0+x1+x2)/3,centerY=(y0+y1+y2)/3,normX=x0-centerX,normY=y0-centerY,dist=Math.sqrt(normX*normX+normY*normY);x0=centerX+normX/dist*(dist+paddingX),y0=centerY+normY/dist*(dist+paddingY),normX=x1-centerX,normY=y1-centerY,dist=Math.sqrt(normX*normX+normY*normY),x1=centerX+normX/dist*(dist+paddingX),y1=centerY+normY/dist*(dist+paddingY),normX=x2-centerX,normY=y2-centerY,dist=Math.sqrt(normX*normX+normY*normY),x2=centerX+normX/dist*(dist+paddingX),y2=centerY+normY/dist*(dist+paddingY)}context.save(),context.beginPath(),context.moveTo(x0,y0),context.lineTo(x1,y1),context.lineTo(x2,y2),context.closePath(),context.clip();var delta=u0*v1+v0*u2+u1*v2-v1*u2-v0*u1-u0*v2,deltaA=x0*v1+v0*x2+x1*v2-v1*x2-v0*x1-x0*v2,deltaB=u0*x1+x0*u2+u1*x2-x1*u2-x0*u1-u0*x2,deltaC=u0*v1*x2+v0*x1*u2+x0*u1*v2-x0*v1*u2-v0*u1*x2-u0*x1*v2,deltaD=y0*v1+v0*y2+y1*v2-v1*y2-v0*y1-y0*v2,deltaE=u0*y1+y0*u2+u1*y2-y1*u2-y0*u1-u0*y2,deltaF=u0*v1*y2+v0*y1*u2+y0*u1*v2-y0*v1*u2-v0*u1*y2-u0*y1*v2;context.transform(deltaA/delta,deltaD/delta,deltaB/delta,deltaE/delta,deltaC/delta,deltaF/delta),context.drawImage(textureSource,0,0,textureWidth*base.resolution,textureHeight*base.resolution,0,0,textureWidth,textureHeight),context.restore(),this.renderer.invalidateBlendMode()}},MeshSpriteRenderer.prototype.renderMeshFlat=function(mesh){var context=this.renderer.context,vertices=mesh.vertices,length=vertices.length/2;context.beginPath();for(var i=1;i<length-2;++i){var index=2*i,x0=vertices[index],y0=vertices[index+1],x1=vertices[index+2],y1=vertices[index+3],x2=vertices[index+4],y2=vertices[index+5];context.moveTo(x0,y0),context.lineTo(x1,y1),context.lineTo(x2,y2)}context.fillStyle="#FF0000",context.fill(),context.closePath()},MeshSpriteRenderer.prototype.destroy=function(){this.renderer=null},MeshSpriteRenderer}();exports.default=MeshSpriteRenderer,core.CanvasRenderer.registerPlugin("mesh",MeshSpriteRenderer)},{"../../core":169,"../Mesh":271}],276:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.__esModule=!0;var _Mesh=require("./Mesh");Object.defineProperty(exports,"Mesh",{enumerable:!0,get:function(){return _interopRequireDefault(_Mesh).default}});var _MeshRenderer=require("./webgl/MeshRenderer");Object.defineProperty(exports,"MeshRenderer",{enumerable:!0,get:function(){return _interopRequireDefault(_MeshRenderer).default}});var _CanvasMeshRenderer=require("./canvas/CanvasMeshRenderer");Object.defineProperty(exports,"CanvasMeshRenderer",{enumerable:!0,get:function(){return _interopRequireDefault(_CanvasMeshRenderer).default}});var _Plane=require("./Plane");Object.defineProperty(exports,"Plane",{enumerable:!0,get:function(){return _interopRequireDefault(_Plane).default}});var _NineSlicePlane=require("./NineSlicePlane");Object.defineProperty(exports,"NineSlicePlane",{enumerable:!0,get:function(){return _interopRequireDefault(_NineSlicePlane).default}});var _Rope=require("./Rope");Object.defineProperty(exports,"Rope",{enumerable:!0,get:function(){return _interopRequireDefault(_Rope).default}})},{"./Mesh":271,"./NineSlicePlane":272,"./Plane":273,"./Rope":274,"./canvas/CanvasMeshRenderer":275,"./webgl/MeshRenderer":277}],277:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _core=require("../../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),_pixiGlCore=require("pixi-gl-core"),_pixiGlCore2=_interopRequireDefault(_pixiGlCore),_Mesh=require("../Mesh"),_Mesh2=_interopRequireDefault(_Mesh),matrixIdentity=(require("path"),core.Matrix.IDENTITY),MeshRenderer=function(_core$ObjectRenderer){function MeshRenderer(renderer){_classCallCheck(this,MeshRenderer);var _this=_possibleConstructorReturn(this,_core$ObjectRenderer.call(this,renderer));return _this.shader=null,_this}return _inherits(MeshRenderer,_core$ObjectRenderer),MeshRenderer.prototype.onContextChange=function(){var gl=this.renderer.gl;this.shader=new core.Shader(gl,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n")},MeshRenderer.prototype.render=function(mesh){var renderer=this.renderer,gl=renderer.gl,texture=mesh._texture;if(texture.valid){var glData=mesh._glDatas[renderer.CONTEXT_UID];glData||(renderer.bindVao(null),glData={shader:this.shader,vertexBuffer:_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl,mesh.vertices,gl.STREAM_DRAW),uvBuffer:_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl,mesh.uvs,gl.STREAM_DRAW),indexBuffer:_pixiGlCore2.default.GLBuffer.createIndexBuffer(gl,mesh.indices,gl.STATIC_DRAW),vao:null,dirty:mesh.dirty,indexDirty:mesh.indexDirty,vertexDirty:mesh.vertexDirty},glData.vao=new _pixiGlCore2.default.VertexArrayObject(gl).addIndex(glData.indexBuffer).addAttribute(glData.vertexBuffer,glData.shader.attributes.aVertexPosition,gl.FLOAT,!1,8,0).addAttribute(glData.uvBuffer,glData.shader.attributes.aTextureCoord,gl.FLOAT,!1,8,0),mesh._glDatas[renderer.CONTEXT_UID]=glData),renderer.bindVao(glData.vao),mesh.dirty!==glData.dirty&&(glData.dirty=mesh.dirty,glData.uvBuffer.upload(mesh.uvs)),mesh.indexDirty!==glData.indexDirty&&(glData.indexDirty=mesh.indexDirty,glData.indexBuffer.upload(mesh.indices)),mesh.vertexDirty!==glData.vertexDirty&&(glData.vertexDirty=mesh.vertexDirty,glData.vertexBuffer.upload(mesh.vertices)),renderer.bindShader(glData.shader),glData.shader.uniforms.uSampler=renderer.bindTexture(texture),renderer.state.setBlendMode(core.utils.correctBlendMode(mesh.blendMode,texture.baseTexture.premultipliedAlpha)),glData.shader.uniforms.uTransform&&(mesh.uploadUvTransform?glData.shader.uniforms.uTransform=mesh._uvTransform.mapCoord.toArray(!0):glData.shader.uniforms.uTransform=matrixIdentity.toArray(!0)),glData.shader.uniforms.translationMatrix=mesh.worldTransform.toArray(!0),glData.shader.uniforms.uColor=core.utils.premultiplyRgba(mesh.tintRgb,mesh.worldAlpha,glData.shader.uniforms.uColor,texture.baseTexture.premultipliedAlpha);var drawMode=mesh.drawMode===_Mesh2.default.DRAW_MODES.TRIANGLE_MESH?gl.TRIANGLE_STRIP:gl.TRIANGLES;glData.vao.draw(drawMode,mesh.indices.length,0)}},MeshRenderer}(core.ObjectRenderer);exports.default=MeshRenderer,core.WebGLRenderer.registerPlugin("mesh",MeshRenderer)},{"../../core":169,"../Mesh":271,path:126,"pixi-gl-core":133}],278:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_core=require("../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),_utils=require("../core/utils"),ParticleContainer=function(_core$Container){function ParticleContainer(){var maxSize=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1500,properties=arguments[1],batchSize=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16384,autoResize=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,ParticleContainer);var _this=_possibleConstructorReturn(this,_core$Container.call(this));return batchSize>16384&&(batchSize=16384),batchSize>maxSize&&(batchSize=maxSize),_this._properties=[!1,!0,!1,!1,!1],_this._maxSize=maxSize,_this._batchSize=batchSize,_this._glBuffers={},_this._bufferUpdateIDs=[],_this._updateID=0,_this.interactiveChildren=!1,_this.blendMode=core.BLEND_MODES.NORMAL,_this.autoResize=autoResize,_this.roundPixels=!0,_this.baseTexture=null,_this.setProperties(properties),_this._tint=0,_this.tintRgb=new Float32Array(4),_this.tint=16777215,_this}return _inherits(ParticleContainer,_core$Container),ParticleContainer.prototype.setProperties=function(properties){properties&&(this._properties[0]="vertices"in properties||"scale"in properties?!!properties.vertices||!!properties.scale:this._properties[0],this._properties[1]="position"in properties?!!properties.position:this._properties[1],this._properties[2]="rotation"in properties?!!properties.rotation:this._properties[2],this._properties[3]="uvs"in properties?!!properties.uvs:this._properties[3],this._properties[4]="tint"in properties||"alpha"in properties?!!properties.tint||!!properties.alpha:this._properties[4])},ParticleContainer.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},ParticleContainer.prototype.renderWebGL=function(renderer){var _this2=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.hasLoaded||this.baseTexture.once("update",function(){return _this2.onChildrenChange(0)})),renderer.setObjectRenderer(renderer.plugins.particle),renderer.plugins.particle.render(this))},ParticleContainer.prototype.onChildrenChange=function(smallestChildIndex){for(var bufferIndex=Math.floor(smallestChildIndex/this._batchSize);this._bufferUpdateIDs.length<bufferIndex;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[bufferIndex]=++this._updateID},ParticleContainer.prototype.renderCanvas=function(renderer){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var context=renderer.context,transform=this.worldTransform,isRotated=!0,positionX=0,positionY=0,finalWidth=0,finalHeight=0;renderer.setBlendMode(this.blendMode),context.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var i=0;i<this.children.length;++i){var child=this.children[i];if(child.visible){var frame=child._texture.frame;if(context.globalAlpha=this.worldAlpha*child.alpha,
child.rotation%(2*Math.PI)==0)isRotated&&(context.setTransform(transform.a,transform.b,transform.c,transform.d,transform.tx*renderer.resolution,transform.ty*renderer.resolution),isRotated=!1),positionX=child.anchor.x*(-frame.width*child.scale.x)+child.position.x+.5,positionY=child.anchor.y*(-frame.height*child.scale.y)+child.position.y+.5,finalWidth=frame.width*child.scale.x,finalHeight=frame.height*child.scale.y;else{isRotated||(isRotated=!0),child.displayObjectUpdateTransform();var childTransform=child.worldTransform;renderer.roundPixels?context.setTransform(childTransform.a,childTransform.b,childTransform.c,childTransform.d,childTransform.tx*renderer.resolution|0,childTransform.ty*renderer.resolution|0):context.setTransform(childTransform.a,childTransform.b,childTransform.c,childTransform.d,childTransform.tx*renderer.resolution,childTransform.ty*renderer.resolution),positionX=child.anchor.x*-frame.width+.5,positionY=child.anchor.y*-frame.height+.5,finalWidth=frame.width,finalHeight=frame.height}var resolution=child._texture.baseTexture.resolution;context.drawImage(child._texture.baseTexture.source,frame.x*resolution,frame.y*resolution,frame.width*resolution,frame.height*resolution,positionX*renderer.resolution,positionY*renderer.resolution,finalWidth*renderer.resolution,finalHeight*renderer.resolution)}}}},ParticleContainer.prototype.destroy=function(options){if(_core$Container.prototype.destroy.call(this,options),this._buffers)for(var i=0;i<this._buffers.length;++i)this._buffers[i].destroy();this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},_createClass(ParticleContainer,[{key:"tint",get:function(){return this._tint},set:function(value){this._tint=value,(0,_utils.hex2rgb)(value,this.tintRgb)}}]),ParticleContainer}(core.Container);exports.default=ParticleContainer},{"../core":169,"../core/utils":229}],279:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.__esModule=!0;var _ParticleContainer=require("./ParticleContainer");Object.defineProperty(exports,"ParticleContainer",{enumerable:!0,get:function(){return _interopRequireDefault(_ParticleContainer).default}});var _ParticleRenderer=require("./webgl/ParticleRenderer");Object.defineProperty(exports,"ParticleRenderer",{enumerable:!0,get:function(){return _interopRequireDefault(_ParticleRenderer).default}})},{"./ParticleContainer":278,"./webgl/ParticleRenderer":281}],280:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _pixiGlCore=require("pixi-gl-core"),_pixiGlCore2=_interopRequireDefault(_pixiGlCore),_createIndicesForQuads=require("../../core/utils/createIndicesForQuads"),_createIndicesForQuads2=_interopRequireDefault(_createIndicesForQuads),ParticleBuffer=function(){function ParticleBuffer(gl,properties,dynamicPropertyFlags,size){_classCallCheck(this,ParticleBuffer),this.gl=gl,this.size=size,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<properties.length;++i){var property=properties[i];property={attribute:property.attribute,size:property.size,uploadFunction:property.uploadFunction,unsignedByte:property.unsignedByte,offset:property.offset},dynamicPropertyFlags[i]?this.dynamicProperties.push(property):this.staticProperties.push(property)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return ParticleBuffer.prototype.initBuffers=function(){var gl=this.gl,dynamicOffset=0;this.indices=(0,_createIndicesForQuads2.default)(this.size),this.indexBuffer=_pixiGlCore2.default.GLBuffer.createIndexBuffer(gl,this.indices,gl.STATIC_DRAW),this.dynamicStride=0;for(var i=0;i<this.dynamicProperties.length;++i){var property=this.dynamicProperties[i];property.offset=dynamicOffset,dynamicOffset+=property.size,this.dynamicStride+=property.size}var dynBuffer=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(dynBuffer),this.dynamicDataUint32=new Uint32Array(dynBuffer),this.dynamicBuffer=_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl,dynBuffer,gl.STREAM_DRAW);var staticOffset=0;this.staticStride=0;for(var _i=0;_i<this.staticProperties.length;++_i){var _property=this.staticProperties[_i];_property.offset=staticOffset,staticOffset+=_property.size,this.staticStride+=_property.size}var statBuffer=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(statBuffer),this.staticDataUint32=new Uint32Array(statBuffer),this.staticBuffer=_pixiGlCore2.default.GLBuffer.createVertexBuffer(gl,statBuffer,gl.STATIC_DRAW),this.vao=new _pixiGlCore2.default.VertexArrayObject(gl).addIndex(this.indexBuffer);for(var _i2=0;_i2<this.dynamicProperties.length;++_i2){var _property2=this.dynamicProperties[_i2];_property2.unsignedByte?this.vao.addAttribute(this.dynamicBuffer,_property2.attribute,gl.UNSIGNED_BYTE,!0,4*this.dynamicStride,4*_property2.offset):this.vao.addAttribute(this.dynamicBuffer,_property2.attribute,gl.FLOAT,!1,4*this.dynamicStride,4*_property2.offset)}for(var _i3=0;_i3<this.staticProperties.length;++_i3){var _property3=this.staticProperties[_i3];_property3.unsignedByte?this.vao.addAttribute(this.staticBuffer,_property3.attribute,gl.UNSIGNED_BYTE,!0,4*this.staticStride,4*_property3.offset):this.vao.addAttribute(this.staticBuffer,_property3.attribute,gl.FLOAT,!1,4*this.staticStride,4*_property3.offset)}},ParticleBuffer.prototype.uploadDynamic=function(children,startIndex,amount){for(var i=0;i<this.dynamicProperties.length;i++){var property=this.dynamicProperties[i];property.uploadFunction(children,startIndex,amount,property.unsignedByte?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,property.offset)}this.dynamicBuffer.upload()},ParticleBuffer.prototype.uploadStatic=function(children,startIndex,amount){for(var i=0;i<this.staticProperties.length;i++){var property=this.staticProperties[i];property.uploadFunction(children,startIndex,amount,property.unsignedByte?this.staticDataUint32:this.staticData,this.staticStride,property.offset)}this.staticBuffer.upload()},ParticleBuffer.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicBuffer.destroy(),this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer.destroy(),this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null},ParticleBuffer}();exports.default=ParticleBuffer},{"../../core/utils/createIndicesForQuads":227,"pixi-gl-core":133}],281:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _core=require("../../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),_ParticleShader=require("./ParticleShader"),_ParticleShader2=_interopRequireDefault(_ParticleShader),_ParticleBuffer=require("./ParticleBuffer"),_ParticleBuffer2=_interopRequireDefault(_ParticleBuffer),_utils=require("../../core/utils"),ParticleRenderer=function(_core$ObjectRenderer){function ParticleRenderer(renderer){_classCallCheck(this,ParticleRenderer);var _this=_possibleConstructorReturn(this,_core$ObjectRenderer.call(this,renderer));return _this.shader=null,_this.indexBuffer=null,_this.properties=null,_this.tempMatrix=new core.Matrix,_this.CONTEXT_UID=0,_this}return _inherits(ParticleRenderer,_core$ObjectRenderer),ParticleRenderer.prototype.onContextChange=function(){var gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.shader=new _ParticleShader2.default(gl),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,unsignedByte:!0,uploadFunction:this.uploadTint,offset:0}]},ParticleRenderer.prototype.start=function(){this.renderer.bindShader(this.shader)},ParticleRenderer.prototype.render=function(container){var children=container.children,maxSize=container._maxSize,batchSize=container._batchSize,renderer=this.renderer,totalChildren=children.length;if(0!==totalChildren){totalChildren>maxSize&&(totalChildren=maxSize);var buffers=container._glBuffers[renderer.CONTEXT_UID];buffers||(buffers=container._glBuffers[renderer.CONTEXT_UID]=this.generateBuffers(container));var baseTexture=children[0]._texture.baseTexture;this.renderer.setBlendMode(core.utils.correctBlendMode(container.blendMode,baseTexture.premultipliedAlpha));var gl=renderer.gl,m=container.worldTransform.copy(this.tempMatrix);m.prepend(renderer._activeRenderTarget.projectionMatrix),this.shader.uniforms.projectionMatrix=m.toArray(!0),this.shader.uniforms.uColor=core.utils.premultiplyRgba(container.tintRgb,container.worldAlpha,this.shader.uniforms.uColor,baseTexture.premultipliedAlpha),this.shader.uniforms.uSampler=renderer.bindTexture(baseTexture);for(var updateStatic=!1,i=0,j=0;i<totalChildren;i+=batchSize,j+=1){var amount=totalChildren-i;if(amount>batchSize&&(amount=batchSize),j>=buffers.length){if(!container.autoResize)break;buffers.push(this._generateOneMoreBuffer(container))}var buffer=buffers[j];buffer.uploadDynamic(children,i,amount);var bid=container._bufferUpdateIDs[j]||0;updateStatic=updateStatic||buffer._updateID<bid,updateStatic&&(buffer._updateID=container._updateID,buffer.uploadStatic(children,i,amount)),renderer.bindVao(buffer.vao),buffer.vao.draw(gl.TRIANGLES,6*amount)}}},ParticleRenderer.prototype.generateBuffers=function(container){for(var gl=this.renderer.gl,buffers=[],size=container._maxSize,batchSize=container._batchSize,dynamicPropertyFlags=container._properties,i=0;i<size;i+=batchSize)buffers.push(new _ParticleBuffer2.default(gl,this.properties,dynamicPropertyFlags,batchSize));return buffers},ParticleRenderer.prototype._generateOneMoreBuffer=function(container){var gl=this.renderer.gl,batchSize=container._batchSize,dynamicPropertyFlags=container._properties;return new _ParticleBuffer2.default(gl,this.properties,dynamicPropertyFlags,batchSize)},ParticleRenderer.prototype.uploadVertices=function(children,startIndex,amount,array,stride,offset){for(var w0=0,w1=0,h0=0,h1=0,i=0;i<amount;++i){var sprite=children[startIndex+i],texture=sprite._texture,sx=sprite.scale.x,sy=sprite.scale.y,trim=texture.trim,orig=texture.orig;trim?(w1=trim.x-sprite.anchor.x*orig.width,w0=w1+trim.width,h1=trim.y-sprite.anchor.y*orig.height,h0=h1+trim.height):(w0=orig.width*(1-sprite.anchor.x),w1=orig.width*-sprite.anchor.x,h0=orig.height*(1-sprite.anchor.y),h1=orig.height*-sprite.anchor.y),array[offset]=w1*sx,array[offset+1]=h1*sy,array[offset+stride]=w0*sx,array[offset+stride+1]=h1*sy,array[offset+2*stride]=w0*sx,array[offset+2*stride+1]=h0*sy,array[offset+3*stride]=w1*sx,array[offset+3*stride+1]=h0*sy,offset+=4*stride}},ParticleRenderer.prototype.uploadPosition=function(children,startIndex,amount,array,stride,offset){for(var i=0;i<amount;i++){var spritePosition=children[startIndex+i].position;array[offset]=spritePosition.x,array[offset+1]=spritePosition.y,array[offset+stride]=spritePosition.x,array[offset+stride+1]=spritePosition.y,array[offset+2*stride]=spritePosition.x,array[offset+2*stride+1]=spritePosition.y,array[offset+3*stride]=spritePosition.x,array[offset+3*stride+1]=spritePosition.y,offset+=4*stride}},ParticleRenderer.prototype.uploadRotation=function(children,startIndex,amount,array,stride,offset){for(var i=0;i<amount;i++){var spriteRotation=children[startIndex+i].rotation;array[offset]=spriteRotation,array[offset+stride]=spriteRotation,array[offset+2*stride]=spriteRotation,array[offset+3*stride]=spriteRotation,offset+=4*stride}},ParticleRenderer.prototype.uploadUvs=function(children,startIndex,amount,array,stride,offset){for(var i=0;i<amount;++i){var textureUvs=children[startIndex+i]._texture._uvs;textureUvs?(array[offset]=textureUvs.x0,array[offset+1]=textureUvs.y0,array[offset+stride]=textureUvs.x1,array[offset+stride+1]=textureUvs.y1,array[offset+2*stride]=textureUvs.x2,array[offset+2*stride+1]=textureUvs.y2,array[offset+3*stride]=textureUvs.x3,array[offset+3*stride+1]=textureUvs.y3,offset+=4*stride):(array[offset]=0,array[offset+1]=0,array[offset+stride]=0,array[offset+stride+1]=0,array[offset+2*stride]=0,array[offset+2*stride+1]=0,array[offset+3*stride]=0,array[offset+3*stride+1]=0,offset+=4*stride)}},ParticleRenderer.prototype.uploadTint=function(children,startIndex,amount,array,stride,offset){for(var i=0;i<amount;++i){var sprite=children[startIndex+i],premultiplied=sprite._texture.baseTexture.premultipliedAlpha,alpha=sprite.alpha,argb=alpha<1&&premultiplied?(0,_utils.premultiplyTint)(sprite._tintRGB,alpha):sprite._tintRGB+(255*alpha<<24);array[offset]=argb,array[offset+stride]=argb,array[offset+2*stride]=argb,array[offset+3*stride]=argb,offset+=4*stride}},ParticleRenderer.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),_core$ObjectRenderer.prototype.destroy.call(this),this.shader.destroy(),this.indices=null,this.tempMatrix=null},ParticleRenderer}(core.ObjectRenderer);exports.default=ParticleRenderer,core.WebGLRenderer.registerPlugin("particle",ParticleRenderer)},{"../../core":169,"../../core/utils":229,"./ParticleBuffer":280,"./ParticleShader":282}],282:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}exports.__esModule=!0;var _Shader2=require("../../core/Shader"),_Shader3=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_Shader2),ParticleShader=function(_Shader){function ParticleShader(gl){return _classCallCheck(this,ParticleShader),_possibleConstructorReturn(this,_Shader.call(this,gl,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","attribute vec2 aPositionCoord;","attribute float aRotation;","uniform mat3 projectionMatrix;","uniform vec4 uColor;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   vec2 v = vec2(x, y);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor * uColor;","}"].join("\n"),["varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor;","  gl_FragColor = color;","}"].join("\n")))}return _inherits(ParticleShader,_Shader),ParticleShader}(_Shader3.default);exports.default=ParticleShader},{"../../core/Shader":148}],283:[function(require,module,exports){"use strict";Math.sign||(Math.sign=function(x){return x=Number(x),0===x||isNaN(x)?x:x>0?1:-1})},{}],284:[function(require,module,exports){"use strict";Number.isInteger||(Number.isInteger=function(value){return"number"==typeof value&&isFinite(value)&&Math.floor(value)===value})},{}],285:[function(require,module,exports){"use strict";var _objectAssign=require("object-assign"),_objectAssign2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_objectAssign);Object.assign||(Object.assign=_objectAssign2.default)},{"object-assign":124}],286:[function(require,module,exports){"use strict";require("./Object.assign"),require("./requestAnimationFrame"),require("./Math.sign"),require("./Number.isInteger"),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array)},{"./Math.sign":283,"./Number.isInteger":284,"./Object.assign":285,"./requestAnimationFrame":287}],287:[function(require,module,exports){(function(global){"use strict";if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!global.performance||!global.performance.now){var startTime=Date.now();global.performance||(global.performance={}),global.performance.now=function(){return Date.now()-startTime}}for(var lastTime=Date.now(),vendors=["ms","moz","webkit","o"],x=0;x<vendors.length&&!global.requestAnimationFrame;++x){var p=vendors[x];global.requestAnimationFrame=global[p+"RequestAnimationFrame"],global.cancelAnimationFrame=global[p+"CancelAnimationFrame"]||global[p+"CancelRequestAnimationFrame"]}global.requestAnimationFrame||(global.requestAnimationFrame=function(callback){if("function"!=typeof callback)throw new TypeError(callback+"is not a function");var currentTime=Date.now(),delay=16+lastTime-currentTime;return delay<0&&(delay=0),lastTime=currentTime,setTimeout(function(){lastTime=Date.now(),callback(performance.now())},delay)}),global.cancelAnimationFrame||(global.cancelAnimationFrame=function(id){return clearTimeout(id)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],288:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function findMultipleBaseTextures(item,queue){var result=!1;if(item&&item._textures&&item._textures.length)for(var i=0;i<item._textures.length;i++)if(item._textures[i]instanceof core.Texture){var baseTexture=item._textures[i].baseTexture;-1===queue.indexOf(baseTexture)&&(queue.push(baseTexture),result=!0)}return result}function findBaseTexture(item,queue){return item instanceof core.BaseTexture&&(-1===queue.indexOf(item)&&queue.push(item),!0)}function findTexture(item,queue){if(item._texture&&item._texture instanceof core.Texture){var texture=item._texture.baseTexture;return-1===queue.indexOf(texture)&&queue.push(texture),!0}return!1}function drawText(helper,item){return item instanceof core.Text&&(item.updateText(!0),!0)}function calculateTextStyle(helper,item){if(item instanceof core.TextStyle){var font=item.toFontString();return core.TextMetrics.measureFont(font),!0}return!1}function findText(item,queue){if(item instanceof core.Text){-1===queue.indexOf(item.style)&&queue.push(item.style),-1===queue.indexOf(item)&&queue.push(item);var texture=item._texture.baseTexture;return-1===queue.indexOf(texture)&&queue.push(texture),!0}return!1}function findTextStyle(item,queue){return item instanceof core.TextStyle&&(-1===queue.indexOf(item)&&queue.push(item),!0)}exports.__esModule=!0;var _core=require("../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),_CountLimiter=require("./limiters/CountLimiter"),_CountLimiter2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_CountLimiter),SharedTicker=core.ticker.shared;core.settings.UPLOADS_PER_FRAME=4;var BasePrepare=function(){function BasePrepare(renderer){var _this=this;_classCallCheck(this,BasePrepare),this.limiter=new _CountLimiter2.default(core.settings.UPLOADS_PER_FRAME),this.renderer=renderer,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){_this.queue&&_this.prepareItems()},this.registerFindHook(findText),this.registerFindHook(findTextStyle),this.registerFindHook(findMultipleBaseTextures),this.registerFindHook(findBaseTexture),this.registerFindHook(findTexture),this.registerUploadHook(drawText),this.registerUploadHook(calculateTextStyle)}return BasePrepare.prototype.upload=function(item,done){"function"==typeof item&&(done=item,item=null),item&&this.add(item),this.queue.length?(done&&this.completes.push(done),this.ticking||(this.ticking=!0,SharedTicker.addOnce(this.tick,this,core.UPDATE_PRIORITY.UTILITY))):done&&done()},BasePrepare.prototype.tick=function(){setTimeout(this.delayedTick,0)},BasePrepare.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var item=this.queue[0],uploaded=!1;if(item&&!item._destroyed)for(var i=0,len=this.uploadHooks.length;i<len;i++)if(this.uploadHooks[i](this.uploadHookHelper,item)){this.queue.shift(),uploaded=!0;break}uploaded||this.queue.shift()}if(this.queue.length)SharedTicker.addOnce(this.tick,this,core.UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;var completes=this.completes.slice(0);this.completes.length=0;for(var _i=0,_len=completes.length;_i<_len;_i++)completes[_i]()}},BasePrepare.prototype.registerFindHook=function(addHook){return addHook&&this.addHooks.push(addHook),this},BasePrepare.prototype.registerUploadHook=function(uploadHook){return uploadHook&&this.uploadHooks.push(uploadHook),this},BasePrepare.prototype.add=function(item){for(var i=0,len=this.addHooks.length;i<len&&!this.addHooks[i](item,this.queue);i++);if(item instanceof core.Container)for(var _i2=item.children.length-1;_i2>=0;_i2--)this.add(item.children[_i2]);return this},BasePrepare.prototype.destroy=function(){this.ticking&&SharedTicker.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},BasePrepare}();exports.default=BasePrepare},{"../core":169,"./limiters/CountLimiter":291}],289:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function uploadBaseTextures(prepare,item){if(item instanceof core.BaseTexture){var image=item.source,imageWidth=0===image.width?prepare.canvas.width:Math.min(prepare.canvas.width,image.width),imageHeight=0===image.height?prepare.canvas.height:Math.min(prepare.canvas.height,image.height);return prepare.ctx.drawImage(image,0,0,imageWidth,imageHeight,0,0,prepare.canvas.width,prepare.canvas.height),!0}return!1}exports.__esModule=!0;var _core=require("../../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),_BasePrepare2=require("../BasePrepare"),_BasePrepare3=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_BasePrepare2),CANVAS_START_SIZE=16,CanvasPrepare=function(_BasePrepare){function CanvasPrepare(renderer){_classCallCheck(this,CanvasPrepare);var _this=_possibleConstructorReturn(this,_BasePrepare.call(this,renderer));return _this.uploadHookHelper=_this,_this.canvas=document.createElement("canvas"),_this.canvas.width=CANVAS_START_SIZE,_this.canvas.height=CANVAS_START_SIZE,_this.ctx=_this.canvas.getContext("2d"),_this.registerUploadHook(uploadBaseTextures),_this}return _inherits(CanvasPrepare,_BasePrepare),CanvasPrepare.prototype.destroy=function(){_BasePrepare.prototype.destroy.call(this),this.ctx=null,this.canvas=null},CanvasPrepare}(_BasePrepare3.default);exports.default=CanvasPrepare,core.CanvasRenderer.registerPlugin("prepare",CanvasPrepare)},{"../../core":169,"../BasePrepare":288}],290:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.__esModule=!0;var _WebGLPrepare=require("./webgl/WebGLPrepare");Object.defineProperty(exports,"webgl",{enumerable:!0,get:function(){return _interopRequireDefault(_WebGLPrepare).default}});var _CanvasPrepare=require("./canvas/CanvasPrepare");Object.defineProperty(exports,"canvas",{enumerable:!0,get:function(){return _interopRequireDefault(_CanvasPrepare).default}});var _BasePrepare=require("./BasePrepare");Object.defineProperty(exports,"BasePrepare",{enumerable:!0,get:function(){return _interopRequireDefault(_BasePrepare).default}});var _CountLimiter=require("./limiters/CountLimiter");Object.defineProperty(exports,"CountLimiter",{enumerable:!0,get:function(){return _interopRequireDefault(_CountLimiter).default}});var _TimeLimiter=require("./limiters/TimeLimiter");Object.defineProperty(exports,"TimeLimiter",{enumerable:!0,get:function(){return _interopRequireDefault(_TimeLimiter).default}})},{"./BasePrepare":288,"./canvas/CanvasPrepare":289,"./limiters/CountLimiter":291,"./limiters/TimeLimiter":292,"./webgl/WebGLPrepare":293}],291:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var CountLimiter=function(){function CountLimiter(maxItemsPerFrame){_classCallCheck(this,CountLimiter),this.maxItemsPerFrame=maxItemsPerFrame,this.itemsLeft=0}return CountLimiter.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},CountLimiter.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},CountLimiter}();exports.default=CountLimiter},{}],292:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var TimeLimiter=function(){function TimeLimiter(maxMilliseconds){_classCallCheck(this,TimeLimiter),this.maxMilliseconds=maxMilliseconds,this.frameStart=0}return TimeLimiter.prototype.beginFrame=function(){this.frameStart=Date.now()},TimeLimiter.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},TimeLimiter}();exports.default=TimeLimiter},{}],293:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function uploadBaseTextures(renderer,item){return item instanceof core.BaseTexture&&(item._glTextures[renderer.CONTEXT_UID]||renderer.textureManager.updateTexture(item),!0)}function uploadGraphics(renderer,item){return item instanceof core.Graphics&&((item.dirty||item.clearDirty||!item._webGL[renderer.plugins.graphics.CONTEXT_UID])&&renderer.plugins.graphics.updateGraphics(item),!0)}function findGraphics(item,queue){return item instanceof core.Graphics&&(queue.push(item),!0)}exports.__esModule=!0;var _core=require("../../core"),core=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_core),_BasePrepare2=require("../BasePrepare"),_BasePrepare3=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_BasePrepare2),WebGLPrepare=function(_BasePrepare){function WebGLPrepare(renderer){_classCallCheck(this,WebGLPrepare);var _this=_possibleConstructorReturn(this,_BasePrepare.call(this,renderer));return _this.uploadHookHelper=_this.renderer,_this.registerFindHook(findGraphics),_this.registerUploadHook(uploadBaseTextures),_this.registerUploadHook(uploadGraphics),_this}return _inherits(WebGLPrepare,_BasePrepare),WebGLPrepare}(_BasePrepare3.default);exports.default=WebGLPrepare,core.WebGLRenderer.registerPlugin("prepare",WebGLPrepare)},{"../../core":169,"../BasePrepare":288}],294:[function(require,module,exports){function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,runClearTimeout(timeout)}}function Item(fun,array){this.fun=fun,
this.array=array}function noop(){}var cachedSetTimeout,cachedClearTimeout,process=module.exports={};!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],295:[function(require,module,exports){(function(global){!function(root){function error(type){throw new RangeError(errors[type])}function map(array,fn){for(var length=array.length,result=[];length--;)result[length]=fn(array[length]);return result}function mapDomain(string,fn){var parts=string.split("@"),result="";return parts.length>1&&(result=parts[0]+"@",string=parts[1]),string=string.replace(regexSeparators,"."),result+map(string.split("."),fn).join(".")}function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;counter<length;)value=string.charCodeAt(counter++),value>=55296&&value<=56319&&counter<length?(extra=string.charCodeAt(counter++),56320==(64512&extra)?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--)):output.push(value);return output}function ucs2encode(array){return map(array,function(value){var output="";return value>65535&&(value-=65536,output+=stringFromCharCode(value>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value)}).join("")}function basicToDigit(codePoint){return codePoint-48<10?codePoint-22:codePoint-65<26?codePoint-65:codePoint-97<26?codePoint-97:base}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((0!=flag)<<5)}function adapt(delta,numPoints,firstTime){var k=0;for(delta=firstTime?floor(delta/damp):delta>>1,delta+=floor(delta/numPoints);delta>baseMinusTMin*tMax>>1;k+=base)delta=floor(delta/baseMinusTMin);return floor(k+(baseMinusTMin+1)*delta/(delta+skew))}function decode(input){var out,basic,j,index,oldi,w,k,digit,t,baseMinusT,output=[],inputLength=input.length,i=0,n=initialN,bias=initialBias;for(basic=input.lastIndexOf(delimiter),basic<0&&(basic=0),j=0;j<basic;++j)input.charCodeAt(j)>=128&&error("not-basic"),output.push(input.charCodeAt(j));for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=base;index>=inputLength&&error("invalid-input"),digit=basicToDigit(input.charCodeAt(index++)),(digit>=base||digit>floor((maxInt-i)/w))&&error("overflow"),i+=digit*w,t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias,!(digit<t);k+=base)baseMinusT=base-t,w>floor(maxInt/baseMinusT)&&error("overflow"),w*=baseMinusT;out=output.length+1,bias=adapt(i-oldi,out,0==oldi),floor(i/out)>maxInt-n&&error("overflow"),n+=floor(i/out),i%=out,output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,inputLength,handledCPCountPlusOne,baseMinusT,qMinusT,output=[];for(input=ucs2decode(input),inputLength=input.length,n=initialN,delta=0,bias=initialBias,j=0;j<inputLength;++j)(currentValue=input[j])<128&&output.push(stringFromCharCode(currentValue));for(handledCPCount=basicLength=output.length,basicLength&&output.push(delimiter);handledCPCount<inputLength;){for(m=maxInt,j=0;j<inputLength;++j)(currentValue=input[j])>=n&&currentValue<m&&(m=currentValue);for(handledCPCountPlusOne=handledCPCount+1,m-n>floor((maxInt-delta)/handledCPCountPlusOne)&&error("overflow"),delta+=(m-n)*handledCPCountPlusOne,n=m,j=0;j<inputLength;++j)if(currentValue=input[j],currentValue<n&&++delta>maxInt&&error("overflow"),currentValue==n){for(q=delta,k=base;t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias,!(q<t);k+=base)qMinusT=q-t,baseMinusT=base-t,output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0))),q=floor(qMinusT/baseMinusT);output.push(stringFromCharCode(digitToBasic(q,0))),bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength),delta=0,++handledCPCount}++delta,++n}return output.join("")}function toUnicode(input){return mapDomain(input,function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string})}function toASCII(input){return mapDomain(input,function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string})}var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule="object"==typeof module&&module&&!module.nodeType&&module,freeGlobal="object"==typeof global&&global;freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal&&freeGlobal.self!==freeGlobal||(root=freeGlobal);var punycode,key,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode;if(punycode={version:"1.4.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:toASCII,toUnicode:toUnicode},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return punycode});else if(freeExports&&freeModule)if(module.exports==freeExports)freeModule.exports=punycode;else for(key in punycode)punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key]);else root.punycode=punycode}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],296:[function(require,module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&",eq=eq||"=";var obj={};if("string"!=typeof qs||0===qs.length)return obj;var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;options&&"number"==typeof options.maxKeys&&(maxKeys=options.maxKeys);var len=qs.length;maxKeys>0&&len>maxKeys&&(len=maxKeys);for(var i=0;i<len;++i){var kstr,vstr,k,v,x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq);idx>=0?(kstr=x.substr(0,idx),vstr=x.substr(idx+1)):(kstr=x,vstr=""),k=decodeURIComponent(kstr),v=decodeURIComponent(vstr),hasOwnProperty(obj,k)?isArray(obj[k])?obj[k].push(v):obj[k]=[obj[k],v]:obj[k]=v}return obj};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)}},{}],297:[function(require,module,exports){"use strict";function map(xs,f){if(xs.map)return xs.map(f);for(var res=[],i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){return sep=sep||"&",eq=eq||"=",null===obj&&(obj=void 0),"object"==typeof obj?map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;return isArray(obj[k])?map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))}).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):""};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)},objectKeys=Object.keys||function(obj){var res=[];for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&res.push(key);return res}},{}],298:[function(require,module,exports){"use strict";exports.decode=exports.parse=require("./decode"),exports.encode=exports.stringify=require("./encode")},{"./decode":296,"./encode":297}],299:[function(require,module,exports){"use strict";module.exports=function(arr,startIdx,removeCount){var i,length=arr.length;if(!(startIdx>=length||0===removeCount)){removeCount=startIdx+removeCount>length?length-startIdx:removeCount;var len=length-removeCount;for(i=startIdx;i<len;++i)arr[i]=arr[i+removeCount];arr.length=len}}},{}],300:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_miniSignals=require("mini-signals"),_miniSignals2=_interopRequireDefault(_miniSignals),_parseUri=require("parse-uri"),_parseUri2=_interopRequireDefault(_parseUri),_async=require("./async"),async=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_async),_Resource=require("./Resource"),_Resource2=_interopRequireDefault(_Resource),rgxExtractUrlHash=/(#[\w-]+)?$/,Loader=function(){function Loader(){var _this=this,baseUrl=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",concurrency=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;_classCallCheck(this,Loader),this.baseUrl=baseUrl,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(r,d){return _this._loadResource(r,d)},this._queue=async.queue(this._boundLoadResource,concurrency),this._queue.pause(),this.resources={},this.onProgress=new _miniSignals2.default,this.onError=new _miniSignals2.default,this.onLoad=new _miniSignals2.default,this.onStart=new _miniSignals2.default,this.onComplete=new _miniSignals2.default}return Loader.prototype.add=function(name,url,options,cb){if(Array.isArray(name)){for(var i=0;i<name.length;++i)this.add(name[i]);return this}if("object"===(void 0===name?"undefined":_typeof(name))&&(cb=url||name.callback||name.onComplete,options=name,url=name.url,name=name.name||name.key||name.url),"string"!=typeof url&&(cb=options,options=url,url=name),"string"!=typeof url)throw new Error("No url passed to add resource to loader.");if("function"==typeof options&&(cb=options,options=null),this.loading&&(!options||!options.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[name])throw new Error('Resource named "'+name+'" already exists.');if(url=this._prepareUrl(url),this.resources[name]=new _Resource2.default(name,url,options),"function"==typeof cb&&this.resources[name].onAfterMiddleware.once(cb),this.loading){for(var parent=options.parentResource,incompleteChildren=[],_i=0;_i<parent.children.length;++_i)parent.children[_i].isComplete||incompleteChildren.push(parent.children[_i]);var fullChunk=parent.progressChunk*(incompleteChildren.length+1),eachChunk=fullChunk/(incompleteChildren.length+2);parent.children.push(this.resources[name]),parent.progressChunk=eachChunk;for(var _i2=0;_i2<incompleteChildren.length;++_i2)incompleteChildren[_i2].progressChunk=eachChunk;this.resources[name].progressChunk=eachChunk}return this._queue.push(this.resources[name]),this},Loader.prototype.pre=function(fn){return this._beforeMiddleware.push(fn),this},Loader.prototype.use=function(fn){return this._afterMiddleware.push(fn),this},Loader.prototype.reset=function(){this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause();for(var k in this.resources){var res=this.resources[k];res._onLoadBinding&&res._onLoadBinding.detach(),res.isLoading&&res.abort()}return this.resources={},this},Loader.prototype.load=function(cb){if("function"==typeof cb&&this.onComplete.once(cb),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var numTasks=this._queue._tasks.length,chunk=100/numTasks,i=0;i<this._queue._tasks.length;++i)this._queue._tasks[i].data.progressChunk=chunk;this._onStart(),this._queue.resume()}return this},Loader.prototype._prepareUrl=function(url){var parsedUrl=(0,_parseUri2.default)(url,{strictMode:!0}),result=void 0;if(result=parsedUrl.protocol||!parsedUrl.path||0===url.indexOf("//")?url:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==url.charAt(0)?this.baseUrl+"/"+url:this.baseUrl+url,this.defaultQueryString){var hash=rgxExtractUrlHash.exec(result)[0];result=result.substr(0,result.length-hash.length),-1!==result.indexOf("?")?result+="&"+this.defaultQueryString:result+="?"+this.defaultQueryString,result+=hash}return result},Loader.prototype._loadResource=function(resource,dequeue){var _this2=this;resource._dequeue=dequeue,async.eachSeries(this._beforeMiddleware,function(fn,next){fn.call(_this2,resource,function(){next(resource.isComplete?{}:null)})},function(){resource.isComplete?_this2._onLoad(resource):(resource._onLoadBinding=resource.onComplete.once(_this2._onLoad,_this2),resource.load())},!0)},Loader.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},Loader.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},Loader.prototype._onLoad=function(resource){var _this3=this;resource._onLoadBinding=null,this._resourcesParsing.push(resource),resource._dequeue(),async.eachSeries(this._afterMiddleware,function(fn,next){fn.call(_this3,resource,next)},function(){resource.onAfterMiddleware.dispatch(resource),_this3.progress+=resource.progressChunk,_this3.onProgress.dispatch(_this3,resource),resource.error?_this3.onError.dispatch(resource.error,_this3,resource):_this3.onLoad.dispatch(_this3,resource),_this3._resourcesParsing.splice(_this3._resourcesParsing.indexOf(resource),1),_this3._queue.idle()&&0===_this3._resourcesParsing.length&&_this3._onComplete()},!0)},_createClass(Loader,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(concurrency){this._queue.concurrency=concurrency}}]),Loader}();exports.default=Loader},{"./Resource":301,"./async":302,"mini-signals":123,"parse-uri":125}],301:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _noop(){}function setExtMap(map,extname,val){extname&&0===extname.indexOf(".")&&(extname=extname.substring(1)),extname&&(map[extname]=val)}function reqType(xhr){return xhr.toString().replace("object ","")}exports.__esModule=!0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_parseUri=require("parse-uri"),_parseUri2=_interopRequireDefault(_parseUri),_miniSignals=require("mini-signals"),_miniSignals2=_interopRequireDefault(_miniSignals),useXdr=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),tempAnchor=null,Resource=function(){function Resource(name,url,options){if(_classCallCheck(this,Resource),"string"!=typeof name||"string"!=typeof url)throw new Error("Both name and url are required for constructing a resource.");options=options||{},this._flags=0,this._setFlag(Resource.STATUS_FLAGS.DATA_URL,0===url.indexOf("data:")),this.name=name,this.url=url,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===options.crossOrigin?"anonymous":options.crossOrigin,this.loadType=options.loadType||this._determineLoadType(),this.xhrType=options.xhrType,this.metadata=options.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=Resource.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=_noop,this._onLoadBinding=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this),this.onStart=new _miniSignals2.default,this.onProgress=new _miniSignals2.default,this.onComplete=new _miniSignals2.default,this.onAfterMiddleware=new _miniSignals2.default}return Resource.setExtensionLoadType=function(extname,loadType){setExtMap(Resource._loadTypeMap,extname,loadType)},Resource.setExtensionXhrType=function(extname,xhrType){setExtMap(Resource._xhrTypeMap,extname,xhrType)},Resource.prototype.complete=function(){if(this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null)),this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(Resource.STATUS_FLAGS.COMPLETE,!0),this._setFlag(Resource.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},Resource.prototype.abort=function(message){if(!this.error){if(this.error=new Error(message),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=Resource.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this.complete()}},Resource.prototype.load=function(cb){var _this=this;if(!this.isLoading){if(this.isComplete)return void(cb&&setTimeout(function(){return cb(_this)},1));switch(cb&&this.onComplete.once(cb),this._setFlag(Resource.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case Resource.LOAD_TYPE.IMAGE:this.type=Resource.TYPE.IMAGE,this._loadElement("image");break;case Resource.LOAD_TYPE.AUDIO:this.type=Resource.TYPE.AUDIO,this._loadSourceElement("audio");break;case Resource.LOAD_TYPE.VIDEO:this.type=Resource.TYPE.VIDEO,this._loadSourceElement("video");break;case Resource.LOAD_TYPE.XHR:default:useXdr&&this.crossOrigin?this._loadXdr():this._loadXhr()}}},Resource.prototype._hasFlag=function(flag){return!!(this._flags&flag)},Resource.prototype._setFlag=function(flag,value){this._flags=value?this._flags|flag:this._flags&~flag},Resource.prototype._loadElement=function(type){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===type&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(type),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1)},Resource.prototype._loadSourceElement=function(type){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===type&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(type),null===this.data)return void this.abort("Unsupported element: "+type);if(!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var mimeTypes=this.metadata.mimeType,i=0;i<this.url.length;++i)this.data.appendChild(this._createSource(type,this.url[i],Array.isArray(mimeTypes)?mimeTypes[i]:mimeTypes));else{var _mimeTypes=this.metadata.mimeType;this.data.appendChild(this._createSource(type,this.url,Array.isArray(_mimeTypes)?_mimeTypes[0]:_mimeTypes))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load()},Resource.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var xhr=this.xhr=new XMLHttpRequest;xhr.open("GET",this.url,!0),this.xhrType===Resource.XHR_RESPONSE_TYPE.JSON||this.xhrType===Resource.XHR_RESPONSE_TYPE.DOCUMENT?xhr.responseType=Resource.XHR_RESPONSE_TYPE.TEXT:xhr.responseType=this.xhrType,xhr.addEventListener("error",this._boundXhrOnError,!1),xhr.addEventListener("abort",this._boundXhrOnAbort,!1),xhr.addEventListener("progress",this._boundOnProgress,!1),xhr.addEventListener("load",this._boundXhrOnLoad,!1),xhr.send()},Resource.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var xdr=this.xhr=new XDomainRequest;xdr.timeout=5e3,xdr.onerror=this._boundXhrOnError,xdr.ontimeout=this._boundXdrOnTimeout,xdr.onprogress=this._boundOnProgress,xdr.onload=this._boundXhrOnLoad,xdr.open("GET",this.url,!0),setTimeout(function(){return xdr.send()},1)},Resource.prototype._createSource=function(type,url,mime){mime||(mime=type+"/"+this._getExtension(url));var source=document.createElement("source");return source.src=url,source.type=mime,source},Resource.prototype._onError=function(event){this.abort("Failed to load element using: "+event.target.nodeName)},Resource.prototype._onProgress=function(event){event&&event.lengthComputable&&this.onProgress.dispatch(this,event.loaded/event.total)},Resource.prototype._xhrOnError=function(){var xhr=this.xhr;this.abort(reqType(xhr)+" Request failed. Status: "+xhr.status+', text: "'+xhr.statusText+'"')},Resource.prototype._xhrOnAbort=function(){this.abort(reqType(this.xhr)+" Request was aborted by the user.")},Resource.prototype._xdrOnTimeout=function(){this.abort(reqType(this.xhr)+" Request timed out.")},Resource.prototype._xhrOnLoad=function(){var xhr=this.xhr,text="",status=void 0===xhr.status?200:xhr.status;if(""!==xhr.responseType&&"text"!==xhr.responseType&&void 0!==xhr.responseType||(text=xhr.responseText),0===status&&(text.length>0||xhr.responseType===Resource.XHR_RESPONSE_TYPE.BUFFER)?status=200:1223===status&&(status=204),2!=(status/100|0))return void this.abort("["+xhr.status+"] "+xhr.statusText+": "+xhr.responseURL);if(this.xhrType===Resource.XHR_RESPONSE_TYPE.TEXT)this.data=text,this.type=Resource.TYPE.TEXT;else if(this.xhrType===Resource.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(text),this.type=Resource.TYPE.JSON}catch(e){return void this.abort("Error trying to parse loaded json: "+e)}else if(this.xhrType===Resource.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var domparser=new DOMParser;this.data=domparser.parseFromString(text,"text/xml")}else{var div=document.createElement("div");div.innerHTML=text,this.data=div}this.type=Resource.TYPE.XML}catch(e){return void this.abort("Error trying to parse loaded xml: "+e)}else this.data=xhr.response||text;this.complete()},Resource.prototype._determineCrossOrigin=function(url,loc){if(0===url.indexOf("data:"))return"";loc=loc||window.location,tempAnchor||(tempAnchor=document.createElement("a")),tempAnchor.href=url,url=(0,_parseUri2.default)(tempAnchor.href,{strictMode:!0});var samePort=!url.port&&""===loc.port||url.port===loc.port,protocol=url.protocol?url.protocol+":":"";return url.host===loc.hostname&&samePort&&protocol===loc.protocol?"":"anonymous"},Resource.prototype._determineXhrType=function(){return Resource._xhrTypeMap[this.extension]||Resource.XHR_RESPONSE_TYPE.TEXT},Resource.prototype._determineLoadType=function(){return Resource._loadTypeMap[this.extension]||Resource.LOAD_TYPE.XHR},Resource.prototype._getExtension=function(){var url=this.url,ext="";if(this.isDataUrl){var slashIndex=url.indexOf("/");ext=url.substring(slashIndex+1,url.indexOf(";",slashIndex))}else{var queryStart=url.indexOf("?"),hashStart=url.indexOf("#"),index=Math.min(queryStart>-1?queryStart:url.length,hashStart>-1?hashStart:url.length);url=url.substring(0,index),ext=url.substring(url.lastIndexOf(".")+1)}return ext.toLowerCase()},Resource.prototype._getMimeFromXhrType=function(type){switch(type){case Resource.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case Resource.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case Resource.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case Resource.XHR_RESPONSE_TYPE.JSON:return"application/json";case Resource.XHR_RESPONSE_TYPE.DEFAULT:case Resource.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},_createClass(Resource,[{key:"isDataUrl",get:function(){return this._hasFlag(Resource.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(Resource.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(Resource.STATUS_FLAGS.LOADING)}}]),Resource}();exports.default=Resource,Resource.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},Resource.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},Resource.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},Resource.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},Resource._loadTypeMap={gif:Resource.LOAD_TYPE.IMAGE,png:Resource.LOAD_TYPE.IMAGE,bmp:Resource.LOAD_TYPE.IMAGE,jpg:Resource.LOAD_TYPE.IMAGE,jpeg:Resource.LOAD_TYPE.IMAGE,tif:Resource.LOAD_TYPE.IMAGE,tiff:Resource.LOAD_TYPE.IMAGE,webp:Resource.LOAD_TYPE.IMAGE,tga:Resource.LOAD_TYPE.IMAGE,svg:Resource.LOAD_TYPE.IMAGE,"svg+xml":Resource.LOAD_TYPE.IMAGE,mp3:Resource.LOAD_TYPE.AUDIO,ogg:Resource.LOAD_TYPE.AUDIO,wav:Resource.LOAD_TYPE.AUDIO,mp4:Resource.LOAD_TYPE.VIDEO,webm:Resource.LOAD_TYPE.VIDEO},Resource._xhrTypeMap={xhtml:Resource.XHR_RESPONSE_TYPE.DOCUMENT,html:Resource.XHR_RESPONSE_TYPE.DOCUMENT,htm:Resource.XHR_RESPONSE_TYPE.DOCUMENT,xml:Resource.XHR_RESPONSE_TYPE.DOCUMENT,tmx:Resource.XHR_RESPONSE_TYPE.DOCUMENT,svg:Resource.XHR_RESPONSE_TYPE.DOCUMENT,tsx:Resource.XHR_RESPONSE_TYPE.DOCUMENT,gif:Resource.XHR_RESPONSE_TYPE.BLOB,png:Resource.XHR_RESPONSE_TYPE.BLOB,bmp:Resource.XHR_RESPONSE_TYPE.BLOB,jpg:Resource.XHR_RESPONSE_TYPE.BLOB,jpeg:Resource.XHR_RESPONSE_TYPE.BLOB,tif:Resource.XHR_RESPONSE_TYPE.BLOB,tiff:Resource.XHR_RESPONSE_TYPE.BLOB,webp:Resource.XHR_RESPONSE_TYPE.BLOB,tga:Resource.XHR_RESPONSE_TYPE.BLOB,json:Resource.XHR_RESPONSE_TYPE.JSON,text:Resource.XHR_RESPONSE_TYPE.TEXT,txt:Resource.XHR_RESPONSE_TYPE.TEXT,ttf:Resource.XHR_RESPONSE_TYPE.BUFFER,otf:Resource.XHR_RESPONSE_TYPE.BUFFER},Resource.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="},{"mini-signals":123,"parse-uri":125}],302:[function(require,module,exports){"use strict";function _noop(){}function eachSeries(array,iterator,callback,deferNext){var i=0,len=array.length;!function next(err){if(err||i===len)return void(callback&&callback(err));deferNext?setTimeout(function(){iterator(array[i++],next)},1):iterator(array[i++],next)}()}function onlyOnce(fn){return function(){if(null===fn)throw new Error("Callback was already called.");var callFn=fn;fn=null,callFn.apply(this,arguments)}}function queue(worker,concurrency){function _insert(data,insertAtFront,callback){if(null!=callback&&"function"!=typeof callback)throw new Error("task callback must be a function");if(q.started=!0,null==data&&q.idle())return void setTimeout(function(){return q.drain()},1);var item={data:data,callback:"function"==typeof callback?callback:_noop};insertAtFront?q._tasks.unshift(item):q._tasks.push(item),setTimeout(function(){return q.process()},1)}function _next(task){return function(){workers-=1,task.callback.apply(task,arguments),null!=arguments[0]&&q.error(arguments[0],task.data),workers<=q.concurrency-q.buffer&&q.unsaturated(),q.idle()&&q.drain(),q.process()}}if(null==concurrency)concurrency=1;else if(0===concurrency)throw new Error("Concurrency must not be zero");var workers=0,q={_tasks:[],concurrency:concurrency,saturated:_noop,unsaturated:_noop,buffer:concurrency/4,empty:_noop,drain:_noop,error:_noop,started:!1,paused:!1,push:function(data,callback){_insert(data,!1,callback)},kill:function(){workers=0,q.drain=_noop,q.started=!1,q._tasks=[]},unshift:function(data,callback){_insert(data,!0,callback)},process:function(){for(;!q.paused&&workers<q.concurrency&&q._tasks.length;){var task=q._tasks.shift();0===q._tasks.length&&q.empty(),workers+=1,workers===q.concurrency&&q.saturated(),worker(task.data,onlyOnce(_next(task)))}},length:function(){return q._tasks.length},running:function(){return workers},idle:function(){return q._tasks.length+workers===0},pause:function(){!0!==q.paused&&(q.paused=!0)},resume:function(){if(!1!==q.paused){q.paused=!1;for(var w=1;w<=q.concurrency;w++)q.process()}}};return q}exports.__esModule=!0,exports.eachSeries=eachSeries,exports.queue=queue},{}],303:[function(require,module,exports){"use strict";function encodeBinary(input){for(var output="",inx=0;inx<input.length;){for(var bytebuffer=[0,0,0],encodedCharIndexes=[0,0,0,0],jnx=0;jnx<bytebuffer.length;++jnx)inx<input.length?bytebuffer[jnx]=255&input.charCodeAt(inx++):bytebuffer[jnx]=0;encodedCharIndexes[0]=bytebuffer[0]>>2,encodedCharIndexes[1]=(3&bytebuffer[0])<<4|bytebuffer[1]>>4,encodedCharIndexes[2]=(15&bytebuffer[1])<<2|bytebuffer[2]>>6,encodedCharIndexes[3]=63&bytebuffer[2];switch(inx-(input.length-1)){case 2:encodedCharIndexes[3]=64,encodedCharIndexes[2]=64;break;case 1:encodedCharIndexes[3]=64}for(var _jnx=0;_jnx<encodedCharIndexes.length;++_jnx)output+=_keyStr.charAt(encodedCharIndexes[_jnx])}return output}exports.__esModule=!0,exports.encodeBinary=encodeBinary;var _keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},{}],304:[function(require,module,exports){"use strict";var Loader=require("./Loader").default,Resource=require("./Resource").default,async=require("./async"),b64=require("./b64");Loader.Resource=Resource,Loader.async=async,Loader.base64=b64,module.exports=Loader,module.exports.default=Loader},{"./Loader":300,"./Resource":301,"./async":302,"./b64":303}],305:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function blobMiddlewareFactory(){
return function(resource,next){if(!resource.data)return void next();if(resource.xhr&&resource.xhrType===_Resource2.default.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof resource.data){if(0===resource.data.type.indexOf("image")){var _ret=function(){var src=Url.createObjectURL(resource.data);return resource.blob=resource.data,resource.data=new Image,resource.data.src=src,resource.type=_Resource2.default.TYPE.IMAGE,resource.data.onload=function(){Url.revokeObjectURL(src),resource.data.onload=null,next()},{v:void 0}}();if("object"===(void 0===_ret?"undefined":_typeof(_ret)))return _ret.v}}else{var type=resource.xhr.getResponseHeader("content-type");if(type&&0===type.indexOf("image"))return resource.data=new Image,resource.data.src="data:"+type+";base64,"+_b2.default.encodeBinary(resource.xhr.responseText),resource.type=_Resource2.default.TYPE.IMAGE,void(resource.data.onload=function(){resource.data.onload=null,next()})}next()}}exports.__esModule=!0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.blobMiddlewareFactory=blobMiddlewareFactory;var _Resource=require("../../Resource"),_Resource2=_interopRequireDefault(_Resource),_b=require("../../b64"),_b2=_interopRequireDefault(_b),Url=window.URL||window.webkitURL},{"../../Resource":301,"../../b64":303}],306:[function(require,module,exports){(function(setImmediate,clearImmediate){function Timeout(id,clearFn){this._id=id,this._clearFn=clearFn}var nextTick=require("process/browser.js").nextTick,apply=Function.prototype.apply,slice=Array.prototype.slice,immediateIds={},nextImmediateId=0;exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)},exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)},exports.clearTimeout=exports.clearInterval=function(timeout){timeout.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(window,this._id)},exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId),item._idleTimeout=msecs},exports.unenroll=function(item){clearTimeout(item._idleTimeoutId),item._idleTimeout=-1},exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;msecs>=0&&(item._idleTimeoutId=setTimeout(function(){item._onTimeout&&item._onTimeout()},msecs))},exports.setImmediate="function"==typeof setImmediate?setImmediate:function(fn){var id=nextImmediateId++,args=!(arguments.length<2)&&slice.call(arguments,1);return immediateIds[id]=!0,nextTick(function(){immediateIds[id]&&(args?fn.apply(null,args):fn.call(null),exports.clearImmediate(id))}),id},exports.clearImmediate="function"==typeof clearImmediate?clearImmediate:function(id){delete immediateIds[id]}}).call(this,require("timers").setImmediate,require("timers").clearImmediate)},{"process/browser.js":294,timers:306}],307:[function(require,module,exports){"use strict";var tweenFunctions={linear:function(t,b,_c,d){return(_c-b)*t/d+b},easeInQuad:function(t,b,_c,d){return(_c-b)*(t/=d)*t+b},easeOutQuad:function(t,b,_c,d){return-(_c-b)*(t/=d)*(t-2)+b},easeInOutQuad:function(t,b,_c,d){var c=_c-b;return(t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b},easeInCubic:function(t,b,_c,d){return(_c-b)*(t/=d)*t*t+b},easeOutCubic:function(t,b,_c,d){return(_c-b)*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(t,b,_c,d){var c=_c-b;return(t/=d/2)<1?c/2*t*t*t+b:c/2*((t-=2)*t*t+2)+b},easeInQuart:function(t,b,_c,d){return(_c-b)*(t/=d)*t*t*t+b},easeOutQuart:function(t,b,_c,d){return-(_c-b)*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(t,b,_c,d){var c=_c-b;return(t/=d/2)<1?c/2*t*t*t*t+b:-c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(t,b,_c,d){return(_c-b)*(t/=d)*t*t*t*t+b},easeOutQuint:function(t,b,_c,d){return(_c-b)*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(t,b,_c,d){var c=_c-b;return(t/=d/2)<1?c/2*t*t*t*t*t+b:c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(t,b,_c,d){var c=_c-b;return-c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(t,b,_c,d){return(_c-b)*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(t,b,_c,d){return-(_c-b)/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(t,b,_c,d){var c=_c-b;return 0==t?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(t,b,_c,d){var c=_c-b;return t==d?b+c:c*(1-Math.pow(2,-10*t/d))+b},easeInOutExpo:function(t,b,_c,d){var c=_c-b;return 0===t?b:t===d?b+c:(t/=d/2)<1?c/2*Math.pow(2,10*(t-1))+b:c/2*(2-Math.pow(2,-10*--t))+b},easeInCirc:function(t,b,_c,d){return-(_c-b)*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(t,b,_c,d){return(_c-b)*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(t,b,_c,d){var c=_c-b;return(t/=d/2)<1?-c/2*(Math.sqrt(1-t*t)-1)+b:c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(t,b,_c,d){var a,p,s,c=_c-b;return s=1.70158,p=0,a=c,0===t?b:1==(t/=d)?b+c:(p||(p=.3*d),a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),-a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)+b)},easeOutElastic:function(t,b,_c,d){var a,p,s,c=_c-b;return s=1.70158,p=0,a=c,0===t?b:1==(t/=d)?b+c:(p||(p=.3*d),a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b)},easeInOutElastic:function(t,b,_c,d){var a,p,s,c=_c-b;return s=1.70158,p=0,a=c,0===t?b:2==(t/=d/2)?b+c:(p||(p=d*(.3*1.5)),a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),t<1?a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*-.5+b:a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b)},easeInBack:function(t,b,_c,d,s){var c=_c-b;return void 0===s&&(s=1.70158),c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(t,b,_c,d,s){var c=_c-b;return void 0===s&&(s=1.70158),c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(t,b,_c,d,s){var c=_c-b;return void 0===s&&(s=1.70158),(t/=d/2)<1?c/2*(t*t*((1+(s*=1.525))*t-s))+b:c/2*((t-=2)*t*((1+(s*=1.525))*t+s)+2)+b},easeInBounce:function(t,b,_c,d){var v,c=_c-b;return v=tweenFunctions.easeOutBounce(d-t,0,c,d),c-v+b},easeOutBounce:function(t,b,_c,d){var c=_c-b;return(t/=d)<1/2.75?c*(7.5625*t*t)+b:t<2/2.75?c*(7.5625*(t-=1.5/2.75)*t+.75)+b:t<2.5/2.75?c*(7.5625*(t-=2.25/2.75)*t+.9375)+b:c*(7.5625*(t-=2.625/2.75)*t+.984375)+b},easeInOutBounce:function(t,b,_c,d){var c=_c-b;return t<d/2?.5*tweenFunctions.easeInBounce(2*t,0,c,d)+b:.5*tweenFunctions.easeOutBounce(2*t-d,0,c,d)+.5*c+b}};module.exports=tweenFunctions},{}],308:[function(require,module,exports){"use strict";function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&util.isObject(url)&&url instanceof Url)return url;var u=new Url;return u.parse(url,parseQueryString,slashesDenoteHost),u}function urlFormat(obj){return util.isString(obj)&&(obj=urlParse(obj)),obj instanceof Url?obj.format():Url.prototype.format.call(obj)}function urlResolve(source,relative){return urlParse(source,!1,!0).resolve(relative)}function urlResolveObject(source,relative){return source?urlParse(source,!1,!0).resolveObject(relative):relative}var punycode=require("punycode"),util=require("./util");exports.parse=urlParse,exports.resolve=urlResolve,exports.resolveObject=urlResolveObject,exports.format=urlFormat,exports.Url=Url;var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r","\n","\t"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=require("querystring");Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!util.isString(url))throw new TypeError("Parameter 'url' must be a string, not "+typeof url);var queryIndex=url.indexOf("?"),splitter=-1!==queryIndex&&queryIndex<url.indexOf("#")?"?":"#",uSplit=url.split(splitter),slashRegex=/\\/g;uSplit[0]=uSplit[0].replace(slashRegex,"/"),url=uSplit.join(splitter);var rest=url;if(rest=rest.trim(),!slashesDenoteHost&&1===url.split("#").length){var simplePath=simplePathPattern.exec(rest);if(simplePath)return this.path=rest,this.href=rest,this.pathname=simplePath[1],simplePath[2]?(this.search=simplePath[2],this.query=parseQueryString?querystring.parse(this.search.substr(1)):this.search.substr(1)):parseQueryString&&(this.search="",this.query={}),this}var proto=protocolPattern.exec(rest);if(proto){proto=proto[0];var lowerProto=proto.toLowerCase();this.protocol=lowerProto,rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes="//"===rest.substr(0,2);!slashes||proto&&hostlessProtocol[proto]||(rest=rest.substr(2),this.slashes=!0)}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){for(var hostEnd=-1,i=0;i<hostEndingChars.length;i++){var hec=rest.indexOf(hostEndingChars[i]);-1!==hec&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}var auth,atSign;atSign=-1===hostEnd?rest.lastIndexOf("@"):rest.lastIndexOf("@",hostEnd),-1!==atSign&&(auth=rest.slice(0,atSign),rest=rest.slice(atSign+1),this.auth=decodeURIComponent(auth)),hostEnd=-1;for(var i=0;i<nonHostChars.length;i++){var hec=rest.indexOf(nonHostChars[i]);-1!==hec&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}-1===hostEnd&&(hostEnd=rest.length),this.host=rest.slice(0,hostEnd),rest=rest.slice(hostEnd),this.parseHost(),this.hostname=this.hostname||"";var ipv6Hostname="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!ipv6Hostname)for(var hostparts=this.hostname.split(/\./),i=0,l=hostparts.length;i<l;i++){var part=hostparts[i];if(part&&!part.match(hostnamePartPattern)){for(var newpart="",j=0,k=part.length;j<k;j++)part.charCodeAt(j)>127?newpart+="x":newpart+=part[j];if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i),notHost=hostparts.slice(i+1),bit=part.match(hostnamePartStart);bit&&(validParts.push(bit[1]),notHost.unshift(bit[2])),notHost.length&&(rest="/"+notHost.join(".")+rest),this.hostname=validParts.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),ipv6Hostname||(this.hostname=punycode.toASCII(this.hostname));var p=this.port?":"+this.port:"",h=this.hostname||"";this.host=h+p,this.href+=this.host,ipv6Hostname&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==rest[0]&&(rest="/"+rest))}if(!unsafeProtocol[lowerProto])for(var i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];if(-1!==rest.indexOf(ae)){var esc=encodeURIComponent(ae);esc===ae&&(esc=escape(ae)),rest=rest.split(ae).join(esc)}}var hash=rest.indexOf("#");-1!==hash&&(this.hash=rest.substr(hash),rest=rest.slice(0,hash));var qm=rest.indexOf("?");if(-1!==qm?(this.search=rest.substr(qm),this.query=rest.substr(qm+1),parseQueryString&&(this.query=querystring.parse(this.query)),rest=rest.slice(0,qm)):parseQueryString&&(this.search="",this.query={}),rest&&(this.pathname=rest),slashedProtocol[lowerProto]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var p=this.pathname||"",s=this.search||"";this.path=p+s}return this.href=this.format(),this},Url.prototype.format=function(){var auth=this.auth||"";auth&&(auth=encodeURIComponent(auth),auth=auth.replace(/%3A/i,":"),auth+="@");var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=!1,query="";this.host?host=auth+this.host:this.hostname&&(host=auth+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(host+=":"+this.port)),this.query&&util.isObject(this.query)&&Object.keys(this.query).length&&(query=querystring.stringify(this.query));var search=this.search||query&&"?"+query||"";return protocol&&":"!==protocol.substr(-1)&&(protocol+=":"),this.slashes||(!protocol||slashedProtocol[protocol])&&!1!==host?(host="//"+(host||""),pathname&&"/"!==pathname.charAt(0)&&(pathname="/"+pathname)):host||(host=""),hash&&"#"!==hash.charAt(0)&&(hash="#"+hash),search&&"?"!==search.charAt(0)&&(search="?"+search),pathname=pathname.replace(/[?#]/g,function(match){return encodeURIComponent(match)}),search=search.replace("#","%23"),protocol+host+pathname+search+hash},Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,!1,!0)).format()},Url.prototype.resolveObject=function(relative){if(util.isString(relative)){var rel=new Url;rel.parse(relative,!1,!0),relative=rel}for(var result=new Url,tkeys=Object.keys(this),tk=0;tk<tkeys.length;tk++){var tkey=tkeys[tk];result[tkey]=this[tkey]}if(result.hash=relative.hash,""===relative.href)return result.href=result.format(),result;if(relative.slashes&&!relative.protocol){for(var rkeys=Object.keys(relative),rk=0;rk<rkeys.length;rk++){var rkey=rkeys[rk];"protocol"!==rkey&&(result[rkey]=relative[rkey])}return slashedProtocol[result.protocol]&&result.hostname&&!result.pathname&&(result.path=result.pathname="/"),result.href=result.format(),result}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){for(var keys=Object.keys(relative),v=0;v<keys.length;v++){var k=keys[v];result[k]=relative[k]}return result.href=result.format(),result}if(result.protocol=relative.protocol,relative.host||hostlessProtocol[relative.protocol])result.pathname=relative.pathname;else{for(var relPath=(relative.pathname||"").split("/");relPath.length&&!(relative.host=relPath.shift()););relative.host||(relative.host=""),relative.hostname||(relative.hostname=""),""!==relPath[0]&&relPath.unshift(""),relPath.length<2&&relPath.unshift(""),result.pathname=relPath.join("/")}if(result.search=relative.search,result.query=relative.query,result.host=relative.host||"",result.auth=relative.auth,result.hostname=relative.hostname||relative.host,result.port=relative.port,result.pathname||result.search){var p=result.pathname||"",s=result.search||"";result.path=p+s}return result.slashes=result.slashes||relative.slashes,result.href=result.format(),result}var isSourceAbs=result.pathname&&"/"===result.pathname.charAt(0),isRelAbs=relative.host||relative.pathname&&"/"===relative.pathname.charAt(0),mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],relPath=relative.pathname&&relative.pathname.split("/")||[],psychotic=result.protocol&&!slashedProtocol[result.protocol];if(psychotic&&(result.hostname="",result.port=null,result.host&&(""===srcPath[0]?srcPath[0]=result.host:srcPath.unshift(result.host)),result.host="",relative.protocol&&(relative.hostname=null,relative.port=null,relative.host&&(""===relPath[0]?relPath[0]=relative.host:relPath.unshift(relative.host)),relative.host=null),mustEndAbs=mustEndAbs&&(""===relPath[0]||""===srcPath[0])),isRelAbs)result.host=relative.host||""===relative.host?relative.host:result.host,result.hostname=relative.hostname||""===relative.hostname?relative.hostname:result.hostname,result.search=relative.search,result.query=relative.query,srcPath=relPath;else if(relPath.length)srcPath||(srcPath=[]),srcPath.pop(),srcPath=srcPath.concat(relPath),result.search=relative.search,result.query=relative.query;else if(!util.isNullOrUndefined(relative.search)){if(psychotic){result.hostname=result.host=srcPath.shift();var authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@");authInHost&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift())}return result.search=relative.search,result.query=relative.query,util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.href=result.format(),result}if(!srcPath.length)return result.pathname=null,result.search?result.path="/"+result.search:result.path=null,result.href=result.format(),result;for(var last=srcPath.slice(-1)[0],hasTrailingSlash=(result.host||relative.host||srcPath.length>1)&&("."===last||".."===last)||""===last,up=0,i=srcPath.length;i>=0;i--)last=srcPath[i],"."===last?srcPath.splice(i,1):".."===last?(srcPath.splice(i,1),up++):up&&(srcPath.splice(i,1),up--);if(!mustEndAbs&&!removeAllDots)for(;up--;up)srcPath.unshift("..");!mustEndAbs||""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0)||srcPath.unshift(""),hasTrailingSlash&&"/"!==srcPath.join("/").substr(-1)&&srcPath.push("");var isAbsolute=""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0);if(psychotic){result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"";var authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@");authInHost&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift())}return mustEndAbs=mustEndAbs||result.host&&srcPath.length,mustEndAbs&&!isAbsolute&&srcPath.unshift(""),srcPath.length?result.pathname=srcPath.join("/"):(result.pathname=null,result.path=null),util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.auth=relative.auth||result.auth,result.slashes=result.slashes||relative.slashes,result.href=result.format(),result},Url.prototype.parseHost=function(){var host=this.host,port=portPattern.exec(host);port&&(port=port[0],":"!==port&&(this.port=port.substr(1)),host=host.substr(0,host.length-port.length)),host&&(this.hostname=host)}},{"./util":309,punycode:295,querystring:298}],309:[function(require,module,exports){"use strict";module.exports={isString:function(arg){return"string"==typeof arg},isObject:function(arg){return"object"==typeof arg&&null!==arg},isNull:function(arg){return null===arg},isNullOrUndefined:function(arg){return null==arg}}},{}]},{},[12]);
